<?xml version="1.0"?> <!-- -*- nxml -*- -->
<transfer default="chunk">
  <section-def-cats>
    <def-cat n="nom">
      <cat-item tags="n.*"/><!--Falten els altres np (antroponims) que tenen gen i nbr, revisar regles.-->
      <cat-item tags="np.loc.*"/>
    </def-cat>

     <def-cat n="ant">
      <cat-item tags="np.ant.*"/>
    </def-cat>

 <def-cat n="sent">
       <cat-item tags="sent"/>
     </def-cat>

 <def-cat n="sent_coma">
       <cat-item tags="cm"/><!-- provem amb la coma EO, per a poder tractar el pro-drop-->
     </def-cat>

    <def-cat n="adj">
      <cat-item tags="adj.*"/>
      <cat-item tags="adj.pos.*"/>
      <cat-item tags="vblex.pp.*"/>
    </def-cat>
    
    <def-cat n="adjADJ"> <!-- únicament adjs, no pp -->
      <cat-item tags="adj.*"/>
      <cat-item tags="adj.pos.*"/>
    </def-cat>
    
    <def-cat n="article">
      <cat-item lemma="el" tags="det.*"/>
    </def-cat>

    
   <def-cat n="det"><!--Determinants i predeterminants, van anteposats en català -->
      <cat-item tags="det.dem.*"/>
      <cat-item tags="det.ind.*"/>
      <cat-item tags="det.def.*"/>
      <cat-item tags="det.pos.*"/>
      <cat-item tags="det.qnt.*"/>
      <cat-item tags="det.itg.*"/>
      <cat-item tags="det.ord.*"/>
      <cat-item tags="predet.*"/>
      <cat-item tags="num.*"/> 
    </def-cat>


   <def-cat n="dem">
      <cat-item tags="det.dem.*"/>
    </def-cat>
   <def-cat n="def">
      <cat-item tags="det.def.*"/>
    </def-cat>
   <def-cat n="tot">
      <cat-item tags="det.qnt.*"/>
    </def-cat>

    <def-cat n="num">
      <cat-item tags="num.*"/>
      <cat-item tags="num"/>
    </def-cat>

    <def-cat n="prep">
      <cat-item tags="pr"/>
    </def-cat>

    <def-cat n="prpers">
      <cat-item lemma="prpers" tags="prn.*"/>
    </def-cat>

    <def-cat n="tn"><!--EO indefnitis i companyia sense gènere al EO-->
      <cat-item tags="prn.tn.m.*"/>
      <cat-item tags="prn.tn.f.*"/>
      <cat-item tags="prn.tn.mf.*"/>
    </def-cat>
    
    <def-cat n="tn_itg_pos"><!--Aquí no hi entren els pronoms personals, caldrà fer-ne un xunc a part. -->
      <!--<cat-item tags="prn.tn.m.*"/>
      <cat-item tags="prn.tn.f.*"/>
      <cat-item tags="prn.tn.mf.*"/>-->
      <cat-item tags="prn.itg.*"/>
      <cat-item tags="prn.pos.*"/>
    </def-cat>
    
    <def-cat n="pos"><!-- pel tagger-->
      <cat-item tags="prn.pos.*"/>
    </def-cat>

    <def-cat n="proenc">
      <cat-item lemma="prpers" tags="prn.enc.*"/>
      <cat-item lemma="prpers" tags="prn.pro.*"/>
      <cat-item lemma="es" tags="prn.pro.*"/>
      <cat-item lemma="es" tags="prn.enc.*"/>
    </def-cat>

    <def-cat n="profort"> <!-- ver regla PRO_FORT...-->
      <cat-item lemma="prpers_fort" tags="prn.pro.*"/>
    </def-cat>


    <def-cat n="relatiu"> <!-- EO-->
      <cat-item tags="prn.rel.*"/>
    </def-cat>

    <def-cat n="relatiu_prep"> <!-- EO-->
      <cat-item tags="rel.*"/>
    </def-cat>

    <def-cat n="enc">
      <cat-item tags="prn.enc.*"/>
    </def-cat>

    <def-cat n="pro">
      <cat-item tags="prn.pro.*"/>
    </def-cat>

    <def-cat n="verbnm_inf_ger"><!--verb no modal, infinitiu i gerundi -->
      <cat-item tags="vblex.inf"/>
      <cat-item tags="vblex.pron.inf"/>
      <cat-item tags="vbser.inf"/>
      <cat-item tags="vbser.pron.inf"/>
      <cat-item tags="vbhaver.inf"/>
      <cat-item tags="vbhaver.pron.inf"/>
      <cat-item tags="vblex.ger"/>
      <cat-item tags="vblex.pron.ger"/>
      <cat-item tags="vbser.ger"/>
      <cat-item tags="vbser.pron.ger"/>
      <cat-item tags="vbhaver.ger"/>
      <cat-item tags="vbhaver.pron.ger"/>
    </def-cat>

    <def-cat n="verbnm_imp"><!--verb no modal, imperatiu -->
      <cat-item tags="vblex.imp.*"/>
      <cat-item tags="vblex.pron.imp.*"/>
      <cat-item tags="vbser.imp.*"/>
      <cat-item tags="vbser.pron.imp.*"/>
      <cat-item tags="vbhaver.imp.*"/>
      <cat-item tags="vbhaver.pron.imp.*"/>
    </def-cat>

    <def-cat n="verbm"><!--verb modal -->
      <cat-item tags="vbmod.*"/>
    </def-cat>

    <def-cat n="inf_imp"><!--verb modal, infinitiu o gerundi -->
      <cat-item tags="vblex.inf"/>
      <cat-item tags="vblex.imp.*"/>
    </def-cat>

    <def-cat n="verbm_inf_ger"><!--verb modal, infinitiu o gerundi -->
      <cat-item tags="vbmod.inf"/>
      <cat-item tags="vbmod.ger"/>
    </def-cat>

    <def-cat n="haver">
      <cat-item tags="vbhaver.*"/>
    </def-cat>

    <def-cat n="caldre">
      <cat-item lemma="caldre" tags="vbmod.*"/>
    </def-cat>

    <def-cat n="verbcj">
      <cat-item tags="vblex.cni.*"/>
      <cat-item tags="vblex.fti.*"/>
      <cat-item tags="vblex.ifi.*"/>
      <cat-item tags="vblex.imp.*"/>
      <cat-item tags="vblex.pii.*"/>
      <cat-item tags="vblex.pis.*"/>
      <cat-item tags="vblex.pri.*"/>
      <cat-item tags="vblex.prs.*"/>
      <cat-item tags="vbser.cni.*"/>
      <cat-item tags="vbser.fti.*"/>
      <cat-item tags="vbser.ifi.*"/>
      <cat-item tags="vbser.imp.*"/>
      <cat-item tags="vbser.pii.*"/>
      <cat-item tags="vbser.pis.*"/>
      <cat-item tags="vbser.pri.*"/>
      <cat-item tags="vbser.prs.*"/>
      <cat-item tags="vbhaver.cni.*"/>
      <cat-item tags="vbhaver.fti.*"/>
      <cat-item tags="vbhaver.ifi.*"/>
      <cat-item tags="vbhaver.imp.*"/>
      <cat-item tags="vbhaver.pii.*"/>
      <cat-item tags="vbhaver.pis.*"/>
      <cat-item tags="vbhaver.pri.*"/>
      <cat-item tags="vbhaver.prs.*"/>
      <cat-item tags="vbmod.cni.*"/>
      <cat-item tags="vbmod.fti.*"/>
      <cat-item tags="vbmod.ifi.*"/>
      <cat-item tags="vbmod.imp.*"/>
      <cat-item tags="vbmod.pii.*"/>
      <cat-item tags="vbmod.pis.*"/>
      <cat-item tags="vbmod.pri.*"/>
      <cat-item tags="vbmod.prs.*"/>
      <cat-item tags="vblex.pron.cni.*"/>
      <cat-item tags="vblex.pron.fti.*"/>
      <cat-item tags="vblex.pron.ifi.*"/>
      <cat-item tags="vblex.pron.imp.*"/>
      <cat-item tags="vblex.pron.pii.*"/>
      <cat-item tags="vblex.pron.pis.*"/>
      <cat-item tags="vblex.pron.pri.*"/>
      <cat-item tags="vblex.pron.prs.*"/>
    </def-cat>


    <def-cat n="verbcj2">
      <cat-item tags="vblex.cni.*"/>
      <cat-item tags="vblex.fti.*"/>
      <cat-item tags="vblex.ifi.*"/>
      <cat-item tags="vblex.imp.*"/>
      <cat-item tags="vblex.pii.*"/>
      <cat-item tags="vblex.pis.*"/>
      <cat-item tags="vblex.pri.*"/>
      <cat-item tags="vblex.prs.*"/>
      <cat-item tags="vbser.cni.*"/>
      <cat-item tags="vbser.fti.*"/>
      <cat-item tags="vbser.ifi.*"/>
      <cat-item tags="vbser.imp.*"/>
      <cat-item tags="vbser.pii.*"/>
      <cat-item tags="vbser.pis.*"/>
      <cat-item tags="vbser.pri.*"/>
      <cat-item tags="vbser.prs.*"/>
      <cat-item tags="vblex.pron.cni.*"/>
      <cat-item tags="vblex.pron.fti.*"/>
      <cat-item tags="vblex.pron.ifi.*"/>
      <cat-item tags="vblex.pron.imp.*"/>
      <cat-item tags="vblex.pron.pii.*"/>
      <cat-item tags="vblex.pron.pis.*"/>
      <cat-item tags="vblex.pron.pri.*"/>
      <cat-item tags="vblex.pron.prs.*"/>
    </def-cat>

    <def-cat n="pp">
      <cat-item tags="vblex.pp.*"/>
      <cat-item tags="vblex.pron.pp.*"/>
      <cat-item tags="vbser.pp.*"/>
      <cat-item tags="vbmod.pp.*"/>
      <cat-item tags="vbhaver.pp.*"/><!--ATENCIÓ: CANVI -->
    </def-cat>

    <def-cat n="inf">
      <cat-item tags="vblex.inf"/>
      <cat-item tags="vblex.pron.inf"/>
      <cat-item tags="vbser.inf"/>
      <cat-item tags="vbhaver.inf"/>
      <cat-item tags="vbmod.inf"/>
    </def-cat>

    <def-cat n="ger">
      <cat-item tags="vblex.ger"/>
      <cat-item tags="vblex.pron.ger"/>
      <cat-item tags="vbser.ger"/>
      <cat-item tags="vbhaver.ger"/>
      <cat-item tags="vbmod.ger"/>
    </def-cat>


    <def-cat n="anar">
      <cat-item lemma="anar" tags="vblex.pri.*"/>
    </def-cat>
    
    <def-cat n="haveranar">
      <cat-item lemma="anar" tags="vblex.pri.*"/>
      <cat-item lemma="haver" tags="vbhaver.*"/>
    </def-cat>
    
    <def-cat n="anar_a"> <!-- per a la perífrasi 'vaig a dormir' EO-->
      <cat-item lemma="anar" tags="vblex.*"/>
    </def-cat>

    <def-cat n="adv_preadv">
      <cat-item tags="adv"/>
      <cat-item tags="preadv"/>
    </def-cat>

    <def-cat n="adv">
      <cat-item tags="adv"/>
    </def-cat>

    <def-cat n="advment">
      <cat-item tags="adv.ment"/>
    </def-cat>

    <def-cat n="advitg">
      <cat-item tags="adv.itg"/>
    </def-cat>
    
    <def-cat n="mes">
      <cat-item lemma="més" tags="adv"/>
      <cat-item lemma="més" tags="preadv"/>
      <cat-item lemma="més" tags="det.*"/><!-- pel tagger-->
    </def-cat>


    <def-cat n="no">
      <cat-item lemma="no" tags="adv"/>
    </def-cat>

    <def-cat n="cnjcoo">
      <cat-item lemma="i" tags="cnjcoo"/>
      <cat-item lemma="o" tags="cnjcoo"/>
      <cat-item lemma="però" tags="cnjcoo"/>
    </def-cat>

     <def-cat n="cnjcoopercorregir"> <!-- EO afegit per a corregir errors del tagger, veure regles-->
      <cat-item lemma="que" tags="cnjcoo"/> <!-- ara el tagger prioritza aquest-->
      <cat-item tags="cnjsub"/> <!-- per si de cas-->
      <cat-item tags="prn.rel.*"/> <!-- seria el correcte, en fi ... -->
    </def-cat>

     <def-cat n="cnj">
      <cat-item tags="cnjcoo"/>
      <cat-item tags="cnjsub"/>
      <cat-item tags="cnjadv"/>
    </def-cat>

     <def-cat n="cnjcomp"><!-- regla adv adj cnjcopm-->
      <cat-item lemma="que" tags="cnjcoo"/>
      <cat-item lemma="que" tags="cnjsub"/>
      <cat-item lemma="que" tags="cnjadv"/>
    </def-cat>

    <def-cat n="per">
      <cat-item lemma="per" tags="pr"/>
    </def-cat>

    <def-cat n="de">
      <cat-item lemma="de" tags="pr"/>
    </def-cat>

    <def-cat n="a">
      <cat-item lemma="a" tags="pr"/>
    </def-cat>

    <def-cat n="estarapuntde"> <!--EO perífrasi-->
      <cat-item lemma="estar# a punt de" tags="vblex.*"/>
    </def-cat>

    <def-cat n="acabarde"> <!--EO perífrasi-->
      <cat-item lemma="acabar# de" tags="vblex.*"/>
    </def-cat>

    <def-cat n="estar"> <!--EO per a la perifrasi estar +  gerundi-->
      <cat-item lemma="estar" tags="vblex.*"/>
    </def-cat>

    <def-cat n="deure"> <!--EO per a la perifrasi deure +  infinitiu-->
      <cat-item lemma="deure" tags="vblex.*"/>
    </def-cat>


  </section-def-cats>

  <section-def-attrs>
    <def-attr n="a_nom">
      <attr-item tags="n"/>
      <attr-item tags="n.acr"/>
      <attr-item tags="n.unc"/>
      <attr-item tags="np.loc"/>
      <attr-item tags="np.ant"/>
    </def-attr>

    <def-attr n="a_np_acr">
      <attr-item tags="np"/>
      <attr-item tags="acr"/>
    </def-attr>

    <def-attr n="a_adj">          
      <attr-item tags="adj"/>
      <attr-item tags="adj.sint"/>
      <attr-item tags="adj.sint.comp"/>
      <attr-item tags="adj.sint.sup"/>
      <attr-item tags="adj.pos"/>
      <attr-item tags="vblex.pp"/>
    </def-attr>  


    <def-attr n="a_det">
      <attr-item tags="det.dem"/>
      <attr-item tags="det.ind"/>
      <attr-item tags="det.def"/>
      <attr-item tags="det.pos"/>
      <attr-item tags="det.qnt"/>
      <attr-item tags="det.itg"/>
      <attr-item tags="det.ord"/>
      <attr-item tags="predet"/>
      <attr-item tags="num"/>
    </def-attr>

    <def-attr n="a_num">
      <attr-item tags="num"/>
    </def-attr>

    <def-attr n="a_verb2"> <!-- mirem si és pronominal a la macro tipus_verbs -->
      <attr-item tags="vblex"/>
      <attr-item tags="vblex.pron"/>
      <attr-item tags="vbser"/>
      <attr-item tags="vbhaver"/>
      <attr-item tags="vbmod"/>
      <attr-item tags="vaux"/>
    </def-attr>

    <def-attr n="a_verb">
      <attr-item tags="vblex"/>
      <attr-item tags="vbser"/>
      <attr-item tags="vbhaver"/>
      <attr-item tags="vbmod"/>
      <attr-item tags="vaux"/>
    </def-attr>

    <def-attr n="pron">
      <attr-item tags="pron"/>
    </def-attr>

    <def-attr n="sep">
      <attr-item tags="sep"/>
    </def-attr>

    <def-attr n="a_adv">
      <attr-item tags="adv"/>
      <attr-item tags="preadv"/>
      <attr-item tags="adv.itg"/>
    </def-attr>

    <def-attr n="a_pp">
      <attr-item tags="vblex.pp"/>
      <attr-item tags="vblex.pron.pp"/>
      <attr-item tags="vbser.pp"/>
      <attr-item tags="vbmod.pp"/>
      <attr-item tags="vblex.sep.pp"/>
      <attr-item tags="vbser.sep.pp"/>
      <attr-item tags="vbmod.sep.pp"/>
      <attr-item tags="vaux.pp"/>
      <attr-item tags="vbhaver.pp"/>
    </def-attr>

    <def-attr n="a_prn">
      <attr-item tags="prn"/>
      <attr-item tags="prn.pro"/>
      <attr-item tags="rel"/><!-- OJO -->
    </def-attr>

    <def-attr n="tipus_prn">
      <attr-item tags="subj"/>
      <attr-item tags="obj"/>
      <attr-item tags="tn"/>
      <attr-item tags="itg"/>
      <attr-item tags="pos"/>
      <attr-item tags="ref"/>
      <attr-item tags="rel"/><!--EO-->
      <attr-item tags="nn"/><!--EO-->
      <attr-item tags="adv"/><!--EO-->
    </def-attr>
    <def-attr n="pers">
      <attr-item tags="p1"/>
      <attr-item tags="p2"/>
      <attr-item tags="p3"/>
    </def-attr>

    <def-attr n="cas"> <!--EO-->
      <attr-item tags="nomi"/>
      <attr-item tags="nomi2"/>
      <attr-item tags="acc"/>
      <attr-item tags="sense"/>
    </def-attr>

    <def-attr n="gen">
      <attr-item tags="m"/>
      <attr-item tags="f"/>
      <attr-item tags="mf"/>
      <attr-item tags="nt"/>
    </def-attr>

    <def-attr n="nbr">
      <attr-item tags="sg"/>
      <attr-item tags="pl"/>
      <attr-item tags="sp"/>
      <attr-item tags="ND"/>
    </def-attr>

    <def-attr n="temps">
      <attr-item tags="cni"/>
      <attr-item tags="fti"/>  
      <attr-item tags="ifi"/>
      <attr-item tags="imp"/>
      <attr-item tags="pii"/>
      <attr-item tags="pis"/>
      <attr-item tags="pri"/>
      <attr-item tags="prs"/>
      <attr-item tags="pres"/>
      <attr-item tags="past"/>

      <attr-item tags="pp"/><!-- ? -->
      <attr-item tags="pp2"/><!-- ? -->
      <attr-item tags="pp3"/><!-- ? -->
      <attr-item tags="ger"/><!-- ? -->
      <attr-item tags="gerpast"/><!-- ? -->
      <attr-item tags="inf"/><!-- ? -->

    </def-attr>



    <def-attr n="neg">
      <attr-item tags="NEG"/>
    </def-attr>  

  </section-def-attrs>
  <section-def-vars>
    <def-var n="case"/>
    <def-var n="changecase"/>
    <def-var n="lemapos"/>
    <def-var n="nombre"/>
    <def-var n="genere"/>
    <def-var n="concDet"/>
    <def-var n="concAdj"/>
    <def-var n="concPrimero"/>
    <def-var n="concSegundo"/>
    <def-var n="concTercero"/>
    <def-var n="interrogativa"/>
    <def-var n="exclamativa"/>
    <def-var n="caseFirstWord"/> 
    <def-var n="lema"/>
    <def-var n="EOS"/>
    <def-var n="paraula1"/>
    <def-var n="SVnegatiu"/>
    <def-var n="auxiliar"/>
    <def-var n="tipus_verb"/>
    <def-var n="tipus_verb2"/>
  </section-def-vars>

  <section-def-lists>


  <def-list n="detsprep"> <!-- BCN EO per marcar els que no poden anar en acc-->
    <list-item v="pli da"/>
    <list-item v="iom da"/>
    <list-item v="la plimulto da"/>
    <list-item v="tro da"/>
    <list-item v="malpli da"/>
    <list-item v="ne multe da"/>
    <list-item v="sufiĉe da"/>
    <list-item v="ne multe da"/>
    <list-item v="tiom da"/>
    </def-list> 
  
  <def-list n="qui"> <!-- BCN EO per marcar els que no poden anar en acc-->
    <list-item v="qui"/>
    </def-list> 

  <def-list n="quin"> <!-- BCN EO per marcar els que han d'anar en acc (dets int preverbals)-->
    <list-item v="quin"/>
    </def-list> 

  <def-list n="moviment"> <!-- BCN EO-->
    <list-item v="anar"/>
    <list-item v="afegir"/>
    <list-item v="posar"/>
    <list-item v="treure"/>
    <list-item v="introduir"/>
    <list-item v="entrar"/>
    <list-item v="caure"/>
    <list-item v="pujar"/>
    <list-item v="creuar"/>
    <list-item v="relliscar"/>
    <list-item v="arribar"/>
    <list-item v="volar"/>
    <list-item v="córrer"/>
    <list-item v="caminar"/>
    <list-item v="avançar"/>
    <list-item v="sortir"/>
    </def-list> 


  <def-list n="agradar"> <!-- BCN EO per a la inversio argumental-->
    <list-item v="agradar"/>
    <list-item v="encantar"/>
    <list-item v="plaure"/>
    <list-item v="preocupar-se"/>
    <list-item v="interesar-se"/>
    <list-item v="inquietar-se"/>
    </def-list> 

  <def-list n="volition"> <!-- BCN EO verbs que porten KE -->
    <list-item v="voler"/>
    <list-item v="proposar"/>
    <list-item v="exigir"/>
    <list-item v="reclamar"/>
    <list-item v="indicar"/>
    <list-item v="demanar"/>
    <list-item v="suggerir"/>
    <list-item v="caldre"/>
    <list-item v="caler"/>
    </def-list> 

  <def-list n="reportingverb"> <!-- BCN EO verbs que porten KE (no s'utilitza)-->
    <list-item v="dir"/>
    <list-item v="admetre"/>
    <list-item v="acordar"/>
    <list-item v="decidir"/>
    <list-item v="negar"/>
    <list-item v="explicar"/>
    <list-item v="insistir"/>
    <list-item v="prometre"/>
    <list-item v="recomanar"/>
    <list-item v="suggerir"/>
    <list-item v="esmentar"/>
    <list-item v="pensar"/>
    <list-item v="creure"/>
    <list-item v="esperar"/>
    <list-item v="témer"/>
    <list-item v="suposar"/>
    <list-item v="significar"/>
  </def-list>

  </section-def-lists>


  <section-def-macros>
   
    <def-macro n="tipus_verbs" npar="1"> <!-- tots els verbs passen per aqui -->
      <choose>
        <when>
          <test>
          <in>
         <clip pos="1" side="sl" part="lemh"/>
         <list n="agradar"/>
          </in>
          </test>
          <let>
            <var n="tipus_verb"/>
            <lit-tag v="like"/>
          </let>
        </when>
	<when>
    	<test>
     	 <in>
       	  <clip pos="1" side="sl" part="lemh"/>
       	  <list n="moviment"/>
      	</in>
    	</test>
 	<let>
       <var n="tipus_verb"/>
       <lit-tag v="moviment"/>
       </let>
     </when>

    <when>
    <test>
      <in>
         <clip pos="1" side="sl" part="lemh"/>
         <list n="volition"/>
      </in>
    </test>
    <let>
     <var n="tipus_verb"/>
     <lit-tag v="volition"/>
     </let>
</when>

	<when>
    	<test>
      	<in>
        <clip pos="1" side="sl" part="lemh"/>
        <list n="reportingverb"/>
      	</in>
    	</test>
 		<let>
               <var n="tipus_verb"/>
               <lit-tag v="reportingverb"/>
                </let>
	</when>

        <when>
          <test>
            <equal>
              <clip pos="1" side="sl" part="a_verb2"/>
              <lit-tag v="vblex.pron"/>
            </equal>
          </test>
          <let>
            <var n="tipus_verb2"/>
            <lit-tag v="pron"/>
          </let>
        </when>

        <otherwise>
          <let>
            <var n="tipus_verb"/>
                        <lit-tag v="res"/>
          </let>
        </otherwise>
      </choose>
    </def-macro>


 

    <def-macro n="f_bcond" npar="1"><!--Per mirar si el blanc conté o no format. Cal posar aquesta funció en les regles en què desaparegui alguna paraula, per tal de decidir si el blanc de la paraula eliminada s'ha d'eliminar o conservar. Si conté format cal conservar-la, si no en conté cal eliminar-la perquè no apareguin dos espais seguits. -->
      <choose>
	<when>
	  <test>
	    <not>
	      <equal>
		<b pos="1"/>
		<lit v=" "/>
	      </equal>
	    </not>
	  </test>
	  <out>
	    <b pos="1"/>
	  </out>
	</when>     	    
      </choose>
    </def-macro>


    <def-macro n="nom_cas" npar="1"> <!-- EO: marca els SN que si són objecte estaran en accusatiu (les regles del t2x s'encarreguen; també marca els dets interrogatius 'quin' per a tractaclor al t2x)-->
	<choose>
  	<when>
    	<test>
	<or>
      	   <in>
         	<clip pos="1" side="tl" part="lem"/>
         	<list n="detsprep"/> <!-- llista de dets amb preposició (quantificadors) -->
      	   </in>
      	   <in>
         	<clip pos="1" side="sl" part="lem"/>
         	<list n="qui"/> <!-- per a pronoms  -->
      	   </in>
	</or>
    	</test>
      	<let>
		<var n="changecase"/>
		<lit-tag v="sense"/>
      	</let>
  	</when>

  	<when>
    	<test>
      	   <in>
         	<clip pos="1" side="sl" part="lem"/>
         	<list n="quin"/> <!-- per a determinats interrogatius (van davant del verb) -->
      	   </in>
    	</test>
      	<let>
		<var n="changecase"/>
		<lit-tag v="nomi2"/>
      	</let>
  	</when>
  	<otherwise>
      	<let>
		<var n="changecase"/>
		<lit-tag v="nomi"/>
      	</let>
  	</otherwise>
	</choose>
      	<let>
		<var n="case"/>
		<lit-tag v="nomi"/>
      	</let>
    </def-macro>

    <def-macro n="nombre_nom" npar="1">
      <let>
	<var n="nombre"/>
	<lit v=""/>
      </let>
      <choose>
	<when>
	  <test>
	    <and>
	      <equal>
		<clip pos="1" side="sl" part="nbr"/>
		<lit-tag v="sg"/>
	      </equal>
	      <equal>
		<clip pos="1" side="tl" part="nbr"/>
		<lit-tag v="pl"/>
	      </equal>
	    </and>
	  </test>
	  <let>
	    <var n="nombre"/>
	    <lit-tag v="pl"/>
	  </let>
	</when>
	<when>
	  <test>
	    <and>
	      <equal>
		<clip pos="1" side="sl" part="nbr"/>
		<lit-tag v="pl"/>
	      </equal>
	      <equal>
		<clip pos="1" side="tl" part="nbr"/>
		<lit-tag v="sg"/>
	      </equal>
	    </and>
	  </test>
	  <let>
	    <var n="nombre"/>
	    <lit-tag v="sg_slpl"/>
	  </let>
	</when>
       <when>
	<test>
              <equal>
                <clip pos="1" side="sl" part="nbr"/>
                <lit-tag v="sp"/>
              </equal>
          </test>
          <let>
            <var n="nombre"/>
            <lit-tag v="sg"/>
          </let>
        </when>

	<otherwise>
	  <let>
	    <var n="nombre"/>
	    <clip pos="1" side="tl" part="nbr"/>
	  </let>
	</otherwise>
      </choose> 
    </def-macro>


    <def-macro n="firstWord" npar="1">
      <choose>
	<when>
	  <test>
	    <equal>
	      <clip pos="1" side="sl" part="a_np_acr"/>
	      <lit v=""/>
	    </equal>
	  </test>
	  <choose>
	    <when>
	      <test>
		<equal> 
		  <var n="EOS"/>
		  <lit v="true"/>
		</equal> 
	      </test>
	      <modify-case>
		<clip pos="1" side="tl" part="lem"/>
		<lit v="aa"/>
	      </modify-case>
	      <let>
		<var n="caseFirstWord"/>
		<lit v="Aa"/>
	      </let>
	    </when>
	  </choose>
	</when>
	<otherwise>
	  <let>
	    <var n="caseFirstWord"/>
	    <lit v="aa"/>
	  </let>
	</otherwise>
      </choose>
      <let>
	<var n="EOS"/>
	<lit v="false"/>
      </let>
    </def-macro>


  </section-def-macros> 

  <section-rules>




<!--******** REGLES DE SN ******************************************** -->

<rule comment="REGLA: NOM (per a col·locar la cua en les multiparaules amb g (EO)">
      <pattern>
	<pattern-item n="nom"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="nombre_nom">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="nom_cas">
	  <with-param pos="1"/>
	</call-macro>
	<out>
	  <chunk name="nom" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN"/></tag>
	      <tag><clip pos="1" side="sl" part="gen"/></tag>
	      <tag><var n="nombre"/></tag>
	      <tag><var n="case"/></tag>
	    </tags>
	    <lu>   <!--<clip pos="1" side="tl" part="whole"/> Per a compostos: --> 
	      <clip pos="1" side="tl" part="lemh"/> 
	      <clip pos="1" side="tl" part="a_nom"/>
	      <clip pos="1" side="tl" part="gen"/>
	      <clip pos="1" side="tl" part="nbr"/>
	      <lit-tag v="4"/>
	      <clip pos="1" side="tl" part="lemq"/>
	    </lu>
	  </chunk>
	</out>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>

<rule comment="REGLA: ANTROPÒNIM (Barcelona)">
      <pattern>
	<pattern-item n="ant"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<let>
	  <var n="nombre"/>
	  <clip pos="1" side="tl" part="nbr"/>
	</let>
	<out>
	  <chunk name="ant" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN"/></tag>
	      <tag><clip pos="1" side="sl" part="gen"/></tag>
	      <tag><var n="nombre"/></tag>
	    </tags>
	    <lu>   
	      <clip pos="1" side="tl" part="whole"/>
	    </lu>
	  </chunk>
	</out>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>


<rule comment="REGLA: DET ANTROPÒNIM (La Maria - Maria; s'elimina l'article)">
      <pattern>
	<pattern-item n="det"/>
	<pattern-item n="ant"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<let>
	  <var n="nombre"/>
	  <clip pos="2" side="tl" part="nbr"/>
	</let>
	<out>
	  <chunk name="ant" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN"/></tag>
	      <tag><clip pos="2" side="sl" part="gen"/></tag>
	      <tag><var n="nombre"/></tag>
	    </tags>
	    <lu>   
	      <clip pos="2" side="tl" part="whole"/>
	    </lu>
	  </chunk>
	</out>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>


<rule comment="REGLA: ART NOM més ADJ (EO, més -> plej ex: la casa més gran -> la plej granda domo)">
      <pattern>
	<pattern-item n="article"/>
	<pattern-item n="nom"/>
	<pattern-item n="mes"/>
	<pattern-item n="adj"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	 <call-macro n="nom_cas"> <!-- assigna cas nominatiu per defecte --> 
	  <with-param pos="1"/>
	</call-macro> 
	<call-macro n="nombre_nom">
	  <with-param pos="2"/>
	</call-macro>


	<out>
	  <chunk name="det_nom" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN"/></tag>
	      <tag><clip pos="2" side="sl" part="gen"/></tag>
	      <tag><var n="nombre"/></tag>
	      <tag><var n="case"/></tag>
	      <tag><var n="changecase"/></tag>
	    </tags>
	    <lu>   
	      <clip pos="1" side="tl" part="lem"/> 
	      <clip pos="1" side="tl" part="a_det"/>
	      <clip pos="1" side="tl" part="nbr"/>
	      <lit-tag v="4"/>
	    </lu> 
            <b pos="1"/> <!-- canvi a plej-->
                        <lu>
                        <lit v="plej"/>
                        <lit-tag v="adv"/>
                        </lu>

            <b pos="2"/>
            <lu>
              <clip pos="4" side="tl" part="lem"/>
              <clip pos="4" side="tl" part="a_adj"/>
              <clip pos="4" side="tl" part="nbr"/>
              <lit-tag v="4"/>
            </lu>

	    <b pos="3"/>
	    <lu>     
	      <clip pos="2" side="tl" part="lemh"/> 
	      <clip pos="2" side="tl" part="a_nom"/>
              <clip pos="2" side="tl" part="gen"/>
	      <clip pos="2" side="tl" part="nbr"/>
	      <lit-tag v="4"/>
	      <clip pos="2" side="tl" part="lemq"/>
	    </lu>

	  </chunk>
	</out>	  
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>

<rule comment="REGLA: ART més ADJ (EO, més -> plej ex: la més gran -> la plej granda)">
      <pattern>
	<pattern-item n="article"/>
	<pattern-item n="mes"/>
	<pattern-item n="adj"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	 <call-macro n="nom_cas"> <!-- assigna cas nominatiu per defecte --> 
	  <with-param pos="1"/>
	</call-macro> 
	<call-macro n="nombre_nom">
	  <with-param pos="1"/>
	</call-macro>


	<out>
	  <chunk name="det_nom" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN"/></tag>
	      <tag><clip pos="2" side="sl" part="gen"/></tag>
	      <tag><var n="nombre"/></tag>
	      <tag><var n="case"/></tag>
	      <tag><var n="changecase"/></tag>
	    </tags>
	    <lu>   
	      <clip pos="1" side="tl" part="lem"/> 
	      <clip pos="1" side="tl" part="a_det"/>
	      <clip pos="1" side="tl" part="nbr"/>
	      <lit-tag v="4"/>
	    </lu> 
            <b pos="1"/> <!-- canvi a plej-->
                        <lu>
                        <lit v="plej"/>
                        <lit-tag v="adv"/>
                        </lu>

            <b pos="2"/>
            <lu>
              <clip pos="3" side="tl" part="lem"/>
              <clip pos="3" side="tl" part="a_adj"/>
              <clip pos="3" side="tl" part="nbr"/>
              <lit-tag v="4"/>
            </lu>

	  </chunk>
	</out>	  
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>

<rule comment="REGLA: DET NOM (EO ex. els llibres, les cases -> la libroj, la domoj)">
      <pattern>
	<pattern-item n="det"/>
	<pattern-item n="nom"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	 <call-macro n="nom_cas"> <!-- assigna cas nominatiu per defecte --> 
	  <with-param pos="1"/>
	</call-macro> 
	<call-macro n="nombre_nom">
	  <with-param pos="2"/>
	</call-macro>

   <choose>
     <when>   <!-- article indefinit s'elimina -->
      <test>
       <or>
       <equal caseless="yes">
        <clip pos="1" side="sl" part="lem"/>
        <lit v="un"/>
        </equal>
       <equal caseless="yes">
        <clip pos="1" side="sl" part="lem"/>
        <lit v="cert"/>
        </equal>
       <equal caseless="yes">
        <clip pos="1" side="sl" part="lem"/>
        <lit v="algun"/>
        </equal>
       </or>
      </test>
        <out>
          <chunk name="nom" case="caseFirstWord">
            <tags>
              <tag><lit-tag v="SN"/></tag>
              <tag><clip pos="2" side="sl" part="gen"/></tag>
              <tag><var n="nombre"/></tag>
              <tag><var n="case"/></tag>
            </tags>
            <lu>
              <clip pos="2" side="tl" part="lemh"/>
              <clip pos="2" side="tl" part="a_nom"/>
              <clip pos="2" side="tl" part="gen"/>
              <clip pos="2" side="tl" part="nbr"/>
              <lit-tag v="4"/>
              <clip pos="2" side="tl" part="lemq"/>
            </lu>
          </chunk>
        </out>
    </when>

<otherwise>           <!-- altres (amb cas)-->

	<out>
	  <chunk name="det_nom" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN"/></tag>
	      <tag><clip pos="2" side="sl" part="gen"/></tag>
	      <tag><var n="nombre"/></tag>
	      <tag><var n="case"/></tag>
	      <tag><var n="changecase"/></tag>
	    </tags>
	    <lu>   
	      <clip pos="1" side="tl" part="lem"/> 
	      <clip pos="1" side="tl" part="a_det"/>
	      <clip pos="1" side="tl" part="nbr"/>
	      <lit-tag v="4"/>
	    </lu> 
	    <b pos="1"/>
	    <lu>     
	      <clip pos="2" side="tl" part="lemh"/> 
	      <clip pos="2" side="tl" part="a_nom"/>
              <clip pos="2" side="tl" part="gen"/>
	      <clip pos="2" side="tl" part="nbr"/>
	      <lit-tag v="4"/>
	      <clip pos="2" side="tl" part="lemq"/>
	    </lu>
	  </chunk>
	</out>	  
     </otherwise>
      </choose>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>


<rule comment="REGLA: DET NUM NOM (EO, ex. les dues noies, aquests tres llibres -> la du knaboj, ĉi tiuj tri libroj)">
      <pattern>
	<pattern-item n="det"/>
	<pattern-item n="num"/>
	<pattern-item n="nom"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="nom_cas">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="nombre_nom">
	  <with-param pos="3"/>
	</call-macro>
	<!--<call-macro n="canvia_det">
	  <with-param pos="1"/>
	  <with-param pos="3"/>
	</call-macro>-->

   <!-- article indefinit s'elimina-->
   <choose>
     <when>
      <test>
       <equal caseless="yes">
        <clip pos="1" side="sl" part="lem"/>
        <lit v="un"/>
        </equal>
      </test>
        <out>
          <chunk name="num_nom" case="caseFirstWord">
            <tags>
              <tag><lit-tag v="SN"/></tag>
              <tag><clip pos="3" side="sl" part="gen"/></tag>
              <tag><var n="nombre"/></tag>
              <tag><var n="case"/></tag>
            </tags>
	    <lu>   
	      <clip pos="2" side="tl" part="lem"/> 
	      <clip pos="2" side="tl" part="a_det"/>
	      <clip pos="2" side="tl" part="nbr"/>
	    </lu> 
	    <b pos="2"/>
            <lu>
              <clip pos="3" side="tl" part="lemh"/>
              <clip pos="3" side="tl" part="a_nom"/>
              <clip pos="3" side="tl" part="gen"/>
              <clip pos="3" side="tl" part="nbr"/>
              <lit-tag v="4"/>
              <clip pos="3" side="tl" part="lemq"/>
            </lu>
          </chunk>
        </out>
    </when>
<otherwise>           <!-- article definit-->
	<out>
	  <chunk name="det_num_nom" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN"/></tag>
	      <tag><clip pos="3" side="sl" part="gen"/></tag>
	      <tag><var n="nombre"/></tag>
	      <tag><var n="case"/></tag>
	      <tag><var n="changecase"/></tag>
	    </tags>
	    <lu>   
	      <clip pos="1" side="tl" part="lem"/> 
	      <clip pos="1" side="tl" part="a_det"/>
	      <clip pos="1" side="tl" part="nbr"/>
	      <lit-tag v="4"/>
	    </lu> 
	    <b pos="1"/>
	    <lu>   
	      <clip pos="2" side="tl" part="lem"/> 
	      <clip pos="2" side="tl" part="a_num"/>
	      <clip pos="2" side="tl" part="nbr"/>
	    </lu> 
	    <b pos="2"/>
	    <lu>     
	      <clip pos="3" side="tl" part="lemh"/> 
	      <clip pos="3" side="tl" part="a_nom"/>
              <clip pos="3" side="tl" part="gen"/>
	      <clip pos="3" side="tl" part="nbr"/>
	      <lit-tag v="4"/>
	      <clip pos="3" side="tl" part="lemq"/>
	    </lu>
	  </chunk>
	</out>	  
     </otherwise>
      </choose>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>


<rule comment="REGLA: QNT DET NOM (EO, tots els nois -> ĉiuj knaboj; la majoria dels nois -> la plimulto da knaboj)">
      <pattern>
	<pattern-item n="tot"/>
	<pattern-item n="det"/>
	<pattern-item n="nom"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="nom_cas">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="nombre_nom">
	  <with-param pos="3"/>
	</call-macro>

   <!-- article definit s'elimina i es 'genera' cas: 'totes les nenes : ĉiuj knabinoj-->
   <choose>
     <when>
      <test>
       <equal caseless="yes">
        <clip pos="2" side="sl" part="lem"/>
        <lit v="el"/>
        </equal>
      </test>
        <out>
          <chunk name="ĉiu_nom" case="caseFirstWord">
            <tags>
              <tag><lit-tag v="SN"/></tag>
              <tag><clip pos="3" side="sl" part="gen"/></tag>
              <tag><var n="nombre"/></tag>
              <tag><var n="case"/></tag>
              <tag><var n="changecase"/></tag>
            </tags>
	    <lu>   
	      <clip pos="1" side="tl" part="lem"/> 
	      <clip pos="1" side="tl" part="a_det"/>
	      <clip pos="1" side="tl" part="nbr"/>
	      <lit-tag v="4"/>
	    </lu> 
	    <b pos="1"/>
            <lu>
              <clip pos="3" side="tl" part="lemh"/>
              <clip pos="3" side="tl" part="a_nom"/>
              <clip pos="3" side="tl" part="gen"/>
              <clip pos="3" side="tl" part="nbr"/>
              <lit-tag v="4"/>
              <clip pos="3" side="tl" part="lemq"/>
            </lu>
          </chunk>
        </out>
    </when>
<otherwise>           <!-- demostratius i altres -->
	<out>
	  <chunk name="ĉiunom" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN"/></tag>
	      <tag><clip pos="3" side="sl" part="gen"/></tag>
	      <tag><var n="nombre"/></tag>
	      <tag><var n="case"/></tag>
	      <tag><var n="changecase"/></tag>
	    </tags>
	    <lu>   
	      <clip pos="1" side="tl" part="lem"/> 
	      <clip pos="1" side="tl" part="a_det"/>
	      <clip pos="1" side="tl" part="nbr"/>
	      <lit-tag v="4"/>
	    </lu> 
	    <b pos="1"/>
	    <lu>   
	      <clip pos="2" side="tl" part="lem"/> 
	      <clip pos="2" side="tl" part="a_det"/>
	      <clip pos="2" side="tl" part="nbr"/>
	      <lit-tag v="4"/>
	    </lu> 
	    <b pos="2"/>
	    <lu>     
	      <clip pos="3" side="tl" part="lemh"/> 
	      <clip pos="3" side="tl" part="a_nom"/>
              <clip pos="3" side="tl" part="gen"/>
	      <clip pos="3" side="tl" part="nbr"/>
	      <lit-tag v="4"/>
	      <clip pos="3" side="tl" part="lemq"/>
	    </lu>
	  </chunk>
	</out>	  
     </otherwise>
      </choose>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>


<rule comment="REGLA: DET ADJ NOM (EO) el mateix noi; una gran persona -> la sama knabo, granda homo">
      <pattern>
	<pattern-item n="det"/>
	<pattern-item n="adj"/>
	<pattern-item n="nom"/>
      </pattern>
      <action>	
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>	
	<call-macro n="nombre_nom">
	  <with-param pos="3"/>
	</call-macro>	
	<call-macro n="nom_cas">
	  <with-param pos="1"/>
	</call-macro>	
   <!-- article indefinit s'elimina-->
   <choose>
     <when>
      <test>
       <equal caseless="yes">
        <clip pos="1" side="sl" part="lem"/>
        <lit v="un"/>
        </equal>
      </test>
	<out>  
	  <chunk name="nom_adj" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN"/></tag>
	      <tag><clip pos="3" side="sl" part="gen"/></tag>
	      <tag><var n="nombre"/></tag>
	      <tag><var n="case"/></tag>
	    </tags>
	    <lu>   
	      <clip pos="2" side="tl" part="lem"/> 
	      <clip pos="2" side="tl" part="a_adj"/>
	      <clip pos="2" side="tl" part="nbr"/>
	      <lit-tag v="4"/>
	    </lu> 
	    <b pos="1"/>
	    <lu>       
	      <clip pos="3" side="tl" part="lemh"/> 
	      <clip pos="3" side="tl" part="a_nom"/>
	      <clip pos="3" side="tl" part="gen"/> 
	      <clip pos="3" side="tl" part="nbr"/>
	      <lit-tag v="4"/>
	      <clip pos="3" side="tl" part="lemq"/>
	    </lu>
	  </chunk>
	</out>       
    </when>
<otherwise>           <!-- article definit-->
	<out>  
	  <chunk name="det_nom_adj" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN"/></tag>
	      <tag><clip pos="3" side="sl" part="gen"/></tag>
	      <tag><var n="nombre"/></tag>
	      <tag><var n="case"/></tag>
	      <tag><var n="changecase"/></tag>
	    </tags>
	    <lu>   
	      <clip pos="1" side="tl" part="lem"/> 
	      <clip pos="1" side="tl" part="a_det"/>
	      <clip pos="1" side="tl" part="nbr"/>
	      <lit-tag v="4"/>
	    </lu>
	    <b pos="1"/>
	    <lu>   
	      <clip pos="2" side="tl" part="lem"/> 
	      <clip pos="2" side="tl" part="a_adj"/>
	      <clip pos="2" side="tl" part="nbr"/>
	      <lit-tag v="4"/>
	    </lu> 
	    <b pos="2"/>
	    <lu>       
	      <clip pos="3" side="tl" part="lemh"/> 
	      <clip pos="3" side="tl" part="a_nom"/>
	      <clip pos="3" side="tl" part="gen"/> 
	      <clip pos="3" side="tl" part="nbr"/>
	      <lit-tag v="4"/>
	      <clip pos="3" side="tl" part="lemq"/>
	    </lu>
	  </chunk>
	</out>       
     </otherwise>
      </choose>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>


<rule comment="REGLA: DET NOM ADJ (EO, aquella casa gran, un llibre interessant, alguns cotxes verds -> tiu granda domo, interesa libro, iuj verdaj auxtoj)">
      <pattern>
	<pattern-item n="det"/>
	<pattern-item n="nom"/>
	<pattern-item n="adj"/>
      </pattern>
      <action>	
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>	
	<call-macro n="nombre_nom">
	  <with-param pos="2"/>
	</call-macro>	
	<call-macro n="nom_cas">
	  <with-param pos="1"/>
	</call-macro>	
   <!-- article indefinit s'elimina-->
   <choose>
     <when>
      <test>
       <equal caseless="yes">
        <clip pos="1" side="sl" part="lem"/>
        <lit v="un"/>
        </equal>
      </test>
	<out>  
	  <chunk name="nom_adj" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN"/></tag>
	      <tag><clip pos="2" side="sl" part="gen"/></tag>
	      <tag><var n="nombre"/></tag>
	      <tag><var n="case"/></tag>
	    </tags>
	    <lu>   
	      <clip pos="3" side="tl" part="lem"/> 
	      <clip pos="3" side="tl" part="a_adj"/>
	      <clip pos="3" side="tl" part="nbr"/>
	      <lit-tag v="4"/>
	    </lu> 
	    <b pos="1"/>
	    <lu>       
	      <clip pos="2" side="tl" part="lemh"/> 
	      <clip pos="2" side="tl" part="a_nom"/>
	      <clip pos="2" side="tl" part="gen"/> 
	      <clip pos="2" side="tl" part="nbr"/>
	      <lit-tag v="4"/>
	      <clip pos="2" side="tl" part="lemq"/>
	    </lu>
	  </chunk>
	</out>       
    </when>
<otherwise>           <!-- article definit-->
	<out>  
	  <chunk name="det_nom_adj" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN"/></tag>
	      <tag><clip pos="2" side="sl" part="gen"/></tag>
	      <tag><var n="nombre"/></tag>
	      <tag><var n="case"/></tag>
	      <tag><var n="changecase"/></tag>
	    </tags>
	    <lu>   
	      <clip pos="1" side="tl" part="lem"/> 
	      <clip pos="1" side="tl" part="a_det"/>
	      <clip pos="1" side="tl" part="nbr"/>
	      <lit-tag v="4"/>
	    </lu>
	    <b pos="1"/>
	    <lu>   
	      <clip pos="3" side="tl" part="lem"/> 
	      <clip pos="3" side="tl" part="a_adj"/>
	      <clip pos="3" side="tl" part="nbr"/>
	      <lit-tag v="4"/>
	    </lu> 
	    <b pos="2"/>
	    <lu>       
	      <clip pos="2" side="tl" part="lemh"/> 
	      <clip pos="2" side="tl" part="a_nom"/>
	      <clip pos="2" side="tl" part="gen"/> 
	      <clip pos="2" side="tl" part="nbr"/>
	      <lit-tag v="4"/>
	      <clip pos="2" side="tl" part="lemq"/>
	    </lu>
	  </chunk>
	</out>       
     </otherwise>
      </choose>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>


<rule comment="REGLA: DET NUM NOM ADJ (EO, ex. aquelles tres cases blanques, els tres llibres interessants, aquests dos cotxes verds -> tiuj tri blankaj domoj, la tri interesaj libroj, ĉi tiuj du verdaj auxtoj)">
      <pattern>
	<pattern-item n="det"/>
	<pattern-item n="num"/>
	<pattern-item n="nom"/>
	<pattern-item n="adj"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="nom_cas">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="nombre_nom">
	  <with-param pos="3"/>
	</call-macro>
   <!-- article indefinit s'elimina-->
   <choose>
     <when>
      <test>
       <equal caseless="yes">
        <clip pos="1" side="sl" part="lem"/>
        <lit v="un"/>
        </equal>
      </test>
        <out>
          <chunk name="num_nom_adj" case="caseFirstWord">
            <tags>
              <tag><lit-tag v="SN"/></tag>
              <tag><clip pos="3" side="sl" part="gen"/></tag>
              <tag><var n="nombre"/></tag>
              <tag><var n="case"/></tag>
            </tags>
	    <lu>   
	      <clip pos="2" side="tl" part="lem"/> 
	      <clip pos="2" side="tl" part="a_det"/>
	      <clip pos="2" side="tl" part="nbr"/>
	    </lu> 
	    <b pos="1"/>
            <lu>
              <clip pos="4" side="tl" part="lem"/>
              <clip pos="4" side="tl" part="a_adj"/>
              <clip pos="4" side="tl" part="nbr"/>
              <lit-tag v="4"/>
            </lu>
	    <b pos="2"/>
            <lu>
              <clip pos="3" side="tl" part="lemh"/>
              <clip pos="3" side="tl" part="a_nom"/>
              <clip pos="3" side="tl" part="gen"/>
              <clip pos="3" side="tl" part="nbr"/>
              <lit-tag v="4"/>
              <clip pos="3" side="tl" part="lemq"/>
            </lu>
          </chunk>
        </out>
    </when>
<otherwise>           <!-- article definit-->
	<out>
	  <chunk name="det_num_nom_adj" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN"/></tag>
	      <tag><clip pos="3" side="sl" part="gen"/></tag>
	      <tag><var n="nombre"/></tag>
	      <tag><var n="case"/></tag>
	      <tag><var n="changecase"/></tag>
	    </tags>
	    <lu>   
	      <clip pos="1" side="tl" part="lem"/> 
	      <clip pos="1" side="tl" part="a_det"/>
	      <clip pos="1" side="tl" part="nbr"/>
	      <lit-tag v="4"/>
	    </lu> 
	    <b pos="1"/>
	    <lu>   
	      <clip pos="2" side="tl" part="lem"/> 
	      <clip pos="2" side="tl" part="a_num"/>
	      <clip pos="2" side="tl" part="nbr"/>
	    </lu> 
	    <b pos="2"/>
            <lu>
              <clip pos="4" side="tl" part="lem"/>
              <clip pos="4" side="tl" part="a_adj"/>
              <clip pos="4" side="tl" part="nbr"/>
              <lit-tag v="4"/>
            </lu>
	    <b pos="3"/>
	    <lu>     
	      <clip pos="3" side="tl" part="lemh"/> 
	      <clip pos="3" side="tl" part="a_nom"/>
              <clip pos="3" side="tl" part="gen"/>
	      <clip pos="3" side="tl" part="nbr"/>
	      <lit-tag v="4"/>
	      <clip pos="3" side="tl" part="lemq"/>
	    </lu>
	  </chunk>
	</out>	  
     </otherwise>
      </choose>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>


<rule comment="REGLA: QNT DET NOM ADJ (EO, ex. tots els cotxes blancs -> ĉiuj blankaj auxtoj)">
      <pattern>
	<pattern-item n="tot"/>
	<pattern-item n="det"/>
	<pattern-item n="nom"/>
	<pattern-item n="adj"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="nom_cas">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="nombre_nom">
	  <with-param pos="3"/>
	</call-macro>

   <!-- article definit s'elimina i es 'genera' cas: 'totes les nenes : ĉiuj knabinoj-->
   <choose>
     <when>
      <test>
       <equal caseless="yes">
        <clip pos="2" side="sl" part="lem"/>
        <lit v="el"/>
        </equal>
      </test>
        <out>
          <chunk name="ĉiu_nom_adj" case="caseFirstWord">
            <tags>
              <tag><lit-tag v="SN"/></tag>
              <tag><clip pos="3" side="sl" part="gen"/></tag>
              <tag><var n="nombre"/></tag>
              <tag><var n="case"/></tag>
              <tag><var n="changecase"/></tag>
            </tags>
	    <lu>   
	      <clip pos="1" side="tl" part="lem"/> 
	      <clip pos="1" side="tl" part="a_det"/>
	      <clip pos="1" side="tl" part="nbr"/>
	      <lit-tag v="4"/>
	    </lu> 
	    <b pos="1"/>
            <lu>
              <clip pos="4" side="tl" part="lem"/>
              <clip pos="4" side="tl" part="a_adj"/>
              <clip pos="4" side="tl" part="nbr"/>
              <lit-tag v="4"/>
            </lu>
            <b pos="2"/>
            <lu>
              <clip pos="3" side="tl" part="lemh"/>
              <clip pos="3" side="tl" part="a_nom"/>
              <clip pos="3" side="tl" part="gen"/>
              <clip pos="3" side="tl" part="nbr"/>
              <lit-tag v="4"/>
              <clip pos="3" side="tl" part="lemq"/>
            </lu>
          </chunk>
        </out>
    </when>
<otherwise>           <!-- demostratiu (dividim el SN en tot/ĉiu + PP(le ...)-->
	<out>
	  <chunk name="ĉiunom" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN"/></tag>
	      <tag><clip pos="3" side="sl" part="gen"/></tag>
	      <tag><var n="nombre"/></tag>
	      <tag><var n="case"/></tag>
              <tag><var n="changecase"/></tag>
	    </tags>
	    <lu>   
	      <clip pos="1" side="tl" part="lem"/> 
	      <clip pos="1" side="tl" part="a_det"/>
	      <clip pos="1" side="tl" part="nbr"/>
	      <lit-tag v="4"/>
	    </lu> 
	  </chunk>
 	    <b/>
	  <chunk name="le" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="PREP"/></tag>
	    </tags>
	    <lu>
	      <lit v="el"/>
	      <lit-tag v="pr"/>
	    </lu>
	  </chunk>
 	    <b/>
	  <chunk name="det_nom_adj" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN"/></tag>
	      <tag><clip pos="3" side="sl" part="gen"/></tag>
	      <tag><var n="nombre"/></tag>
	      <tag><var n="case"/></tag>
	    </tags>
	    <lu>   
	      <clip pos="2" side="tl" part="lem"/> 
	      <clip pos="2" side="tl" part="a_det"/>
	      <clip pos="2" side="tl" part="nbr"/>
	      <lit-tag v="4"/>
	    </lu> 
	    <b pos="1"/>
            <lu>
              <clip pos="4" side="tl" part="lem"/>
              <clip pos="4" side="tl" part="a_adj"/>
              <clip pos="4" side="tl" part="nbr"/>
              <lit-tag v="4"/>
            </lu>
	    <b pos="2"/>
	    <lu>     
	      <clip pos="3" side="tl" part="lemh"/> 
	      <clip pos="3" side="tl" part="a_nom"/>
              <clip pos="3" side="tl" part="gen"/>
	      <clip pos="3" side="tl" part="nbr"/>
	      <lit-tag v="4"/>
	      <clip pos="3" side="tl" part="lemq"/>
	    </lu>
	  </chunk>
	</out>	  
     </otherwise>
      </choose>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>

<rule comment="REGLA: DET NOM ADV ADJ (EO, una noia molt maca; una noia increïblement maca -> tre bela knabino; nekredeble bela knabino)">
      <pattern>
	<pattern-item n="det"/>
	<pattern-item n="nom"/>
	<pattern-item n="adv_preadv"/>
	<pattern-item n="adj"/>
      </pattern>
      <action>	
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>	
	<call-macro n="nom_cas">
	  <with-param pos="1"/>
	</call-macro>	
	<call-macro n="nombre_nom">
	  <with-param pos="2"/>
	</call-macro>	
   <!-- article indefinit s'elimina-->
   <choose>
     <when>
      <test>
       <equal caseless="yes">
        <clip pos="1" side="sl" part="lem"/>
        <lit v="un"/>
        </equal>
      </test>

	<out>  
	  <chunk name="nom_adv_adj" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN"/></tag>
	      <tag><clip pos="2" side="sl" part="gen"/></tag>
	      <tag><var n="nombre"/></tag>
	      <tag><var n="case"/></tag>
	    </tags>
	    <lu>   
	      <clip pos="3" side="tl" part="whole"/> 
	    </lu>
	    <b pos="1"/>
	    <lu>   
	      <clip pos="4" side="tl" part="lem"/> 
	      <clip pos="4" side="tl" part="a_adj"/>
	      <clip pos="4" side="tl" part="nbr"/>
	      <lit-tag v="4"/>
	    </lu> 
	    <b pos="2"/>
	    <lu>         
	      <clip pos="2" side="tl" part="lemh"/> 
	      <clip pos="2" side="tl" part="a_nom"/>
	      <clip pos="2" side="tl" part="gen"/>
	      <clip pos="2" side="tl" part="nbr"/>
	      <lit-tag v="4"/>
	      <clip pos="2" side="tl" part="lemq"/> 
	    </lu>
	  </chunk>
	</out>       
  </when>
  <otherwise>
	<out>  
	  <chunk name="det_nom_adv_adj" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN"/></tag>
	      <tag><clip pos="2" side="sl" part="gen"/></tag>
	      <tag><var n="nombre"/></tag>
	      <tag><var n="case"/></tag>
	      <tag><var n="changecase"/></tag>
	    </tags>
	    <lu>   
	      <clip pos="1" side="tl" part="lem"/> 
	      <clip pos="1" side="tl" part="a_det"/>
	      <clip pos="1" side="tl" part="nbr"/>
	      <lit-tag v="4"/>
	    </lu>
	    <b pos="1"/>
	    <lu>   
	      <clip pos="3" side="tl" part="whole"/> 
	    </lu>
	    <b pos="2"/>
	    <lu>   
	      <clip pos="4" side="tl" part="lem"/> 
	      <clip pos="4" side="tl" part="a_adj"/>
	      <clip pos="4" side="tl" part="nbr"/>
	      <lit-tag v="4"/>
	    </lu> 
	    <b pos="3"/>
	    <lu>         
	      <clip pos="2" side="tl" part="lemh"/> 
	      <clip pos="2" side="tl" part="a_nom"/>
	      <clip pos="2" side="tl" part="gen"/>
	      <clip pos="2" side="tl" part="nbr"/>
	      <lit-tag v="4"/>
	      <clip pos="2" side="tl" part="lemq"/> 
	    </lu>
	  </chunk>
	</out>       
     </otherwise>
      </choose>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>


<rule comment="REGLA: DET NUM NOM ADV ADJ (EO, ex. les dos cases tan grans -> la du tiel grandaj domoj)">
      <pattern>
	<pattern-item n="det"/>
	<pattern-item n="num"/>
	<pattern-item n="nom"/>
        <pattern-item n="adv_preadv"/>
	<pattern-item n="adj"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="nom_cas">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="nombre_nom">
	  <with-param pos="3"/>
	</call-macro>
   <!-- article indefinit s'elimina-->
   <choose>
     <when>
      <test>
       <equal caseless="yes">
        <clip pos="1" side="sl" part="lem"/>
        <lit v="un"/>
        </equal>
      </test>
        <out>
          <chunk name="num_nom_adv_adj" case="caseFirstWord">
            <tags>
              <tag><lit-tag v="SN"/></tag>
              <tag><clip pos="3" side="sl" part="gen"/></tag>
              <tag><var n="nombre"/></tag>
              <tag><var n="case"/></tag>
            </tags>
	    <lu>   
	      <clip pos="2" side="tl" part="lem"/> 
	      <clip pos="2" side="tl" part="a_det"/>
	      <clip pos="2" side="tl" part="nbr"/>
	    </lu> 
	    <b pos="1"/>
                <lu>
                  <clip pos="4" side="tl" part="whole"/>
                </lu>
	    <b pos="2"/>
            <lu>
              <clip pos="5" side="tl" part="lem"/>
              <clip pos="5" side="tl" part="a_adj"/>
              <clip pos="5" side="tl" part="nbr"/>
              <lit-tag v="4"/>
            </lu>
	    <b pos="3"/>
            <lu>
              <clip pos="3" side="tl" part="lemh"/>
              <clip pos="3" side="tl" part="a_nom"/>
              <clip pos="3" side="tl" part="gen"/>
              <clip pos="3" side="tl" part="nbr"/>
              <lit-tag v="4"/>
              <clip pos="3" side="tl" part="lemq"/>
            </lu>
          </chunk>
        </out>
    </when>
<otherwise>           <!-- article definit-->
	<out>
	  <chunk name="det_num_nom_adv_adj" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN"/></tag>
	      <tag><clip pos="3" side="sl" part="gen"/></tag>
	      <tag><var n="nombre"/></tag>
	      <tag><var n="case"/></tag>
	      <tag><var n="changecase"/></tag>
	    </tags>
	    <lu>   
	      <clip pos="1" side="tl" part="lem"/> 
	      <clip pos="1" side="tl" part="a_det"/>
	      <clip pos="1" side="tl" part="nbr"/>
	      <lit-tag v="4"/>
	    </lu> 
	    <b pos="1"/>
	    <lu>   
	      <clip pos="2" side="tl" part="lem"/> 
	      <clip pos="2" side="tl" part="a_num"/>
	      <clip pos="2" side="tl" part="nbr"/>
	    </lu> 
	    <b pos="2"/>
                <lu>
                  <clip pos="4" side="tl" part="whole"/>
                </lu>
	    <b pos="3"/>
            <lu>
              <clip pos="5" side="tl" part="lem"/>
              <clip pos="5" side="tl" part="a_adj"/>
              <clip pos="5" side="tl" part="nbr"/>
              <lit-tag v="4"/>
            </lu>
	    <b pos="4"/>
	    <lu>     
	      <clip pos="3" side="tl" part="lemh"/> 
	      <clip pos="3" side="tl" part="a_nom"/>
              <clip pos="3" side="tl" part="gen"/>
	      <clip pos="3" side="tl" part="nbr"/>
	      <lit-tag v="4"/>
	      <clip pos="3" side="tl" part="lemq"/>
	    </lu>
	  </chunk>
	</out>	  
     </otherwise>
      </choose>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>






<rule comment="REGLA: DET NOM ADJ conj ADJ (EO, coordinació d'adjectius modificant el mateix nom, ex. una dona alta i prima -> alta kaj maldika virino)">
      <pattern>
	<pattern-item n="det"/>
	<pattern-item n="nom"/>
	<pattern-item n="adj"/>
	<pattern-item n="cnjcoo"/>
	<pattern-item n="adj"/>
      </pattern>
      <action>		
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>	
	<call-macro n="nombre_nom">
	  <with-param pos="2"/>
	</call-macro>	
	<call-macro n="nom_cas">
	  <with-param pos="1"/>
	</call-macro>	
   <!-- article indefinit s'elimina-->
   <choose>
     <when>
      <test>
       <equal caseless="yes">
        <clip pos="1" side="sl" part="lem"/>
        <lit v="un"/>
        </equal>
      </test>
	    <out> 
	      <chunk name="nom_adj_coo_adj" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="SN"/></tag>
		  <tag><clip pos="2" side="sl" part="gen"/></tag>
		  <tag><var n="nombre"/></tag>
		  <tag><var n="case"/></tag>
		</tags>
		<lu>   
		  <clip pos="3" side="tl" part="lem"/> 
		  <clip pos="3" side="tl" part="a_adj"/>
		  <clip pos="3" side="tl" part="nbr"/>
		  <lit-tag v="4"/>
		</lu> 
		<b pos="1"/>
		<lu>
		  <clip pos="4" side="tl" part="whole"/> 
		</lu>
		<b pos="2"/>
		<lu>   
		  <clip pos="5" side="tl" part="lem"/> 
		  <clip pos="5" side="tl" part="a_adj"/>
		  <clip pos="5" side="tl" part="nbr"/>
		  <lit-tag v="4"/>
		</lu> 
		<b pos="3"/>
		<lu>       
		  <clip pos="2" side="tl" part="lemh"/> 
		  <clip pos="2" side="tl" part="a_nom"/>
		  <clip pos="2" side="tl" part="gen"/>
		  <clip pos="2" side="tl" part="nbr"/>
		  <lit-tag v="4"/>
		  <clip pos="2" side="tl" part="lemq"/>  
		</lu>
	      </chunk>
	    </out>
</when>
<otherwise>           <!-- article definit-->
	    <out> 
	      <chunk name="det_nom_adj_coo_adj" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="SN"/></tag>
		  <tag><clip pos="2" side="sl" part="gen"/></tag>
		  <tag><var n="nombre"/></tag>
		  <tag><var n="case"/></tag>
		  <tag><var n="changecase"/></tag>
		</tags>
		<lu>   
		  <clip pos="1" side="tl" part="lem"/> 
		  <clip pos="1" side="tl" part="a_det"/>
		  <clip pos="1" side="tl" part="nbr"/>
		  <lit-tag v="4"/>
		</lu>
		<b pos="1"/>
		<lu>   
		  <clip pos="3" side="tl" part="lem"/> 
		  <clip pos="3" side="tl" part="a_adj"/>
		  <clip pos="3" side="tl" part="nbr"/>
		  <lit-tag v="4"/>
		</lu> 
		<b pos="2"/>
		<lu>
		  <clip pos="4" side="tl" part="whole"/> 
		</lu>
		<b pos="3"/>
		<lu>   
		  <clip pos="5" side="tl" part="lem"/> 
		  <clip pos="5" side="tl" part="a_adj"/>
		  <clip pos="5" side="tl" part="nbr"/>
		  <lit-tag v="4"/>
		</lu> 
		<b pos="4"/>
		<lu>       
		  <clip pos="2" side="tl" part="lemh"/> 
		  <clip pos="2" side="tl" part="a_nom"/>
		  <clip pos="2" side="tl" part="gen"/>
		  <clip pos="2" side="tl" part="nbr"/>
		  <lit-tag v="4"/>
		  <clip pos="2" side="tl" part="lemq"/>  
		</lu>
	      </chunk>
	    </out>
     </otherwise>
      </choose>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>

<rule comment="REGLA: DET NUM NOM ADJ conj ADJ (EO, coordinació d'ajectius)">
      <pattern>
	<pattern-item n="det"/>
	<pattern-item n="num"/>
	<pattern-item n="nom"/>
	<pattern-item n="adj"/>
	<pattern-item n="cnjcoo"/>
	<pattern-item n="adj"/>
      </pattern>
      <action>		
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>	
	<call-macro n="nombre_nom">
	  <with-param pos="3"/>
	</call-macro>	
	<call-macro n="nom_cas">
	  <with-param pos="1"/>
	</call-macro>	
   <!-- article indefinit s'elimina-->
   <choose>
     <when>
      <test>
       <equal caseless="yes">
        <clip pos="1" side="sl" part="lem"/>
        <lit v="un"/>
        </equal>
      </test>
	    <out> 
	      <chunk name="nom_adj_coo_adj" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="SN"/></tag>
		  <tag><clip pos="3" side="sl" part="gen"/></tag>
		  <tag><var n="nombre"/></tag>
		  <tag><var n="case"/></tag>
		</tags>
            	<lu>
              	<clip pos="2" side="tl" part="lem"/>
              	<clip pos="2" side="tl" part="a_det"/>
              	<clip pos="2" side="tl" part="nbr"/>
            	</lu>
		<b pos="1"/>
		<lu>   
		  <clip pos="4" side="tl" part="lem"/> 
		  <clip pos="4" side="tl" part="a_adj"/>
		  <clip pos="4" side="tl" part="nbr"/>
		  <lit-tag v="4"/>
		</lu> 
		<b pos="2"/>
		<lu>
		  <clip pos="5" side="tl" part="whole"/> 
		</lu>
		<b pos="3"/>
		<lu>   
		  <clip pos="6" side="tl" part="lem"/> 
		  <clip pos="6" side="tl" part="a_adj"/>
		  <clip pos="6" side="tl" part="nbr"/>
		  <lit-tag v="4"/>
		</lu> 
		<b pos="4"/>
		<lu>       
		  <clip pos="3" side="tl" part="lemh"/> 
		  <clip pos="3" side="tl" part="a_nom"/>
		  <clip pos="3" side="tl" part="gen"/>
		  <clip pos="3" side="tl" part="nbr"/>
		  <lit-tag v="4"/>
		  <clip pos="3" side="tl" part="lemq"/>  
		</lu>
	      </chunk>
	    </out>
</when>
<otherwise>           <!-- article definit-->
	    <out> 
	      <chunk name="det_nom_adj_coo_adj" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="SN"/></tag>
		  <tag><clip pos="3" side="sl" part="gen"/></tag>
		  <tag><var n="nombre"/></tag>
		  <tag><var n="case"/></tag>
		  <tag><var n="changecase"/></tag>
		</tags>
		<lu>   
		  <clip pos="1" side="tl" part="lem"/> 
		  <clip pos="1" side="tl" part="a_det"/>
		  <clip pos="1" side="tl" part="nbr"/>
		  <lit-tag v="4"/>
		</lu>
		<b pos="1"/>
            	<lu>
              	<clip pos="2" side="tl" part="lem"/>
              	<clip pos="2" side="tl" part="a_det"/>
              	<clip pos="2" side="tl" part="nbr"/>
            	</lu>
		<b pos="2"/>
		<lu>   
		  <clip pos="4" side="tl" part="lem"/> 
		  <clip pos="4" side="tl" part="a_adj"/>
		  <clip pos="4" side="tl" part="nbr"/>
		  <lit-tag v="4"/>
		</lu> 
		<b pos="3"/>
		<lu>
		  <clip pos="5" side="tl" part="whole"/> 
		</lu>
		<b pos="4"/>
		<lu>   
		  <clip pos="6" side="tl" part="lem"/> 
		  <clip pos="6" side="tl" part="a_adj"/>
		  <clip pos="6" side="tl" part="nbr"/>
		  <lit-tag v="4"/>
		</lu> 
		<b pos="5"/>
		<lu>       
		  <clip pos="3" side="tl" part="lemh"/> 
		  <clip pos="3" side="tl" part="a_nom"/>
		  <clip pos="3" side="tl" part="gen"/>
		  <clip pos="3" side="tl" part="nbr"/>
		  <lit-tag v="4"/>
		  <clip pos="3" side="tl" part="lemq"/>  
		</lu>
	      </chunk>
	    </out>
     </otherwise>
      </choose>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>



<rule comment="REGLA: DET NOM DE NOM ADJ (EO)(pertany a les regles de formació de compostos a partir de  N+de+N, en aquest cas NO volem que faci el compost, ex. els animals de zones càlides-> la besto de varmaj zonoj)">
      <pattern>
	<pattern-item n="det"/>
	<pattern-item n="nom"/>
	<pattern-item n="de"/>
	<pattern-item n="nom"/>
	<pattern-item n="adj"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	 <call-macro n="nom_cas"> <!-- assigna cas nominatiu per defecte --> 
	  <with-param pos="1"/>
	</call-macro> 
	<call-macro n="nombre_nom">
	  <with-param pos="2"/>
	</call-macro>

   <choose>
     <when>   <!-- article indefinit s'elimina -->
      <test>
       <or>
       <equal caseless="yes">
        <clip pos="1" side="sl" part="lem"/>
        <lit v="un"/>
        </equal>
       <equal caseless="yes">
        <clip pos="1" side="sl" part="lem"/>
        <lit v="cert"/>
        </equal>
       <equal caseless="yes">
        <clip pos="1" side="sl" part="lem"/>
        <lit v="algun"/>
        </equal>
       </or>
      </test>
        <out>
          <chunk name="nom" case="caseFirstWord">
            <tags>
              <tag><lit-tag v="SN"/></tag>
              <tag><clip pos="2" side="sl" part="gen"/></tag>
              <tag><var n="nombre"/></tag>
              <tag><var n="case"/></tag>
            </tags>
            <lu>
              <clip pos="2" side="tl" part="lemh"/>
              <clip pos="2" side="tl" part="a_nom"/>
              <clip pos="2" side="tl" part="gen"/>
              <clip pos="2" side="tl" part="nbr"/>
              <lit-tag v="4"/>
              <clip pos="2" side="tl" part="lemq"/>
            </lu>
	 </chunk>
	    <b pos="1"/>
         <chunk name="de" case="caseFirstWord">
            <tags>
              <tag><lit-tag v="PREP"/></tag>
            </tags>
	    <lu>
              <clip pos="3" side="tl" part="whole"/>
            </lu>
	  </chunk>
	    <b pos="2"/>
         <chunk name="nom_adj" case="caseFirstWord">
            <tags>
              <tag><lit-tag v="SN"/></tag>
              <tag><clip pos="2" side="sl" part="gen"/></tag>
              <tag><var n="nombre"/></tag>
              <tag><var n="case"/></tag>
            </tags>
            <lu>
              <clip pos="5" side="tl" part="lem"/>
              <clip pos="5" side="tl" part="a_adj"/>
              <clip pos="5" side="tl" part="nbr"/>
              <lit-tag v="4"/>
            </lu>
	    <b pos="1"/>
	    <lu>
	      <clip pos="4" side="tl" part="lemh"/>
              <clip pos="4" side="tl" part="a_nom"/>
              <clip pos="4" side="tl" part="gen"/>
              <clip pos="4" side="tl" part="nbr"/>
              <lit-tag v="4"/>
              <clip pos="4" side="tl" part="lemq"/>
            </lu>
          </chunk>
        </out>
    </when>

<otherwise>           <!-- altres (amb cas)-->

	<out>
	  <chunk name="det_nom" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN"/></tag>
	      <tag><clip pos="2" side="sl" part="gen"/></tag>
	      <tag><var n="nombre"/></tag>
	      <tag><var n="case"/></tag>
	      <tag><var n="changecase"/></tag>
	    </tags>
	    <lu>   
	      <clip pos="1" side="tl" part="lem"/> 
	      <clip pos="1" side="tl" part="a_det"/>
	      <clip pos="1" side="tl" part="nbr"/>
	      <lit-tag v="4"/>
	    </lu> 
            <b pos="1"/>

            <lu>
              <clip pos="2" side="tl" part="lemh"/>
              <clip pos="2" side="tl" part="a_nom"/>
              <clip pos="2" side="tl" part="gen"/>
              <clip pos="2" side="tl" part="nbr"/>
              <lit-tag v="4"/>
              <clip pos="2" side="tl" part="lemq"/>
            </lu>
	    </chunk>
	    <b pos="2"/>
            <chunk name="de" case="caseFirstWord">
            <tags>
              <tag><lit-tag v="PREP"/></tag>
            </tags>
	    <lu>
              <clip pos="3" side="tl" part="whole"/>
            </lu>
	    </chunk>
	    <b pos="3"/>
         <chunk name="nom_adj" case="caseFirstWord">
            <tags>
              <tag><lit-tag v="SN"/></tag>
              <tag><clip pos="2" side="sl" part="gen"/></tag>
              <tag><var n="nombre"/></tag>
              <tag><var n="case"/></tag>
            </tags>
            <lu>
              <clip pos="5" side="tl" part="lem"/>
              <clip pos="5" side="tl" part="a_adj"/>
              <clip pos="5" side="tl" part="nbr"/>
              <lit-tag v="4"/>
            </lu>
	    <b pos="4"/>
	    <lu>
	      <clip pos="4" side="tl" part="lemh"/>
              <clip pos="4" side="tl" part="a_nom"/>
              <clip pos="4" side="tl" part="gen"/>
              <clip pos="4" side="tl" part="nbr"/>
              <lit-tag v="4"/>
              <clip pos="4" side="tl" part="lemq"/>
            </lu>
	  </chunk>
	</out>	  
     </otherwise>
      </choose>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>

<rule comment="REGLA: DET NOM DE NOM (EO)(pertany a les regles de formació de compostos a partir de  N+de+N, ex. un llibre de consulta -> konsultolibro)">
      <pattern>
	<pattern-item n="det"/>
	<pattern-item n="nom"/>
	<pattern-item n="de"/>
	<pattern-item n="nom"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	 <call-macro n="nom_cas"> <!-- assigna cas nominatiu per defecte --> 
	  <with-param pos="1"/>
	</call-macro> 
	<call-macro n="nombre_nom">
	  <with-param pos="2"/>
	</call-macro>

   <choose>
     <when>   <!-- article indefinit s'elimina -->
      <test>
       <or>
       <equal caseless="yes">
        <clip pos="1" side="sl" part="lem"/>
        <lit v="un"/>
        </equal>
       <equal caseless="yes">
        <clip pos="1" side="sl" part="lem"/>
        <lit v="cert"/>
        </equal>
       <equal caseless="yes">
        <clip pos="1" side="sl" part="lem"/>
        <lit v="algun"/>
        </equal>
       </or>
      </test>
        <out>
          <chunk name="nom" case="caseFirstWord">
            <tags>
              <tag><lit-tag v="SN"/></tag>
              <tag><clip pos="2" side="sl" part="gen"/></tag>
              <tag><var n="nombre"/></tag>
              <tag><var n="case"/></tag>
            </tags>
            <lu>
              <clip pos="4" side="tl" part="lemh"/>
              <clip pos="4" side="tl" part="a_nom"/>
              <clip pos="4" side="tl" part="gen"/>
	      <lit-tag v="sg"/> <!-- no volem que canvii el nbr, de fet passa a formar part d'un compost-->
	      <lit-tag v="nomi"/> <!-- no volem que canvii el cas, de fet passa a formar part d'un compost-->
              <clip pos="4" side="tl" part="lemq"/>
            </lu>
            <!--<b pos="1"/> de fet formem un compost--> 
            <lu>
              <clip pos="2" side="tl" part="lemh"/>
              <clip pos="2" side="tl" part="a_nom"/>
              <clip pos="2" side="tl" part="gen"/>
              <clip pos="2" side="tl" part="nbr"/>
              <lit-tag v="4"/>
              <clip pos="2" side="tl" part="lemq"/>
            </lu>
          </chunk>
        </out>
    </when>

<otherwise>           <!-- altres (amb cas)-->

	<out>
	  <chunk name="det_nom" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN"/></tag>
	      <tag><clip pos="2" side="sl" part="gen"/></tag>
	      <tag><var n="nombre"/></tag>
	      <tag><var n="case"/></tag>
	      <tag><var n="changecase"/></tag>
	    </tags>
	    <lu>   
	      <clip pos="1" side="tl" part="lem"/> 
	      <clip pos="1" side="tl" part="a_det"/>
	      <clip pos="1" side="tl" part="nbr"/>
	      <lit-tag v="4"/>
	    </lu> 
            <b pos="1"/>
            <lu>
              <clip pos="4" side="tl" part="lemh"/>
              <clip pos="4" side="tl" part="a_nom"/>
              <clip pos="4" side="tl" part="gen"/>
	      <lit-tag v="sg"/> <!-- no volem que canvii el nbr, de fet passa a formar part d'un compost-->
	      <lit-tag v="nomi"/> <!-- no volem que canvii el cas, de fet passa a formar part d'un compost-->
              <clip pos="4" side="tl" part="lemq"/>
            </lu>
 <!--           <b pos="2"/>-->
	    <lu>     
	      <clip pos="2" side="tl" part="lemh"/> 
	      <clip pos="2" side="tl" part="a_nom"/>
              <clip pos="2" side="tl" part="gen"/>
	      <clip pos="2" side="tl" part="nbr"/>
	      <lit-tag v="4"/>
	      <clip pos="2" side="tl" part="lemq"/>
	    </lu>
	  </chunk>
	</out>	  
     </otherwise>
      </choose>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>


<rule comment="REGLA: DET NUM NOM DE NOM ADJ (EO)(pertany a les regles de formació de compostos a partir de  N+de+N, en aquest cas NO volem que faci el compost)">
      <pattern>
	<pattern-item n="det"/>
	<pattern-item n="num"/>
	<pattern-item n="nom"/>
	<pattern-item n="de"/>
	<pattern-item n="nom"/>
	<pattern-item n="adj"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="nom_cas">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="nombre_nom">
	  <with-param pos="3"/>
	</call-macro>

   <!-- article indefinit s'elimina-->
   <choose>
     <when>
      <test>
       <equal caseless="yes">
        <clip pos="1" side="sl" part="lem"/>
        <lit v="un"/>
        </equal>
      </test>
        <out>
          <chunk name="num_nom" case="caseFirstWord">
            <tags>
              <tag><lit-tag v="SN"/></tag>
              <tag><clip pos="3" side="sl" part="gen"/></tag>
              <tag><var n="nombre"/></tag>
              <tag><var n="case"/></tag>
            </tags>
	    <lu>   
	      <clip pos="2" side="tl" part="lem"/> 
	      <clip pos="2" side="tl" part="a_det"/>
	      <clip pos="2" side="tl" part="nbr"/>
	    </lu> 
	    <b pos="1"/>
            <lu>
              <clip pos="3" side="tl" part="lemh"/>
              <clip pos="3" side="tl" part="a_nom"/>
              <clip pos="3" side="tl" part="gen"/>
              <clip pos="3" side="tl" part="nbr"/>
              <lit-tag v="4"/>
              <clip pos="3" side="tl" part="lemq"/>
            </lu>
	    </chunk>
	    <b pos="1"/>
         <chunk name="de" case="caseFirstWord">
            <tags>
              <tag><lit-tag v="PREP"/></tag>
            </tags>
            <lu>
              <clip pos="4" side="tl" part="whole"/>
            </lu>
          </chunk>
            <b pos="2"/>
         <chunk name="nom_adj" case="caseFirstWord">
            <tags>
              <tag><lit-tag v="SN"/></tag>
              <tag><clip pos="5" side="sl" part="gen"/></tag>
              <tag><var n="nombre"/></tag>
              <tag><var n="case"/></tag>
            </tags>
            <lu>
              <clip pos="6" side="tl" part="lem"/>
              <clip pos="6" side="tl" part="a_adj"/>
              <clip pos="6" side="tl" part="nbr"/>
              <lit-tag v="4"/>
            </lu>
            <b pos="1"/>
            <lu>
              <clip pos="5" side="tl" part="lemh"/>
              <clip pos="5" side="tl" part="a_nom"/>
              <clip pos="5" side="tl" part="gen"/>
              <clip pos="5" side="tl" part="nbr"/>
              <lit-tag v="4"/>
              <clip pos="5" side="tl" part="lemq"/>
            </lu>
          </chunk>
        </out>
    </when>
<otherwise>           <!-- article definit-->
	<out>
	  <chunk name="det_num_nom" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN"/></tag>
	      <tag><clip pos="3" side="sl" part="gen"/></tag>
	      <tag><var n="nombre"/></tag>
	      <tag><var n="case"/></tag>
	      <tag><var n="changecase"/></tag>
	    </tags>
	    <lu>   
	      <clip pos="1" side="tl" part="lem"/> 
	      <clip pos="1" side="tl" part="a_det"/>
	      <clip pos="1" side="tl" part="nbr"/>
	      <lit-tag v="4"/>
	    </lu> 
	    <b pos="1"/>
	    <lu>   
	      <clip pos="2" side="tl" part="lem"/> 
	      <clip pos="2" side="tl" part="a_num"/>
	      <clip pos="2" side="tl" part="nbr"/>
	    </lu> 
	    <b pos="2"/>
	    <lu>     
              <clip pos="3" side="tl" part="lemh"/>
              <clip pos="3" side="tl" part="a_nom"/>
              <clip pos="3" side="tl" part="gen"/>
              <clip pos="3" side="tl" part="nbr"/>
              <lit-tag v="4"/>
              <clip pos="3" side="tl" part="lemq"/>
	    </lu>
	    </chunk>
	    <b pos="1"/>
         <chunk name="de" case="caseFirstWord">
            <tags>
              <tag><lit-tag v="PREP"/></tag>
            </tags>
            <lu>
              <clip pos="4" side="tl" part="whole"/>
            </lu>
          </chunk>
            <b pos="2"/>
         <chunk name="nom_adj" case="caseFirstWord">
            <tags>
              <tag><lit-tag v="SN"/></tag>
              <tag><clip pos="5" side="sl" part="gen"/></tag>
              <tag><var n="nombre"/></tag>
              <tag><var n="case"/></tag>
            </tags>
            <lu>
              <clip pos="6" side="tl" part="lem"/>
              <clip pos="6" side="tl" part="a_adj"/>
              <clip pos="6" side="tl" part="nbr"/>
              <lit-tag v="4"/>
            </lu>
            <b pos="1"/>
	    <lu>     
	      <clip pos="5" side="tl" part="lemh"/> 
	      <clip pos="5" side="tl" part="a_nom"/>
              <clip pos="5" side="tl" part="gen"/>
	      <clip pos="5" side="tl" part="nbr"/>
	      <lit-tag v="4"/>
	      <clip pos="5" side="tl" part="lemq"/>
	    </lu>
	  </chunk>
	</out>	  
     </otherwise>
      </choose>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>

<rule comment="REGLA: DET NUM NOM DE NOM (EO)(pertany a les regles de formació de compostos a partir de  N+de+N)">
      <pattern>
	<pattern-item n="det"/>
	<pattern-item n="num"/>
	<pattern-item n="nom"/>
	<pattern-item n="de"/>
	<pattern-item n="nom"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="nom_cas">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="nombre_nom">
	  <with-param pos="3"/>
	</call-macro>

   <!-- article indefinit s'elimina-->
   <choose>
     <when>
      <test>
       <equal caseless="yes">
        <clip pos="1" side="sl" part="lem"/>
        <lit v="un"/>
        </equal>
      </test>
        <out>
          <chunk name="num_nom" case="caseFirstWord">
            <tags>
              <tag><lit-tag v="SN"/></tag>
              <tag><clip pos="3" side="sl" part="gen"/></tag>
              <tag><var n="nombre"/></tag>
              <tag><var n="case"/></tag>
            </tags>
	    <lu>   
	      <clip pos="2" side="tl" part="lem"/> 
	      <clip pos="2" side="tl" part="a_det"/>
	      <clip pos="2" side="tl" part="nbr"/>
	    </lu> 
	    <b pos="1"/>
            <lu>
              <clip pos="5" side="tl" part="lemh"/>
              <clip pos="5" side="tl" part="a_nom"/>
              <clip pos="5" side="tl" part="gen"/>
	      <lit-tag v="sg"/> <!-- no volem que canvii el nbr, de fet passa a formar part d'un compost-->
	      <lit-tag v="nomi"/> <!-- no volem que canvii el cas, de fet passa a formar part d'un compost-->
              <clip pos="5" side="tl" part="lemq"/>
            </lu>
	    <!--<b pos="2"/>-->
            <lu>
              <clip pos="3" side="tl" part="lemh"/>
              <clip pos="3" side="tl" part="a_nom"/>
              <clip pos="3" side="tl" part="gen"/>
              <clip pos="3" side="tl" part="nbr"/>
              <lit-tag v="4"/>
              <clip pos="3" side="tl" part="lemq"/>
            </lu>
          </chunk>
        </out>
    </when>
<otherwise>           <!-- article definit-->
	<out>
	  <chunk name="det_num_nom" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN"/></tag>
	      <tag><clip pos="3" side="sl" part="gen"/></tag>
	      <tag><var n="nombre"/></tag>
	      <tag><var n="case"/></tag>
	      <tag><var n="changecase"/></tag>
	    </tags>
	    <lu>   
	      <clip pos="1" side="tl" part="lem"/> 
	      <clip pos="1" side="tl" part="a_det"/>
	      <clip pos="1" side="tl" part="nbr"/>
	      <lit-tag v="4"/>
	    </lu> 
	    <b pos="1"/>
	    <lu>   
	      <clip pos="2" side="tl" part="lem"/> 
	      <clip pos="2" side="tl" part="a_num"/>
	      <clip pos="2" side="tl" part="nbr"/>
	    </lu> 
	    <b pos="2"/>
	    <lu>     
	      <clip pos="5" side="tl" part="lemh"/> 
	      <clip pos="5" side="tl" part="a_nom"/>
              <clip pos="5" side="tl" part="gen"/>
	      <lit-tag v="sg"/> <!-- no volem que canvii el nbr, de fet passa a formar part d'un compost-->
	      <lit-tag v="nomi"/> <!-- no volem que canvii el cas, de fet passa a formar part d'un compost-->
	      <clip pos="5" side="tl" part="lemq"/>
	    </lu>
	    <!--<b pos="3"/>-->
	    <lu>     
	      <clip pos="3" side="tl" part="lemh"/> 
	      <clip pos="3" side="tl" part="a_nom"/>
              <clip pos="3" side="tl" part="gen"/>
	      <clip pos="3" side="tl" part="nbr"/>
	      <lit-tag v="4"/>
	      <clip pos="3" side="tl" part="lemq"/>
	    </lu>
	  </chunk>
	</out>	  
     </otherwise>
      </choose>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>


<rule comment="REGLA: QNT DET NOM DE NOM ADJ (EO)(pertany a les regles de formació de compostos a partir de  N+de+N, en aquest cas NO volem que faci el compost)">
      <pattern>
	<pattern-item n="tot"/>
	<pattern-item n="det"/>
	<pattern-item n="nom"/>
	<pattern-item n="de"/>
	<pattern-item n="nom"/>
	<pattern-item n="adj"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="nom_cas">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="nombre_nom">
	  <with-param pos="3"/>
	</call-macro>

   <!-- article definit s'elimina i es 'genera' cas: 'totes les nenes : ĉiuj knabinoj-->
   <choose>
     <when>
      <test>
       <equal caseless="yes">
        <clip pos="2" side="sl" part="lem"/>
        <lit v="el"/>
        </equal>
      </test>
        <out>
          <chunk name="ĉiu_nom" case="caseFirstWord">
            <tags>
              <tag><lit-tag v="SN"/></tag>
              <tag><clip pos="3" side="sl" part="gen"/></tag>
              <tag><var n="nombre"/></tag>
              <tag><var n="case"/></tag>
              <tag><var n="changecase"/></tag>
            </tags>
	    <lu>   
	      <clip pos="1" side="tl" part="lem"/> 
	      <clip pos="1" side="tl" part="a_det"/>
	      <clip pos="1" side="tl" part="nbr"/>
	      <lit-tag v="4"/>
	    </lu> 
	    <b pos="1"/>
            <lu>
              <clip pos="3" side="tl" part="lemh"/>
              <clip pos="3" side="tl" part="a_nom"/>
              <clip pos="3" side="tl" part="gen"/>
              <clip pos="3" side="tl" part="nbr"/>
              <lit-tag v="4"/>
              <clip pos="3" side="tl" part="lemq"/>
            </lu>
	    </chunk>
	    <b pos="1"/>
         <chunk name="de" case="caseFirstWord">
            <tags>
              <tag><lit-tag v="PREP"/></tag>
            </tags>
            <lu>
              <clip pos="4" side="tl" part="whole"/>
            </lu>
          </chunk>
            <b pos="2"/>
         <chunk name="nom_adj" case="caseFirstWord">
            <tags>
              <tag><lit-tag v="SN"/></tag>
              <tag><clip pos="5" side="sl" part="gen"/></tag>
              <tag><var n="nombre"/></tag>
              <tag><var n="case"/></tag>
            </tags>
            <lu>
              <clip pos="6" side="tl" part="lem"/>
              <clip pos="6" side="tl" part="a_adj"/>
              <clip pos="6" side="tl" part="nbr"/>
              <lit-tag v="4"/>
            </lu>
            <b pos="1"/>
	    <lu>
	      <clip pos="5" side="tl" part="lemh"/>
              <clip pos="5" side="tl" part="a_nom"/>
              <clip pos="5" side="tl" part="gen"/>
              <clip pos="5" side="tl" part="nbr"/>
              <lit-tag v="4"/>
              <clip pos="5" side="tl" part="lemq"/>
            </lu>
          </chunk>
        </out>
    </when>
<otherwise>           <!-- demostratius i altres -->
	<out>
	  <chunk name="ĉiunom" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN"/></tag>
	      <tag><clip pos="3" side="sl" part="gen"/></tag>
	      <tag><var n="nombre"/></tag>
	      <tag><var n="case"/></tag>
	      <tag><var n="changecase"/></tag>
	    </tags>
	    <lu>   
	      <clip pos="1" side="tl" part="lem"/> 
	      <clip pos="1" side="tl" part="a_det"/>
	      <clip pos="1" side="tl" part="nbr"/>
	      <lit-tag v="4"/>
	    </lu> 
	    <b pos="1"/>
	    <lu>   
	      <clip pos="2" side="tl" part="lem"/> 
	      <clip pos="2" side="tl" part="a_det"/>
	      <clip pos="2" side="tl" part="nbr"/>
	      <lit-tag v="4"/>
	    </lu> 
	    <b pos="2"/>
	    <lu>     
              <clip pos="3" side="tl" part="lemh"/>
              <clip pos="3" side="tl" part="a_nom"/>
              <clip pos="3" side="tl" part="gen"/>
              <clip pos="3" side="tl" part="nbr"/>
              <lit-tag v="4"/>
              <clip pos="3" side="tl" part="lemq"/>
	    </lu>
	    </chunk>
            <b pos="1"/>
         <chunk name="de" case="caseFirstWord">
            <tags>
              <tag><lit-tag v="PREP"/></tag>
            </tags>
            <lu>
              <clip pos="4" side="tl" part="whole"/>
            </lu>
          </chunk>
            <b pos="2"/>
         <chunk name="nom_adj" case="caseFirstWord">
            <tags>
              <tag><lit-tag v="SN"/></tag>
              <tag><clip pos="5" side="sl" part="gen"/></tag>
              <tag><var n="nombre"/></tag>
              <tag><var n="case"/></tag>
            </tags>
            <lu>
              <clip pos="6" side="tl" part="lem"/>
              <clip pos="6" side="tl" part="a_adj"/>
              <clip pos="6" side="tl" part="nbr"/>
              <lit-tag v="4"/>
            </lu>
            <b pos="1"/>
	    <lu>     
	      <clip pos="5" side="tl" part="lemh"/> 
	      <clip pos="5" side="tl" part="a_nom"/>
              <clip pos="5" side="tl" part="gen"/>
	      <clip pos="5" side="tl" part="nbr"/>
	      <lit-tag v="4"/>
	      <clip pos="5" side="tl" part="lemq"/>
	    </lu>
	  </chunk>
	</out>	  
     </otherwise>
      </choose>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>
<rule comment="REGLA: QNT DET NOM DE NOM (EO)(pertany a les regles de formació de compostos a partir de  N+de+N)">
      <pattern>
	<pattern-item n="tot"/>
	<pattern-item n="det"/>
	<pattern-item n="nom"/>
	<pattern-item n="de"/>
	<pattern-item n="nom"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="nom_cas">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="nombre_nom">
	  <with-param pos="3"/>
	</call-macro>

   <!-- article definit s'elimina i es 'genera' cas: 'totes les nenes : ĉiuj knabinoj-->
   <choose>
     <when>
      <test>
       <equal caseless="yes">
        <clip pos="2" side="sl" part="lem"/>
        <lit v="el"/>
        </equal>
      </test>
        <out>
          <chunk name="ĉiu_nom" case="caseFirstWord">
            <tags>
              <tag><lit-tag v="SN"/></tag>
              <tag><clip pos="3" side="sl" part="gen"/></tag>
              <tag><var n="nombre"/></tag>
              <tag><var n="case"/></tag>
              <tag><var n="changecase"/></tag>
            </tags>
	    <lu>   
	      <clip pos="1" side="tl" part="lem"/> 
	      <clip pos="1" side="tl" part="a_det"/>
	      <clip pos="1" side="tl" part="nbr"/>
	      <lit-tag v="4"/>
	    </lu> 
	    <b pos="1"/>
            <lu>
              <clip pos="5" side="tl" part="lemh"/>
              <clip pos="5" side="tl" part="a_nom"/>
              <clip pos="5" side="tl" part="gen"/>
	      <lit-tag v="sg"/> <!-- no volem que canvii el nbr, de fet passa a formar part d'un compost-->
	      <lit-tag v="nomi"/> <!-- no volem que canvii el cas, de fet passa a formar part d'un compost-->
              <clip pos="5" side="tl" part="lemq"/>
            </lu>
	    <!--<b pos="2"/>-->
            <lu>
              <clip pos="3" side="tl" part="lemh"/>
              <clip pos="3" side="tl" part="a_nom"/>
              <clip pos="3" side="tl" part="gen"/>
              <clip pos="3" side="tl" part="nbr"/>
              <lit-tag v="4"/>
              <clip pos="3" side="tl" part="lemq"/>
            </lu>
          </chunk>
        </out>
    </when>
<otherwise>           <!-- demostratius i altres -->
	<out>
	  <chunk name="ĉiunom" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN"/></tag>
	      <tag><clip pos="3" side="sl" part="gen"/></tag>
	      <tag><var n="nombre"/></tag>
	      <tag><var n="case"/></tag>
	      <tag><var n="changecase"/></tag>
	    </tags>
	    <lu>   
	      <clip pos="1" side="tl" part="lem"/> 
	      <clip pos="1" side="tl" part="a_det"/>
	      <clip pos="1" side="tl" part="nbr"/>
	      <lit-tag v="4"/>
	    </lu> 
	    <b pos="1"/>
	    <lu>   
	      <clip pos="2" side="tl" part="lem"/> 
	      <clip pos="2" side="tl" part="a_det"/>
	      <clip pos="2" side="tl" part="nbr"/>
	      <lit-tag v="4"/>
	    </lu> 
	    <b pos="2"/>
	    <lu>     
	      <clip pos="5" side="tl" part="lemh"/> 
	      <clip pos="5" side="tl" part="a_nom"/>
              <clip pos="5" side="tl" part="gen"/>
	      <lit-tag v="sg"/> <!-- no volem que canvii el nbr, de fet passa a formar part d'un compost-->
	      <lit-tag v="nomi"/> <!-- no volem que canvii el cas, de fet passa a formar part d'un compost-->
	      <clip pos="5" side="tl" part="lemq"/>
	    </lu>
	    <!--<b pos="3"/>-->
	    <lu>     
	      <clip pos="3" side="tl" part="lemh"/> 
	      <clip pos="3" side="tl" part="a_nom"/>
              <clip pos="3" side="tl" part="gen"/>
	      <clip pos="3" side="tl" part="nbr"/>
	      <lit-tag v="4"/>
	      <clip pos="3" side="tl" part="lemq"/>
	    </lu>
	  </chunk>
	</out>	  
     </otherwise>
      </choose>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>


<rule comment="REGLA: DET ADJ NOM DE NOM (EO) (pertany a les regles de formació de compostos a partir de  N+de+N)">
      <pattern>
	<pattern-item n="det"/>
	<pattern-item n="adj"/>
	<pattern-item n="nom"/>
	<pattern-item n="de"/>
	<pattern-item n="nom"/>
      </pattern>
      <action>	
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>	
	<call-macro n="nombre_nom">
	  <with-param pos="3"/>
	</call-macro>	
	<call-macro n="nom_cas">
	  <with-param pos="1"/>
	</call-macro>	
   <!-- article indefinit s'elimina-->
   <choose>
     <when>
      <test>
       <equal caseless="yes">
        <clip pos="1" side="sl" part="lem"/>
        <lit v="un"/>
        </equal>
      </test>
	<out>  
	  <chunk name="nom_adj" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN"/></tag>
	      <tag><clip pos="3" side="sl" part="gen"/></tag>
	      <tag><var n="nombre"/></tag>
	      <tag><var n="case"/></tag>
	    </tags>
	    <lu>   
	      <clip pos="2" side="tl" part="lem"/> 
	      <clip pos="2" side="tl" part="a_adj"/>
	      <clip pos="2" side="tl" part="nbr"/>
	      <lit-tag v="4"/>
	    </lu> 
	    <b pos="1"/>
	    <lu>       
	      <clip pos="5" side="tl" part="lemh"/> 
	      <clip pos="5" side="tl" part="a_nom"/>
	      <clip pos="5" side="tl" part="gen"/> 
	      <lit-tag v="sg"/> <!-- no volem que canvii el nbr, de fet passa a formar part d'un compost-->
	      <lit-tag v="nomi"/> <!-- no volem que canvii el cas, de fet passa a formar part d'un compost-->
	      <clip pos="5" side="tl" part="lemq"/>
	    </lu>
	    <!--<b pos="2"/>-->
	    <lu>       
	      <clip pos="3" side="tl" part="lemh"/> 
	      <clip pos="3" side="tl" part="a_nom"/>
	      <clip pos="3" side="tl" part="gen"/> 
	      <clip pos="3" side="tl" part="nbr"/>
	      <lit-tag v="4"/>
	      <clip pos="3" side="tl" part="lemq"/>
	    </lu>
	  </chunk>
	</out>       
    </when>
<otherwise>           <!-- article definit-->
	<out>  
	  <chunk name="det_nom_adj" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN"/></tag>
	      <tag><clip pos="3" side="sl" part="gen"/></tag>
	      <tag><var n="nombre"/></tag>
	      <tag><var n="case"/></tag>
	      <tag><var n="changecase"/></tag>
	    </tags>
	    <lu>   
	      <clip pos="1" side="tl" part="lem"/> 
	      <clip pos="1" side="tl" part="a_det"/>
	      <clip pos="1" side="tl" part="nbr"/>
	      <lit-tag v="4"/>
	    </lu>
	    <b pos="1"/>
	    <lu>   
	      <clip pos="2" side="tl" part="lem"/> 
	      <clip pos="2" side="tl" part="a_adj"/>
	      <clip pos="2" side="tl" part="nbr"/>
	      <lit-tag v="4"/>
	    </lu> 
	    <b pos="2"/>
	    <lu>       
	      <clip pos="5" side="tl" part="lemh"/> 
	      <clip pos="5" side="tl" part="a_nom"/>
	      <clip pos="5" side="tl" part="gen"/> 
	      <lit-tag v="sg"/> <!-- no volem que canvii el nbr, de fet passa a formar part d'un compost-->
	      <lit-tag v="nomi"/> <!-- no volem que canvii el cas, de fet passa a formar part d'un compost-->
	      <clip pos="5" side="tl" part="lemq"/>
	    </lu>
	    <!--<b pos="3"/>-->
	    <lu>       
	      <clip pos="3" side="tl" part="lemh"/> 
	      <clip pos="3" side="tl" part="a_nom"/>
	      <clip pos="3" side="tl" part="gen"/> 
	      <clip pos="3" side="tl" part="nbr"/>
	      <lit-tag v="4"/>
	      <clip pos="3" side="tl" part="lemq"/>
	    </lu>
	  </chunk>
	</out>       
     </otherwise>
      </choose>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>

<rule comment="REGLA: NOM ADJ (EO, sintagmes nominals sense especificadors)">
      <pattern>
	<pattern-item n="nom"/>
	<pattern-item n="adj"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>	
	<call-macro n="nombre_nom">
	  <with-param pos="1"/>
	</call-macro>	
	<call-macro n="nom_cas">
	  <with-param pos="1"/>
	</call-macro>	
	<out> 
	  <chunk name="nom_adj" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN"/></tag>
	      <tag><clip pos="1" side="sl" part="gen"/></tag>
	      <tag><var n="nombre"/></tag>
	      <tag><var n="case"/></tag>
	    </tags>
	    <lu>   
	      <clip pos="2" side="tl" part="lem"/> 
	      <clip pos="2" side="tl" part="a_adj"/>
	      <clip pos="2" side="tl" part="nbr"/>
	      <lit-tag v="4"/>
	    </lu> 
	    <b pos="1"/>
	    <lu>       
	      <clip pos="1" side="tl" part="lemh"/> 
	      <clip pos="1" side="tl" part="a_nom"/>
	      <clip pos="1" side="tl" part="gen"/> 
	      <clip pos="1" side="tl" part="nbr"/>
	      <lit-tag v="4"/>
	      <clip pos="1" side="tl" part="lemq"/>
	    </lu>
	  </chunk>
	</out>       
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>

<rule comment="REGLA: NOM ADJ ADJ (EO, sintagmes nominals sense especificadors)">
      <pattern>
	<pattern-item n="nom"/>
	<pattern-item n="adj"/>
	<pattern-item n="adj"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>	
	<call-macro n="nombre_nom">
	  <with-param pos="1"/>
	</call-macro>	
	<call-macro n="nom_cas">
	  <with-param pos="1"/>
	</call-macro>	
	<out> 
	  <chunk name="nom_adj_adj" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN"/></tag>
	      <tag><clip pos="1" side="sl" part="gen"/></tag>
	      <tag><var n="nombre"/></tag>
	      <tag><var n="case"/></tag>
	    </tags>
	    <lu>   
	      <clip pos="3" side="tl" part="lem"/> 
	      <clip pos="3" side="tl" part="a_adj"/>
	      <clip pos="3" side="tl" part="nbr"/>
	      <lit-tag v="4"/>
	    </lu> 
	    <b pos="1"/>
	    <lu>   
	      <clip pos="2" side="tl" part="lem"/> 
	      <clip pos="2" side="tl" part="a_adj"/>
	      <clip pos="2" side="tl" part="nbr"/>
	      <lit-tag v="4"/>
	    </lu> 
	    <b pos="2"/>
	    <lu>       
	      <clip pos="1" side="tl" part="lemh"/> 
	      <clip pos="1" side="tl" part="a_nom"/>
	      <clip pos="1" side="tl" part="gen"/> 
	      <clip pos="1" side="tl" part="nbr"/>
	      <lit-tag v="4"/>
	      <clip pos="1" side="tl" part="lemq"/>
	    </lu>
	  </chunk>
	</out>       
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>
    

<rule comment="REGLA: NOM ADJ I ADJ (EO, sintagmes nominals sense especificadors)">
      <pattern>
	<pattern-item n="nom"/>
	<pattern-item n="adj"/>
	<pattern-item n="cnjcoo"/>
	<pattern-item n="adj"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>	
	<call-macro n="nombre_nom">
	  <with-param pos="1"/>
	</call-macro>	
	<call-macro n="nom_cas">
	  <with-param pos="1"/>
	</call-macro>	
	<out> 
	  <chunk name="nom_adj_i_adj" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN"/></tag>
	      <tag><clip pos="1" side="sl" part="gen"/></tag>
	      <tag><var n="nombre"/></tag>
	      <tag><var n="case"/></tag>
	    </tags>
	    <lu>   
	      <clip pos="4" side="tl" part="lem"/> 
	      <clip pos="4" side="tl" part="a_adj"/>
	      <clip pos="4" side="tl" part="nbr"/>
	      <lit-tag v="4"/>
	    </lu> 
	    <b pos="1"/>
	    <lu>   
	      <clip pos="3" side="tl" part="whole"/> 
	    </lu>
	    <b pos="2"/>
	    <lu>   
	      <clip pos="2" side="tl" part="lem"/> 
	      <clip pos="2" side="tl" part="a_adj"/>
	      <clip pos="2" side="tl" part="nbr"/>
	      <lit-tag v="4"/>
	    </lu> 
	    <b pos="3"/>
	    <lu>       
	      <clip pos="1" side="tl" part="lemh"/> 
	      <clip pos="1" side="tl" part="a_nom"/>
	      <clip pos="1" side="tl" part="gen"/> 
	      <clip pos="1" side="tl" part="nbr"/>
	      <lit-tag v="4"/>
	      <clip pos="1" side="tl" part="lemq"/>
	    </lu>
	  </chunk>
	</out>       
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>



<rule comment="REGLA: NOM QUE (EO, regles específiques de SN amb causula de relatiu, creades per a corregir el tagger 'que -> kiu' )">
      <pattern>
	<pattern-item n="nom"/>
	<pattern-item n="cnjcoopercorregir"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="nombre_nom">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="nom_cas">
	  <with-param pos="1"/>
	</call-macro>
	<out>
	  <chunk name="nom" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN"/></tag>
	      <tag><clip pos="1" side="sl" part="gen"/></tag>
	      <tag><var n="nombre"/></tag>
	      <tag><var n="case"/></tag>
	    </tags>
	    <lu>   <!--<clip pos="1" side="tl" part="whole"/> Per a compostos: --> 
	      <clip pos="1" side="tl" part="lemh"/> 
	      <clip pos="1" side="tl" part="a_nom"/>
	      <clip pos="1" side="tl" part="gen"/>
	      <clip pos="1" side="tl" part="nbr"/>
	      <lit-tag v="4"/>
	      <clip pos="1" side="tl" part="lemq"/>
	    </lu>
	  </chunk>
                <b pos="1"/>
                 <chunk name="relatiu" >
                        <tags>
                        <tag><lit-tag v="SNrelatiu"/></tag>
                        <tag><var n="case"/></tag>
                        </tags>
                        <lu>
                        <lit v="kiu"/>
                        <lit-tag v="prn"/>
                        <lit-tag v="rel"/>
                        <clip pos="1" side="tl" part="nbr"/>
                        <lit-tag v="2"/>
                        </lu>
                        </chunk>

	</out>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>



<rule comment="REGLA: COMA QUE (EO, regles específiques de SN amb causula de relatiu, creades per a corregir el tagger 'que -> kiu' )">
      <pattern>
	<pattern-item n="sent_coma"/>
	<pattern-item n="cnjcoopercorregir"/>
      </pattern>
      <action>
        <let>
                <var n="case"/>
                <lit-tag v="nomi"/>
        </let>

	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<out>
          <chunk name="punt">
            <tags>
              <tag><lit-tag v="sent"/></tag>
            </tags>
            <lu>
              <clip pos="1" side="tl" part="whole"/>
            </lu>
          </chunk>

                <b pos="1"/>
                 <chunk name="relatiu" >
                        <tags>
                        <tag><lit-tag v="SNrelatiu"/></tag>
                        <tag><var n="case"/></tag>
                        </tags>
                        <lu>
                        <lit v="kiu"/>
                        <lit-tag v="prn"/>
                        <lit-tag v="rel"/>
                        <lit-tag v="sg"/>
                        <lit-tag v="2"/>
                        </lu>
                        </chunk>

	</out>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>

<rule comment="REGLA: DET NOM QUE (EO, regles específiques de SN amb causula de relatiu, creades per a corregir el tagger 'que -> kiu' )">
      <pattern>
	<pattern-item n="det"/>
	<pattern-item n="nom"/>
	<pattern-item n="cnjcoopercorregir"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	 <call-macro n="nom_cas"> <!-- assigna cas nominatiu per defecte --> 
	  <with-param pos="1"/>
	</call-macro> 
	<call-macro n="nombre_nom">
	  <with-param pos="2"/>
	</call-macro>

   <choose>
     <when>   <!-- article indefinit s'elimina -->
      <test>
       <or>
       <equal caseless="yes">
        <clip pos="1" side="sl" part="lem"/>
        <lit v="un"/>
        </equal>
       <equal caseless="yes">
        <clip pos="1" side="sl" part="lem"/>
        <lit v="cert"/>
        </equal>
       <equal caseless="yes">
        <clip pos="1" side="sl" part="lem"/>
        <lit v="algun"/>
        </equal>
       </or>
      </test>
        <out>
          <chunk name="nom" case="caseFirstWord">
            <tags>
              <tag><lit-tag v="SN"/></tag>
              <tag><clip pos="2" side="sl" part="gen"/></tag>
              <tag><var n="nombre"/></tag>
              <tag><var n="case"/></tag>
            </tags>
            <lu>
              <clip pos="2" side="tl" part="lemh"/>
              <clip pos="2" side="tl" part="a_nom"/>
              <clip pos="2" side="tl" part="gen"/>
              <clip pos="2" side="tl" part="nbr"/>
              <lit-tag v="4"/>
              <clip pos="2" side="tl" part="lemq"/>
            </lu>
          </chunk>
        </out>
    </when>

<otherwise>           <!-- altres (amb cas)-->

	<out>
	  <chunk name="det_nom" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN"/></tag>
	      <tag><clip pos="2" side="sl" part="gen"/></tag>
	      <tag><var n="nombre"/></tag>
	      <tag><var n="case"/></tag>
	      <tag><var n="changecase"/></tag>
	    </tags>
	    <lu>   
	      <clip pos="1" side="tl" part="lem"/> 
	      <clip pos="1" side="tl" part="a_det"/>
	      <clip pos="1" side="tl" part="nbr"/>
	      <lit-tag v="4"/>
	    </lu> 
	    <b pos="1"/>
	    <lu>     
	      <clip pos="2" side="tl" part="lemh"/> 
	      <clip pos="2" side="tl" part="a_nom"/>
              <clip pos="2" side="tl" part="gen"/>
	      <clip pos="2" side="tl" part="nbr"/>
	      <lit-tag v="4"/>
	      <clip pos="2" side="tl" part="lemq"/>
	    </lu>
	  </chunk>
	</out>	  
     </otherwise>
      </choose>
	<out>
                <b pos="1"/>
                 <chunk name="relatiu" >
                        <tags>
                        <tag><lit-tag v="SNrelatiu"/></tag>
	                <tag><var n="case"/></tag>
                        </tags>
                        <lu>
                        <lit v="kiu"/>
                        <lit-tag v="prn"/>
                        <lit-tag v="rel"/>
              		<clip pos="2" side="tl" part="nbr"/>
              		<lit-tag v="2"/>
                        </lu>
                        </chunk>

	</out>	  
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>


<rule comment="REGLA: DET NUM NOM QUE (EO regles específiques de SN amb causula de relatiu, creades per a corregir el tagger 'que -> kiu' )">
      <pattern>
	<pattern-item n="det"/>
	<pattern-item n="num"/>
	<pattern-item n="nom"/>
	<pattern-item n="cnjcoopercorregir"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="nom_cas">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="nombre_nom">
	  <with-param pos="3"/>
	</call-macro>
	<!--<call-macro n="canvia_det">
	  <with-param pos="1"/>
	  <with-param pos="3"/>
	</call-macro>-->

   <!-- article indefinit s'elimina-->
   <choose>
     <when>
      <test>
       <equal caseless="yes">
        <clip pos="1" side="sl" part="lem"/>
        <lit v="un"/>
        </equal>
      </test>
        <out>
          <chunk name="num_nom" case="caseFirstWord">
            <tags>
              <tag><lit-tag v="SN"/></tag>
              <tag><clip pos="3" side="sl" part="gen"/></tag>
              <tag><var n="nombre"/></tag>
              <tag><var n="case"/></tag>
            </tags>
	    <lu>   
	      <clip pos="2" side="tl" part="lem"/> 
	      <clip pos="2" side="tl" part="a_det"/>
	      <clip pos="2" side="tl" part="nbr"/>
	    </lu> 
	    <b pos="2"/>
            <lu>
              <clip pos="3" side="tl" part="lemh"/>
              <clip pos="3" side="tl" part="a_nom"/>
              <clip pos="3" side="tl" part="gen"/>
              <clip pos="3" side="tl" part="nbr"/>
              <lit-tag v="4"/>
              <clip pos="3" side="tl" part="lemq"/>
            </lu>
          </chunk>
        </out>
    </when>
<otherwise>           <!-- article definit-->
	<out>
	  <chunk name="det_num_nom" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN"/></tag>
	      <tag><clip pos="3" side="sl" part="gen"/></tag>
	      <tag><var n="nombre"/></tag>
	      <tag><var n="case"/></tag>
	      <tag><var n="changecase"/></tag>
	    </tags>
	    <lu>   
	      <clip pos="1" side="tl" part="lem"/> 
	      <clip pos="1" side="tl" part="a_det"/>
	      <clip pos="1" side="tl" part="nbr"/>
	      <lit-tag v="4"/>
	    </lu> 
	    <b pos="1"/>
	    <lu>   
	      <clip pos="2" side="tl" part="lem"/> 
	      <clip pos="2" side="tl" part="a_num"/>
	      <clip pos="2" side="tl" part="nbr"/>
	    </lu> 
	    <b pos="2"/>
	    <lu>     
	      <clip pos="3" side="tl" part="lemh"/> 
	      <clip pos="3" side="tl" part="a_nom"/>
              <clip pos="3" side="tl" part="gen"/>
	      <clip pos="3" side="tl" part="nbr"/>
	      <lit-tag v="4"/>
	      <clip pos="3" side="tl" part="lemq"/>
	    </lu>
	  </chunk>
	</out>	  
     </otherwise>
      </choose>
		<out>
                <b pos="3"/>
                 <chunk name="relatiu" >
                        <tags>
                        <tag><lit-tag v="SNrelatiu"/></tag>
                        <tag><var n="case"/></tag>
                        </tags>
                        <lu>
                        <lit v="kiu"/>
                        <lit-tag v="prn"/>
                        <lit-tag v="rel"/>
                        <clip pos="3" side="tl" part="nbr"/>
              		<lit-tag v="2"/>
                        </lu>
                        </chunk>

	</out>	  
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>



<rule comment="REGLA: QNT DET NOM QUE (EO, regles específiques de SN amb causula de relatiu, creades per a corregir el tagger 'que -> kiu')">
      <pattern>
	<pattern-item n="tot"/>
	<pattern-item n="det"/>
	<pattern-item n="nom"/>
	<pattern-item n="cnjcoopercorregir"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="nom_cas">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="nombre_nom">
	  <with-param pos="3"/>
	</call-macro>

   <!-- article definit s'elimina i es 'genera' cas: 'totes les nenes : ĉiuj knabinoj-->
   <choose>
     <when>
      <test>
       <equal caseless="yes">
        <clip pos="2" side="sl" part="lem"/>
        <lit v="el"/>
        </equal>
      </test>
        <out>
          <chunk name="ĉiu_nom" case="caseFirstWord">
            <tags>
              <tag><lit-tag v="SN"/></tag>
              <tag><clip pos="3" side="sl" part="gen"/></tag>
              <tag><var n="nombre"/></tag>
              <tag><var n="case"/></tag>
              <tag><var n="changecase"/></tag>
            </tags>
	    <lu>   
	      <clip pos="1" side="tl" part="lem"/> 
	      <clip pos="1" side="tl" part="a_det"/>
	      <clip pos="1" side="tl" part="nbr"/>
	      <lit-tag v="4"/>
	    </lu> 
	    <b pos="1"/>
            <lu>
              <clip pos="3" side="tl" part="lemh"/>
              <clip pos="3" side="tl" part="a_nom"/>
              <clip pos="3" side="tl" part="gen"/>
              <clip pos="3" side="tl" part="nbr"/>
              <lit-tag v="4"/>
              <clip pos="3" side="tl" part="lemq"/>
            </lu>
          </chunk>
        </out>
    </when>
<otherwise>           <!-- demostratius i altres -->
	<out>
	  <chunk name="ĉiunom" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN"/></tag>
	      <tag><clip pos="3" side="sl" part="gen"/></tag>
	      <tag><var n="nombre"/></tag>
	      <tag><var n="case"/></tag>
              <tag><var n="changecase"/></tag>
	    </tags>
	    <lu>   
	      <clip pos="1" side="tl" part="lem"/> 
	      <clip pos="1" side="tl" part="a_det"/>
	      <clip pos="1" side="tl" part="nbr"/>
	      <lit-tag v="4"/>
	    </lu> 
	    <b pos="1"/>
	    <lu>   
	      <clip pos="2" side="tl" part="lem"/> 
	      <clip pos="2" side="tl" part="a_det"/>
	      <clip pos="2" side="tl" part="nbr"/>
	      <lit-tag v="4"/>
	    </lu> 
	    <b pos="2"/>
	    <lu>     
	      <clip pos="3" side="tl" part="lemh"/> 
	      <clip pos="3" side="tl" part="a_nom"/>
              <clip pos="3" side="tl" part="gen"/>
	      <clip pos="3" side="tl" part="nbr"/>
	      <lit-tag v="4"/>
	      <clip pos="3" side="tl" part="lemq"/>
	    </lu>
	  </chunk>
	</out>	  
     </otherwise>
      </choose>
	<out>
                <b pos="3"/>
                 <chunk name="relatiu" >
                        <tags>
                        <tag><lit-tag v="SNrelatiu"/></tag>
                        <tag><var n="case"/></tag>
                        </tags>
                        <lu>
                        <lit v="kiu"/>
                        <lit-tag v="prn"/>
                        <lit-tag v="rel"/>
                        <clip pos="3" side="tl" part="nbr"/>
              		<lit-tag v="2"/>
                        </lu>
                        </chunk>
	</out>	  
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>


<rule comment="REGLA: DET NOM ADJ QUE (EO, regles específiques de SN amb causula de relatiu, creades per a corregir el tagger 'que -> kiu' )">
      <pattern>
	<pattern-item n="det"/>
	<pattern-item n="nom"/>
	<pattern-item n="adj"/>
	<pattern-item n="cnjcoopercorregir"/>
      </pattern>
      <action>	
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>	
	<call-macro n="nombre_nom">
	  <with-param pos="2"/>
	</call-macro>	
	<call-macro n="nom_cas">
	  <with-param pos="1"/>
	</call-macro>	
   <!-- article indefinit s'elimina-->
   <choose>
     <when>
      <test>
       <equal caseless="yes">
        <clip pos="1" side="sl" part="lem"/>
        <lit v="un"/>
        </equal>
      </test>
	<out>  
	  <chunk name="nom_adj" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN"/></tag>
	      <tag><clip pos="2" side="sl" part="gen"/></tag>
	      <tag><var n="nombre"/></tag>
	      <tag><var n="case"/></tag>
	    </tags>
	    <lu>   
	      <clip pos="3" side="tl" part="lem"/> 
	      <clip pos="3" side="tl" part="a_adj"/>
	      <clip pos="3" side="tl" part="nbr"/>
	      <lit-tag v="4"/>
	    </lu> 
	    <b pos="1"/>
	    <lu>       
	      <clip pos="2" side="tl" part="lemh"/> 
	      <clip pos="2" side="tl" part="a_nom"/>
	      <clip pos="2" side="tl" part="gen"/> 
	      <clip pos="2" side="tl" part="nbr"/>
	      <lit-tag v="4"/>
	      <clip pos="2" side="tl" part="lemq"/>
	    </lu>
	  </chunk>
	</out>       
    </when>
<otherwise>           <!-- article definit-->
	<out>  
	  <chunk name="det_nom_adj" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN"/></tag>
	      <tag><clip pos="2" side="sl" part="gen"/></tag>
	      <tag><var n="nombre"/></tag>
	      <tag><var n="case"/></tag>
	      <tag><var n="changecase"/></tag>
	    </tags>
	    <lu>   
	      <clip pos="1" side="tl" part="lem"/> 
	      <clip pos="1" side="tl" part="a_det"/>
	      <clip pos="1" side="tl" part="nbr"/>
	      <lit-tag v="4"/>
	    </lu>
	    <b pos="1"/>
	    <lu>   
	      <clip pos="3" side="tl" part="lem"/> 
	      <clip pos="3" side="tl" part="a_adj"/>
	      <clip pos="3" side="tl" part="nbr"/>
	      <lit-tag v="4"/>
	    </lu> 
	    <b pos="2"/>
	    <lu>       
	      <clip pos="2" side="tl" part="lemh"/> 
	      <clip pos="2" side="tl" part="a_nom"/>
	      <clip pos="2" side="tl" part="gen"/> 
	      <clip pos="2" side="tl" part="nbr"/>
	      <lit-tag v="4"/>
	      <clip pos="2" side="tl" part="lemq"/>
	    </lu>
	  </chunk>
	</out>       
     </otherwise>
      </choose>
	<out>
                <b pos="3"/>
                 <chunk name="relatiu" >
                        <tags>
                        <tag><lit-tag v="SNrelatiu"/></tag>
                        <tag><var n="case"/></tag>
                        </tags>
                        <lu>
                        <lit v="kiu"/>
                        <lit-tag v="prn"/>
                        <lit-tag v="rel"/>
                        <clip pos="2" side="tl" part="nbr"/>
              		<lit-tag v="2"/>
                        </lu>
                        </chunk>
	</out>       
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>


<rule comment="REGLA: DET NUM NOM ADJ QUE (EO, regles específiques de SN amb causula de relatiu, creades per a corregir el tagger 'que -> kiu'  )">
      <pattern>
	<pattern-item n="det"/>
	<pattern-item n="num"/>
	<pattern-item n="nom"/>
	<pattern-item n="adj"/>
	<pattern-item n="cnjcoopercorregir"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="nom_cas">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="nombre_nom">
	  <with-param pos="3"/>
	</call-macro>
   <!-- article indefinit s'elimina-->
   <choose>
     <when>
      <test>
       <equal caseless="yes">
        <clip pos="1" side="sl" part="lem"/>
        <lit v="un"/>
        </equal>
      </test>
        <out>
          <chunk name="num_nom_adj" case="caseFirstWord">
            <tags>
              <tag><lit-tag v="SN"/></tag>
              <tag><clip pos="3" side="sl" part="gen"/></tag>
              <tag><var n="nombre"/></tag>
              <tag><var n="case"/></tag>
            </tags>
	    <lu>   
	      <clip pos="2" side="tl" part="lem"/> 
	      <clip pos="2" side="tl" part="a_det"/>
	      <clip pos="2" side="tl" part="nbr"/>
	    </lu> 
	    <b pos="1"/>
            <lu>
              <clip pos="4" side="tl" part="lem"/>
              <clip pos="4" side="tl" part="a_adj"/>
              <clip pos="4" side="tl" part="nbr"/>
              <lit-tag v="4"/>
            </lu>
	    <b pos="2"/>
            <lu>
              <clip pos="3" side="tl" part="lemh"/>
              <clip pos="3" side="tl" part="a_nom"/>
              <clip pos="3" side="tl" part="gen"/>
              <clip pos="3" side="tl" part="nbr"/>
              <lit-tag v="4"/>
              <clip pos="3" side="tl" part="lemq"/>
            </lu>
          </chunk>
        </out>
    </when>
<otherwise>           <!-- article definit-->
	<out>
	  <chunk name="det_num_nom_adj" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN"/></tag>
	      <tag><clip pos="3" side="sl" part="gen"/></tag>
	      <tag><var n="nombre"/></tag>
	      <tag><var n="case"/></tag>
	      <tag><var n="changecase"/></tag>
	    </tags>
	    <lu>   
	      <clip pos="1" side="tl" part="lem"/> 
	      <clip pos="1" side="tl" part="a_det"/>
	      <clip pos="1" side="tl" part="nbr"/>
	      <lit-tag v="4"/>
	    </lu> 
	    <b pos="1"/>
	    <lu>   
	      <clip pos="2" side="tl" part="lem"/> 
	      <clip pos="2" side="tl" part="a_num"/>
	      <clip pos="2" side="tl" part="nbr"/>
	    </lu> 
	    <b pos="2"/>
            <lu>
              <clip pos="4" side="tl" part="lem"/>
              <clip pos="4" side="tl" part="a_adj"/>
              <clip pos="4" side="tl" part="nbr"/>
              <lit-tag v="4"/>
            </lu>
	    <b pos="3"/>
	    <lu>     
	      <clip pos="3" side="tl" part="lemh"/> 
	      <clip pos="3" side="tl" part="a_nom"/>
              <clip pos="3" side="tl" part="gen"/>
	      <clip pos="3" side="tl" part="nbr"/>
	      <lit-tag v="4"/>
	      <clip pos="3" side="tl" part="lemq"/>
	    </lu>
	  </chunk>
	</out>	  
     </otherwise>
      </choose>
	<out>
                <b pos="4"/>
                 <chunk name="relatiu" >
                        <tags>
                        <tag><lit-tag v="SNrelatiu"/></tag>
                        <tag><var n="case"/></tag>
                        </tags>
                        <lu>
                        <lit v="kiu"/>
                        <lit-tag v="prn"/>
                        <lit-tag v="rel"/>
                        <clip pos="3" side="tl" part="nbr"/>
              		<lit-tag v="2"/>
                        </lu>
                        </chunk>
	</out>	  
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>


<rule comment="REGLA: QNT DET NOM ADJ QUE (EO, regles específiques de SN amb causula de relatiu, creades per a corregir el tagger 'que -> kiu')">
      <pattern>
	<pattern-item n="tot"/>
	<pattern-item n="det"/>
	<pattern-item n="nom"/>
	<pattern-item n="adj"/>
	<pattern-item n="cnjcoopercorregir"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="nom_cas">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="nombre_nom">
	  <with-param pos="3"/>
	</call-macro>

   <!-- article definit s'elimina i es 'genera' cas: 'totes les nenes : ĉiuj knabinoj-->
   <choose>
     <when>
      <test>
       <equal caseless="yes">
        <clip pos="2" side="sl" part="lem"/>
        <lit v="el"/>
        </equal>
      </test>
        <out>
          <chunk name="ĉiu_nom_adj" case="caseFirstWord">
            <tags>
              <tag><lit-tag v="SN"/></tag>
              <tag><clip pos="3" side="sl" part="gen"/></tag>
              <tag><var n="nombre"/></tag>
              <tag><var n="case"/></tag>
              <tag><var n="changecase"/></tag>
            </tags>
	    <lu>   
	      <clip pos="1" side="tl" part="lem"/> 
	      <clip pos="1" side="tl" part="a_det"/>
	      <clip pos="1" side="tl" part="nbr"/>
	      <lit-tag v="4"/>
	    </lu> 
	    <b pos="1"/>
            <lu>
              <clip pos="4" side="tl" part="lem"/>
              <clip pos="4" side="tl" part="a_adj"/>
              <clip pos="4" side="tl" part="nbr"/>
              <lit-tag v="4"/>
            </lu>
            <b pos="2"/>
            <lu>
              <clip pos="3" side="tl" part="lemh"/>
              <clip pos="3" side="tl" part="a_nom"/>
              <clip pos="3" side="tl" part="gen"/>
              <clip pos="3" side="tl" part="nbr"/>
              <lit-tag v="4"/>
              <clip pos="3" side="tl" part="lemq"/>
            </lu>
          </chunk>
        </out>
    </when>
<otherwise>           <!-- demostratiu (dividim el SN en tot/ĉiu + PP(le ...)-->
	<out>
	  <chunk name="ĉiunom" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN"/></tag>
	      <tag><clip pos="3" side="sl" part="gen"/></tag>
	      <tag><var n="nombre"/></tag>
	      <tag><var n="case"/></tag>
              <tag><var n="changecase"/></tag>
	    </tags>
	    <lu>   
	      <clip pos="1" side="tl" part="lem"/> 
	      <clip pos="1" side="tl" part="a_det"/>
	      <clip pos="1" side="tl" part="nbr"/>
	      <lit-tag v="4"/>
	    </lu> 
	  </chunk>
 	    <b/>
	  <chunk name="le" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="PREP"/></tag>
	    </tags>
	    <lu>
	      <lit v="el"/>
	      <lit-tag v="pr"/>
	    </lu>
	  </chunk>
 	    <b/>
	  <chunk name="det_nom_adj" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN"/></tag>
	      <tag><clip pos="3" side="sl" part="gen"/></tag>
	      <tag><var n="nombre"/></tag>
	      <tag><var n="case"/></tag>
              <tag><var n="changecase"/></tag>
	    </tags>
	    <lu>   
	      <clip pos="2" side="tl" part="lem"/> 
	      <clip pos="2" side="tl" part="a_det"/>
	      <clip pos="2" side="tl" part="nbr"/>
	      <lit-tag v="4"/>
	    </lu> 
	    <b pos="1"/>
            <lu>
              <clip pos="4" side="tl" part="lem"/>
              <clip pos="4" side="tl" part="a_adj"/>
              <clip pos="4" side="tl" part="nbr"/>
              <lit-tag v="4"/>
            </lu>
	    <b pos="2"/>
	    <lu>     
	      <clip pos="3" side="tl" part="lemh"/> 
	      <clip pos="3" side="tl" part="a_nom"/>
              <clip pos="3" side="tl" part="gen"/>
	      <clip pos="3" side="tl" part="nbr"/>
	      <lit-tag v="4"/>
	      <clip pos="3" side="tl" part="lemq"/>
	    </lu>
	  </chunk>
	</out>	  
     </otherwise>
      </choose>
	<out>
                <b pos="4"/>
                 <chunk name="relatiu" >
                        <tags>
                        <tag><lit-tag v="SNrelatiu"/></tag>
                        <tag><var n="case"/></tag>
                        </tags>
                        <lu>
                        <lit v="kiu"/>
                        <lit-tag v="prn"/>
                        <lit-tag v="rel"/>
                        <clip pos="3" side="tl" part="nbr"/>
              		<lit-tag v="2"/>
                        </lu>
                        </chunk>
	</out>	  
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>

<rule comment="REGLA: DET NOM ADV ADJ QUE (EO, regles específiques de SN amb causula de relatiu, creades per a corregir el tagger 'que -> kiu')">
      <pattern>
	<pattern-item n="det"/>
	<pattern-item n="nom"/>
	<pattern-item n="adv_preadv"/>
	<pattern-item n="adj"/>
	<pattern-item n="cnjcoopercorregir"/>
      </pattern>
      <action>	
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>	
	<call-macro n="nom_cas">
	  <with-param pos="1"/>
	</call-macro>	
	<call-macro n="nombre_nom">
	  <with-param pos="2"/>
	</call-macro>	
	<!--<call-macro n="canvia_det">
	  <with-param pos="1"/>
	  <with-param pos="2"/>
	</call-macro>-->
   <!-- article indefinit s'elimina-->
   <choose>
     <when>
      <test>
       <equal caseless="yes">
        <clip pos="1" side="sl" part="lem"/>
        <lit v="un"/>
        </equal>
      </test>

	<out>  
	  <chunk name="nom_adv_adj" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN"/></tag>
	      <tag><clip pos="2" side="sl" part="gen"/></tag>
	      <tag><var n="nombre"/></tag>
	      <tag><var n="case"/></tag>
	    </tags>
	    <lu>   
	      <clip pos="3" side="tl" part="whole"/> 
	    </lu>
	    <b pos="1"/>
	    <lu>   
	      <clip pos="4" side="tl" part="lem"/> 
	      <clip pos="4" side="tl" part="a_adj"/>
	      <clip pos="4" side="tl" part="nbr"/>
	      <lit-tag v="4"/>
	    </lu> 
	    <b pos="2"/>
	    <lu>         
	      <clip pos="2" side="tl" part="lemh"/> 
	      <clip pos="2" side="tl" part="a_nom"/>
	      <clip pos="2" side="tl" part="gen"/>
	      <clip pos="2" side="tl" part="nbr"/>
	      <lit-tag v="4"/>
	      <clip pos="2" side="tl" part="lemq"/> 
	    </lu>
	  </chunk>
	</out>       
  </when>
  <otherwise>
	<out>  
	  <chunk name="det_nom_adv_adj" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN"/></tag>
	      <tag><clip pos="2" side="sl" part="gen"/></tag>
	      <tag><var n="nombre"/></tag>
	      <tag><var n="case"/></tag>
	      <tag><var n="changecase"/></tag>
	    </tags>
	    <lu>   
	      <clip pos="1" side="tl" part="lem"/> 
	      <clip pos="1" side="tl" part="a_det"/>
	      <clip pos="1" side="tl" part="nbr"/>
	      <lit-tag v="4"/>
	    </lu>
	    <b pos="1"/>
	    <lu>   
	      <clip pos="3" side="tl" part="whole"/> 
	    </lu>
	    <b pos="2"/>
	    <lu>   
	      <clip pos="4" side="tl" part="lem"/> 
	      <clip pos="4" side="tl" part="a_adj"/>
	      <clip pos="4" side="tl" part="nbr"/>
	      <lit-tag v="4"/>
	    </lu> 
	    <b pos="3"/>
	    <lu>         
	      <clip pos="2" side="tl" part="lemh"/> 
	      <clip pos="2" side="tl" part="a_nom"/>
	      <clip pos="2" side="tl" part="gen"/>
	      <clip pos="2" side="tl" part="nbr"/>
	      <lit-tag v="4"/>
	      <clip pos="2" side="tl" part="lemq"/> 
	    </lu>
	  </chunk>
	</out>       
     </otherwise>
      </choose>
	<out>
                <b pos="4"/>
                 <chunk name="relatiu" >
                        <tags>
                        <tag><lit-tag v="SNrelatiu"/></tag>
                        <tag><var n="case"/></tag>
                        </tags>
                        <lu>
                        <lit v="kiu"/>
                        <lit-tag v="prn"/>
                        <lit-tag v="rel"/>
                        <clip pos="2" side="tl" part="nbr"/>
              		<lit-tag v="2"/>
                        </lu>
                        </chunk>
	</out>       
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>


<rule comment="REGLA: DET NUM NOM ADV ADJ QUE (EO, regles específiques de SN amb causula de relatiu, creades per a corregir el tagger 'que -> kiu' )">
      <pattern>
	<pattern-item n="det"/>
	<pattern-item n="num"/>
	<pattern-item n="nom"/>
        <pattern-item n="adv_preadv"/>
	<pattern-item n="adj"/>
	<pattern-item n="cnjcoopercorregir"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="nom_cas">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="nombre_nom">
	  <with-param pos="3"/>
	</call-macro>
   <!-- article indefinit s'elimina-->
   <choose>
     <when>
      <test>
       <equal caseless="yes">
        <clip pos="1" side="sl" part="lem"/>
        <lit v="un"/>
        </equal>
      </test>
        <out>
          <chunk name="num_nom_adv_adj" case="caseFirstWord">
            <tags>
              <tag><lit-tag v="SN"/></tag>
              <tag><clip pos="3" side="sl" part="gen"/></tag>
              <tag><var n="nombre"/></tag>
              <tag><var n="case"/></tag>
            </tags>
	    <lu>   
	      <clip pos="2" side="tl" part="lem"/> 
	      <clip pos="2" side="tl" part="a_det"/>
	      <clip pos="2" side="tl" part="nbr"/>
	    </lu> 
	    <b pos="1"/>
                <lu>
                  <clip pos="4" side="tl" part="whole"/>
                </lu>
	    <b pos="2"/>
            <lu>
              <clip pos="5" side="tl" part="lem"/>
              <clip pos="5" side="tl" part="a_adj"/>
              <clip pos="5" side="tl" part="nbr"/>
              <lit-tag v="4"/>
            </lu>
	    <b pos="3"/>
            <lu>
              <clip pos="3" side="tl" part="lemh"/>
              <clip pos="3" side="tl" part="a_nom"/>
              <clip pos="3" side="tl" part="gen"/>
              <clip pos="3" side="tl" part="nbr"/>
              <lit-tag v="4"/>
              <clip pos="3" side="tl" part="lemq"/>
            </lu>
          </chunk>
        </out>
    </when>
<otherwise>           <!-- article definit-->
	<out>
	  <chunk name="det_num_nom_adv_adj" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN"/></tag>
	      <tag><clip pos="3" side="sl" part="gen"/></tag>
	      <tag><var n="nombre"/></tag>
	      <tag><var n="case"/></tag>
	      <tag><var n="changecase"/></tag>
	    </tags>
	    <lu>   
	      <clip pos="1" side="tl" part="lem"/> 
	      <clip pos="1" side="tl" part="a_det"/>
	      <clip pos="1" side="tl" part="nbr"/>
	      <lit-tag v="4"/>
	    </lu> 
	    <b pos="1"/>
	    <lu>   
	      <clip pos="2" side="tl" part="lem"/> 
	      <clip pos="2" side="tl" part="a_num"/>
	      <clip pos="2" side="tl" part="nbr"/>
	    </lu> 
	    <b pos="2"/>
                <lu>
                  <clip pos="4" side="tl" part="whole"/>
                </lu>
	    <b pos="3"/>
            <lu>
              <clip pos="5" side="tl" part="lem"/>
              <clip pos="5" side="tl" part="a_adj"/>
              <clip pos="5" side="tl" part="nbr"/>
              <lit-tag v="4"/>
            </lu>
	    <b pos="4"/>
	    <lu>     
	      <clip pos="3" side="tl" part="lemh"/> 
	      <clip pos="3" side="tl" part="a_nom"/>
              <clip pos="3" side="tl" part="gen"/>
	      <clip pos="3" side="tl" part="nbr"/>
	      <lit-tag v="4"/>
	      <clip pos="3" side="tl" part="lemq"/>
	    </lu>
	  </chunk>
	</out>	  
     </otherwise>
      </choose>
	<out>
                <b pos="5"/>
                 <chunk name="relatiu" >
                        <tags>
                        <tag><lit-tag v="SNrelatiu"/></tag>
                        <tag><var n="case"/></tag>
                        </tags>
                        <lu>
                        <lit v="kiu"/>
                        <lit-tag v="prn"/>
                        <lit-tag v="rel"/>
                        <clip pos="3" side="tl" part="nbr"/>
              		<lit-tag v="2"/>
                        </lu>
                        </chunk>
	</out>	  
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>


<rule comment="REGLA: DET NOM ADJ conj ADJ QUE (EO, regles específiques de SN amb causula de relatiu, creades per a corregir el tagger 'que -> kiu' )">
      <pattern>
	<pattern-item n="det"/>
	<pattern-item n="nom"/>
	<pattern-item n="adj"/>
	<pattern-item n="cnjcoo"/>
	<pattern-item n="adj"/>
	<pattern-item n="cnjcoopercorregir"/>
      </pattern>
      <action>		
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>	
	<call-macro n="nombre_nom">
	  <with-param pos="2"/>
	</call-macro>	
	<call-macro n="nom_cas">
	  <with-param pos="1"/>
	</call-macro>	
   <!-- article indefinit s'elimina-->
   <choose>
     <when>
      <test>
       <equal caseless="yes">
        <clip pos="1" side="sl" part="lem"/>
        <lit v="un"/>
        </equal>
      </test>
	    <out> 
	      <chunk name="nom_adj_coo_adj" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="SN"/></tag>
		  <tag><clip pos="2" side="sl" part="gen"/></tag>
		  <tag><var n="nombre"/></tag>
		  <tag><var n="case"/></tag>
		</tags>
		<lu>   
		  <clip pos="3" side="tl" part="lem"/> 
		  <clip pos="3" side="tl" part="a_adj"/>
		  <clip pos="3" side="tl" part="nbr"/>
		  <lit-tag v="4"/>
		</lu> 
		<b pos="1"/>
		<lu>
		  <clip pos="4" side="tl" part="whole"/> 
		</lu>
		<b pos="2"/>
		<lu>   
		  <clip pos="5" side="tl" part="lem"/> 
		  <clip pos="5" side="tl" part="a_adj"/>
		  <clip pos="5" side="tl" part="nbr"/>
		  <lit-tag v="4"/>
		</lu> 
		<b pos="3"/>
		<lu>       
		  <clip pos="2" side="tl" part="lemh"/> 
		  <clip pos="2" side="tl" part="a_nom"/>
		  <clip pos="2" side="tl" part="gen"/>
		  <clip pos="2" side="tl" part="nbr"/>
		  <lit-tag v="4"/>
		  <clip pos="2" side="tl" part="lemq"/>  
		</lu>
	      </chunk>
	    </out>
</when>
<otherwise>           <!-- article definit-->
	    <out> 
	      <chunk name="det_nom_adj_coo_adj" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="SN"/></tag>
		  <tag><clip pos="2" side="sl" part="gen"/></tag>
		  <tag><var n="nombre"/></tag>
		  <tag><var n="case"/></tag>
		  <tag><var n="changecase"/></tag>
		</tags>
		<lu>   
		  <clip pos="1" side="tl" part="lem"/> 
		  <clip pos="1" side="tl" part="a_det"/>
		  <clip pos="1" side="tl" part="nbr"/>
		  <lit-tag v="4"/>
		</lu>
		<b pos="1"/>
		<lu>   
		  <clip pos="3" side="tl" part="lem"/> 
		  <clip pos="3" side="tl" part="a_adj"/>
		  <clip pos="3" side="tl" part="nbr"/>
		  <lit-tag v="4"/>
		</lu> 
		<b pos="2"/>
		<lu>
		  <clip pos="4" side="tl" part="whole"/> 
		</lu>
		<b pos="3"/>
		<lu>   
		  <clip pos="5" side="tl" part="lem"/> 
		  <clip pos="5" side="tl" part="a_adj"/>
		  <clip pos="5" side="tl" part="nbr"/>
		  <lit-tag v="4"/>
		</lu> 
		<b pos="4"/>
		<lu>       
		  <clip pos="2" side="tl" part="lemh"/> 
		  <clip pos="2" side="tl" part="a_nom"/>
		  <clip pos="2" side="tl" part="gen"/>
		  <clip pos="2" side="tl" part="nbr"/>
		  <lit-tag v="4"/>
		  <clip pos="2" side="tl" part="lemq"/>  
		</lu>
	      </chunk>
	    </out>
     </otherwise>
      </choose>
	<out>
                <b pos="5"/>
                 <chunk name="relatiu" >
                        <tags>
                        <tag><lit-tag v="SNrelatiu"/></tag>
                        <tag><var n="case"/></tag>
                        </tags>
                        <lu>
                        <lit v="kiu"/>
                        <lit-tag v="prn"/>
                        <lit-tag v="rel"/>
                        <clip pos="2" side="tl" part="nbr"/>
              		<lit-tag v="2"/>
                        </lu>
                        </chunk>
	    </out>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>

<rule comment="REGLA: DET NUM NOM ADJ conj ADJ QUE (EO, regles específiques de SN amb causula de relatiu, creades per a corregir el tagger 'que -> kiu' )">
      <pattern>
	<pattern-item n="det"/>
	<pattern-item n="num"/>
	<pattern-item n="nom"/>
	<pattern-item n="adj"/>
	<pattern-item n="cnjcoo"/>
	<pattern-item n="adj"/>
	<pattern-item n="cnjcoopercorregir"/>
      </pattern>
      <action>		
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>	
	<call-macro n="nombre_nom">
	  <with-param pos="3"/>
	</call-macro>	
	<call-macro n="nom_cas">
	  <with-param pos="1"/>
	</call-macro>	
   <!-- article indefinit s'elimina-->
   <choose>
     <when>
      <test>
       <equal caseless="yes">
        <clip pos="1" side="sl" part="lem"/>
        <lit v="un"/>
        </equal>
      </test>
	    <out> 
	      <chunk name="nom_adj_coo_adj" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="SN"/></tag>
		  <tag><clip pos="3" side="sl" part="gen"/></tag>
		  <tag><var n="nombre"/></tag>
		  <tag><var n="case"/></tag>
		</tags>
            	<lu>
              	<clip pos="2" side="tl" part="lem"/>
              	<clip pos="2" side="tl" part="a_det"/>
              	<clip pos="2" side="tl" part="nbr"/>
            	</lu>
		<b pos="1"/>
		<lu>   
		  <clip pos="4" side="tl" part="lem"/> 
		  <clip pos="4" side="tl" part="a_adj"/>
		  <clip pos="4" side="tl" part="nbr"/>
		  <lit-tag v="4"/>
		</lu> 
		<b pos="2"/>
		<lu>
		  <clip pos="5" side="tl" part="whole"/> 
		</lu>
		<b pos="3"/>
		<lu>   
		  <clip pos="6" side="tl" part="lem"/> 
		  <clip pos="6" side="tl" part="a_adj"/>
		  <clip pos="6" side="tl" part="nbr"/>
		  <lit-tag v="4"/>
		</lu> 
		<b pos="4"/>
		<lu>       
		  <clip pos="3" side="tl" part="lemh"/> 
		  <clip pos="3" side="tl" part="a_nom"/>
		  <clip pos="3" side="tl" part="gen"/>
		  <clip pos="3" side="tl" part="nbr"/>
		  <lit-tag v="4"/>
		  <clip pos="3" side="tl" part="lemq"/>  
		</lu>
	      </chunk>
	    </out>
</when>
<otherwise>           <!-- article definit-->
	    <out> 
	      <chunk name="det_nom_adj_coo_adj" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="SN"/></tag>
		  <tag><clip pos="3" side="sl" part="gen"/></tag>
		  <tag><var n="nombre"/></tag>
		  <tag><var n="case"/></tag>
		  <tag><var n="changecase"/></tag>
		</tags>
		<lu>   
		  <clip pos="1" side="tl" part="lem"/> 
		  <clip pos="1" side="tl" part="a_det"/>
		  <clip pos="1" side="tl" part="nbr"/>
		  <lit-tag v="4"/>
		</lu>
		<b pos="1"/>
            	<lu>
              	<clip pos="2" side="tl" part="lem"/>
              	<clip pos="2" side="tl" part="a_det"/>
              	<clip pos="2" side="tl" part="nbr"/>
            	</lu>
		<b pos="2"/>
		<lu>   
		  <clip pos="4" side="tl" part="lem"/> 
		  <clip pos="4" side="tl" part="a_adj"/>
		  <clip pos="4" side="tl" part="nbr"/>
		  <lit-tag v="4"/>
		</lu> 
		<b pos="3"/>
		<lu>
		  <clip pos="5" side="tl" part="whole"/> 
		</lu>
		<b pos="4"/>
		<lu>   
		  <clip pos="6" side="tl" part="lem"/> 
		  <clip pos="6" side="tl" part="a_adj"/>
		  <clip pos="6" side="tl" part="nbr"/>
		  <lit-tag v="4"/>
		</lu> 
		<b pos="5"/>
		<lu>       
		  <clip pos="3" side="tl" part="lemh"/> 
		  <clip pos="3" side="tl" part="a_nom"/>
		  <clip pos="3" side="tl" part="gen"/>
		  <clip pos="3" side="tl" part="nbr"/>
		  <lit-tag v="4"/>
		  <clip pos="3" side="tl" part="lemq"/>  
		</lu>
	      </chunk>
	    </out>
     </otherwise>
      </choose>
	<out>
                <b pos="6"/>
                 <chunk name="relatiu" >
                        <tags>
                        <tag><lit-tag v="SNrelatiu"/></tag>
                        <tag><var n="case"/></tag>
                        </tags>
                        <lu>
                        <lit v="kiu"/>
                        <lit-tag v="prn"/>
                        <lit-tag v="rel"/>
                        <clip pos="2" side="tl" part="nbr"/>
              		<lit-tag v="2"/>
                        </lu>
                        </chunk>
	    </out>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>





<rule comment="REGLA: ADJECTIU (quan no acompanya res o va amb desconeguda) (EO)">
      <pattern>
	<pattern-item n="adj"/>
      </pattern>
      <action>     	
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>	
	<call-macro n="nom_cas">
	  <with-param pos="1"/>
	</call-macro>	
	<out>
	  <chunk name="adj" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SA"/></tag>
	      <tag><clip pos="1" side="sl" part="gen"/></tag>
	      <tag><clip pos="1" side="sl" part="nbr"/></tag>
	      <tag><var n="case"/></tag>
	    </tags>
	    <lu>   
	      <clip pos="1" side="tl" part="lem"/> 
	      <clip pos="1" side="tl" part="a_adj"/>
	      <clip pos="1" side="tl" part="nbr"/>
	      <lit-tag v="4"/>
	    </lu> 
	  </chunk>
	</out>  
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule> 


<rule comment="REGLA: ADV ADJECTIU QUE ('més/menys gran que - ') (EO)">
      <pattern>
	<pattern-item n="adv_preadv"/>
	<pattern-item n="adj"/>
	<pattern-item n="cnjcomp"/>
      </pattern>
      <action>          	
	<call-macro n="nom_cas">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	    <out>
	      <chunk name="adj_comparatiu" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="SA"/></tag>
		  <tag><clip pos="2" side="sl" part="gen"/></tag>
		  <tag><clip pos="2" side="sl" part="nbr"/></tag>
	          <tag><var n="case"/></tag>
		</tags>
		<lu>   
		  <clip pos="1" side="tl" part="whole"/> 
		</lu> 
		<b pos="1"/>
		<lu>   
		  <clip pos="2" side="tl" part="lem"/> 
		  <clip pos="2" side="tl" part="a_adj"/>
	          <clip pos="2" side="sl" part="nbr"/>
	          <lit-tag v="4"/>
		</lu>
		<b pos="2"/>
		<lu>   
		  <clip pos="3" side="tl" part="whole"/> 
		</lu>   
	      </chunk>
	    </out>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule> 



<rule comment="REGLA: DETERMINANT (perquè no doni error si va davant de desconegudes i no es pot assignar nombre) (EO)">
      <pattern>
	<pattern-item n="det"/>
      </pattern>
      <action>        	
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="nom_cas">
	  <with-param pos="1"/>
	</call-macro>
	<out>  
	  <chunk name="det" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="DET"/></tag>
	      <tag><clip pos="1" side="sl" part="gen"/></tag>
	      <tag><clip pos="1" side="sl" part="nbr"/></tag>
	      <tag><var n="case"/></tag>
	    </tags>
	    <lu>   
	      <clip pos="1" side="tl" part="lem"/> 
	      <clip pos="1" side="tl" part="a_det"/>
	      <clip pos="1" side="tl" part="nbr"/>
	      <lit-tag v="4"/>
	    </lu> 
	  </chunk>
	</out>  
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>


<!-- ****** REGLES DE SV *********************************************** -->




<rule comment="VERB QUE ( únicament per corregir al tagger quan s'equivoca amb el KE) (EO)">
      <pattern>
	<pattern-item n="verbcj"/>
	<pattern-item n="cnjcoopercorregir"/>
      </pattern>
      <action>    	
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
        <call-macro n="tipus_verbs">
          <with-param pos="1"/>
        </call-macro>

	<choose>
              <when>  <!-- traduccions a present -->
                <test>
                  <or>
                    <equal>
                      <clip pos="1" side="sl" part="temps"/>
                      <lit-tag v="pri"/><!--present indicatiu dic -->
                    </equal>
                    <equal>
                      <clip pos="1" side="sl" part="temps"/>
                      <lit-tag v="prs"/><!--present subjunctiu digui -->
                    </equal>
                  </or>
                </test>
                <let>
                  <clip pos="1" side="tl" part="temps"/>
                  <lit-tag v="pres"/> <!-- present -->
                </let>
              </when>
              <when>           <!-- traduccions a passat -->
                <test>
                  <or>
                    <equal>
                      <clip pos="1" side="sl" part="temps"/>
                      <lit-tag v="ifi"/><!--digué -->
                    </equal>
                    <equal>
                      <clip pos="1" side="sl" part="temps"/>
                      <lit-tag v="pii"/><!--deia -->
                    </equal>
                    <equal>
                      <clip pos="1" side="sl" part="temps"/>
                      <lit-tag v="pis"/><!--digués -->
                    </equal>
                  </or>
                </test>
                <let>
                  <clip pos="1" side="tl" part="temps"/>
                  <lit-tag v="past"/>
                </let>
              </when>

              <when>           <!-- traduccions a futur -->
                <test>
                    <equal>
                      <clip pos="1" side="sl" part="temps"/>
                      <lit-tag v="fti"/><!--digué -->
                    </equal>
                </test>
                <let>
                  <clip pos="1" side="tl" part="temps"/>
                  <lit-tag v="fti"/>
                </let>
              </when>

              <when>           <!-- traduccions a condicional -->
                <test>
                    <equal>
                      <clip pos="1" side="sl" part="temps"/>
                      <lit-tag v="cni"/><!-- -->
                    </equal>
                </test>
                <let>
                  <clip pos="1" side="tl" part="temps"/>
                  <lit-tag v="cni"/>
                </let>
              </when>

              <when>           <!-- traduccions a gerundi -->
                <test>
                    <equal>
                      <clip pos="1" side="sl" part="temps"/>
                      <lit-tag v="ger"/><!-- -->
                    </equal>
                </test>
                <let>
                  <clip pos="1" side="tl" part="temps"/>
                  <lit-tag v="ger"/>
                </let>
              </when>


            </choose>
                <out>
                  <chunk name="verbcj" case="caseFirstWord">
                    <tags>
                      <tag><lit-tag v="SV"/></tag>
                      <tag><clip pos="1" side="tl" part="a_verb"/></tag>
                      <tag><clip pos="1" side="sl" part="temps"/></tag>
                      <tag><clip pos="1" side="tl" part="pers"/></tag>
                      <tag><clip pos="1" side="tl" part="nbr"/></tag>
                      <tag><var n="tipus_verb"/></tag>

                    </tags>
                    <lu>
                      <clip pos="1" side="tl" part="lemh"/>
                      <clip pos="1" side="tl" part="a_verb"/>
                      <clip pos="1" side="tl" part="sep"/>
                      <clip pos="1" side="tl" part="temps"/>
                      <clip pos="1" side="tl" part="lemq"/>
                    </lu>
                  </chunk>
		<b pos="1"/>
		 <chunk name="cnjsub">
            		<tags>
            	  	<tag><lit-tag v="cnjsub"/></tag>
            		</tags>
            		<lu>
              		<lit v="ke"/>
			<lit-tag v="cnjsub"/>
            		</lu>
          		</chunk>
                </out>
        <let>
          <var n="caseFirstWord"/>
          <lit v="aa"/>
        </let>
      </action>
    </rule>


<rule comment="VERB ADV QUE ( únicament per corregir al tagger quan s'equivoca amb el KE) (EO)">
      <pattern>
	<pattern-item n="verbcj"/>
	<pattern-item n="adv"/>
	<pattern-item n="cnjcoopercorregir"/>
      </pattern>
      <action>    	
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
        <call-macro n="tipus_verbs">
          <with-param pos="1"/>
        </call-macro>

	<choose>
              <when>  <!-- traduccions a present -->
                <test>
                  <or>
                    <equal>
                      <clip pos="1" side="sl" part="temps"/>
                      <lit-tag v="pri"/><!--present indicatiu dic -->
                    </equal>
                    <equal>
                      <clip pos="1" side="sl" part="temps"/>
                      <lit-tag v="prs"/><!--present subjunctiu digui -->
                    </equal>
                  </or>
                </test>
                <let>
                  <clip pos="1" side="tl" part="temps"/>
                  <lit-tag v="pres"/> <!-- present -->
                </let>
              </when>
              <when>           <!-- traduccions a passat -->
                <test>
                  <or>
                    <equal>
                      <clip pos="1" side="sl" part="temps"/>
                      <lit-tag v="ifi"/><!--digué -->
                    </equal>
                    <equal>
                      <clip pos="1" side="sl" part="temps"/>
                      <lit-tag v="pii"/><!--deia -->
                    </equal>
                    <equal>
                      <clip pos="1" side="sl" part="temps"/>
                      <lit-tag v="pis"/><!--digués -->
                    </equal>
                  </or>
                </test>
                <let>
                  <clip pos="1" side="tl" part="temps"/>
                  <lit-tag v="past"/>
                </let>
              </when>

              <when>           <!-- traduccions a futur -->
                <test>
                    <equal>
                      <clip pos="1" side="sl" part="temps"/>
                      <lit-tag v="fti"/><!--digué -->
                    </equal>
                </test>
                <let>
                  <clip pos="1" side="tl" part="temps"/>
                  <lit-tag v="fti"/>
                </let>
              </when>
              <when>           <!-- traduccions a condicional -->
                <test>
                    <equal>
                      <clip pos="1" side="sl" part="temps"/>
                      <lit-tag v="cni"/><!-- -->
                    </equal>
                </test>
                <let>
                  <clip pos="1" side="tl" part="temps"/>
                  <lit-tag v="cni"/>
                </let>
              </when>
              <when>           <!-- traduccions a gerundi -->
                <test>
                    <equal>
                      <clip pos="1" side="sl" part="temps"/>
                      <lit-tag v="ger"/><!-- -->
                    </equal>
                </test>
                <let>
                  <clip pos="1" side="tl" part="temps"/>
                  <lit-tag v="ger"/>
                </let>
              </when>
            </choose>
                <out>
                  <chunk name="verbcj" case="caseFirstWord">
                    <tags>
                      <tag><lit-tag v="SV"/></tag>
                      <tag><clip pos="1" side="tl" part="a_verb"/></tag>
                      <tag><clip pos="1" side="sl" part="temps"/></tag>
                      <tag><clip pos="1" side="tl" part="pers"/></tag>
                      <tag><clip pos="1" side="tl" part="nbr"/></tag>
                      <tag><var n="tipus_verb"/></tag>

                    </tags>
                    <lu>
                      <clip pos="1" side="tl" part="lemh"/>
                      <clip pos="1" side="tl" part="a_verb"/>
                      <clip pos="1" side="tl" part="sep"/>
                      <clip pos="1" side="tl" part="temps"/>
                      <clip pos="1" side="tl" part="lemq"/>
                    </lu>
                  </chunk>
		<b pos="1"/>
		  <chunk name="adv" >
		    <tags>
		      <tag><lit-tag v="ADV"/></tag>
		    </tags>
		    <lu>
		      <clip pos="2" side="tl" part="whole"/>
		    </lu>
		  </chunk>
		<b pos="2"/>
		 <chunk name="cnjsub" >
            		<tags>
            	  	<tag><lit-tag v="CNJCSUB"/></tag>
            		</tags>
            		<lu>
              		<lit v="ke"/>
			<lit-tag v="cnjsub"/>
            		</lu>
          		</chunk>
                </out>
        <let>
          <var n="caseFirstWord"/>
          <lit v="aa"/>
        </let>
      </action>
    </rule>

<rule comment="ANAR + INF + QUE (vaig dir que, únicament per corregir el tagger) EO">
      <pattern>
        <pattern-item n="anar"/>
        <pattern-item n="inf"/>
        <pattern-item n="cnjcoopercorregir"/>
      </pattern>
      <action>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="tipus_verbs">
          <with-param pos="2"/>
        </call-macro>

        <let>
          <clip pos="2" side="tl" part="temps"/>
          <lit-tag v="past"/>
        </let>
            <out>
              <chunk name="verbcj" case="caseFirstWord">
                <tags>
                  <tag><lit-tag v="SV"/></tag>
                  <tag><clip pos="2" side="tl" part="a_verb"/></tag>
                  <tag><clip pos="2" side="tl" part="temps"/></tag>
                  <tag><clip pos="1" side="tl" part="pers"/></tag>
                  <tag><clip pos="1" side="tl" part="nbr"/></tag>
		 <tag><var n="tipus_verb"/></tag>
                </tags>
                <lu>
                  <clip pos="2" side="tl" part="lemh"/>
                  <clip pos="2" side="tl" part="a_verb"/>
                  <clip pos="2" side="tl" part="sep"/>
                  <clip pos="2" side="tl" part="temps"/>
                  <clip pos="2" side="tl" part="lemq"/>
                </lu>
              </chunk>
                <b pos="1"/>
                 <chunk name="cnjsub" >
                        <tags>
                        <tag><lit-tag v="cnjsub"/></tag>
                        </tags>
                        <lu>
                        <lit v="ke"/>
                        <lit-tag v="cnjsub"/>
                        </lu>
                        </chunk>
            </out>
        <call-macro n="f_bcond">
          <with-param pos="1"/>
        </call-macro>
        <let>
          <var n="caseFirstWord"/>
          <lit v="aa"/>
        </let>
      </action>
    </rule>


<rule comment="VERBestar + GERUNDI + QUE (per corregir el ke) (estar dient que  EO)">
      <pattern>
	<pattern-item n="estar"/>
	<pattern-item n="ger"/>
        <pattern-item n="cnjcoopercorregir"/>
      </pattern>
      <action>    	
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
        <call-macro n="tipus_verbs">
          <with-param pos="2"/>
        </call-macro>

	<choose>
              <when>  <!-- traduccions a present -->
                <test>
                  <or>
                    <equal>
                      <clip pos="1" side="sl" part="temps"/>
                      <lit-tag v="pri"/><!--present indicatiu dic -->
                    </equal>
                    <equal>
                      <clip pos="1" side="sl" part="temps"/>
                      <lit-tag v="prs"/><!--present subjunctiu digui -->
                    </equal>
                  </or>
                </test>
                <let>
                  <clip pos="1" side="tl" part="temps"/>
                  <lit-tag v="pres"/> <!-- present -->
                </let>
              </when>
              <when>           <!-- traduccions a passat -->
                <test>
                  <or>
                    <equal>
                      <clip pos="1" side="sl" part="temps"/>
                      <lit-tag v="ifi"/><!--digué -->
                    </equal>
                    <equal>
                      <clip pos="1" side="sl" part="temps"/>
                      <lit-tag v="pii"/><!--deia -->
                    </equal>
                    <equal>
                      <clip pos="1" side="sl" part="temps"/>
                      <lit-tag v="pis"/><!--digués -->
                    </equal>
                  </or>
                </test>
                <let>
                  <clip pos="1" side="tl" part="temps"/>
                  <lit-tag v="past"/>
                </let>
              </when>

              <when>           <!-- traduccions a futur -->
                <test>
                    <equal>
                      <clip pos="1" side="sl" part="temps"/>
                      <lit-tag v="fti"/><!--digué -->
                    </equal>
                </test>
                <let>
                  <clip pos="1" side="tl" part="temps"/>
                  <lit-tag v="fti"/>
                </let>
              </when>
              <when>           <!-- traduccions a condicional -->
                <test>
                    <equal>
                      <clip pos="1" side="sl" part="temps"/>
                      <lit-tag v="cni"/><!-- -->
                    </equal>
                </test>
                <let>
                  <clip pos="1" side="tl" part="temps"/>
                  <lit-tag v="cni"/>
                </let>
              </when>
              <when>           <!-- traduccions a gerundi -->
                <test>
                    <equal>
                      <clip pos="1" side="sl" part="temps"/>
                      <lit-tag v="ger"/><!-- -->
                    </equal>
                </test>
                <let>
                  <clip pos="1" side="tl" part="temps"/>
                  <lit-tag v="ger"/>
                </let>
              </when>
            </choose>
                <out>
                  <chunk name="verbcj" case="caseFirstWord">
                    <tags>
                      <tag><lit-tag v="SV"/></tag>
                      <tag><clip pos="2" side="tl" part="a_verb"/></tag>
                      <tag><clip pos="1" side="sl" part="temps"/></tag>
                      <tag><clip pos="1" side="tl" part="pers"/></tag>
                      <tag><clip pos="1" side="tl" part="nbr"/></tag>
		      <tag><var n="tipus_verb"/></tag>

                    </tags>
                    <lu>
                      <clip pos="2" side="tl" part="lemh"/>
                      <clip pos="2" side="tl" part="a_verb"/>
                      <clip pos="1" side="tl" part="sep"/>
                      <clip pos="1" side="tl" part="temps"/>
                      <clip pos="2" side="tl" part="lemq"/>
                    </lu>
                  </chunk>
                <b pos="1"/>
                 <chunk name="cnjsub" >
                        <tags>
                        <tag><lit-tag v="cnjsub"/></tag>
                        </tags>
                        <lu>
                        <lit v="ke"/>
                        <lit-tag v="cnjsub"/>
                        </lu>
                        </chunk>

                </out>
        <let>
          <var n="caseFirstWord"/>
          <lit v="aa"/>
        </let>
      </action>
    </rule>


<rule comment="VERBestar + ADV + GERUNDI + QUE (per corregir el ke) (estar sempre/constantment cantant EO)">
      <pattern>
	<pattern-item n="estar"/>
	<pattern-item n="adv"/>
	<pattern-item n="ger"/>
        <pattern-item n="cnjcoopercorregir"/>
      </pattern>
      <action>    	
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
        <call-macro n="tipus_verbs">
          <with-param pos="3"/>
        </call-macro>

	<choose>
              <when>  <!-- traduccions a present -->
                <test>
                  <or>
                    <equal>
                      <clip pos="1" side="sl" part="temps"/>
                      <lit-tag v="pri"/><!--present indicatiu dic -->
                    </equal>
                    <equal>
                      <clip pos="1" side="sl" part="temps"/>
                      <lit-tag v="prs"/><!--present subjunctiu digui -->
                    </equal>
                  </or>
                </test>
                <let>
                  <clip pos="1" side="tl" part="temps"/>
                  <lit-tag v="pres"/> <!-- present -->
                </let>
              </when>
              <when>           <!-- traduccions a passat -->
                <test>
                  <or>
                    <equal>
                      <clip pos="1" side="sl" part="temps"/>
                      <lit-tag v="ifi"/><!--digué -->
                    </equal>
                    <equal>
                      <clip pos="1" side="sl" part="temps"/>
                      <lit-tag v="pii"/><!--deia -->
                    </equal>
                    <equal>
                      <clip pos="1" side="sl" part="temps"/>
                      <lit-tag v="pis"/><!--digués -->
                    </equal>
                  </or>
                </test>
                <let>
                  <clip pos="1" side="tl" part="temps"/>
                  <lit-tag v="past"/>
                </let>
              </when>

              <when>           <!-- traduccions a futur -->
                <test>
                    <equal>
                      <clip pos="1" side="sl" part="temps"/>
                      <lit-tag v="fti"/><!--digué -->
                    </equal>
                </test>
                <let>
                  <clip pos="1" side="tl" part="temps"/>
                  <lit-tag v="fti"/>
                </let>
              </when>
              <when>           <!-- traduccions a condicional -->
                <test>
                    <equal>
                      <clip pos="1" side="sl" part="temps"/>
                      <lit-tag v="cni"/><!-- -->
                    </equal>
                </test>
                <let>
                  <clip pos="1" side="tl" part="temps"/>
                  <lit-tag v="cni"/>
                </let>
              </when>
              <when>           <!-- traduccions a gerundi -->
                <test>
                    <equal>
                      <clip pos="1" side="sl" part="temps"/>
                      <lit-tag v="ger"/><!-- -->
                    </equal>
                </test>
                <let>
                  <clip pos="1" side="tl" part="temps"/>
                  <lit-tag v="ger"/>
                </let>
              </when>
            </choose>
                <out> 
                  <chunk name="adv" case="caseFirstWord">
                    <tags>
                      <tag><lit-tag v="ADV"/></tag>
                    </tags>
                    <lu>
                      <clip pos="2" side="tl" part="whole"/>
                    </lu>
                  </chunk>
 	          <b pos="1"/>
                  <chunk name="verbcj" >
                    <tags>
                      <tag><lit-tag v="SV"/></tag>
                      <tag><clip pos="3" side="tl" part="a_verb"/></tag>
                      <tag><clip pos="1" side="sl" part="temps"/></tag>
                      <tag><clip pos="1" side="tl" part="pers"/></tag>
                      <tag><clip pos="1" side="tl" part="nbr"/></tag>
		      <tag><var n="tipus_verb"/></tag>

                    </tags>
                    <lu>
                      <clip pos="3" side="tl" part="lemh"/>
                      <clip pos="3" side="tl" part="a_verb"/>
                      <clip pos="1" side="tl" part="sep"/>
                      <clip pos="1" side="tl" part="temps"/>
                      <clip pos="3" side="tl" part="lemq"/>
                    </lu>
                  </chunk>
                <b pos="1"/>
                 <chunk name="cnjsub" >
                        <tags>
                        <tag><lit-tag v="cnjsub"/></tag>
                        </tags>
                        <lu>
                        <lit v="ke"/>
                        <lit-tag v="cnjsub"/>
                        </lu>
                        </chunk>

                </out>
        <let>
          <var n="caseFirstWord"/>
          <lit v="aa"/>
        </let>
      </action>
    </rule>

<rule comment="VERBestar_a_punt_de + INF + QUE (per corregir el ke) (estar a punt de EO)">
      <pattern>
	<pattern-item n="estarapuntde"/>
	<pattern-item n="inf"/>
        <pattern-item n="cnjcoopercorregir"/>
      </pattern>
      <action>    	
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
        <call-macro n="tipus_verbs">
          <with-param pos="2"/>
        </call-macro>

	<choose>
              <when>  <!-- traduccions a present -->
                <test>
                  <or>
                    <equal>
                      <clip pos="1" side="sl" part="temps"/>
                      <lit-tag v="pri"/><!--present indicatiu dic -->
                    </equal>
                    <equal>
                      <clip pos="1" side="sl" part="temps"/>
                      <lit-tag v="prs"/><!--present subjunctiu digui -->
                    </equal>
                  </or>
                </test>
                <let>
                  <clip pos="1" side="tl" part="temps"/>
                  <lit-tag v="pres"/> <!-- present -->
                </let>
              </when>
              <when>           <!-- traduccions a passat -->
                <test>
                  <or>
                    <equal>
                      <clip pos="1" side="sl" part="temps"/>
                      <lit-tag v="ifi"/><!--digué -->
                    </equal>
                    <equal>
                      <clip pos="1" side="sl" part="temps"/>
                      <lit-tag v="pii"/><!--deia -->
                    </equal>
                    <equal>
                      <clip pos="1" side="sl" part="temps"/>
                      <lit-tag v="pis"/><!--digués -->
                    </equal>
                  </or>
                </test>
                <let>
                  <clip pos="1" side="tl" part="temps"/>
                  <lit-tag v="past"/>
                </let>
              </when>

              <when>           <!-- traduccions a futur -->
                <test>
                    <equal>
                      <clip pos="1" side="sl" part="temps"/>
                      <lit-tag v="fti"/><!--digué -->
                    </equal>
                </test>
                <let>
                  <clip pos="1" side="tl" part="temps"/>
                  <lit-tag v="fti"/>
                </let>
              </when>
              <when>           <!-- traduccions a condicional -->
                <test>
                    <equal>
                      <clip pos="1" side="sl" part="temps"/>
                      <lit-tag v="cni"/><!-- -->
                    </equal>
                </test>
                <let>
                  <clip pos="1" side="tl" part="temps"/>
                  <lit-tag v="cni"/>
                </let>
              </when>

              <when>           <!-- traduccions a infinitiu -->
                <test>
                    <equal>
                      <clip pos="1" side="sl" part="temps"/>
                      <lit-tag v="inf"/><!-- -->
                    </equal>
                </test>
                <let>
                  <clip pos="1" side="tl" part="temps"/>
                  <lit-tag v="inf"/>
                </let>
                <let>
                  <clip pos="2" side="tl" part="nbr"/>
                  <lit-tag v="sg"/>
                </let>
              </when>
              <when>           <!-- traduccions a gerundi -->
                <test>
                    <equal>
                      <clip pos="1" side="sl" part="temps"/>
                      <lit-tag v="ger"/><!-- -->
                    </equal>
                </test>
                <let>
                  <clip pos="1" side="tl" part="temps"/>
                  <lit-tag v="ger"/>
                </let>
              </when>
            </choose>
                <let>
                  <clip pos="2" side="tl" part="temps"/>
                  <lit-tag v="pp2"/>
                </let>
                <out>
                  <chunk name="verb_perif" case="caseFirstWord">
                    <tags>
                      <tag><lit-tag v="SV"/></tag>
                      <tag><clip pos="2" side="tl" part="a_verb"/></tag>
                      <tag><clip pos="1" side="sl" part="temps"/></tag>
                      <tag><clip pos="1" side="tl" part="pers"/></tag>
                      <tag><clip pos="1" side="tl" part="nbr"/></tag>
		      <tag><var n="tipus_verb"/></tag>

                    </tags>
                    <lu>
                      <clip pos="1" side="tl" part="lemh"/>
                      <clip pos="1" side="tl" part="a_verb"/>
                      <clip pos="1" side="tl" part="temps"/>
                    </lu>
		    <b pos="1"/>
                    <lu>
                      <clip pos="2" side="tl" part="lemh"/>
                      <clip pos="2" side="tl" part="a_verb"/>
                      <clip pos="2" side="tl" part="temps"/>
                      <clip pos="1" side="tl" part="nbr"/>
                    </lu>
                  </chunk>
                <b pos="1"/>
                 <chunk name="cnjsub" >
                        <tags>
                        <tag><lit-tag v="cnjsub"/></tag>
                        </tags>
                        <lu>
                        <lit v="ke"/>
                        <lit-tag v="cnjsub"/>
                        </lu>
                        </chunk>

                </out>
        <let>
          <var n="caseFirstWord"/>
          <lit v="aa"/>
        </let>
      </action>
    </rule>


<rule comment="VERBacabarde + INF + QUE (per corregir el ke) (acabar de EO)">
      <pattern>
	<pattern-item n="acabarde"/>
	<pattern-item n="inf"/>
        <pattern-item n="cnjcoopercorregir"/>
      </pattern>
      <action>    	
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
        <call-macro n="nom_cas">
          <with-param pos="2"/>
        </call-macro>

	<choose>

              <when>           <!-- traduccions a participi -->
                <test>
                    <equal>
                      <clip pos="1" side="sl" part="temps"/>
                      <lit-tag v="pp"/><!-- -->
                    </equal>
                </test>
                <let>
                  <clip pos="1" side="tl" part="temps"/>
                  <lit-tag v="pp"/>
                </let>
            <out>

		 <chunk name="adv" case="caseFirstWord">
                    <tags>
                      <tag><lit-tag v="ADV"/></tag>
                    </tags>
		    <lu>
                      <lit v="ĵus"/>
                      <lit-tag v="adv"/>
                    </lu>
		</chunk>
		<b/>


                  <chunk name="verb_perif" >
                    <tags>
                      <tag><lit-tag v="SV"/></tag>
                      <tag><clip pos="2" side="tl" part="a_verb"/></tag>
                      <tag><clip pos="1" side="sl" part="temps"/></tag>
                      <tag><clip pos="1" side="tl" part="pers"/></tag>
                      <tag><clip pos="1" side="tl" part="nbr"/></tag>
	              <tag><var n="case"/></tag>
                    </tags>
                    <lu>
                      <clip pos="2" side="tl" part="lemh"/>
                      <clip pos="2" side="tl" part="a_verb"/>
                      <clip pos="1" side="tl" part="temps"/>
                      <clip pos="1" side="tl" part="nbr"/>
		      <clip pos="2" side="tl" part="tipus_prn" link-to="5"/>
                    </lu>
                  </chunk>
            </out>
              </when>
            <otherwise>
	    <choose>
              <when>  <!-- traduccions a present -->
                <test>
                  <or>
                    <equal>
                      <clip pos="1" side="sl" part="temps"/>
                      <lit-tag v="pri"/><!--present indicatiu dic -->
                    </equal>
                    <equal>
                      <clip pos="1" side="sl" part="temps"/>
                      <lit-tag v="prs"/><!--present subjunctiu digui -->
                    </equal>
                  </or>
                </test>
                <let>
                  <clip pos="1" side="tl" part="temps"/>
                  <lit-tag v="past"/> <!-- passat -->
                </let>
              </when>
              <when>           <!-- traduccions a passat -->
                <test>
                  <or>
                    <equal>
                      <clip pos="1" side="sl" part="temps"/>
                      <lit-tag v="ifi"/><!--digué -->
                    </equal>
                    <equal>
                      <clip pos="1" side="sl" part="temps"/>
                      <lit-tag v="pii"/><!--deia -->
                    </equal>
                    <equal>
                      <clip pos="1" side="sl" part="temps"/>
                      <lit-tag v="pis"/><!--digués -->
                    </equal>
                  </or>
                </test>
                <let>
                  <clip pos="1" side="tl" part="temps"/>
                  <lit-tag v="past"/>
                </let>
              </when>

              <when>           <!-- traduccions a futur -->
                <test>
                    <equal>
                      <clip pos="1" side="sl" part="temps"/>
                      <lit-tag v="fti"/><!--digué -->
                    </equal>
                </test>
                <let>
                  <clip pos="1" side="tl" part="temps"/>
                  <lit-tag v="fti"/>
                </let>
              </when>
              <when>           <!-- traduccions a condicional -->
                <test>
                    <equal>
                      <clip pos="1" side="sl" part="temps"/>
                      <lit-tag v="cni"/><!-- -->
                    </equal>
                </test>
                <let>
                  <clip pos="1" side="tl" part="temps"/>
                  <lit-tag v="cni"/>
                </let>
              </when>
              <when>           <!-- traduccions a gerundi -->
                <test>
                    <equal>
                      <clip pos="1" side="sl" part="temps"/>
                      <lit-tag v="ger"/><!-- -->
                    </equal>
                </test>
                <let>
                  <clip pos="1" side="tl" part="temps"/>
                  <lit-tag v="ger"/>
                </let>
              </when>
	   </choose>
                <let>
                  <clip pos="2" side="tl" part="temps"/>
                  <lit-tag v="pp2"/>
                </let>
                <out>
		 <chunk name="adv" case="caseFirstWord">
                    <tags>
                      <tag><lit-tag v="ADV"/></tag>
                    </tags>
		    <lu>
                      <lit v="ĵus"/>
                      <lit-tag v="adv"/>
                    </lu>
		</chunk>
		<b/>


                  <chunk name="verb_perif" >
                    <tags>
                      <tag><lit-tag v="SV"/></tag>
                      <tag><clip pos="2" side="tl" part="a_verb"/></tag>
                      <tag><clip pos="1" side="sl" part="temps"/></tag>
                      <tag><clip pos="1" side="tl" part="pers"/></tag>
                      <tag><clip pos="1" side="tl" part="nbr"/></tag>
                    </tags>
                    <lu>
                      <clip pos="2" side="tl" part="lemh"/>
                      <clip pos="2" side="tl" part="a_verb"/>
                      <clip pos="1" side="tl" part="temps"/>
                    </lu>
                  </chunk>
                <b pos="1"/>
                 <chunk name="cnjsub" >
                        <tags>
                        <tag><lit-tag v="cnjsub"/></tag>
                        </tags>
                        <lu>
                        <lit v="ke"/>
                        <lit-tag v="cnjsub"/>
                        </lu>
                        </chunk>

                </out>
        </otherwise>
        </choose>
        <let>
          <var n="caseFirstWord"/>
          <lit v="aa"/>
        </let>
      </action>
    </rule>


<rule comment="VERBestar + GERUNDI (estar cantant EO)">
      <pattern>
	<pattern-item n="estar"/>
	<pattern-item n="ger"/>
      </pattern>
      <action>    	
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
        <call-macro n="tipus_verbs">
          <with-param pos="2"/>
        </call-macro>

	<choose>
              <when>  <!-- traduccions a present -->
                <test>
                  <or>
                    <equal>
                      <clip pos="1" side="sl" part="temps"/>
                      <lit-tag v="pri"/><!--present indicatiu dic -->
                    </equal>
                    <equal>
                      <clip pos="1" side="sl" part="temps"/>
                      <lit-tag v="prs"/><!--present subjunctiu digui -->
                    </equal>
                  </or>
                </test>
                <let>
                  <clip pos="1" side="tl" part="temps"/>
                  <lit-tag v="pres"/> <!-- present -->
                </let>
              </when>
              <when>           <!-- traduccions a passat -->
                <test>
                  <or>
                    <equal>
                      <clip pos="1" side="sl" part="temps"/>
                      <lit-tag v="ifi"/><!--digué -->
                    </equal>
                    <equal>
                      <clip pos="1" side="sl" part="temps"/>
                      <lit-tag v="pii"/><!--deia -->
                    </equal>
                    <equal>
                      <clip pos="1" side="sl" part="temps"/>
                      <lit-tag v="pis"/><!--digués -->
                    </equal>
                  </or>
                </test>
                <let>
                  <clip pos="1" side="tl" part="temps"/>
                  <lit-tag v="past"/>
                </let>
              </when>

              <when>           <!-- traduccions a futur -->
                <test>
                    <equal>
                      <clip pos="1" side="sl" part="temps"/>
                      <lit-tag v="fti"/><!--digué -->
                    </equal>
                </test>
                <let>
                  <clip pos="1" side="tl" part="temps"/>
                  <lit-tag v="fti"/>
                </let>
              </when>
              <when>           <!-- traduccions a condicional -->
                <test>
                    <equal>
                      <clip pos="1" side="sl" part="temps"/>
                      <lit-tag v="cni"/><!-- -->
                    </equal>
                </test>
                <let>
                  <clip pos="1" side="tl" part="temps"/>
                  <lit-tag v="cni"/>
                </let>
              </when>
              <when>           <!-- traduccions a gerundi -->
                <test>
                    <equal>
                      <clip pos="1" side="sl" part="temps"/>
                      <lit-tag v="ger"/><!-- -->
                    </equal>
                </test>
                <let>
                  <clip pos="1" side="tl" part="temps"/>
                  <lit-tag v="ger"/>
                </let>
              </when>
            </choose>
                <out>
                  <chunk name="verbcj" case="caseFirstWord">
                    <tags>
                      <tag><lit-tag v="SV"/></tag>
                      <tag><clip pos="2" side="tl" part="a_verb"/></tag>
                      <tag><clip pos="1" side="sl" part="temps"/></tag>
                      <tag><clip pos="1" side="tl" part="pers"/></tag>
                      <tag><clip pos="1" side="tl" part="nbr"/></tag>
		      <tag><var n="tipus_verb"/></tag>

                    </tags>
                    <lu>
                      <clip pos="2" side="tl" part="lemh"/>
                      <clip pos="2" side="tl" part="a_verb"/>
                      <clip pos="1" side="tl" part="sep"/>
                      <clip pos="1" side="tl" part="temps"/>
                      <clip pos="2" side="tl" part="lemq"/>
                    </lu>
                  </chunk>
                </out>
        <let>
          <var n="caseFirstWord"/>
          <lit v="aa"/>
        </let>
      </action>
    </rule>


<rule comment="VERBestar + ADV + GERUNDI (estar sempre/constantment cantant EO)">
      <pattern>
	<pattern-item n="estar"/>
	<pattern-item n="adv"/>
	<pattern-item n="ger"/>
      </pattern>
      <action>    	
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
        <call-macro n="tipus_verbs">
          <with-param pos="3"/>
        </call-macro>

	<choose>
              <when>  <!-- traduccions a present -->
                <test>
                  <or>
                    <equal>
                      <clip pos="1" side="sl" part="temps"/>
                      <lit-tag v="pri"/><!--present indicatiu dic -->
                    </equal>
                    <equal>
                      <clip pos="1" side="sl" part="temps"/>
                      <lit-tag v="prs"/><!--present subjunctiu digui -->
                    </equal>
                  </or>
                </test>
                <let>
                  <clip pos="1" side="tl" part="temps"/>
                  <lit-tag v="pres"/> <!-- present -->
                </let>
              </when>
              <when>           <!-- traduccions a passat -->
                <test>
                  <or>
                    <equal>
                      <clip pos="1" side="sl" part="temps"/>
                      <lit-tag v="ifi"/><!--digué -->
                    </equal>
                    <equal>
                      <clip pos="1" side="sl" part="temps"/>
                      <lit-tag v="pii"/><!--deia -->
                    </equal>
                    <equal>
                      <clip pos="1" side="sl" part="temps"/>
                      <lit-tag v="pis"/><!--digués -->
                    </equal>
                  </or>
                </test>
                <let>
                  <clip pos="1" side="tl" part="temps"/>
                  <lit-tag v="past"/>
                </let>
              </when>

              <when>           <!-- traduccions a futur -->
                <test>
                    <equal>
                      <clip pos="1" side="sl" part="temps"/>
                      <lit-tag v="fti"/><!--digué -->
                    </equal>
                </test>
                <let>
                  <clip pos="1" side="tl" part="temps"/>
                  <lit-tag v="fti"/>
                </let>
              </when>
              <when>           <!-- traduccions a condicional -->
                <test>
                    <equal>
                      <clip pos="1" side="sl" part="temps"/>
                      <lit-tag v="cni"/><!-- -->
                    </equal>
                </test>
                <let>
                  <clip pos="1" side="tl" part="temps"/>
                  <lit-tag v="cni"/>
                </let>
              </when>
              <when>           <!-- traduccions a gerundi -->
                <test>
                    <equal>
                      <clip pos="1" side="sl" part="temps"/>
                      <lit-tag v="ger"/><!-- -->
                    </equal>
                </test>
                <let>
                  <clip pos="1" side="tl" part="temps"/>
                  <lit-tag v="ger"/>
                </let>
              </when>
            </choose>
                <out> 
                  <chunk name="adv" case="caseFirstWord">
                    <tags>
                      <tag><lit-tag v="ADV"/></tag>
                    </tags>
                    <lu>
                      <clip pos="2" side="tl" part="whole"/>
                    </lu>
                  </chunk>
 	          <b pos="1"/>
                  <chunk name="verbcj" case="caseFirstWord">
                    <tags>
                      <tag><lit-tag v="SV"/></tag>
                      <tag><clip pos="3" side="tl" part="a_verb"/></tag>
                      <tag><clip pos="1" side="sl" part="temps"/></tag>
                      <tag><clip pos="1" side="tl" part="pers"/></tag>
                      <tag><clip pos="1" side="tl" part="nbr"/></tag>
		      <tag><var n="tipus_verb"/></tag>

                    </tags>
                    <lu>
                      <clip pos="3" side="tl" part="lemh"/>
                      <clip pos="3" side="tl" part="a_verb"/>
                      <clip pos="1" side="tl" part="sep"/>
                      <clip pos="1" side="tl" part="temps"/>
                      <clip pos="3" side="tl" part="lemq"/>
                    </lu>
                  </chunk>
                </out>
        <let>
          <var n="caseFirstWord"/>
          <lit v="aa"/>
        </let>
      </action>
    </rule>

<rule comment="VERBestar_a_punt_de + INF (estar a punt de EO)">
      <pattern>
	<pattern-item n="estarapuntde"/>
	<pattern-item n="inf"/>
      </pattern>
      <action>    	
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
        <call-macro n="tipus_verbs">
          <with-param pos="2"/>
        </call-macro>

	<choose>
              <when>  <!-- traduccions a present -->
                <test>
                  <or>
                    <equal>
                      <clip pos="1" side="sl" part="temps"/>
                      <lit-tag v="pri"/><!--present indicatiu dic -->
                    </equal>
                    <equal>
                      <clip pos="1" side="sl" part="temps"/>
                      <lit-tag v="prs"/><!--present subjunctiu digui -->
                    </equal>
                  </or>
                </test>
                <let>
                  <clip pos="1" side="tl" part="temps"/>
                  <lit-tag v="pres"/> <!-- present -->
                </let>
              </when>
              <when>           <!-- traduccions a passat -->
                <test>
                  <or>
                    <equal>
                      <clip pos="1" side="sl" part="temps"/>
                      <lit-tag v="ifi"/><!--digué -->
                    </equal>
                    <equal>
                      <clip pos="1" side="sl" part="temps"/>
                      <lit-tag v="pii"/><!--deia -->
                    </equal>
                    <equal>
                      <clip pos="1" side="sl" part="temps"/>
                      <lit-tag v="pis"/><!--digués -->
                    </equal>
                  </or>
                </test>
                <let>
                  <clip pos="1" side="tl" part="temps"/>
                  <lit-tag v="past"/>
                </let>
              </when>

              <when>           <!-- traduccions a futur -->
                <test>
                    <equal>
                      <clip pos="1" side="sl" part="temps"/>
                      <lit-tag v="fti"/><!--digué -->
                    </equal>
                </test>
                <let>
                  <clip pos="1" side="tl" part="temps"/>
                  <lit-tag v="fti"/>
                </let>
              </when>
              <when>           <!-- traduccions a condicional -->
                <test>
                    <equal>
                      <clip pos="1" side="sl" part="temps"/>
                      <lit-tag v="cni"/><!-- -->
                    </equal>
                </test>
                <let>
                  <clip pos="1" side="tl" part="temps"/>
                  <lit-tag v="cni"/>
                </let>
              </when>

              <when>           <!-- traduccions a infinitiu -->
                <test>
                    <equal>
                      <clip pos="1" side="sl" part="temps"/>
                      <lit-tag v="inf"/><!-- -->
                    </equal>
                </test>
                <let>
                  <clip pos="1" side="tl" part="temps"/>
                  <lit-tag v="inf"/>
                </let>
                <let>
                  <clip pos="2" side="tl" part="nbr"/>
                  <lit-tag v="sg"/>
                </let>
              </when>
              <when>           <!-- traduccions a gerundi -->
                <test>
                    <equal>
                      <clip pos="1" side="sl" part="temps"/>
                      <lit-tag v="ger"/><!-- -->
                    </equal>
                </test>
                <let>
                  <clip pos="1" side="tl" part="temps"/>
                  <lit-tag v="ger"/>
                </let>
              </when>
            </choose>
                <let>
                  <clip pos="2" side="tl" part="temps"/>
                  <lit-tag v="pp2"/>
                </let>
                <out>
                  <chunk name="verb_perif" case="caseFirstWord">
                    <tags>
                      <tag><lit-tag v="SV"/></tag>
                      <tag><clip pos="2" side="tl" part="a_verb"/></tag>
                      <tag><clip pos="1" side="sl" part="temps"/></tag>
                      <tag><clip pos="1" side="tl" part="pers"/></tag>
                      <tag><clip pos="1" side="tl" part="nbr"/></tag>
		      <tag><var n="tipus_verb"/></tag>

                    </tags>
                    <lu>
                      <clip pos="1" side="tl" part="lemh"/>
                      <clip pos="1" side="tl" part="a_verb"/>
                      <clip pos="1" side="tl" part="temps"/>
                    </lu>
		    <b pos="1"/>
                    <lu>
                      <clip pos="2" side="tl" part="lemh"/>
                      <clip pos="2" side="tl" part="a_verb"/>
                      <clip pos="2" side="tl" part="temps"/>
                      <clip pos="1" side="tl" part="nbr"/>
                    </lu>
                  </chunk>
                </out>
        <let>
          <var n="caseFirstWord"/>
          <lit v="aa"/>
        </let>
      </action>
    </rule>


<rule comment="HAVER/ANAR VERBacabarde + INF (acabar de EO)">
      <pattern>
	<pattern-item n="haveranar"/>
	<pattern-item n="acabarde"/>
	<pattern-item n="inf"/>
      </pattern>
      <action>    	
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>

                <let>
                  <clip pos="2" side="tl" part="temps"/>
                  <lit-tag v="past"/>
                </let>
	    <out>
		 <chunk name="adv" case="caseFirstWord">
                    <tags>
                      <tag><lit-tag v="ADV"/></tag>
                    </tags>
		    <lu>
                      <lit v="ĵus"/>
                      <lit-tag v="adv"/>
                    </lu>
		</chunk>
		<b/>


                  <chunk name="verb_perif" case="caseFirstWord">
                    <tags>
                      <tag><lit-tag v="SV"/></tag>
                      <tag><clip pos="2" side="tl" part="a_verb"/></tag>
                      <tag><clip pos="2" side="tl" part="temps"/></tag>
                      <tag><clip pos="1" side="tl" part="pers"/></tag>
                      <tag><clip pos="1" side="tl" part="nbr"/></tag>
                    </tags>
                    <lu>
                      <clip pos="3" side="tl" part="lemh"/>
                      <clip pos="3" side="tl" part="a_verb"/>
                      <clip pos="2" side="tl" part="temps"/>
                    </lu>
                  </chunk>
            </out>
	  <let>
          <var n="caseFirstWord"/>
          <lit v="aa"/>
	  </let>
      </action>
    </rule>

<rule comment="VERBacabarde + INF (acabar de EO)">
      <pattern>
	<pattern-item n="acabarde"/>
	<pattern-item n="inf"/>
      </pattern>
      <action>    	
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
        <call-macro n="nom_cas">
          <with-param pos="2"/>
        </call-macro>

	<choose>

              <when>           <!-- traduccions a participi -->
                <test>
                    <equal>
                      <clip pos="1" side="sl" part="temps"/>
                      <lit-tag v="pp"/><!-- -->
                    </equal>
                </test>
                <let>
                  <clip pos="1" side="tl" part="temps"/>
                  <lit-tag v="pp"/>
                </let>
            <out>

		 <chunk name="adv" case="caseFirstWord">
                    <tags>
                      <tag><lit-tag v="ADV"/></tag>
                    </tags>
		    <lu>
                      <lit v="ĵus"/>
                      <lit-tag v="adv"/>
                    </lu>
		</chunk>
		<b/>


                  <chunk name="verb_perif" case="caseFirstWord">
                    <tags>
                      <tag><lit-tag v="SV"/></tag>
                      <tag><clip pos="2" side="tl" part="a_verb"/></tag>
                      <tag><clip pos="1" side="sl" part="temps"/></tag>
                      <tag><clip pos="1" side="tl" part="pers"/></tag>
                      <tag><clip pos="1" side="tl" part="nbr"/></tag>
	              <tag><var n="case"/></tag>
                    </tags>
                    <lu>
                      <clip pos="2" side="tl" part="lemh"/>
                      <clip pos="2" side="tl" part="a_verb"/>
                      <clip pos="1" side="tl" part="temps"/>
                      <clip pos="1" side="tl" part="nbr"/>
		      <clip pos="2" side="tl" part="tipus_prn" link-to="5"/>
                    </lu>
                  </chunk>
            </out>
              </when>
            <otherwise>
	    <choose>
              <when>  <!-- traduccions a present -->
                <test>
                  <or>
                    <equal>
                      <clip pos="1" side="sl" part="temps"/>
                      <lit-tag v="pri"/><!--present indicatiu dic -->
                    </equal>
                    <equal>
                      <clip pos="1" side="sl" part="temps"/>
                      <lit-tag v="prs"/><!--present subjunctiu digui -->
                    </equal>
                  </or>
                </test>
                <let>
                  <clip pos="1" side="tl" part="temps"/>
                  <lit-tag v="past"/> <!-- pasado -->
                </let>
              </when>
              <when>           <!-- traduccions a passat -->
                <test>
                  <or>
                    <equal>
                      <clip pos="1" side="sl" part="temps"/>
                      <lit-tag v="ifi"/><!--digué -->
                    </equal>
                    <equal>
                      <clip pos="1" side="sl" part="temps"/>
                      <lit-tag v="pii"/><!--deia -->
                    </equal>
                    <equal>
                      <clip pos="1" side="sl" part="temps"/>
                      <lit-tag v="pis"/><!--digués -->
                    </equal>
                  </or>
                </test>
                <let>
                  <clip pos="1" side="tl" part="temps"/>
                  <lit-tag v="past"/>
                </let>
              </when>

              <when>           <!-- traduccions a futur -->
                <test>
                    <equal>
                      <clip pos="1" side="sl" part="temps"/>
                      <lit-tag v="fti"/><!--digué -->
                    </equal>
                </test>
                <let>
                  <clip pos="1" side="tl" part="temps"/>
                  <lit-tag v="fti"/>
                </let>
              </when>
              <when>           <!-- traduccions a condicional -->
                <test>
                    <equal>
                      <clip pos="1" side="sl" part="temps"/>
                      <lit-tag v="cni"/><!-- -->
                    </equal>
                </test>
                <let>
                  <clip pos="1" side="tl" part="temps"/>
                  <lit-tag v="cni"/>
                </let>
              </when>
              <when>           <!-- traduccions a gerundi -->
                <test>
                    <equal>
                      <clip pos="1" side="sl" part="temps"/>
                      <lit-tag v="ger"/><!-- -->
                    </equal>
                </test>
                <let>
                  <clip pos="1" side="tl" part="temps"/>
                  <lit-tag v="ger"/>
                </let>
              </when>
	   </choose>
                <let>
                  <clip pos="2" side="tl" part="temps"/>
                  <lit-tag v="pp2"/>
                </let>
                <out>
		 <chunk name="adv" case="caseFirstWord">
                    <tags>
                      <tag><lit-tag v="ADV"/></tag>
                    </tags>
		    <lu>
                      <lit v="ĵus"/>
                      <lit-tag v="adv"/>
                    </lu>
		</chunk>
		<b/>


                  <chunk name="verb_perif" case="caseFirstWord">
                    <tags>
                      <tag><lit-tag v="SV"/></tag>
                      <tag><clip pos="2" side="tl" part="a_verb"/></tag>
                      <tag><clip pos="1" side="sl" part="temps"/></tag>
                      <tag><clip pos="1" side="tl" part="pers"/></tag>
                      <tag><clip pos="1" side="tl" part="nbr"/></tag>
                    </tags>
                    <lu>
                      <clip pos="2" side="tl" part="lemh"/>
                      <clip pos="2" side="tl" part="a_verb"/>
                      <clip pos="1" side="tl" part="temps"/>
                    </lu>
                  </chunk>
                </out>
        </otherwise>
        </choose>
        <let>
          <var n="caseFirstWord"/>
          <lit v="aa"/>
        </let>
      </action>
    </rule>


<rule comment="VERBdeure + INF (deure + inf EO)">
      <pattern>
	<pattern-item n="deure"/>
	<pattern-item n="inf"/>
      </pattern>
      <action>    	
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
        <call-macro n="tipus_verbs">
          <with-param pos="2"/>
        </call-macro>

	<choose>
              <when>  <!-- traduccions a present -->
                <test>
                  <or>
                    <equal>
                      <clip pos="1" side="sl" part="temps"/>
                      <lit-tag v="pri"/><!--present indicatiu dic -->
                    </equal>
                    <equal>
                      <clip pos="1" side="sl" part="temps"/>
                      <lit-tag v="prs"/><!--present subjunctiu digui -->
                    </equal>
                  </or>
                </test>
                <let>
                  <clip pos="1" side="tl" part="temps"/>
                  <lit-tag v="pres"/> <!-- present -->
                </let>
              </when>
              <when>           <!-- traduccions a passat -->
                <test>
                  <or>
                    <equal>
                      <clip pos="1" side="sl" part="temps"/>
                      <lit-tag v="ifi"/><!--digué -->
                    </equal>
                    <equal>
                      <clip pos="1" side="sl" part="temps"/>
                      <lit-tag v="pii"/><!--deia -->
                    </equal>
                    <equal>
                      <clip pos="1" side="sl" part="temps"/>
                      <lit-tag v="pis"/><!--digués -->
                    </equal>
                  </or>
                </test>
                <let>
                  <clip pos="1" side="tl" part="temps"/>
                  <lit-tag v="past"/>
                </let>
              </when>

              <when>           <!-- traduccions a futur -->
                <test>
                    <equal>
                      <clip pos="1" side="sl" part="temps"/>
                      <lit-tag v="fti"/><!--digué -->
                    </equal>
                </test>
                <let>
                  <clip pos="1" side="tl" part="temps"/>
                  <lit-tag v="fti"/>
                </let>
              </when>
              <when>           <!-- traduccions a condicional -->
                <test>
                    <equal>
                      <clip pos="1" side="sl" part="temps"/>
                      <lit-tag v="cni"/><!-- -->
                    </equal>
                </test>
                <let>
                  <clip pos="1" side="tl" part="temps"/>
                  <lit-tag v="cni"/>
                </let>
              </when>
              <when>           <!-- traduccions a gerundi -->
                <test>
                    <equal>
                      <clip pos="1" side="sl" part="temps"/>
                      <lit-tag v="ger"/><!-- -->
                    </equal>
                </test>
                <let>
                  <clip pos="1" side="tl" part="temps"/>
                  <lit-tag v="ger"/>
                </let>
              </when>
            </choose>
                <let>
                  <clip pos="2" side="tl" part="temps"/>
                  <lit-tag v="pp2"/>
                </let>
                <out>
		 <chunk name="adv" case="caseFirstWord">
                    <tags>
                      <tag><lit-tag v="ADV"/></tag>
                    </tags>
		    <lu>
                      <lit v="eble"/>
                      <lit-tag v="adv"/>
                    </lu>
		</chunk>
		<b/>


                  <chunk name="verb_perif" case="caseFirstWord">
                    <tags>
                      <tag><lit-tag v="SV"/></tag>
                      <tag><clip pos="2" side="tl" part="a_verb"/></tag>
                      <tag><clip pos="1" side="sl" part="temps"/></tag>
                      <tag><clip pos="1" side="tl" part="pers"/></tag>
                      <tag><clip pos="1" side="tl" part="nbr"/></tag>
		      <tag><var n="tipus_verb"/></tag>
                    </tags>
                    <lu>
                      <clip pos="2" side="tl" part="lemh"/>
                      <clip pos="2" side="tl" part="a_verb"/>
                      <clip pos="1" side="tl" part="temps"/>
                    </lu>
                  </chunk>
                </out>
        <let>
          <var n="caseFirstWord"/>
          <lit v="aa"/>
        </let>
      </action>
    </rule>


<rule comment="ANAR + A + INF (anem a llegir; es tradueix a futur EO)">
      <pattern>
	<pattern-item n="anar_a"/>
	<pattern-item n="a"/>
	<pattern-item n="inf"/>
      </pattern>
      <action>    	
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
        <call-macro n="tipus_verbs">
          <with-param pos="3"/>
        </call-macro>

        <let>
          <clip pos="3" side="tl" part="temps"/>
          <lit-tag v="fti"/>
        </let>
                <out>

	  <chunk name="adv" case="caseFirstWord">
                    <tags>
                      <tag><lit-tag v="ADV"/></tag>
                    </tags>
		    <lu>
                      <lit v="tuj"/>
                      <lit-tag v="adv"/>
                    </lu>
	  </chunk>
	  <b/>
	  <chunk name="verbcj" case="caseFirstWord">
                    <tags>
                      <tag><lit-tag v="SV"/></tag>
                      <tag><clip pos="3" side="tl" part="a_verb"/></tag>
                      <tag><clip pos="3" side="tl" part="temps"/></tag>
                      <tag><clip pos="1" side="tl" part="pers"/></tag>
                      <tag><clip pos="1" side="tl" part="nbr"/></tag>
		      <tag><var n="tipus_verb"/></tag>
                    </tags>
                    <lu>
                      <clip pos="3" side="tl" part="lemh"/>
                      <clip pos="3" side="tl" part="a_verb"/>
                      <clip pos="3" side="tl" part="temps"/>
                    </lu>
                  </chunk>
                </out>
        <let>
          <var n="caseFirstWord"/>
          <lit v="aa"/>
        </let>
      </action>
    </rule>


<rule comment="VERB + ADJ + INF (el ADJ passa a ADV: sempre és interessant llegir -> ĉiam estas interese legi EO)">
      <pattern>
	<pattern-item n="verbcj2"/>
	<pattern-item n="adjADJ"/>
	<pattern-item n="inf"/>
      </pattern>
      <action>    	
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
        <call-macro n="tipus_verbs">
          <with-param pos="3"/>
        </call-macro>
        <choose>
              <when>  <!-- traduccions a present -->
                <test>
                  <or>
                    <equal>
                      <clip pos="1" side="sl" part="temps"/>
                      <lit-tag v="pri"/><!--present indicatiu dic -->
                    </equal>
                    <equal>
                      <clip pos="1" side="sl" part="temps"/>
                      <lit-tag v="prs"/><!--present subjunctiu digui -->
                    </equal>
                  </or>
                </test>
                <let>
                  <clip pos="1" side="tl" part="temps"/>
                  <lit-tag v="pres"/> <!-- present -->
                </let>
              </when>
              <when>           <!-- traduccions a passat -->
                <test>
                  <or>
                    <equal>
                      <clip pos="1" side="sl" part="temps"/>
                      <lit-tag v="ifi"/><!--digué -->
                    </equal>
                    <equal>
                      <clip pos="1" side="sl" part="temps"/>
                      <lit-tag v="pii"/><!--deia -->
                    </equal>
                    <equal>
                      <clip pos="1" side="sl" part="temps"/>
                      <lit-tag v="pis"/><!--digués -->
                    </equal>
                  </or>
                </test>
                <let>
                  <clip pos="1" side="tl" part="temps"/>
                  <lit-tag v="past"/>
                </let>
              </when>

              <when>           <!-- traduccions a futur -->
                <test>
                    <equal>
                      <clip pos="1" side="sl" part="temps"/>
                      <lit-tag v="fti"/><!--digué -->
                    </equal>
                </test>
                <let>
                  <clip pos="1" side="tl" part="temps"/>
                  <lit-tag v="fti"/>
                </let>
              </when>

              <when>           <!-- traduccions a condicional -->
                <test>
                    <equal>
                      <clip pos="1" side="sl" part="temps"/>
                      <lit-tag v="cni"/><!-- -->
                    </equal>
                </test>
                <let>
                  <clip pos="1" side="tl" part="temps"/>
                  <lit-tag v="cni"/>
                </let>
              </when>

              <when>           <!-- traduccions a gerundi -->
                <test>
                    <equal>
                      <clip pos="1" side="sl" part="temps"/>
                      <lit-tag v="ger"/><!-- -->
                    </equal>
                </test>
                <let>
                  <clip pos="1" side="tl" part="temps"/>
                  <lit-tag v="ger"/>
                </let>
              </when>
            </choose>
                <out>
                  <chunk name="verbcj_adj_inf" case="caseFirstWord">
                    <tags>
                      <tag><lit-tag v="SV"/></tag>
                      <tag><clip pos="1" side="tl" part="a_verb"/></tag>
                      <tag><clip pos="1" side="sl" part="temps"/></tag>
                      <tag><clip pos="1" side="tl" part="pers"/></tag>
                      <tag><clip pos="1" side="tl" part="nbr"/></tag>
                      <tag><var n="tipus_verb"/></tag>
                    </tags>
                    <lu>
                      <clip pos="1" side="tl" part="lemh"/>
                      <clip pos="1" side="tl" part="a_verb"/>
                      <clip pos="1" side="tl" part="sep"/>
                      <clip pos="1" side="tl" part="temps"/>
                      <clip pos="1" side="tl" part="lemq"/>
                    </lu>
                  </chunk>
	        <b pos="1"/>
                <chunk name="adv" case="caseFirstWord">
                        <tags>
                        <tag><lit-tag v="adv"/></tag>
                        </tags>
                        <lu>
                        <clip pos="2" side="tl" part="lem"/>
                        <lit-tag v="adv"/>
                        </lu>
		</chunk>

                <b pos="2"/>

	    <chunk name="inf" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SV"/></tag>
	      <tag><clip pos="3" side="tl" part="a_verb"/></tag>
	      <tag><clip pos="3" side="tl" part="temps"/></tag>
	    </tags>
                <lu>
                  <clip pos="3" side="tl" part="lemh"/>
                  <clip pos="3" side="tl" part="a_verb"/>
                  <clip pos="3" side="tl" part="sep"/>
                  <clip pos="3" side="tl" part="temps"/>
                  <clip pos="3" side="tl" part="lemq"/>
                </lu>
	    </chunk>
                </out>
        <let>
          <var n="caseFirstWord"/>
          <lit v="aa"/>
        </let>
      </action>
    </rule>

<rule comment="VERB + ADV + ADJ + INF (el ADJ passa a ADV: sempre és interessant llegir -> ĉiam estas interese legi EO)">
      <pattern>
	<pattern-item n="verbcj2"/>
	<pattern-item n="adv_preadv"/>
	<pattern-item n="adjADJ"/>
	<pattern-item n="inf"/>
      </pattern>
      <action>    	
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
        <call-macro n="tipus_verbs">
          <with-param pos="4"/>
        </call-macro>
        <choose>
              <when>  <!-- traduccions a present -->
                <test>
                  <or>
                    <equal>
                      <clip pos="1" side="sl" part="temps"/>
                      <lit-tag v="pri"/><!--present indicatiu dic -->
                    </equal>
                    <equal>
                      <clip pos="1" side="sl" part="temps"/>
                      <lit-tag v="prs"/><!--present subjunctiu digui -->
                    </equal>
                  </or>
                </test>
                <let>
                  <clip pos="1" side="tl" part="temps"/>
                  <lit-tag v="pres"/> <!-- present -->
                </let>
              </when>
              <when>           <!-- traduccions a passat -->
                <test>
                  <or>
                    <equal>
                      <clip pos="1" side="sl" part="temps"/>
                      <lit-tag v="ifi"/><!--digué -->
                    </equal>
                    <equal>
                      <clip pos="1" side="sl" part="temps"/>
                      <lit-tag v="pii"/><!--deia -->
                    </equal>
                    <equal>
                      <clip pos="1" side="sl" part="temps"/>
                      <lit-tag v="pis"/><!--digués -->
                    </equal>
                  </or>
                </test>
                <let>
                  <clip pos="1" side="tl" part="temps"/>
                  <lit-tag v="past"/>
                </let>
              </when>

              <when>           <!-- traduccions a futur -->
                <test>
                    <equal>
                      <clip pos="1" side="sl" part="temps"/>
                      <lit-tag v="fti"/><!--digué -->
                    </equal>
                </test>
                <let>
                  <clip pos="1" side="tl" part="temps"/>
                  <lit-tag v="fti"/>
                </let>
              </when>

              <when>           <!-- traduccions a condicional -->
                <test>
                    <equal>
                      <clip pos="1" side="sl" part="temps"/>
                      <lit-tag v="cni"/><!-- -->
                    </equal>
                </test>
                <let>
                  <clip pos="1" side="tl" part="temps"/>
                  <lit-tag v="cni"/>
                </let>
              </when>

              <when>           <!-- traduccions a gerundi -->
                <test>
                    <equal>
                      <clip pos="1" side="sl" part="temps"/>
                      <lit-tag v="ger"/><!-- -->
                    </equal>
                </test>
                <let>
                  <clip pos="1" side="tl" part="temps"/>
                  <lit-tag v="ger"/>
                </let>
              </when>
            </choose>
                <out>
                  <chunk name="verbcj_adj_inf" case="caseFirstWord">
                    <tags>
                      <tag><lit-tag v="SV"/></tag>
                      <tag><clip pos="1" side="tl" part="a_verb"/></tag>
                      <tag><clip pos="1" side="sl" part="temps"/></tag>
                      <tag><clip pos="1" side="tl" part="pers"/></tag>
                      <tag><clip pos="1" side="tl" part="nbr"/></tag>
                      <tag><var n="tipus_verb"/></tag>
                    </tags>
                    <lu>
                      <clip pos="1" side="tl" part="lemh"/>
                      <clip pos="1" side="tl" part="a_verb"/>
                      <clip pos="1" side="tl" part="sep"/>
                      <clip pos="1" side="tl" part="temps"/>
                      <clip pos="1" side="tl" part="lemq"/>
                    </lu>
                  </chunk>
	        <b pos="1"/>


                <chunk name="adv" case="caseFirstWord">
                        <tags>
                        <tag><lit-tag v="adv"/></tag>
                        </tags>
	    		<lu>
	      		<clip pos="2" side="tl" part="lem"/>
	      		<clip pos="2" side="tl" part="a_adv"/>
	    		</lu>
	    		<b/>
                        <lu>
                        <clip pos="3" side="tl" part="lem"/>
                        <lit-tag v="adv"/>
                        </lu>
		</chunk>

                <b pos="2"/>

	    <chunk name="inf" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SV"/></tag>
	      <tag><clip pos="4" side="tl" part="a_verb"/></tag>
	      <tag><clip pos="4" side="tl" part="temps"/></tag>
	    </tags>
                <lu>
                  <clip pos="4" side="tl" part="lemh"/>
                  <clip pos="4" side="tl" part="a_verb"/>
                  <clip pos="4" side="tl" part="sep"/>
                  <clip pos="4" side="tl" part="temps"/>
                  <clip pos="4" side="tl" part="lemq"/>
                </lu>
	    </chunk>
                </out>
        <let>
          <var n="caseFirstWord"/>
          <lit v="aa"/>
        </let>
      </action>
    </rule>


    <rule comment="REGLA: ADV ADJECTIU ('molt/poc/gens/bastant/força/increïblement gran - ') (EO)">
      <pattern>
	<pattern-item n="adv_preadv"/>
	<pattern-item n="adj"/>
      </pattern>
      <action>          	
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="nom_cas">
	  <with-param pos="1"/>
	</call-macro>	
	    <out>
	      <chunk name="adv_adj" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="SA"/></tag>
		  <tag><clip pos="2" side="sl" part="gen"/></tag>
		  <tag><clip pos="2" side="sl" part="nbr"/></tag>
	          <tag><var n="case"/></tag>
		</tags>
		<lu>   
		  <clip pos="1" side="tl" part="whole"/> 
		</lu> 
		<b pos="1"/>
		<lu>   
		  <clip pos="2" side="tl" part="lem"/> 
		  <clip pos="2" side="tl" part="a_adj"/>
	          <clip pos="2" side="sl" part="nbr"/>
	          <lit-tag v="4"/>
		</lu>
	      </chunk>
	    </out>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule> 

    <rule comment="VERB conjugat ( pinto ) (EO)">
      <pattern>
	<pattern-item n="verbcj"/>
      </pattern>
      <action>    	
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
        <call-macro n="tipus_verbs">
          <with-param pos="1"/>
        </call-macro>

	<choose>
              <when>  <!-- traduccions a present -->
                <test>
                  <or>
                    <equal>
                      <clip pos="1" side="sl" part="temps"/>
                      <lit-tag v="pri"/><!--present indicatiu dic -->
                    </equal>
                    <equal>
                      <clip pos="1" side="sl" part="temps"/>
                      <lit-tag v="prs"/><!--present subjunctiu digui -->
                    </equal>
                  </or>
                </test>
                <let>
                  <clip pos="1" side="tl" part="temps"/>
                  <lit-tag v="pres"/> <!-- present -->
                </let>
              </when>
              <when>           <!-- traduccions a passat -->
                <test>
                  <or>
                    <equal>
                      <clip pos="1" side="sl" part="temps"/>
                      <lit-tag v="ifi"/><!--digué -->
                    </equal>
                    <equal>
                      <clip pos="1" side="sl" part="temps"/>
                      <lit-tag v="pii"/><!--deia -->
                    </equal>
                    <equal>
                      <clip pos="1" side="sl" part="temps"/>
                      <lit-tag v="pis"/><!--digués -->
                    </equal>
                  </or>
                </test>
                <let>
                  <clip pos="1" side="tl" part="temps"/>
                  <lit-tag v="past"/>
                </let>
              </when>

              <when>           <!-- traduccions a futur -->
                <test>
                    <equal>
                      <clip pos="1" side="sl" part="temps"/>
                      <lit-tag v="fti"/><!--digué -->
                    </equal>
                </test>
                <let>
                  <clip pos="1" side="tl" part="temps"/>
                  <lit-tag v="fti"/>
                </let>
              </when>
              <when>           <!-- traduccions a condicional -->
                <test>
                    <equal>
                      <clip pos="1" side="sl" part="temps"/>
                      <lit-tag v="cni"/><!-- -->
                    </equal>
                </test>
                <let>
                  <clip pos="1" side="tl" part="temps"/>
                  <lit-tag v="cni"/>
                </let>
              </when>
              <when>           <!-- traduccions a gerundi -->
                <test>
                    <equal>
                      <clip pos="1" side="sl" part="temps"/>
                      <lit-tag v="ger"/><!-- -->
                    </equal>
                </test>
                <let>
                  <clip pos="1" side="tl" part="temps"/>
                  <lit-tag v="ger"/>
                </let>
              </when>
            </choose>
                <out>
                  <chunk name="verbcj" case="caseFirstWord">
                    <tags>
                      <tag><lit-tag v="SV"/></tag>
                      <tag><clip pos="1" side="tl" part="a_verb"/></tag>
                      <tag><clip pos="1" side="sl" part="temps"/></tag>
                      <tag><clip pos="1" side="tl" part="pers"/></tag>
                      <tag><clip pos="1" side="tl" part="nbr"/></tag>
                      <tag><var n="tipus_verb"/></tag>
                      <tag><var n="tipus_verb2"/></tag>

                    </tags>
                    <lu>
                      <clip pos="1" side="tl" part="lemh"/>
                      <clip pos="1" side="tl" part="a_verb"/>
                      <clip pos="1" side="tl" part="sep"/>
                      <clip pos="1" side="tl" part="temps"/>
                      <clip pos="1" side="tl" part="lemq"/>
                    </lu>
                  </chunk>
                </out>
        <let>
          <var n="caseFirstWord"/>
          <lit v="aa"/>
        </let>
      </action>
    </rule>


    <rule comment="ANAR + INF (vaig venir) EO">
      <pattern>
        <pattern-item n="anar"/>
        <pattern-item n="inf"/>
      </pattern>
      <action>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="tipus_verbs">
          <with-param pos="2"/>
        </call-macro>

        <let>
          <clip pos="2" side="tl" part="temps"/>
          <lit-tag v="past"/>
        </let>
            <out>
              <chunk name="verbcj" case="caseFirstWord">
                <tags>
                  <tag><lit-tag v="SV"/></tag>
                  <tag><clip pos="2" side="tl" part="a_verb"/></tag>
                  <tag><clip pos="2" side="tl" part="temps"/></tag>
                  <tag><clip pos="1" side="tl" part="pers"/></tag>
                  <tag><clip pos="1" side="tl" part="nbr"/></tag>
		  <tag><var n="tipus_verb"/></tag>
                </tags>
                <lu>
                  <clip pos="2" side="tl" part="lemh"/>
                  <clip pos="2" side="tl" part="a_verb"/>
                  <clip pos="2" side="tl" part="sep"/>
                  <clip pos="2" side="tl" part="temps"/>
                  <clip pos="2" side="tl" part="lemq"/>
                </lu>
              </chunk>
            </out>
        <call-macro n="f_bcond">
          <with-param pos="1"/>
        </call-macro>
        <let>
          <var n="caseFirstWord"/>
          <lit v="aa"/>
        </let>
      </action>
    </rule>

    <rule comment="VERB conjugat + INF (volia cantar; EO)">
      <pattern>
	<pattern-item n="verbcj"/>
	<pattern-item n="inf"/>
      </pattern>
      <action>    	
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
        <call-macro n="tipus_verbs">
          <with-param pos="1"/>
        </call-macro>
        <!--<call-macro n="tipus_verbs">
          <with-param pos="2"/>
        </call-macro>-->

	<choose>
              <when>  <!-- traduccions a present -->
                <test>
                  <or>
                    <equal>
                      <clip pos="1" side="sl" part="temps"/>
                      <lit-tag v="pri"/><!--present indicatiu dic -->
                    </equal>
                    <equal>
                      <clip pos="1" side="sl" part="temps"/>
                      <lit-tag v="prs"/><!--present subjunctiu digui -->
                    </equal>
                  </or>
                </test>
                <let>
                  <clip pos="1" side="tl" part="temps"/>
                  <lit-tag v="pres"/> <!-- present -->
                </let>
              </when>
              <when>           <!-- traduccions a passat -->
                <test>
                  <or>
                    <equal>
                      <clip pos="1" side="sl" part="temps"/>
                      <lit-tag v="ifi"/><!--digué -->
                    </equal>
                    <equal>
                      <clip pos="1" side="sl" part="temps"/>
                      <lit-tag v="pii"/><!--deia -->
                    </equal>
                    <equal>
                      <clip pos="1" side="sl" part="temps"/>
                      <lit-tag v="pis"/><!--digués -->
                    </equal>
                  </or>
                </test>
                <let>
                  <clip pos="1" side="tl" part="temps"/>
                  <lit-tag v="past"/>
                </let>
              </when>

              <when>           <!-- traduccions a futur -->
                <test>
                    <equal>
                      <clip pos="1" side="sl" part="temps"/>
                      <lit-tag v="fti"/><!--digué -->
                    </equal>
                </test>
                <let>
                  <clip pos="1" side="tl" part="temps"/>
                  <lit-tag v="fti"/>
                </let>
              </when>
              <when>           <!-- traduccions a condicional -->
                <test>
                    <equal>
                      <clip pos="1" side="sl" part="temps"/>
                      <lit-tag v="cni"/><!-- -->
                    </equal>
                </test>
                <let>
                  <clip pos="1" side="tl" part="temps"/>
                  <lit-tag v="cni"/>
                </let>
              </when>
              <when>           <!-- traduccions a gerundi -->
                <test>
                    <equal>
                      <clip pos="1" side="sl" part="temps"/>
                      <lit-tag v="ger"/><!-- -->
                    </equal>
                </test>
                <let>
                  <clip pos="1" side="tl" part="temps"/>
                  <lit-tag v="ger"/>
                </let>
              </when>
            </choose>
	<out>
                  <chunk name="verbcj_perifxx" case="caseFirstWord">
                    <tags>
                      <tag><lit-tag v="SV"/></tag>
                      <tag><clip pos="1" side="tl" part="a_verb"/></tag>
                      <tag><clip pos="1" side="sl" part="temps"/></tag>
                      <tag><clip pos="1" side="tl" part="pers"/></tag>
                      <tag><clip pos="1" side="tl" part="nbr"/></tag>
		      <tag><var n="tipus_verb"/></tag>
		      <!--<tag><var n="tipus_verb2"/></tag>-->

                    </tags>
                    <lu>
                      <clip pos="1" side="tl" part="lemh"/>
                      <clip pos="1" side="tl" part="a_verb"/>
                      <clip pos="1" side="tl" part="sep"/>
                      <clip pos="1" side="tl" part="temps"/>
                      <clip pos="1" side="tl" part="lemq"/>
                    </lu>
	    <b pos="1"/>
                    <lu>
                      <clip pos="2" side="tl" part="lemh"/>
                      <clip pos="2" side="tl" part="a_verb"/>
                      <clip pos="2" side="tl" part="sep"/>
                      <clip pos="2" side="tl" part="temps"/>
                      <clip pos="2" side="tl" part="lemq"/>
                    </lu>
                  </chunk>
                </out>
        <let>
          <var n="caseFirstWord"/>
          <lit v="aa"/>
        </let>
      </action>
    </rule>



    <rule comment="ANAR + INF + INF (vaig voler/estar a punt de venir) EO">
      <pattern>
	<pattern-item n="anar"/> 
	<pattern-item n="inf"/> 
	<pattern-item n="inf"/> 
      </pattern>
      <action>       	
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>   
        <call-macro n="tipus_verbs">
          <with-param pos="2"/>
        </call-macro>
	<let>
	  <clip pos="2" side="tl" part="temps"/>		     
	  <lit-tag v="past"/>
	</let>

	    <out>
	      <chunk name="verbcj_perif" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="SV"/></tag>
		  <tag><clip pos="2" side="tl" part="a_verb"/></tag>
		  <tag><clip pos="2" side="tl" part="temps"/></tag>
		  <tag><clip pos="1" side="tl" part="pers"/></tag>
		  <tag><clip pos="1" side="tl" part="nbr"/></tag>
		  <tag><var n="tipus_verb"/></tag>

		</tags>
		<lu>          
		  <clip pos="2" side="tl" part="lemh"/>
		  <clip pos="2" side="tl" part="a_verb"/>
		  <clip pos="2" side="tl" part="sep"/>
		  <clip pos="2" side="tl" part="temps"/>
		  <clip pos="2" side="tl" part="lemq"/>                  
		</lu> 
		<b pos="1"/>
		<lu>
		  <clip pos="3" side="tl" part="lemh"/> 
		  <clip pos="3" side="tl" part="a_verb"/>
		  <clip pos="3" side="tl" part="temps"/>
		  <clip pos="3" side="tl" part="pers"/>
		  <clip pos="3" side="tl" part="nbr"/>
		  <clip pos="3" side="tl" part="lemq"/> 
		</lu>
	      </chunk>
	    </out>  
	<call-macro n="f_bcond">
	  <with-param pos="1"/>
	</call-macro>  
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>

    <rule comment="ANAR + INF +enc + INF (vaig voler-los comprar) EO">
      <pattern>
	<pattern-item n="anar"/> 
	<pattern-item n="inf"/> 
	<pattern-item n="enc"/> 
	<pattern-item n="inf"/> 
      </pattern>
      <action>       	
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>   
        <call-macro n="tipus_verbs">
          <with-param pos="2"/>
        </call-macro>

	<let>
	  <clip pos="2" side="tl" part="temps"/>		     
	  <lit-tag v="past"/>
	</let>
	    <choose><!--mirem els proclítics -->
	      <when>
		<test>
		  <or>
		    <equal>
		      <clip pos="2" side="sl" part="pron"/>
		      <lit-tag v="pron"/>
		    </equal>
		    <equal>
		      <clip pos="1" side="sl" part="pers"/>
		      <clip pos="3" side="sl" part="pers"/>
		    </equal>
		    <and>
		      <equal>
			<clip pos="1" side="sl" part="nbr"/>
			<clip pos="3" side="sl" part="nbr"/>
		      </equal>
		      <equal>
			<clip pos="3" side="sl" part="lem"/>
			<lit v="es"/><!--és 'sp' -->
		      </equal>
		    </and>
		  </or>
		</test>	
		<call-macro n="f_bcond"><!--imprimeix el blanc si té info de format, el pronom no l'imprimeixis -->
		  <with-param pos="3"/>
		</call-macro>
	      </when>
	      <otherwise>
		
		<out>
		  <chunk name="pro" case="caseFirstWord">
		    <tags>
		      <tag><lit-tag v="SN"/></tag>
		      <tag><clip pos="3" side="tl" part="tipus_prn"/></tag>
		      <tag><clip pos="3" side="sl" part="pers"/></tag>
		      <tag><clip pos="3" side="tl" part="gen"/></tag>
		      <tag><clip pos="3" side="tl" part="nbr"/></tag>
		      <tag><var n="tipus_verb"/></tag>

		    </tags>
		    <lu>
		      <clip pos="3" side="tl" part="whole"/>
		    </lu>
		  </chunk>
		</out>
	      </otherwise>
	    </choose>  


		<out>
		   <b pos="1"/>
		  <chunk name="verbcj_perif" case="caseFirstWord">
		    <tags>
		      <tag><lit-tag v="SV"/></tag>
		      <tag><clip pos="2" side="tl" part="a_verb"/></tag>
		      <tag><clip pos="2" side="tl" part="temps"/></tag>
		      <tag><clip pos="1" side="tl" part="pers"/></tag>
		      <tag><clip pos="1" side="tl" part="nbr"/></tag>
		    </tags>
		    <lu>          
		      <clip pos="2" side="tl" part="lemh"/>
		      <clip pos="2" side="tl" part="a_verb"/>
		      <clip pos="2" side="tl" part="sep"/>
		      <clip pos="2" side="tl" part="temps"/>
		      <clip pos="2" side="tl" part="lemq"/>                  
		    </lu> 
		   <b pos="2"/>
		    <lu>          
		      <clip pos="4" side="tl" part="lemh"/>
		      <clip pos="4" side="tl" part="a_verb"/>
		      <clip pos="4" side="tl" part="sep"/>
		      <clip pos="4" side="tl" part="temps"/>
		      <clip pos="4" side="tl" part="lemq"/>                  
		    </lu> 
		  </chunk>
		</out>  
	    <call-macro n="f_bcond">
	      <with-param pos="1"/>
	    </call-macro>  
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>
	 
    

    <rule comment="HAVER + PP (ell ha llegit aquell llibre - Li legis tiun libron; es tradueix per passat) (EO)">
      <pattern>
	<pattern-item n="haver"/>
	<pattern-item n="pp"/> 
      </pattern>
      <action>
        <call-macro n="tipus_verbs">
          <with-param pos="2"/>
        </call-macro>

        <choose>
              <when>  <!-- traduccions des de present -> passat (1)-->
                <test>
                  <or>
                    <equal>
                      <clip pos="1" side="sl" part="temps"/>
                      <lit-tag v="pri"/><!--present indicatiu dic -->
                    </equal>
                    <equal>
                      <clip pos="1" side="sl" part="temps"/>
                      <lit-tag v="prs"/><!--present subjunctiu digui -->
                    </equal>
                  </or>
                </test>
                <let>
                  <clip pos="2" side="tl" part="temps"/>
                  <lit-tag v="past"/> <!-- present -->
                </let>
                <out>
                  <chunk name="verbcj" case="caseFirstWord">
                    <tags>
                      <tag><lit-tag v="SV"/></tag>
                      <tag><clip pos="2" side="tl" part="a_verb"/></tag>
                      <tag><clip pos="1" side="tl" part="temps"/></tag>
                      <tag><clip pos="1" side="tl" part="pers"/></tag>
                      <tag><clip pos="1" side="tl" part="nbr"/></tag>
                      <tag><var n="tipus_verb"/></tag>
                    </tags>
                    <lu>
                      <clip pos="2" side="tl" part="lemh"/>
                      <clip pos="2" side="tl" part="a_verb"/>
                      <clip pos="2" side="tl" part="temps"/>
                      <clip pos="2" side="tl" part="lemq"/>
                    </lu>
                  </chunk>
                </out>
          </when>
	    <otherwise>
	    <choose>
              <when>      <!-- traduccions des de passat -> ESTIS + PP (2)-->
                <test>
                  <or>
                    <equal>
                      <clip pos="1" side="sl" part="temps"/>
                      <lit-tag v="ifi"/><!--digué -->
                    </equal>
                    <equal>
                      <clip pos="1" side="sl" part="temps"/>
                      <lit-tag v="pii"/><!--deia -->
                    </equal>
                    <equal>
                      <clip pos="1" side="sl" part="temps"/>
                      <lit-tag v="pis"/><!--digués -->
                    </equal>
                  </or>
                </test>
                <let>
                  <clip pos="1" side="tl" part="temps"/>
                  <lit-tag v="past"/>
                </let>
                <let>
                  <clip pos="2" side="tl" part="temps"/>
                  <lit-tag v="pp3"/>
                </let>
              </when>
              <when>      <!-- traduccions des de futur -> ESTIS + PP (3)-->
                <test>
                    <equal>
                      <clip pos="1" side="sl" part="temps"/>
                      <lit-tag v="fti"/><!--digué -->
                    </equal>
                </test>
                <let>
                  <clip pos="1" side="tl" part="temps"/>
                  <lit-tag v="fti"/>
                </let>
                <let>
                  <clip pos="2" side="tl" part="temps"/>
                  <lit-tag v="pp3"/>
                </let>
              </when>
              <when>      <!-- traduccions des de condicional -> ESTIS + PP (3)-->
                <test>
                    <equal>
                      <clip pos="1" side="sl" part="temps"/>
                      <lit-tag v="cni"/><!--digué -->
                    </equal>
                </test>
                <let>
                  <clip pos="1" side="tl" part="temps"/>
                  <lit-tag v="cni"/>
                </let>
                <let>
                  <clip pos="2" side="tl" part="temps"/>
                  <lit-tag v="pp3"/>
                </let>
              </when>

              <when>      <!-- traduccions des de infinitiu -> ESTIS + PP (3)-->
                <test>
		  <or>
                    <equal>
                      <clip pos="1" side="sl" part="temps"/>
                      <lit-tag v="inf"/><!--digué -->
                    </equal>
                    <equal>
                      <clip pos="1" side="sl" part="temps"/>
                      <lit-tag v="ger"/><!--digué -->
                    </equal>
		</or>
                </test>
                <let>
                  <clip pos="1" side="tl" part="temps"/>
                  <lit-tag v="inf"/>
                </let>
                <let>
                  <clip pos="1" side="tl" part="nbr"/>
                  <lit-tag v="sg"/>
                </let>
                <let>
                  <clip pos="2" side="tl" part="temps"/>
                  <lit-tag v="pp3"/>
                </let>
              </when>
	     </choose>

                <out>
                  <chunk name="verbcj_perif" case="caseFirstWord">
                    <tags>
                      <tag><lit-tag v="SV"/></tag>
                      <tag><clip pos="2" side="tl" part="a_verb"/></tag>
                      <tag><clip pos="1" side="tl" part="temps"/></tag>
                      <tag><clip pos="1" side="tl" part="pers"/></tag>
                      <tag><clip pos="1" side="tl" part="nbr"/></tag>
                      <tag><var n="tipus_verb"/></tag>
                    </tags>
                    <lu>
		      <lit v="esti"/>
                      <clip pos="1" side="tl" part="a_verb"/>
                      <clip pos="1" side="tl" part="temps"/>
                    </lu>
		    <b/>
                    <lu>
                      <clip pos="2" side="tl" part="lemh"/>
                      <clip pos="2" side="tl" part="a_verb"/>
                      <clip pos="2" side="tl" part="temps"/>
                      <clip pos="1" side="tl" part="nbr"/>
                    </lu>
                  </chunk>
                </out>
            </otherwise>
	</choose>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>    
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>


    <rule comment="HAVER + PP + QUE (ell ha llegit aquell llibre - Li legis tiun libron;  precorregir el KE) (EO)">
      <pattern>
	<pattern-item n="haver"/>
	<pattern-item n="pp"/> 
	<pattern-item n="cnjcoopercorregir"/>
      </pattern>
      <action>
        <call-macro n="tipus_verbs">
          <with-param pos="2"/>
        </call-macro>

        <choose>
              <when>  <!-- traduccions des de present -> passat (1)-->
                <test>
                  <or>
                    <equal>
                      <clip pos="1" side="sl" part="temps"/>
                      <lit-tag v="pri"/><!--present indicatiu dic -->
                    </equal>
                    <equal>
                      <clip pos="1" side="sl" part="temps"/>
                      <lit-tag v="prs"/><!--present subjunctiu digui -->
                    </equal>
                  </or>
                </test>
                <let>
                  <clip pos="2" side="tl" part="temps"/>
                  <lit-tag v="past"/> <!-- present -->
                </let>
                <out>
                  <chunk name="verbcj" case="caseFirstWord">
                    <tags>
                      <tag><lit-tag v="SV"/></tag>
                      <tag><clip pos="2" side="tl" part="a_verb"/></tag>
                      <tag><clip pos="1" side="tl" part="temps"/></tag>
                      <tag><clip pos="1" side="tl" part="pers"/></tag>
                      <tag><clip pos="1" side="tl" part="nbr"/></tag>
                      <tag><var n="tipus_verb"/></tag>
                    </tags>
                    <lu>
                      <clip pos="2" side="tl" part="lemh"/>
                      <clip pos="2" side="tl" part="a_verb"/>
                      <clip pos="2" side="tl" part="temps"/>
                      <clip pos="2" side="tl" part="lemq"/>
                    </lu>
                  </chunk>
                <b pos="1"/>
                 <chunk name="cnjsub" case="caseFirstWord">
                        <tags>
                        <tag><lit-tag v="cnjsub"/></tag>
                        </tags>
                        <lu>
                        <lit v="ke"/>
                        <lit-tag v="cnjsub"/>
                        </lu>
                        </chunk>

                </out>
          </when>
	    <otherwise>
	    <choose>
              <when>      <!-- traduccions des de passat -> ESTIS + PP (2)-->
                <test>
                  <or>
                    <equal>
                      <clip pos="1" side="sl" part="temps"/>
                      <lit-tag v="ifi"/><!--digué -->
                    </equal>
                    <equal>
                      <clip pos="1" side="sl" part="temps"/>
                      <lit-tag v="pii"/><!--deia -->
                    </equal>
                    <equal>
                      <clip pos="1" side="sl" part="temps"/>
                      <lit-tag v="pis"/><!--digués -->
                    </equal>
                  </or>
                </test>
                <let>
                  <clip pos="1" side="tl" part="temps"/>
                  <lit-tag v="past"/>
                </let>
                <let>
                  <clip pos="2" side="tl" part="temps"/>
                  <lit-tag v="pp3"/>
                </let>
              </when>
              <when>      <!-- traduccions des de futur -> ESTIS + PP (3)-->
                <test>
                    <equal>
                      <clip pos="1" side="sl" part="temps"/>
                      <lit-tag v="fti"/><!--digué -->
                    </equal>
                </test>
                <let>
                  <clip pos="1" side="tl" part="temps"/>
                  <lit-tag v="fti"/>
                </let>
                <let>
                  <clip pos="2" side="tl" part="temps"/>
                  <lit-tag v="pp3"/>
                </let>
              </when>
              <when>      <!-- traduccions des de condicional -> ESTIS + PP (3)-->
                <test>
                    <equal>
                      <clip pos="1" side="sl" part="temps"/>
                      <lit-tag v="cni"/><!--digué -->
                    </equal>
                </test>
                <let>
                  <clip pos="1" side="tl" part="temps"/>
                  <lit-tag v="cni"/>
                </let>
                <let>
                  <clip pos="2" side="tl" part="temps"/>
                  <lit-tag v="pp3"/>
                </let>
              </when>

              <when>      <!-- traduccions des de infinitiu -> ESTIS + PP (3)-->
                <test>
                    <equal>
                      <clip pos="1" side="sl" part="temps"/>
                      <lit-tag v="inf"/><!--digué -->
                    </equal>
                </test>
                <let>
                  <clip pos="1" side="tl" part="temps"/>
                  <lit-tag v="inf"/>
                </let>
                <let>
                  <clip pos="1" side="tl" part="nbr"/>
                  <lit-tag v="sg"/>
                </let>
                <let>
                  <clip pos="2" side="tl" part="temps"/>
                  <lit-tag v="pp3"/>
                </let>
              </when>
	     </choose>

                <out>
                  <chunk name="verbcj_perif" case="caseFirstWord">
                    <tags>
                      <tag><lit-tag v="SV"/></tag>
                      <tag><clip pos="2" side="tl" part="a_verb"/></tag>
                      <tag><clip pos="1" side="tl" part="temps"/></tag>
                      <tag><clip pos="1" side="tl" part="pers"/></tag>
                      <tag><clip pos="1" side="tl" part="nbr"/></tag>
                      <tag><var n="tipus_verb"/></tag>
                    </tags>
                    <lu>
		      <lit v="esti"/>
                      <clip pos="1" side="tl" part="a_verb"/>
                      <clip pos="1" side="tl" part="temps"/>
                    </lu>
		    <b/>
                    <lu>
                      <clip pos="2" side="tl" part="lemh"/>
                      <clip pos="2" side="tl" part="a_verb"/>
                      <clip pos="2" side="tl" part="temps"/>
                      <clip pos="1" side="tl" part="nbr"/>
                    </lu>
                  </chunk>
                <b pos="1"/>
                 <chunk name="cnjsub" case="caseFirstWord">
                        <tags>
                        <tag><lit-tag v="cnjsub"/></tag>
                        </tags>
                        <lu>
                        <lit v="ke"/>
                        <lit-tag v="cnjsub"/>
                        </lu>
                        </chunk>

                </out>
            </otherwise>
	</choose>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>    
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>


    <rule comment="HAVER + PP + INF (ell ha decidit marxar ) (EO)">
      <pattern>
	<pattern-item n="haver"/>
	<pattern-item n="pp"/> 
	<pattern-item n="inf"/> 
      </pattern>
      <action>
        <call-macro n="tipus_verbs">
          <with-param pos="2"/>
        </call-macro>

        <choose>
              <when>  <!-- traduccions des de present -> passat (1)-->
                <test>
                  <or>
                    <equal>
                      <clip pos="1" side="sl" part="temps"/>
                      <lit-tag v="pri"/><!--present indicatiu dic -->
                    </equal>
                    <equal>
                      <clip pos="1" side="sl" part="temps"/>
                      <lit-tag v="prs"/><!--present subjunctiu digui -->
                    </equal>
                  </or>
                </test>
                <let>
                  <clip pos="2" side="tl" part="temps"/>
                  <lit-tag v="past"/> <!-- present -->
                </let>
                <out>
                  <chunk name="verbcj_perif" case="caseFirstWord">
                    <tags>
                      <tag><lit-tag v="SV"/></tag>
                      <tag><clip pos="2" side="tl" part="a_verb"/></tag>
                      <tag><clip pos="1" side="tl" part="temps"/></tag>
                      <tag><clip pos="1" side="tl" part="pers"/></tag>
                      <tag><clip pos="1" side="tl" part="nbr"/></tag>
                      <tag><var n="tipus_verb"/></tag>
                    </tags>
                    <lu>
                      <clip pos="2" side="tl" part="lemh"/>
                      <clip pos="2" side="tl" part="a_verb"/>
                      <clip pos="2" side="tl" part="temps"/>
                      <clip pos="2" side="tl" part="lemq"/>
                    </lu>
                    <b pos="1"/>
                    <lu>
                      <clip pos="3" side="tl" part="lemh"/>
                      <clip pos="3" side="tl" part="a_verb"/>
                      <clip pos="3" side="tl" part="sep"/>
                      <clip pos="3" side="tl" part="temps"/>
                      <clip pos="3" side="tl" part="lemq"/>
                    </lu>

                  </chunk>
                </out>
          </when>
	    <otherwise>
	    <choose>
              <when>      <!-- traduccions des de passat -> ESTIS + PP (2)-->
                <test>
                  <or>
                    <equal>
                      <clip pos="1" side="sl" part="temps"/>
                      <lit-tag v="ifi"/><!--digué -->
                    </equal>
                    <equal>
                      <clip pos="1" side="sl" part="temps"/>
                      <lit-tag v="pii"/><!--deia -->
                    </equal>
                    <equal>
                      <clip pos="1" side="sl" part="temps"/>
                      <lit-tag v="pis"/><!--digués -->
                    </equal>
                  </or>
                </test>
                <let>
                  <clip pos="1" side="tl" part="temps"/>
                  <lit-tag v="past"/>
                </let>
                <let>
                  <clip pos="2" side="tl" part="temps"/>
                  <lit-tag v="pp3"/>
                </let>
              </when>
              <when>      <!-- traduccions des de futur -> ESTIS + PP (3)-->
                <test>
                    <equal>
                      <clip pos="1" side="sl" part="temps"/>
                      <lit-tag v="fti"/><!--digué -->
                    </equal>
                </test>
                <let>
                  <clip pos="1" side="tl" part="temps"/>
                  <lit-tag v="fti"/>
                </let>
                <let>
                  <clip pos="2" side="tl" part="temps"/>
                  <lit-tag v="pp3"/>
                </let>
              </when>
              <when>      <!-- traduccions des de condicional -> ESTIS + PP (3)-->
                <test>
                    <equal>
                      <clip pos="1" side="sl" part="temps"/>
                      <lit-tag v="cni"/><!--digué -->
                    </equal>
                </test>
                <let>
                  <clip pos="1" side="tl" part="temps"/>
                  <lit-tag v="cni"/>
                </let>
                <let>
                  <clip pos="2" side="tl" part="temps"/>
                  <lit-tag v="pp3"/>
                </let>
              </when>

              <when>      <!-- traduccions des de infinitiu -> ESTIS + PP (3)-->
                <test>
                    <equal>
                      <clip pos="1" side="sl" part="temps"/>
                      <lit-tag v="inf"/><!--digué -->
                    </equal>
                </test>
                <let>
                  <clip pos="1" side="tl" part="temps"/>
                  <lit-tag v="inf"/>
                </let>
                <let>
                  <clip pos="1" side="tl" part="nbr"/>
                  <lit-tag v="sg"/>
                </let>
                <let>
                  <clip pos="2" side="tl" part="temps"/>
                  <lit-tag v="pp3"/>
                </let>
              </when>
	     </choose>

                <out>
                  <chunk name="verbcj_perif" case="caseFirstWord">
                    <tags>
                      <tag><lit-tag v="SV"/></tag>
                      <tag><clip pos="2" side="tl" part="a_verb"/></tag>
                      <tag><clip pos="1" side="tl" part="temps"/></tag>
                      <tag><clip pos="1" side="tl" part="pers"/></tag>
                      <tag><clip pos="1" side="tl" part="nbr"/></tag>
                      <tag><var n="tipus_verb"/></tag>
                    </tags>
                    <lu>
		      <lit v="esti"/>
                      <clip pos="1" side="tl" part="a_verb"/>
                      <clip pos="1" side="tl" part="temps"/>
                    </lu>
		    <b/>
                    <lu>
                      <clip pos="2" side="tl" part="lemh"/>
                      <clip pos="2" side="tl" part="a_verb"/>
                      <clip pos="2" side="tl" part="temps"/>
                      <clip pos="1" side="tl" part="nbr"/>
                    </lu>
                    <b pos="1"/>
                    <lu>
                      <clip pos="3" side="tl" part="lemh"/>
                      <clip pos="3" side="tl" part="a_verb"/>
                      <clip pos="3" side="tl" part="sep"/>
                      <clip pos="3" side="tl" part="temps"/>
                      <clip pos="3" side="tl" part="lemq"/>
                    </lu>

                  </chunk>
                </out>
            </otherwise>
	</choose>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>    
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>




    <rule comment="PROCLITIC PROCLITIC (me'ls EO)">
      <pattern>
	<pattern-item n="proenc"/>
	<pattern-item n="proenc"/>
      </pattern>
      <action>    	
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
		<out>
		  <chunk name="pro_directe" case="caseFirstWord">
		    <tags>
		      <tag><lit-tag v="SN"/></tag>
		      <tag><clip pos="2" side="tl" part="tipus_prn"/></tag>
		      <tag><clip pos="2" side="sl" part="pers"/></tag>
		      <tag><clip pos="2" side="tl" part="gen"/></tag>
		      <tag><clip pos="2" side="tl" part="nbr"/></tag>
		    </tags>
		    <lu>
		      <clip pos="2" side="tl" part="whole"/>
		    </lu>
		  </chunk>
		</out>
     <!-- Si el primer clitic és SE: l'eliminem; si no el fem objecte indirecte (eliminem les formes SE ja que estadísticament sembla justificat, la majoria de vegades són benefacctius, etc...-->

          <choose>
              <when>  <!-- mirem si és SE per no fer res-->
                <test>
                    <equal>
                      <clip pos="1" side="sl" part="tipus_prn"/>
                      <lit-tag v="ref"/>
                    </equal>
                </test>
              </when>
           <otherwise> <!-- SI NO es SE: objecte indirecte (passa a 'subj' per agafar nominatiu i s'afegeix la prep 'al') -->	
                <let>
                  <clip pos="1" side="tl" part="tipus_prn"/>
                  <lit-tag v="subj"/>
                </let>
		<out>
		  <b pos="1"/>
		  <chunk name="pro_indirecte" case="caseFirstWord">
		    <tags>
		      <tag><lit-tag v="SN"/></tag>
		      <tag><clip pos="1" side="tl" part="tipus_prn"/></tag>
		      <tag><clip pos="1" side="sl" part="pers"/></tag>
		      <tag><clip pos="1" side="tl" part="gen"/></tag>
		      <tag><clip pos="1" side="tl" part="nbr"/></tag>
		    </tags>
		    <lu>
		      <lit v="al"/>
		      <lit-tag v="pr"/>
		    </lu>
		    <b pos="1"/>
		    <lu>
		      <clip pos="1" side="tl" part="whole"/>
		    </lu>
		  </chunk>
		</out>
        </otherwise>
      </choose>

        <let>
          <var n="caseFirstWord"/>
          <lit v="aa"/>
        </let>
      </action>
    </rule>

    <rule comment="PRO_FORT PROCLITIC (a mi em, a ella li, ... regla per simplificar el clitic doubling EO'a mi em' -> min)">
      <pattern>
        <pattern-item n="profort"/>
        <pattern-item n="proenc"/>
      </pattern>
      <action>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
                <out>
                  <chunk name="pro_directe" case="caseFirstWord">
                    <tags>
                      <tag><lit-tag v="SN"/></tag>
                      <tag><clip pos="1" side="tl" part="tipus_prn"/></tag>
                      <tag><clip pos="1" side="sl" part="pers"/></tag>
                      <tag><clip pos="1" side="tl" part="gen"/></tag>
                      <tag><clip pos="1" side="tl" part="nbr"/></tag>
                    </tags>
                    <lu>
                      <clip pos="1" side="tl" part="whole"/>
                    </lu>
                  </chunk>
                </out>
        <let>
          <var n="caseFirstWord"/>
          <lit v="aa"/>
        </let>
      </action>
    </rule>

    <rule comment="PRO_FORT PROCLITIC PROCLITIC (a mi me'l, a ella se'l, ... regla per simplificar el clitic doubling EO 'a mi me'l' -> lin al mi )">
      <pattern>
        <pattern-item n="profort"/>
        <pattern-item n="proenc"/>
        <pattern-item n="proenc"/>
      </pattern>
      <action>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
                <out>
                  <chunk name="pro_directe" case="caseFirstWord">
                    <tags>
                      <tag><lit-tag v="SN"/></tag>
                      <tag><clip pos="3" side="tl" part="tipus_prn"/></tag>
                      <tag><clip pos="3" side="sl" part="pers"/></tag>
                      <tag><clip pos="3" side="tl" part="gen"/></tag>
                      <tag><clip pos="3" side="tl" part="nbr"/></tag>
                    </tags>
                    <lu>
                      <clip pos="3" side="tl" part="whole"/>
                    </lu>
                  </chunk>
                    <b pos="1"/>
                 <chunk name="pro_indirecte" case="caseFirstWord">
                    <tags>
                      <tag><lit-tag v="SN"/></tag>
                      <tag><clip pos="1" side="tl" part="tipus_prn"/></tag>
                      <tag><clip pos="1" side="sl" part="pers"/></tag>
                      <tag><clip pos="1" side="tl" part="gen"/></tag>
                      <tag><clip pos="1" side="tl" part="nbr"/></tag>
                    </tags>
                    <lu>
                      <lit v="al"/>
                      <lit-tag v="pr"/>
                    </lu>
                    <b pos="1"/>
                    <lu>
                      <clip pos="1" side="tl" part="whole"/>
                    </lu>
                  </chunk>

                </out>
        <let>
          <var n="caseFirstWord"/>
          <lit v="aa"/>
        </let>
      </action>
    </rule>

    <rule comment="PROCLITIC (EO)">
      <pattern>
	<pattern-item n="proenc"/>
      </pattern>
      <action>    	
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>

          <choose>
              <when>  <!-- mirem si és SE o EN per no fer res-->
                <test>
		  <or>
                    <equal>
                      <clip pos="1" side="sl" part="tipus_prn"/>
                      <lit-tag v="ref"/>
                    </equal>
                    <equal>
                      <clip pos="1" side="sl" part="tipus_prn"/>
                      <lit-tag v="adv"/>
                    </equal>
		  </or>
                </test>
              </when>
           <otherwise> <!-- SI NO es SE: el traduim) -->	
		<out>
		  <chunk name="pro_obj" case="caseFirstWord">
		    <tags>
		      <tag><lit-tag v="SN"/></tag>
		      <tag><clip pos="1" side="tl" part="tipus_prn"/></tag>
		      <tag><clip pos="1" side="sl" part="pers"/></tag>
		      <tag><clip pos="1" side="tl" part="gen"/></tag>
		      <tag><clip pos="1" side="tl" part="nbr"/></tag>
		    </tags>
		   <lu>
	              <clip pos="1" side="tl" part="lem"/>
		      <clip pos="1" side="tl" part="a_prn"/>
		      <clip pos="1" side="tl" part="tipus_prn" link-to="2"/>
		      <clip pos="1" side="sl" part="pers"/>
		      <clip pos="1" side="tl" part="gen"/>
		      <clip pos="1" side="tl" part="nbr"/>
		   </lu>

		  </chunk>
		</out>
	</otherwise>
	</choose>
        <let>
          <var n="caseFirstWord"/>
          <lit v="aa"/>
        </let>
      </action>
    </rule>



    <rule comment="INF_IMP + ENCL + INF (haver-los de comprar; poder-los comprar; voler-los comprar; deixa'l llegir. El clític passa al final EO- )">
      <pattern>
	<pattern-item n="inf_imp"/> 
	<pattern-item n="enc"/> 
	<pattern-item n="inf"/> 
      </pattern>
      <action>              	
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>  
	<choose>
              <when>  <!-- mirem si és SE per no fer res-->
                <test>
                    <equal>
                        <clip pos="2" side="sl" part="lem"/>
                        <lit v="es"/><!--és 'sp' -->
                      </equal>
                </test>

	<out>
	  <chunk name="verb_inf" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SV"/></tag>
	      <tag><clip pos="1" side="tl" part="a_verb"/></tag>
	      <tag><clip pos="1" side="tl" part="temps"/></tag>
	      <tag><clip pos="1" side="sl" part="pers"/></tag>
	      <tag><clip pos="1" side="sl" part="nbr"/></tag>
	    </tags>
	    <lu>
	      <clip pos="1" side="tl" part="lemh"/>
	      <clip pos="1" side="tl" part="a_verb"/>
	      <clip pos="1" side="tl" part="temps" link-to="3"/>      
	      <clip pos="1" side="tl" part="lemq"/>
	    </lu>	  
            <b pos="1"/>
             <lu>
              <clip pos="3" side="tl" part="lemh"/>
              <clip pos="3" side="tl" part="a_verb"/>
              <clip pos="3" side="tl" part="sep"/>
              <clip pos="3" side="tl" part="temps"/>
              <clip pos="3" side="tl" part="lemq"/>
             </lu>

	  </chunk>
	</out>  
             </when>
<otherwise>
	<out>
	  <chunk name="verb_inf_enc" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SV"/></tag>
	      <tag><clip pos="1" side="tl" part="a_verb"/></tag>
	      <tag><clip pos="1" side="tl" part="temps"/></tag>
	      <tag><clip pos="1" side="sl" part="pers"/></tag>
	      <tag><clip pos="1" side="sl" part="nbr"/></tag>
	    </tags>
	    <lu>
	      <clip pos="1" side="tl" part="lemh"/>
	      <clip pos="1" side="tl" part="a_verb"/>
	      <clip pos="1" side="tl" part="temps" link-to="3"/>      
	      <clip pos="1" side="tl" part="lemq"/>
	    </lu>	  
            <b pos="1"/>
             <lu>
              <clip pos="3" side="tl" part="lemh"/>
              <clip pos="3" side="tl" part="a_verb"/>
              <clip pos="3" side="tl" part="sep"/>
              <clip pos="3" side="tl" part="temps"/>
              <clip pos="3" side="tl" part="lemq"/>
             </lu>
	    <b pos="2"/>
	    <lu>
	      <clip pos="2" side="tl" part="whole"/>
	    </lu> 
	  </chunk>
	</out>  
	</otherwise>
	</choose>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>


    <rule comment="INF_IMP + ENCL + ENCL + INF (haver-los de comprar; poder-los comprar; voler-los comprar; deixa'l llegir. El clític passa al final EO- )">
      <pattern>
	<pattern-item n="inf_imp"/> 
	<pattern-item n="enc"/> 
	<pattern-item n="enc"/> 
	<pattern-item n="inf"/> 
      </pattern>
      <action>              	
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>  

	<out> <!-- primer pintem els vebrs -->
	  <chunk name="verb_enc_inf" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SV"/></tag>
	      <tag><clip pos="1" side="tl" part="a_verb"/></tag>
	      <tag><clip pos="1" side="tl" part="temps"/></tag>
	      <tag><clip pos="1" side="sl" part="pers"/></tag>
	      <tag><clip pos="1" side="sl" part="nbr"/></tag>
	    </tags>
	    <lu>
	      <clip pos="1" side="tl" part="lemh"/>
	      <clip pos="1" side="tl" part="a_verb"/>
	      <clip pos="1" side="tl" part="temps" link-to="3"/>      
	      <clip pos="1" side="tl" part="lemq"/>
	    </lu>	  
            <b pos="1"/>
             <lu>
              <clip pos="4" side="tl" part="lemh"/>
              <clip pos="4" side="tl" part="a_verb"/>
              <clip pos="4" side="tl" part="sep"/>
              <clip pos="4" side="tl" part="temps"/>
              <clip pos="4" side="tl" part="lemq"/>
             </lu>

	  </chunk>
	 <b/>
	</out>  

                <out>
                  <chunk name="pro_directe" case="caseFirstWord">
                    <tags>
                      <tag><lit-tag v="SN"/></tag>
                      <tag><clip pos="3" side="tl" part="tipus_prn"/></tag>
                      <tag><clip pos="3" side="sl" part="pers"/></tag>
                      <tag><clip pos="3" side="tl" part="gen"/></tag>
                      <tag><clip pos="3" side="tl" part="nbr"/></tag>
                    </tags>
                    <lu>
                      <clip pos="3" side="tl" part="whole"/>
                    </lu>
                  </chunk>
                </out>
     <!-- Si el primer clitic és SE: l'eliminem; si no el fem objecte indirecte (eliminem les formes SE ja que estadísticament sembla justificat, la majoria de vegades són benefacctius, etc...-->

          <choose>
              <when>  <!-- mirem si és SE per no fer res-->
                <test>
                    <equal>
                      <clip pos="2" side="sl" part="tipus_prn"/>
                      <lit-tag v="ref"/>
                    </equal>
                </test>
              </when>
           <otherwise> <!-- SI NO es SE: objecte indirecte (passa a 'subj' per agafar nominatiu i s'afegeix la prep 'al') -->
                <let>
                  <clip pos="2" side="tl" part="tipus_prn"/>
                  <lit-tag v="subj"/>
                </let>
                <out>
                  <b pos="1"/>
                  <chunk name="pro_indirecte" case="caseFirstWord">
                    <tags>
                      <tag><lit-tag v="SN"/></tag>
                      <tag><clip pos="2" side="tl" part="tipus_prn"/></tag>
                      <tag><clip pos="2" side="sl" part="pers"/></tag>
                      <tag><clip pos="2" side="tl" part="gen"/></tag>
                      <tag><clip pos="2" side="tl" part="nbr"/></tag>
                    </tags>
                    <lu>
                      <lit v="al"/>
                      <lit-tag v="pr"/>
                    </lu>
                    <b pos="1"/>
                    <lu>
                      <clip pos="2" side="tl" part="whole"/>
                    </lu>
                  </chunk>
                </out>
        </otherwise>
      </choose>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>


    <rule comment="REGLA: PARTICIPI (perquè no enviï gènere ni nombre quan va sol (per tal que no doni error). Caldrà posar-lo tb en les regles d'adjectiu">
      <pattern>
	<pattern-item n="pp"/> 
      </pattern>
      <action>       	
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
        <call-macro n="nom_cas">
          <with-param pos="1"/>
        </call-macro>
          <let>
            <var n="case"/>
            <lit-tag v="nomi"/>
          </let>

	<out>
	  <chunk name="pp" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SA"/></tag>
	      <tag><clip pos="1" side="sl" part="gen"/></tag>
	      <tag><clip pos="1" side="sl" part="nbr"/></tag>
              <tag><var n="case"/></tag>

	    </tags> 	
	    <lu>
	      <clip pos="1" side="tl" part="lemh"/> 
	      <lit-tag v="vblex.pp"/>
	      <clip pos="1" side="sl" part="nbr"/>
	      <clip pos="1" side="tl" part="cas" link-to="4"/>
	      <lit-tag v="nomi"/>
	      <clip pos="1" side="tl" part="lemq"/>    
	    </lu>
	  </chunk>
	</out>  
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>


    <rule comment="REGLA: VERBinf no conjugat (perquè posi bé la cua en multiparaules)">
      <pattern>
	<pattern-item n="inf"/> 
      </pattern>
      <action>     	
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>     
	<out>
	  <chunk name="inf" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SV"/></tag>
	      <tag><clip pos="1" side="tl" part="a_verb"/></tag>
	      <tag><clip pos="1" side="tl" part="temps"/></tag>
	    </tags>
	    <lu>
	      <clip pos="1" side="tl" part="lemh"/> 
	      <clip pos="1" side="tl" part="a_verb"/>
	      <clip pos="1" side="tl" part="sep"/>
	      <clip pos="1" side="tl" part="temps" link-to="3"/>
	      <clip pos="1" side="tl" part="lemq"/>    
	    </lu>
	  </chunk>
	</out>  
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>

    <rule comment="REGLA: VERBger no conjugat (perquè posi bé la cua en multiparaules)">
      <pattern>
	<pattern-item n="ger"/> 
      </pattern>
      <action>     	
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<out>
	  <chunk name="ger" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SV"/></tag>
	      <tag><clip pos="1" side="tl" part="a_verb"/></tag>
	      <tag><clip pos="1" side="sl" part="temps"/></tag>
	    </tags>
	    <lu>
	      <clip pos="1" side="tl" part="lemh"/> 
	      <clip pos="1" side="tl" part="a_verb"/>
	      <clip pos="1" side="tl" part="sep"/>
	      <clip pos="1" side="tl" part="temps"/>
	      <clip pos="1" side="tl" part="lemq"/>    
	    </lu>
	  </chunk>
	</out>  
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>




    <!--************************************ ALTRES ************************************************ -->

    <rule comment="ADV">
      <pattern>
	<pattern-item n="adv"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<out>
	  <chunk name="adv" case="caseFirstWord">
	    <tags>
	      <tag><clip pos="1" side="tl" part="a_adv"/></tag>
	      <tag><clip pos="1" side="tl" part="neg"/></tag>		
	    </tags>
	    <lu>
	      <clip pos="1" side="tl" part="lem"/>
	      <clip pos="1" side="tl" part="a_adv"/>
	    </lu>
	  </chunk>
	</out>  
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>


<rule comment="ADV ITG">
      <pattern>
	<pattern-item n="advitg"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<out>
	  <chunk name="adv" case="caseFirstWord">
	    <tags>
	      <tag><clip pos="1" side="tl" part="a_adv"/></tag>	
	    </tags>
	    <lu>
	      <clip pos="1" side="tl" part="whole"/>
	    </lu>
	  </chunk>
	</out>  
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>


<rule comment="PRONOM tònic/interrogatiu/possessiu EO"> 
      <pattern>
	<pattern-item n="tn_itg_pos"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
        <call-macro n="nombre_nom">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="nom_cas">
          <with-param pos="1"/>
        </call-macro>

	<out>
	  <chunk name="prn_int" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN"/></tag>
	      <tag><clip pos="1" side="tl" part="tipus_prn"/></tag>
              <tag><var n="nombre"/></tag>
              <tag><var n="case"/></tag>
              <tag><var n="changecase"/></tag>

	    </tags>
	    <lu>
	      <clip pos="1" side="tl" part="lem"/> 
	      <clip pos="1" side="tl" part="a_prn"/>
	      <clip pos="1" side="tl" part="tipus_prn"/>
	      <clip pos="1" side="tl" part="nbr" link-to="3"/>
	      <lit-tag v="4"/>
	    </lu> 
	  </chunk>
	</out>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>


<rule comment="PRONOM indefinit i companyia (EO)"> 
      <pattern>
	<pattern-item n="tn"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="nombre_nom">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="nom_cas">
	  <with-param pos="1"/>
	</call-macro>

	<out>
	  <chunk name="prn_nosubj" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN"/></tag>
	      <tag><clip pos="1" side="tl" part="tipus_prn"/></tag>
	      <tag><var n="nombre"/></tag>
	      <tag><var n="case"/></tag>
	    </tags>
	    <lu>
	      <clip pos="1" side="tl" part="lem"/> 
	      <clip pos="1" side="tl" part="a_prn"/>
	      <clip pos="1" side="tl" part="tipus_prn"/>
	      <clip pos="1" side="tl" part="nbr" link-to="3"/>
	      <lit-tag v="4"/>
	    </lu> 
	  </chunk>
	</out>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>

<rule comment="PRONOM relatiu EO"> 
      <pattern>
	<pattern-item n="relatiu"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="nom_cas">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="nombre_nom">
	  <with-param pos="1"/>
	</call-macro>
	<out>
	  <chunk name="prn" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SNrelatiu"/></tag>
	      <tag><clip pos="1" side="tl" part="tipus_prn"/></tag>
	      <tag><var n="nombre"/></tag>
	      <tag><var n="case"/></tag>
	    </tags>
	    <lu>
	      <clip pos="1" side="tl" part="lem"/> 
	      <clip pos="1" side="tl" part="a_prn"/>
	      <clip pos="1" side="tl" part="tipus_prn"/>
	      <clip pos="1" side="tl" part="nbr" link-to="3"/>
	      <lit-tag v="4"/>
	    </lu> 
	  </chunk>
	</out>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>


<rule comment="PREP + PRONOM relatiu EO( dels quals, pels que, als que ...)"> 
      <pattern>
	<pattern-item n="prep"/>
	<pattern-item n="relatiu_prep"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="nom_cas">
	  <with-param pos="2"/>
	</call-macro>
	<call-macro n="nombre_nom">
	  <with-param pos="2"/>
	</call-macro>
	<out>
          <chunk name="pr" case="caseFirstWord">
            <tags>
              <tag><lit-tag v="PREP"/></tag>
            </tags>
            <lu>
              <clip pos="1" side="tl" part="whole"/>
            </lu>
          </chunk>
	  <b pos="1"/>
	  <chunk name="prn" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SNrelatiu"/></tag>
              <tag><lit-tag v="rel"/></tag>
	      <tag><var n="nombre"/></tag>
	      <tag><var n="case"/></tag>
	    </tags>
	    <lu>
	      <clip pos="2" side="tl" part="lem"/> 
	      <clip pos="2" side="tl" part="a_prn"/>
              <lit-tag v="nn"/>
	      <clip pos="2" side="tl" part="nbr" link-to="3"/>
	    </lu> 
	  </chunk>
	</out>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>

    <rule comment="PRN personal">
      <pattern>
	<pattern-item n="prpers"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<out>
	  <chunk name="prpers" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN"/></tag>
	      <tag><clip pos="1" side="tl" part="tipus_prn"/></tag>
	      <tag><clip pos="1" side="tl" part="pers"/></tag>
	      <tag><clip pos="1" side="tl" part="gen"/></tag>
	      <tag><clip pos="1" side="tl" part="nbr"/></tag>
	    </tags>
	    <lu>   
	      <clip pos="1" side="tl" part="lem"/>  
	      <clip pos="1" side="tl" part="a_prn"/>  
	      <clip pos="1" side="tl" part="tipus_prn" link-to="2"/> 
	      <clip pos="1" side="tl" part="pers"/>
	      <clip pos="1" side="tl" part="gen"/>
	      <clip pos="1" side="tl" part="nbr"/>
	    </lu> 
	  </chunk>
	</out>  
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>
    

 <rule comment="CNJ">
      <pattern>
	<pattern-item n="cnj"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>	
	<out>
	  <chunk name="cnj" case="caseFirstWord">
	    <tags>
	      <tag><clip pos="1" side="tl" part="tags"/></tag>		
	    </tags>
	    <lu>
	      <clip pos="1" side="tl" part="whole"/>
	    </lu>
	  </chunk>
	</out>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>

 <rule comment="de">
      <pattern>
	<pattern-item n="de"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<out>
	  <chunk name="de" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="PREP"/></tag>
	    </tags>
	    <lu>
	      <clip pos="1" side="tl" part="whole"/>
	    </lu>
	  </chunk>
	</out>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>


    <rule comment="PREP">
      <pattern>
	<pattern-item n="prep"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<out>
	  <chunk name="pr" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="PREP"/></tag>
	    </tags>
	    <lu>
	      <clip pos="1" side="tl" part="whole"/>
	    </lu>
	  </chunk>
	</out>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>

    <rule> <!-- REGLA: reset variables, hem afegit la coma per al pro-drop (cal veure el reset de variablesi EO)-->
      <pattern>
	<pattern-item n="sent"/>
      </pattern>
      <action>
	<let>
	  <var n="nombre"/>
	  <lit-tag v="sg"/>
	</let>
	<let>
	  <var n="genere"/>
	  <lit-tag v="m"/>
	</let>
	<choose>
	  <when>
	    <test>
	      <not>
		<or>
		  <equal>
		    <clip pos="1" side="sl" part="lem"/>
		    <lit v=";"/>
		  </equal>
		  <equal>
		    <clip pos="1" side="sl" part="lem"/>
		    <lit v=","/>
		  </equal>
		  <equal>
		    <clip pos="1" side="sl" part="lem"/>
		    <lit v=":"/>
		  </equal>
		</or>
	      </not>
	    </test>	      
	    <let>
	      <var n="EOS"/>
	      <lit v="true"/>
	    </let>
	  </when>
	</choose>
	<out>
	  <chunk name="punt">
	    <tags>
	      <tag><lit-tag v="sent"/></tag>
	    </tags>
	    <lu>
	      <clip pos="1" side="tl" part="whole"/>
	    </lu>
	  </chunk>
	</out>
      </action>
    </rule>

    
    <rule> <!-- REGLA: sent_coma (hem afegit regla per a la coma per al pro-drop (no l'imcloem a l'anterior per no fer el reset de variables EO))-->
      <pattern>
	<pattern-item n="sent_coma"/>
      </pattern>
      <action>
	<out>
	  <chunk name="punt">
	    <tags>
	      <tag><lit-tag v="sent"/></tag>
	    </tags>
	    <lu>
	      <clip pos="1" side="tl" part="whole"/>
	    </lu>
	  </chunk>
	</out>
      </action>
    </rule>

  </section-rules>
</transfer>
