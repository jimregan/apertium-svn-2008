<?xml version="1.0" encoding="ISO-8859-1"?>

<transfer>
  <section-def-cats>
 
    <def-cat n="detnt">
      <cat-item tags="detnt"/>
    </def-cat>
    <def-cat n="proclise">
      <cat-item tags="prn.itg.*"/>
      <cat-item tags="adv.itg"/>
      <cat-item tags="cnjsub"/>
      <cat-item tags="rel.*"/>
      <cat-item tags="adv"/>
      <cat-item tags="ij"/>
      <cat-item tags="prn.*"/>
      <cat-item tags="cnjcoo"/>
      <cat-item tags="pr"/>
      <cat-item tags="cnjadv"/>
    </def-cat>
    <def-cat n="longa_proclise">
      <cat-item tags="prn.itg.*"/>
      <cat-item tags="adv.itg"/>
      <cat-item tags="cnjsub"/>
      <cat-item tags="rel.*"/>
    </def-cat>
    <def-cat n="intermed">
      <cat-item tags="detnt"/>
      <cat-item tags="n.*"/>
      <cat-item tags="np.ant"/>
      <cat-item tags="np.loc"/>
      <cat-item tags="adv"/>
      <cat-item tags="preadv"/>
      <cat-item tags="pr"/>
      <cat-item tags="num.*"/>
      <cat-item tags="prn.tn.*"/>
    </def-cat>
    <def-cat n="nom">
      <cat-item tags="n.*"/>
    </def-cat>
    <def-cat n="nomp">
      <cat-item tags="np.ant"/>
    </def-cat>
    <def-cat n="nploc">
      <cat-item tags="np.loc"/>
    </def-cat>
    <def-cat n="det">
      <cat-item tags="det.*"/>
    </def-cat>
    <def-cat n="predet">
      <cat-item tags="predet.*"/>
    </def-cat>
    <def-cat n="adjec">
      <cat-item tags="adj.*"/>
      <cat-item tags="vblex.pp.*"/>
    </def-cat>
    <def-cat n="adj">
      <cat-item tags="adj.*"/>
    </def-cat>
    <def-cat n="adv">
      <cat-item tags="adv"/>
      <cat-item tags="preadv"/>
    </def-cat>
    <def-cat n="prep">
      <cat-item tags="pr"/>
    </def-cat>
    <def-cat n="cuyo">
      <cat-item tags="rel.aa.*"/>
    </def-cat>
    <def-cat n="prn">
      <cat-item tags="prn.tn.*"/>
      <cat-item tags="prn.itg.*"/>
    </def-cat>
    <def-cat n="prnenc">
      <cat-item tags="prn.enc.*"/>
    </def-cat>
    <def-cat n="prnpro">
      <cat-item tags="prn.pro.*"/>
    </def-cat>
    <def-cat n="prnproref">
      <cat-item tags="prn.pro.ref.*"/>
    </def-cat>
    <def-cat n="verb">
      <cat-item tags="vblex.*"/>
      <cat-item tags="vbser.*"/>
      <cat-item tags="vbhaver.*"/>
      <cat-item tags="vbter.*"/>
      <cat-item tags="vbmod.*"/>
    </def-cat>
    <def-cat n="verbir">
      <cat-item lemma="ir" tags="vblex.*"/>
      <cat-item lemma="venir" tags="vblex.*"/>
      <cat-item lemma="volver" tags="vblex.*"/>
      <cat-item lemma="acostumbrar" tags="vblex.*"/>
    </def-cat>
    <def-cat n="haber">
      <cat-item tags="vbhaver.*"/>
    </def-cat>
    <def-cat n="inf">
      <cat-item tags="vblex.inf"/>
      <cat-item tags="vbser.inf"/>
      <cat-item tags="vbhaver.inf"/>
      <cat-item tags="vbmod.inf"/>
    </def-cat>
    <def-cat n="lquest">
      <cat-item tags="lquest"/>
    </def-cat>
    <def-cat n="num">
      <cat-item tags="num.*"/>
    </def-cat>
    <def-cat n="sent">
      <cat-item tags="sent"/>
    </def-cat> 
  </section-def-cats>
  <section-def-attrs>
    
    <def-attr n="a_nom">
      <attr-item tags="n"/>
      <attr-item tags="n.acr"/>
    </def-attr>
    <def-attr n="a_nomp">
      <attr-item tags="np.ant"/>
    </def-attr>
    <def-attr n="a_nploc">
      <attr-item tags="np.loc"/>
    </def-attr>
    <def-attr n="a_det">
      <attr-item tags="det.def"/>
      <attr-item tags="det.ind"/>
      <attr-item tags="det.dem"/>
      <attr-item tags="det.pos"/>
    </def-attr>
    <def-attr n="a_predet">
      <attr-item tags="predet"/>
    </def-attr>
    <def-attr n="a_adjec">
      <attr-item tags="adj.ind"/>
      <attr-item tags="adj.sup"/>
      <attr-item tags="adj.itg"/>
      <attr-item tags="adj.pos"/>
      <attr-item tags="adj"/>
      <attr-item tags="vblex.pp"/>
    </def-attr>
    <def-attr n="a_adj">
      <attr-item tags="adj.ind"/>
      <attr-item tags="adj.sup"/>
      <attr-item tags="adj.itg"/>
      <attr-item tags="adj.pos"/>
      <attr-item tags="adj"/>
    </def-attr>
    <def-attr n="a_adv">
      <attr-item tags="adv"/>
      <attr-item tags="preadv"/>
    </def-attr>
    <def-attr n="a_prep">
      <attr-item tags="pr"/>
    </def-attr>
    <def-attr n="a_cuyo">
      <attr-item tags="rel.aa"/>
    </def-attr>
    <def-attr n="a_prn">
      <attr-item tags="prn.tn.p1"/>
      <attr-item tags="prn.tn.p2"/>
      <attr-item tags="prn.tn.p3"/>
      <attr-item tags="prn.tn"/>
      <attr-item tags="prn.tn.ref.p3"/>
      <attr-item tags="prn.tn.pos"/>
      <attr-item tags="prn.itg"/>
    </def-attr>
    <def-attr n="a_verb">
      <attr-item tags="vblex"/>
      <attr-item tags="vbser"/>
      <attr-item tags="vbhaver"/>
      <attr-item tags="vbter"/>
      <attr-item tags="vbmod"/>
    </def-attr>
    <def-attr n="a_inf">
      <attr-item tags="vblex.inf"/>
      <attr-item tags="vbser.inf"/>
      <attr-item tags="vbhaver.inf"/>
      <attr-item tags="vbmod.inf"/>
    </def-attr>
    <def-attr n="a_perif">
      <attr-item tags="vblex.ifi"/>
      <attr-item tags="vbser.ifi"/>
      <attr-item tags="vbhaver.ifi"/>
      <attr-item tags="vbmod.ifi"/>
    </def-attr>
    <def-attr n="a_lquest">
      <attr-item tags="lquest"/>
    </def-attr>
    <def-attr n="a_num">
      <attr-item tags="num"/>
    </def-attr>
    <def-attr n="a_prnenc">
      <attr-item tags="prn.enc"/>
      <attr-item tags="prn.enc.ref"/>
    </def-attr>
    <def-attr n="gen">
      <attr-item tags="m"/>
      <attr-item tags="f"/>
      <attr-item tags="mf"/>
      <attr-item tags="GD"/>
      <attr-item tags="nt"/>
    </def-attr>
    <def-attr n="nbr">
      <attr-item tags="sg"/>
      <attr-item tags="pl"/>
      <attr-item tags="sp"/>
      <attr-item tags="ND"/>
    </def-attr>
    <def-attr n="persona">
      <attr-item tags="p1"/>
      <attr-item tags="p2"/>
      <attr-item tags="p3"/>
    </def-attr>
    <def-attr n="temps">
      <attr-item tags="inf"/>
      <attr-item tags="ger"/>
      <attr-item tags="pp"/>
      <attr-item tags="pri"/>
      <attr-item tags="ifi"/>
      <attr-item tags="pii"/>
      <attr-item tags="fti"/>
      <attr-item tags="cni"/>
      <attr-item tags="prs"/>
      <attr-item tags="pis"/>
      <attr-item tags="fts"/>
      <attr-item tags="imp"/>
    </def-attr>
  </section-def-attrs>
  <section-def-vars>
    <def-var n="uno"/>
    <def-var n="genero"/>
    <def-var n="numero"/>
    <def-var n="concDet"/>
    <def-var n="concAdj"/>
    <def-var n="concPrimero"/>
    <def-var n="concSegundo"/>
    <def-var n="concTercero"/>
    <def-var n="interrogativa"/>
    <def-var n="exclamativa"/>
  </section-def-vars>
  
  <section-def-lists>
    <def-list n="pces">
      <list-item v="que"/>
      <list-item v="dónde"/>
      <list-item v="donde"/>
      <list-item v="adónde"/>
      <list-item v="adonde"/>
      <list-item v="cómo"/>
      <list-item v="como"/>
      <list-item v="cuándo"/>
      <list-item v="cuando"/>
      <list-item v="cuánto"/>
      <list-item v="cuanto"/>
      <list-item v="qué"/>
      <list-item v="quién"/>
      <list-item v="quien"/>
      <list-item v="porque"/>
      <list-item v="aunque"/>
      <list-item v="pero"/>
      <list-item v="ojalá"/>
      <list-item v="no"/>
      <list-item v="quizás"/>
      <list-item v="quizá"/>
      <list-item v="nunca"/>
      <list-item v="jamás"/>
      <list-item v="nada"/>
      <list-item v="nadie"/>
      <list-item v="ni"/>
      <list-item v="ni que"/>
      <list-item v="aunque"/>
      <list-item v="si"/>
      <list-item v="excepto si"/>
      <list-item v="incluso"/>
      <list-item v="tampoco"/>
      <list-item v="algo"/>
      <list-item v="alguien"/>
      <list-item v="alguno"/>
      <list-item v="ambos"/>
      <list-item v="bastante"/>
      <list-item v="cualquiera"/>
      <list-item v="todo"/>
      <list-item v="otro"/>
      <list-item v="mucho"/>
      <list-item v="poco"/>
      <list-item v="tanto"/>
      <list-item v="más"/>
      <list-item v="menos"/>
      <list-item v="demasiado"/>
      <list-item v="acaso"/>
      <list-item v="hasta"/>
      <list-item v="casi"/>
      <list-item v="igual"/>
      <list-item v="incluso"/>
      <list-item v="seguramente"/>
      <list-item v="todavía"/>
      <list-item v="ya"/>
      <list-item v="también"/>
      <list-item v="sólo"/>
      <list-item v="siempre"/>
      <list-item v="apenas"/>
      <list-item v="pronto"/>
      <list-item v="sí"/>
      <list-item v="aún"/>
      <list-item v="bien"/>
      <list-item v="en seguida"/>
      <list-item v="temprano"/>
      <list-item v="mal"/>
      <list-item v="mejor"/>
      <list-item v="peor"/>
      <list-item v="tarde"/>
      <list-item v="o"/>
      <list-item v="para que"/>
      <list-item v="siempre y cuando"/>
      <list-item v="a fin de que"/>
      <list-item v="a menos que"/>
      <list-item v="a nada que"/>
      <list-item v="a no ser que"/>
      <list-item v="a poco que"/>
      <list-item v="al tiempo que"/>
      <list-item v="basta con que"/>
      <list-item v="excepto que"/>
      <list-item v="ahora que"/>
      <list-item v="si bien"/>
      <list-item v="antes de que"/>
      <list-item v="antes que"/>
      <list-item v="a lo que"/>
      <list-item v="así"/>
      <list-item v="así que"/>
      <list-item v="hasta que"/>
      <list-item v="tan pronto"/>
      <list-item v="bien que"/>
      <list-item v="cada vez que"/>
      <list-item v="cuando quiera que"/>
      <list-item v="con el fin de que"/>
      <list-item v="comoquiera que"/>
      <list-item v="con que"/>
      <list-item v="con tal de que"/>
      <list-item v="dada cuenta que"/>
      <list-item v="dado el caso de que"/>
      <list-item v="dado que"/>
      <list-item v="conforme"/>
      <list-item v="tal y como"/>
      <list-item v="tal cual"/>
      <list-item v="de manera que"/>
      <list-item v="de forma que"/>
      <list-item v="de modo que"/>
      <list-item v="de no ser que"/>
      <list-item v="de suerte que"/>
      <list-item v="de aquí que"/>
      <list-item v="desde que"/>
      <list-item v="después de que"/>
      <list-item v="al igual que"/>
      <list-item v="y eso que"/>
      <list-item v="por eso es por lo que"/>
      <list-item v="en favor de que"/>
      <list-item v="por lo que"/>
      <list-item v="en tanto"/>
      <list-item v="en tanto que"/>
      <list-item v="fuera de que"/>
      <list-item v="luego que"/>
      <list-item v="en caso de que"/>
      <list-item v="no obstante que"/>
      <list-item v="donde quiera que"/>
      <list-item v="para lo cual"/>
      <list-item v="para que"/>
      <list-item v="mientras"/>
      <list-item v="mientras que"/>
      <list-item v="entre tanto"/>
      <list-item v="pues"/>
      <list-item v="pues que"/>
      <list-item v="por causa de que"/>
      <list-item v="por cosa de que"/>
      <list-item v="por culpa de que"/>
      <list-item v="de ahí que"/>
      <list-item v="por más que"/>
      <list-item v="por mucho que"/>
      <list-item v="por poco que"/>
      <list-item v="puesto que"/>
      <list-item v="salvo que"/>
      <list-item v="siempre que"/>
      <list-item v="sin que"/>
      <list-item v="sino que"/>
      <list-item v="con sólo que"/>
      <list-item v="toda vez que"/>
      <list-item v="todo lo bien que"/>
      <list-item v="visto que"/>
      <list-item v="ya que"/>
      <list-item v="en cuanto que"/>
      <list-item v="en el supuesto de que"/>
      <list-item v="en tanto en cuanto"/>
      <list-item v="a condición de que"/>
      <list-item v="en donde"/>
      <list-item v="a lo mejor"/>
    </def-list>
    
  </section-def-lists>
  
  <section-def-macros>
    
    <def-macro n="f_bcond" npar="1"><!--Per mirar si el blanc conté o no format -->
      <choose>
        <when>
          <test>
            <not>
              <equal>
                <b pos="1"/>
                <lit v=" "/>
              </equal>
            </not>
          </test>
          <out>
            <b pos="1"/>
          </out>
        </when> 
      </choose>
    </def-macro>
    
    <def-macro n="f_concord1" npar="1">
      <choose>
        <!--To determine value of variables of gender and
               number and propagate to other rules. Variables are
               not used again in this rule -->
        <when>
          <test>
            <equal>
              <clip pos="1" side="tl" part="gen"/>
              <lit-tag v="m"/>
            </equal>
          </test>
          <let>
            <var n="genero"/>
            <lit-tag v="m"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="1" side="tl" part="gen"/>
              <lit-tag v="f"/>
            </equal>
          </test>
          <let>
            <var n="genero"/>
            <lit-tag v="f"/>
          </let>
        </when>
      </choose>
      <choose>
        <when>
          <test>
            <equal>
              <clip pos="1" side="tl" part="nbr"/>
              <lit-tag v="sg"/>
            </equal>
          </test>
          <let>
            <var n="numero"/>
            <lit-tag v="sg"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="1" side="tl" part="nbr"/>
              <lit-tag v="pl"/>
            </equal>
          </test>
          <let>
            <var n="numero"/>
            <lit-tag v="pl"/>
          </let>
        </when>
      </choose>
      <choose>
        <when>
          <test>
            <!-- If word has GD or ND, we try to assign the
                 gender or number of the previous rule. If there is no
                 value for the gender or number variable from previous
                 rules, gender will be masculine and number singular.-->
            <equal>
              <clip pos="1" side="tl" part="gen"/>
              <lit-tag v="GD"/>
            </equal>
          </test>
          <choose>
            <when>
              <test>
                <equal>
                  <var n="genero"/>
                  <lit-tag v="f"/>
                </equal>
              </test>
              <let>
                <clip pos="1" side="tl" part="gen"/>
                <lit-tag v="f"/>
              </let>
            </when>
            <otherwise>
              <let>
                <clip pos="1" side="tl" part="gen"/>
                <lit-tag v="m"/>
              </let>
            </otherwise>
          </choose>
        </when>
      </choose>
      <choose>
        <when>
          <test>
            <equal>
              <clip pos="1" side="tl" part="nbr"/>
              <lit-tag v="ND"/>
            </equal>
          </test>
          <choose>
            <when>
              <test>
                <equal>
                  <var n="numero"/>
                  <lit-tag v="pl"/>
                </equal>
              </test>
              <let>
                <clip pos="1" side="tl" part="nbr"/>
                <lit-tag v="pl"/>
              </let>
            </when>
            <otherwise>
              <let>
                <clip pos="1" side="tl" part="nbr"/>
                <lit-tag v="sg"/>
              </let>
            </otherwise>
          </choose>
        </when>
      </choose>
    </def-macro>
    <def-macro n="f_concord2" npar="2">
      <choose>
        <when>
          <test>
            <!-- do the main and second parameter gender agree?-->
            <and>
              <or>
                <equal>
                  <clip pos="2" side="sl" part="gen"/>
                  <clip pos="1" side="sl" part="gen"/>
                </equal>
                <equal>
                  <clip pos="2" side="sl" part="gen"/>
                  <lit-tag v="mf"/>
                </equal>
                <equal>
                  <clip pos="1" side="sl" part="gen"/>
                  <lit-tag v="mf"/>
                </equal>
              </or>
              <or>
                <equal>
                  <!-- do the main and second parameter number agree?-->
                  <clip pos="2" side="sl" part="nbr"/>
                  <clip pos="1" side="sl" part="nbr"/>
                </equal>
                <equal>
                  <clip pos="2" side="sl" part="nbr"/>
                  <lit-tag v="sp"/>
                </equal>
                <equal>
                  <clip pos="1" side="sl" part="nbr"/>
                  <lit-tag v="sp"/>
                </equal>
              </or>
            </and>
          </test>
          <let>
            <var n="concPrimero"/>
            <lit v="true"/>
          </let>
          <!-- there is gender and number agreement-->
        </when>
        <otherwise>
          <let>
            <var n="concPrimero"/>
            <lit v="false"/>
          </let>
          <!-- there isn't gender and number agreement-->
        </otherwise>
      </choose>
      <choose>
        <when>
          <test>
            <!-- Propagate the main parameter gender if it has been modified during the translation -->
            <and>
              <not>
                <equal>
                  <clip pos="1" side="tl" part="gen"/>
                  <clip pos="1" side="sl" part="gen"/>
                </equal>
              </not>
              <not>
                <equal>
                  <clip pos="1" side="tl" part="gen"/>
                  <lit-tag v="mf"/>
                </equal>
              </not>
              <not>
                <equal>
                  <clip pos="1" side="tl" part="gen"/>
                  <lit-tag v="GD"/>
                </equal>
              </not>
            </and>
          </test>
          <choose>
            <when>
              <test>
                <and>
                  <not>
                    <equal>
                      <clip pos="2" side="tl" part="gen"/>
                      <lit-tag v="mf"/>
                    </equal>
                  </not>
                  <not>
                    <and>
                      <equal>
                        <clip pos="2" side="sl" part="gen"/>
                        <lit-tag v="mf"/>
                      </equal>
                      <not>
                        <equal>
                          <clip pos="2" side="tl" part="gen"/>
                          <lit-tag v="GD"/>
                        </equal>
                      </not>
                    </and>
                  </not>
                  <equal>
                    <var n="concPrimero"/>
                    <lit v="true"/>
                  </equal>
                </and>
              </test>
              <let>
                <clip pos="2" side="tl" part="gen"/>
                <clip pos="1" side="tl" part="gen"/>
              </let>
            </when>
          </choose>
        </when>
      </choose>
      <choose>
        <when>
          <test>
            <!-- Propagate the main parameter number if it has been modified during the translation -->
            <and>
              <not>
                <equal>
                  <clip pos="1" side="tl" part="nbr"/>
                  <clip pos="1" side="sl" part="nbr"/>
                </equal>
              </not>
              <not>
                <equal>
                  <clip pos="1" side="tl" part="nbr"/>
                  <lit-tag v="sp"/>
                </equal>
              </not>
              <not>
                <equal>
                  <clip pos="1" side="tl" part="nbr"/>
                  <lit-tag v="ND"/>
                </equal>
              </not>
            </and>
          </test>
          <choose>
            <when>
              <test>
                <and>
                  <not>
                    <equal>
                      <clip pos="2" side="tl" part="nbr"/>
                      <lit-tag v="sp"/>
                    </equal>
                  </not>
                  <not>
                    <and>
                      <equal>
                        <clip pos="2" side="sl" part="nbr"/>
                        <lit-tag v="sp"/>
                      </equal>
                      <not>
                        <equal>
                          <clip pos="2" side="tl" part="nbr"/>
                          <lit-tag v="ND"/>
                        </equal>
                      </not>
                    </and>
                  </not>
                  <equal>
                    <var n="concPrimero"/>
                    <lit v="true"/>
                  </equal>
                </and>
              </test>
            </when>
          </choose>
          <let>
            <clip pos="2" side="tl" part="nbr"/>
            <clip pos="1" side="tl" part="nbr"/>
          </let>
        </when>
      </choose>
      <choose>
        <when>
          <test>
            <!-- Which is the rule general gender? -->
            <equal>
              <clip pos="1" side="tl" part="gen"/>
              <lit-tag v="m"/>
            </equal>
          </test>
          <let>
            <var n="genero"/>
            <lit-tag v="m"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="1" side="tl" part="gen"/>
              <lit-tag v="f"/>
            </equal>
          </test>
          <let>
            <var n="genero"/>
            <lit-tag v="f"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="2" side="tl" part="gen"/>
              <lit-tag v="m"/>
            </equal>
          </test>
          <let>
            <var n="genero"/>
            <lit-tag v="m"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="2" side="tl" part="gen"/>
              <lit-tag v="f"/>
            </equal>
          </test>
          <let>
            <var n="genero"/>
            <lit-tag v="f"/>
          </let>
        </when>
        <when>
          <test>
            <and>
              <equal>
                <clip pos="1" side="tl" part="gen"/>
                <lit-tag v="mf"/>
              </equal>
              <not>
                <equal>
                  <clip pos="1" side="sl" part="gen"/>
                  <lit-tag v="mf"/>
                </equal>
              </not>
            </and>
          </test>
          <let>
            <var n="genero"/>
            <clip pos="1" side="sl" part="gen"/>
          </let>
        </when>
        <when>
          <test>
            <and>
              <equal>
                <clip pos="2" side="tl" part="gen"/>
                <lit-tag v="mf"/>
              </equal>
              <not>
                <equal>
                  <clip pos="2" side="sl" part="gen"/>
                  <lit-tag v="mf"/>
                </equal>
              </not>
            </and>
          </test>
          <let>
            <var n="genero"/>
            <clip pos="2" side="sl" part="gen"/>
          </let>
        </when>
        <otherwise>
          <let>
            <var n="genero"/>
            <lit-tag v="m"/>
          </let>
        </otherwise>
      </choose>
      <choose>
        <when>
          <!-- Which is the rule general number? -->
          <test>
            <equal>
              <clip pos="1" side="tl" part="nbr"/>
              <lit-tag v="sg"/>
            </equal>
          </test>
          <let>
            <var n="numero"/>
            <lit-tag v="sg"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="1" side="tl" part="nbr"/>
              <lit-tag v="pl"/>
            </equal>
          </test>
          <let>
            <var n="numero"/>
            <lit-tag v="pl"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="2" side="tl" part="nbr"/>
              <lit-tag v="sg"/>
            </equal>
          </test>
          <let>
            <var n="numero"/>
            <lit-tag v="sg"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="2" side="tl" part="nbr"/>
              <lit-tag v="pl"/>
            </equal>
          </test>
          <let>
            <var n="numero"/>
            <lit-tag v="pl"/>
          </let>
        </when>
        <when>
          <test>
            <and>
              <equal>
                <clip pos="1" side="tl" part="nbr"/>
                <lit-tag v="sp"/>
              </equal>
              <not>
                <equal>
                  <clip pos="1" side="sl" part="nbr"/>
                  <lit-tag v="sp"/>
                </equal>
              </not>
            </and>
          </test>
          <let>
            <var n="numero"/>
            <clip pos="1" side="sl" part="nbr"/>
          </let>
        </when>
        <when>
          <test>
            <and>
              <equal>
                <clip pos="2" side="tl" part="nbr"/>
                <lit-tag v="sp"/>
              </equal>
              <not>
                <equal>
                  <clip pos="2" side="sl" part="nbr"/>
                  <lit-tag v="sp"/>
                </equal>
              </not>
            </and>
          </test>
          <let>
            <var n="numero"/>
            <clip pos="2" side="sl" part="nbr"/>
          </let>
        </when>
        <otherwise>
          <let>
            <var n="numero"/>
            <lit-tag v="sg"/>
          </let>
        </otherwise>
      </choose>
      <choose>
        <!-- Determine gender and number value if they are undetermined -->
        <when>
          <test>
            <equal>
              <clip pos="1" side="tl" part="gen"/>
              <lit-tag v="GD"/>
            </equal>
          </test>
          <let>
            <clip pos="1" side="tl" part="gen"/>
            <var n="genero"/>
          </let>
        </when>
      </choose>
      <choose>
        <when>
          <test>
            <equal>
              <clip pos="2" side="tl" part="gen"/>
              <lit-tag v="GD"/>
            </equal>
          </test>
          <let>
            <clip pos="2" side="tl" part="gen"/>
            <var n="genero"/>
          </let>
        </when>
      </choose>
      <choose>
        <when>
          <test>
            <equal>
              <clip pos="1" side="tl" part="nbr"/>
              <lit-tag v="ND"/>
            </equal>
          </test>
          <let>
            <clip pos="1" side="tl" part="nbr"/>
            <var n="numero"/>
          </let>
        </when>
      </choose>
      <choose>
        <when>
          <test>
            <equal>
              <clip pos="2" side="tl" part="nbr"/>
              <lit-tag v="ND"/>
            </equal>
          </test>
          <let>
            <clip pos="2" side="tl" part="nbr"/>
            <var n="numero"/>
          </let>
        </when>
      </choose>
    </def-macro>
    <def-macro n="f_concord3" npar="3">
      <choose>
        <!-- Look if in source language there is concordance between first and second element -->
        <when>
          <test>
            <and>
              <or>
                <equal>
                  <clip pos="2" side="sl" part="gen"/>
                  <clip pos="1" side="sl" part="gen"/>
                </equal>
                <equal>
                  <clip pos="2" side="sl" part="gen"/>
                  <lit-tag v="mf"/>
                </equal>
                <equal>
                  <clip pos="1" side="sl" part="gen"/>
                  <lit-tag v="mf"/>
                </equal>
              </or>
              <or>
                <equal>
                  <clip pos="2" side="sl" part="nbr"/>
                  <clip pos="1" side="sl" part="nbr"/>
                </equal>
                <equal>
                  <clip pos="2" side="sl" part="nbr"/>
                  <lit-tag v="sp"/>
                </equal>
                <equal>
                  <clip pos="1" side="sl" part="nbr"/>
                  <lit-tag v="sp"/>
                </equal>
              </or>
            </and>
          </test>
          <let>
            <var n="concPrimero"/>
            <lit v="true"/>
          </let>
        </when>
        <otherwise>
          <let>
            <var n="concPrimero"/>
            <lit v="false"/>
          </let>
        </otherwise>
      </choose>
      <choose>
        <!-- Look if in source language there is concordance between second and third element -->
        <when>
          <test>
            <and>
              <or>
                <equal>
                  <clip pos="3" side="sl" part="gen"/>
                  <clip pos="1" side="sl" part="gen"/>
                </equal>
                <equal>
                  <clip pos="3" side="sl" part="gen"/>
                  <lit-tag v="mf"/>
                </equal>
                <equal>
                  <clip pos="1" side="sl" part="gen"/>
                  <lit-tag v="mf"/>
                </equal>
              </or>
              <or>
                <equal>
                  <clip pos="3" side="sl" part="nbr"/>
                  <clip pos="1" side="sl" part="nbr"/>
                </equal>
                <equal>
                  <clip pos="3" side="sl" part="nbr"/>
                  <lit-tag v="sp"/>
                </equal>
                <equal>
                  <clip pos="1" side="sl" part="nbr"/>
                  <lit-tag v="sp"/>
                </equal>
              </or>
            </and>
          </test>
          <let>
            <var n="concSegundo"/>
            <lit v="true"/>
          </let>
        </when>
        <otherwise>
          <let>
            <var n="concSegundo"/>
            <lit v="false"/>
          </let>
        </otherwise>
      </choose>
      <choose>
        <!-- Propagate the main parameter gender if it has been modified during the translation -->
        <when>
          <test>
            <and>
              <not>
                <equal>
                  <clip pos="1" side="tl" part="gen"/>
                  <clip pos="1" side="sl" part="gen"/>
                </equal>
              </not>
              <not>
                <equal>
                  <clip pos="1" side="tl" part="gen"/>
                  <lit-tag v="mf"/>
                </equal>
              </not>
              <not>
                <equal>
                  <clip pos="1" side="tl" part="gen"/>
                  <lit-tag v="GD"/>
                </equal>
              </not>
            </and>
          </test>
          <choose>
            <when>
              <test>
                <and>
                  <not>
                    <equal>
                      <clip pos="2" side="tl" part="gen"/>
                      <lit-tag v="mf"/>
                    </equal>
                  </not>
                  <not>
                    <and>
                      <equal>
                        <clip pos="2" side="sl" part="gen"/>
                        <lit-tag v="mf"/>
                      </equal>
                      <not>
                        <equal>
                          <clip pos="2" side="tl" part="gen"/>
                          <lit-tag v="GD"/>
                        </equal>
                      </not>
                    </and>
                  </not>
                  <equal>
                    <var n="concPrimero"/>
                    <lit v="true"/>
                  </equal>
                </and>
              </test>
              <let>
                <clip pos="2" side="tl" part="gen"/>
                <clip pos="1" side="tl" part="gen"/>
              </let>
            </when>
          </choose>
          <choose>
            <when>
              <test>
                <and>
                  <not>
                    <equal>
                      <clip pos="3" side="tl" part="gen"/>
                      <lit-tag v="mf"/>
                    </equal>
                  </not>
                  <not>
                    <and>
                      <equal>
                        <clip pos="3" side="sl" part="gen"/>
                        <lit-tag v="mf"/>
                      </equal>
                      <not>
                        <equal>
                          <clip pos="3" side="tl" part="gen"/>
                          <lit-tag v="GD"/>
                        </equal>
                      </not>
                    </and>
                  </not>
                  <equal>
                    <var n="concSegundo"/>
                    <lit v="true"/>
                  </equal>
                </and>
              </test>
              <let>
                <clip pos="3" side="tl" part="gen"/>
                <clip pos="1" side="tl" part="gen"/>
              </let>
            </when>
          </choose>
        </when>
      </choose>
      <choose>
        <!-- Propagate the main parameter number if it has been modified during the translation -->
        <when>
          <test>
            <and>
              <not>
                <equal>
                  <clip pos="1" side="tl" part="nbr"/>
                  <clip pos="1" side="sl" part="nbr"/>
                </equal>
              </not>
              <not>
                <equal>
                  <clip pos="1" side="tl" part="nbr"/>
                  <lit-tag v="sp"/>
                </equal>
              </not>
              <not>
                <equal>
                  <clip pos="1" side="tl" part="nbr"/>
                  <lit-tag v="ND"/>
                </equal>
              </not>
            </and>
          </test>
          <choose>
            <when>
              <test>
                <and>
                  <not>
                    <equal>
                      <clip pos="2" side="tl" part="nbr"/>
                      <lit-tag v="sp"/>
                    </equal>
                  </not>
                  <not>
                    <and>
                      <equal>
                        <clip pos="2" side="sl" part="nbr"/>
                        <lit-tag v="sp"/>
                      </equal>
                      <not>
                        <equal>
                          <clip pos="2" side="tl" part="nbr"/>
                          <lit-tag v="ND"/>
                        </equal>
                      </not>
                    </and>
                  </not>
                  <equal>
                    <var n="concPrimero"/>
                    <lit v="true"/>
                  </equal>
                </and>
              </test>
              <let>
                <clip pos="2" side="tl" part="nbr"/>
                <clip pos="1" side="tl" part="nbr"/>
              </let>
            </when>
          </choose>
          <choose>
            <when>
              <test>
                <and>
                  <not>
                    <equal>
                      <clip pos="3" side="tl" part="nbr"/>
                      <lit-tag v="sp"/>
                    </equal>
                  </not>
                  <not>
                    <and>
                      <equal>
                        <clip pos="3" side="sl" part="nbr"/>
                        <lit-tag v="sp"/>
                      </equal>
                      <not>
                        <equal>
                          <clip pos="3" side="tl" part="nbr"/>
                          <lit-tag v="ND"/>
                        </equal>
                      </not>
                    </and>
                  </not>
                  <equal>
                    <var n="concSegundo"/>
                    <lit v="true"/>
                  </equal>
                </and>
              </test>
              <let>
                <clip pos="3" side="tl" part="nbr"/>
                <clip pos="1" side="tl" part="nbr"/>
              </let>
            </when>
          </choose>
        </when>
      </choose>
      <choose>
        <!-- Determine the rule general gender. Priority order: main, second and third element -->
        <when>
          <test>
            <equal>
              <clip pos="1" side="tl" part="gen"/>
              <lit-tag v="m"/>
            </equal>
          </test>
          <let>
            <var n="genero"/>
            <lit-tag v="m"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="1" side="tl" part="gen"/>
              <lit-tag v="f"/>
            </equal>
          </test>
          <let>
            <var n="genero"/>
            <lit-tag v="f"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="2" side="tl" part="gen"/>
              <lit-tag v="m"/>
            </equal>
          </test>
          <let>
            <var n="genero"/>
            <lit-tag v="m"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="2" side="tl" part="gen"/>
              <lit-tag v="f"/>
            </equal>
          </test>
          <let>
            <var n="genero"/>
            <lit-tag v="f"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="3" side="tl" part="gen"/>
              <lit-tag v="m"/>
            </equal>
          </test>
          <let>
            <var n="genero"/>
            <lit-tag v="m"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="3" side="tl" part="gen"/>
              <lit-tag v="f"/>
            </equal>
          </test>
          <let>
            <var n="genero"/>
            <lit-tag v="f"/>
          </let>
        </when>
        <when>
          <test>
            <and>
              <equal>
                <clip pos="1" side="tl" part="gen"/>
                <lit-tag v="mf"/>
              </equal>
              <not>
                <equal>
                  <clip pos="1" side="sl" part="gen"/>
                  <lit-tag v="mf"/>
                </equal>
              </not>
            </and>
          </test>
          <let>
            <var n="genero"/>
            <clip pos="1" side="sl" part="gen"/>
          </let>
        </when>
        <when>
          <test>
            <and>
              <equal>
                <clip pos="2" side="tl" part="gen"/>
                <lit-tag v="mf"/>
              </equal>
              <not>
                <equal>
                  <clip pos="2" side="sl" part="gen"/>
                  <lit-tag v="mf"/>
                </equal>
              </not>
            </and>
          </test>
          <let>
            <var n="genero"/>
            <clip pos="2" side="sl" part="gen"/>
          </let>
        </when>
        <when>
          <test>
            <and>
              <equal>
                <clip pos="3" side="tl" part="gen"/>
                <lit-tag v="mf"/>
              </equal>
              <not>
                <equal>
                  <clip pos="3" side="sl" part="gen"/>
                  <lit-tag v="mf"/>
                </equal>
              </not>
            </and>
          </test>
          <let>
            <var n="genero"/>
            <clip pos="3" side="sl" part="gen"/>
          </let>
        </when>
        <otherwise>
          <let>
            <var n="genero"/>
            <lit-tag v="m"/>
          </let>
        </otherwise>
      </choose>
      <choose>
        <!-- Determine the rule general number. Priority order: main, second and third element -->
        <when>
          <test>
            <equal>
              <clip pos="1" side="tl" part="nbr"/>
              <lit-tag v="sg"/>
            </equal>
          </test>
          <let>
            <var n="numero"/>
            <lit-tag v="sg"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="1" side="tl" part="nbr"/>
              <lit-tag v="pl"/>
            </equal>
          </test>
          <let>
            <var n="numero"/>
            <lit-tag v="pl"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="2" side="tl" part="nbr"/>
              <lit-tag v="sg"/>
            </equal>
          </test>
          <let>
            <var n="numero"/>
            <lit-tag v="sg"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="2" side="tl" part="nbr"/>
              <lit-tag v="pl"/>
            </equal>
          </test>
          <let>
            <var n="numero"/>
            <lit-tag v="pl"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="3" side="tl" part="nbr"/>
              <lit-tag v="sg"/>
            </equal>
          </test>
          <let>
            <var n="numero"/>
            <lit-tag v="sg"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="3" side="tl" part="nbr"/>
              <lit-tag v="pl"/>
            </equal>
          </test>
          <let>
            <var n="numero"/>
            <lit-tag v="pl"/>
          </let>
        </when>
        <when>
          <test>
            <and>
              <equal>
                <clip pos="1" side="tl" part="nbr"/>
                <lit-tag v="sp"/>
              </equal>
              <not>
                <equal>
                  <clip pos="1" side="sl" part="nbr"/>
                  <lit-tag v="sp"/>
                </equal>
              </not>
            </and>
          </test>
          <let>
            <var n="numero"/>
            <clip pos="1" side="sl" part="nbr"/>
          </let>
        </when>
        <when>
          <test>
            <and>
              <equal>
                <clip pos="2" side="tl" part="nbr"/>
                <lit-tag v="sp"/>
              </equal>
              <not>
                <equal>
                  <clip pos="2" side="sl" part="nbr"/>
                  <lit-tag v="sp"/>
                </equal>
              </not>
            </and>
          </test>
          <let>
            <var n="numero"/>
            <clip pos="2" side="sl" part="nbr"/>
          </let>
        </when>
        <when>
          <test>
            <and>
              <equal>
                <clip pos="3" side="tl" part="nbr"/>
                <lit-tag v="sp"/>
              </equal>
              <not>
                <equal>
                  <clip pos="3" side="sl" part="nbr"/>
                  <lit-tag v="sp"/>
                </equal>
              </not>
            </and>
          </test>
          <let>
            <var n="numero"/>
            <clip pos="3" side="sl" part="nbr"/>
          </let>
        </when>
        <otherwise>
          <let>
            <var n="numero"/>
            <lit-tag v="sg"/>
          </let>
        </otherwise>
      </choose>
      <choose>
        <!-- Assign values to GD and ND -->
        <when>
          <test>
            <equal>
              <clip pos="1" side="tl" part="gen"/>
              <lit-tag v="GD"/>
            </equal>
          </test>
          <let>
            <clip pos="1" side="tl" part="gen"/>
            <var n="genero"/>
          </let>
        </when>
      </choose>
      <choose>
        <when>
          <test>
            <equal>
              <clip pos="2" side="tl" part="gen"/>
              <lit-tag v="GD"/>
            </equal>
          </test>
          <let>
            <clip pos="2" side="tl" part="gen"/>
            <var n="genero"/>
          </let>
        </when>
      </choose>
      <choose>
        <when>
          <test>
            <equal>
              <clip pos="3" side="tl" part="gen"/>
              <lit-tag v="GD"/>
            </equal>
          </test>
          <let>
            <clip pos="3" side="tl" part="gen"/>
            <var n="genero"/>
          </let>
        </when>
      </choose>
      <choose>
        <when>
          <test>
            <equal>
              <clip pos="1" side="tl" part="nbr"/>
              <lit-tag v="ND"/>
            </equal>
          </test>
          <let>
            <clip pos="1" side="tl" part="nbr"/>
            <var n="numero"/>
          </let>
        </when>
      </choose>
      <choose>
        <when>
          <test>
            <equal>
              <clip pos="2" side="tl" part="nbr"/>
              <lit-tag v="ND"/>
            </equal>
          </test>
          <let>
            <clip pos="2" side="tl" part="nbr"/>
            <var n="numero"/>
          </let>
        </when>
      </choose>
      <choose>
        <when>
          <test>
            <equal>
              <clip pos="3" side="tl" part="nbr"/>
              <lit-tag v="ND"/>
            </equal>
          </test>
          <let>
            <clip pos="3" side="tl" part="nbr"/>
            <var n="numero"/>
          </let>
        </when>
      </choose>
    </def-macro>
    <def-macro n="f_concord4" npar="4">
      <choose>
        <when>
          <test>
            <and>
              <or>
                <equal>
                  <clip pos="2" side="sl" part="gen"/>
                  <clip pos="1" side="sl" part="gen"/>
                </equal>
                <equal>
                  <clip pos="2" side="sl" part="gen"/>
                  <lit-tag v="mf"/>
                </equal>
                <equal>
                  <clip pos="1" side="sl" part="gen"/>
                  <lit-tag v="mf"/>
                </equal>
              </or>
              <or>
                <equal>
                  <clip pos="2" side="sl" part="nbr"/>
                  <clip pos="1" side="sl" part="nbr"/>
                </equal>
                <equal>
                  <clip pos="2" side="sl" part="nbr"/>
                  <lit-tag v="sp"/>
                </equal>
                <equal>
                  <clip pos="1" side="sl" part="nbr"/>
                  <lit-tag v="sp"/>
                </equal>
              </or>
            </and>
          </test>
          <let>
            <var n="concPrimero"/>
            <lit v="true"/>
          </let>
        </when>
        <otherwise>
          <let>
            <var n="concPrimero"/>
            <lit v="false"/>
          </let>
        </otherwise>
      </choose>
      <choose>
        <when>
          <test>
            <and>
              <or>
                <equal>
                  <clip pos="3" side="sl" part="gen"/>
                  <clip pos="1" side="sl" part="gen"/>
                </equal>
                <equal>
                  <clip pos="3" side="sl" part="gen"/>
                  <lit-tag v="mf"/>
                </equal>
                <equal>
                  <clip pos="1" side="sl" part="gen"/>
                  <lit-tag v="mf"/>
                </equal>
              </or>
              <or>
                <equal>
                  <clip pos="3" side="sl" part="nbr"/>
                  <clip pos="1" side="sl" part="nbr"/>
                </equal>
                <equal>
                  <clip pos="3" side="sl" part="nbr"/>
                  <lit-tag v="sp"/>
                </equal>
                <equal>
                  <clip pos="1" side="sl" part="nbr"/>
                  <lit-tag v="sp"/>
                </equal>
              </or>
            </and>
          </test>
          <let>
            <var n="concSegundo"/>
            <lit v="true"/>
          </let>
        </when>
        <otherwise>
          <let>
            <var n="concSegundo"/>
            <lit v="false"/>
          </let>
        </otherwise>
      </choose>
      <choose>
        <when>
          <test>
            <and>
              <or>
                <equal>
                  <clip pos="4" side="sl" part="gen"/>
                  <clip pos="1" side="sl" part="gen"/>
                </equal>
                <equal>
                  <clip pos="4" side="sl" part="gen"/>
                  <lit-tag v="mf"/>
                </equal>
                <equal>
                  <clip pos="1" side="sl" part="gen"/>
                  <lit-tag v="mf"/>
                </equal>
              </or>
              <or>
                <equal>
                  <clip pos="4" side="sl" part="nbr"/>
                  <clip pos="1" side="sl" part="nbr"/>
                </equal>
                <equal>
                  <clip pos="4" side="sl" part="nbr"/>
                  <lit-tag v="sp"/>
                </equal>
                <equal>
                  <clip pos="1" side="sl" part="nbr"/>
                  <lit-tag v="sp"/>
                </equal>
              </or>
            </and>
          </test>
          <let>
            <var n="concTercero"/>
            <lit v="true"/>
          </let>
        </when>
        <otherwise>
          <let>
            <var n="concTercero"/>
            <lit v="false"/>
          </let>
        </otherwise>
      </choose>
      <choose>
        <when>
          <test>
            <and>
              <not>
                <equal>
                  <clip pos="1" side="tl" part="gen"/>
                  <clip pos="1" side="sl" part="gen"/>
                </equal>
              </not>
              <not>
                <equal>
                  <clip pos="1" side="tl" part="gen"/>
                  <lit-tag v="mf"/>
                </equal>
              </not>
              <not>
                <equal>
                  <clip pos="1" side="tl" part="gen"/>
                  <lit-tag v="GD"/>
                </equal>
              </not>
            </and>
          </test>
          <choose>
            <when>
              <test>
                <and>
                  <not>
                    <equal>
                      <clip pos="2" side="tl" part="gen"/>
                      <lit-tag v="mf"/>
                    </equal>
                  </not>
                  <not>
                    <and>
                      <equal>
                        <clip pos="2" side="sl" part="gen"/>
                        <lit-tag v="mf"/>
                      </equal>
                      <not>
                        <equal>
                          <clip pos="2" side="tl" part="gen"/>
                          <lit-tag v="GD"/>
                        </equal>
                      </not>
                    </and>
                  </not>
                  <equal>
                    <var n="concPrimero"/>
                    <lit v="true"/>
                  </equal>
                </and>
              </test>
              <let>
                <clip pos="2" side="tl" part="gen"/>
                <clip pos="1" side="tl" part="gen"/>
              </let>
            </when>
          </choose>
          <choose>
            <when>
              <test>
                <and>
                  <not>
                    <equal>
                      <clip pos="3" side="tl" part="gen"/>
                      <lit-tag v="mf"/>
                    </equal>
                  </not>
                  <not>
                    <and>
                      <equal>
                        <clip pos="3" side="sl" part="gen"/>
                        <lit-tag v="mf"/>
                      </equal>
                      <not>
                        <equal>
                          <clip pos="3" side="tl" part="gen"/>
                          <lit-tag v="GD"/>
                        </equal>
                      </not>
                    </and>
                  </not>
                  <equal>
                    <var n="concSegundo"/>
                    <lit v="true"/>
                  </equal>
                </and>
              </test>
              <let>
                <clip pos="3" side="tl" part="gen"/>
                <clip pos="1" side="tl" part="gen"/>
              </let>
            </when>
          </choose>
          <choose>
            <when>
              <test>
                <and>
                  <not>
                    <equal>
                      <clip pos="4" side="tl" part="gen"/>
                      <lit-tag v="mf"/>
                    </equal>
                  </not>
                  <not>
                    <and>
                      <equal>
                        <clip pos="4" side="sl" part="gen"/>
                        <lit-tag v="mf"/>
                      </equal>
                      <not>
                        <equal>
                          <clip pos="4" side="tl" part="gen"/>
                          <lit-tag v="GD"/>
                        </equal>
                      </not>
                    </and>
                  </not>
                  <equal>
                    <var n="concTercero"/>
                    <lit v="true"/>
                  </equal>
                </and>
              </test>
              <let>
                <clip pos="4" side="tl" part="gen"/>
                <clip pos="1" side="tl" part="gen"/>
              </let>
            </when>
          </choose>
        </when>
      </choose>
      <choose>
        <when>
          <test>
            <and>
              <not>
                <equal>
                  <clip pos="1" side="tl" part="nbr"/>
                  <clip pos="1" side="sl" part="nbr"/>
                </equal>
              </not>
              <not>
                <equal>
                  <clip pos="1" side="tl" part="nbr"/>
                  <lit-tag v="sp"/>
                </equal>
              </not>
              <not>
                <equal>
                  <clip pos="1" side="tl" part="nbr"/>
                  <lit-tag v="ND"/>
                </equal>
              </not>
            </and>
          </test>
          <choose>
            <when>
              <test>
                <and>
                  <not>
                    <equal>
                      <clip pos="2" side="tl" part="nbr"/>
                      <lit-tag v="sp"/>
                    </equal>
                  </not>
                  <not>
                    <and>
                      <equal>
                        <clip pos="2" side="sl" part="nbr"/>
                        <lit-tag v="sp"/>
                      </equal>
                      <not>
                        <equal>
                          <clip pos="2" side="tl" part="nbr"/>
                          <lit-tag v="ND"/>
                        </equal>
                      </not>
                    </and>
                  </not>
                  <equal>
                    <var n="concPrimero"/>
                    <lit v="true"/>
                  </equal>
                </and>
              </test>
              <let>
                <clip pos="2" side="tl" part="nbr"/>
                <clip pos="1" side="tl" part="nbr"/>
              </let>
            </when>
          </choose>
          <choose>
            <when>
              <test>
                <and>
                  <not>
                    <equal>
                      <clip pos="3" side="tl" part="nbr"/>
                      <lit-tag v="sp"/>
                    </equal>
                  </not>
                  <not>
                    <and>
                      <equal>
                        <clip pos="3" side="sl" part="nbr"/>
                        <lit-tag v="sp"/>
                      </equal>
                      <not>
                        <equal>
                          <clip pos="3" side="tl" part="nbr"/>
                          <lit-tag v="ND"/>
                        </equal>
                      </not>
                    </and>
                  </not>
                  <equal>
                    <var n="concSegundo"/>
                    <lit v="true"/>
                  </equal>
                </and>
              </test>
              <let>
                <clip pos="3" side="tl" part="nbr"/>
                <clip pos="1" side="tl" part="nbr"/>
              </let>
            </when>
          </choose>
          <choose>
            <when>
              <test>
                <and>
                  <not>
                    <equal>
                      <clip pos="4" side="tl" part="nbr"/>
                      <lit-tag v="sp"/>
                    </equal>
                  </not>
                  <not>
                    <and>
                      <equal>
                        <clip pos="4" side="sl" part="nbr"/>
                        <lit-tag v="sp"/>
                      </equal>
                      <not>
                        <equal>
                          <clip pos="4" side="tl" part="nbr"/>
                          <lit-tag v="ND"/>
                        </equal>
                      </not>
                    </and>
                  </not>
                  <equal>
                    <var n="concTercero"/>
                    <lit v="true"/>
                  </equal>
                </and>
              </test>
              <let>
                <clip pos="4" side="tl" part="nbr"/>
                <clip pos="1" side="tl" part="nbr"/>
              </let>
            </when>
          </choose>
        </when>
      </choose>
      <choose>
        <when>
          <test>
            <equal>
              <clip pos="1" side="tl" part="gen"/>
              <lit-tag v="m"/>
            </equal>
          </test>
          <let>
            <var n="genero"/>
            <lit-tag v="m"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="1" side="tl" part="gen"/>
              <lit-tag v="f"/>
            </equal>
          </test>
          <let>
            <var n="genero"/>
            <lit-tag v="f"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="2" side="tl" part="gen"/>
              <lit-tag v="m"/>
            </equal>
          </test>
          <let>
            <var n="genero"/>
            <lit-tag v="m"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="2" side="tl" part="gen"/>
              <lit-tag v="f"/>
            </equal>
          </test>
          <let>
            <var n="genero"/>
            <lit-tag v="f"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="3" side="tl" part="gen"/>
              <lit-tag v="m"/>
            </equal>
          </test>
          <let>
            <var n="genero"/>
            <lit-tag v="m"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="3" side="tl" part="gen"/>
              <lit-tag v="f"/>
            </equal>
          </test>
          <let>
            <var n="genero"/>
            <lit-tag v="f"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="4" side="tl" part="gen"/>
              <lit-tag v="m"/>
            </equal>
          </test>
          <let>
            <var n="genero"/>
            <lit-tag v="m"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="4" side="tl" part="gen"/>
              <lit-tag v="f"/>
            </equal>
          </test>
          <let>
            <var n="genero"/>
            <lit-tag v="f"/>
          </let>
        </when>
        <otherwise>
          <let>
            <var n="genero"/>
            <lit-tag v="m"/>
          </let>
        </otherwise>
      </choose>
      <choose>
        <when>
          <test>
            <equal>
              <clip pos="1" side="tl" part="nbr"/>
              <lit-tag v="sg"/>
            </equal>
          </test>
          <let>
            <var n="numero"/>
            <lit-tag v="sg"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="1" side="tl" part="nbr"/>
              <lit-tag v="pl"/>
            </equal>
          </test>
          <let>
            <var n="numero"/>
            <lit-tag v="pl"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="2" side="tl" part="nbr"/>
              <lit-tag v="sg"/>
            </equal>
          </test>
          <let>
            <var n="numero"/>
            <lit-tag v="sg"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="2" side="tl" part="nbr"/>
              <lit-tag v="pl"/>
            </equal>
          </test>
          <let>
            <var n="numero"/>
            <lit-tag v="pl"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="3" side="tl" part="nbr"/>
              <lit-tag v="sg"/>
            </equal>
          </test>
          <let>
            <var n="numero"/>
            <lit-tag v="sg"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="3" side="tl" part="nbr"/>
              <lit-tag v="pl"/>
            </equal>
          </test>
          <let>
            <var n="numero"/>
            <lit-tag v="pl"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="4" side="tl" part="nbr"/>
              <lit-tag v="sg"/>
            </equal>
          </test>
          <let>
            <var n="numero"/>
            <lit-tag v="sg"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="4" side="tl" part="nbr"/>
              <lit-tag v="pl"/>
            </equal>
          </test>
          <let>
            <var n="numero"/>
            <lit-tag v="pl"/>
          </let>
        </when>
        <otherwise>
          <let>
            <var n="numero"/>
            <lit-tag v="sg"/>
          </let>
        </otherwise>
      </choose>
      <choose>
        <when>
          <test>
            <equal>
              <clip pos="1" side="tl" part="gen"/>
              <lit-tag v="GD"/>
            </equal>
          </test>
          <let>
            <clip pos="1" side="tl" part="gen"/>
            <var n="genero"/>
          </let>
        </when>
      </choose>
      <choose>
        <when>
          <test>
            <equal>
              <clip pos="2" side="tl" part="gen"/>
              <lit-tag v="GD"/>
            </equal>
          </test>
          <let>
            <clip pos="2" side="tl" part="gen"/>
            <var n="genero"/>
          </let>
        </when>
      </choose>
      <choose>
        <when>
          <test>
            <equal>
              <clip pos="3" side="tl" part="gen"/>
              <lit-tag v="GD"/>
            </equal>
          </test>
          <let>
            <clip pos="3" side="tl" part="gen"/>
            <var n="genero"/>
          </let>
        </when>
      </choose>
      <choose>
        <when>
          <test>
            <equal>
              <clip pos="4" side="tl" part="gen"/>
              <lit-tag v="GD"/>
            </equal>
          </test>
          <let>
            <clip pos="4" side="tl" part="gen"/>
            <var n="genero"/>
          </let>
        </when>
      </choose>
      <choose>
        <when>
          <test>
            <equal>
              <clip pos="1" side="tl" part="nbr"/>
              <lit-tag v="ND"/>
            </equal>
          </test>
          <let>
            <clip pos="1" side="tl" part="nbr"/>
            <var n="numero"/>
          </let>
        </when>
      </choose>
      <choose>
        <when>
          <test>
            <equal>
              <clip pos="2" side="tl" part="nbr"/>
              <lit-tag v="ND"/>
            </equal>
          </test>
          <let>
            <clip pos="2" side="tl" part="nbr"/>
            <var n="numero"/>
          </let>
        </when>
      </choose>
      <choose>
        <when>
          <test>
            <equal>
              <clip pos="3" side="tl" part="nbr"/>
              <lit-tag v="ND"/>
            </equal>
          </test>
          <let>
            <clip pos="3" side="tl" part="nbr"/>
            <var n="numero"/>
          </let>
        </when>
      </choose>
      <choose>
        <when>
          <test>
            <equal>
              <clip pos="4" side="tl" part="nbr"/>
              <lit-tag v="ND"/>
            </equal>
          </test>
          <let>
            <clip pos="4" side="tl" part="nbr"/>
            <var n="numero"/>
          </let>
        </when>
      </choose>
    </def-macro>
  </section-def-macros>
  <section-rules>
    <rule>
      <!-- REGLA 0: DETERMINANT -->
      <pattern>
        <pattern-item n="det"/>
      </pattern>
      <action>
        <call-macro n="f_concord1">
          <with-param pos="1"/>
        </call-macro>
        <out>
          <lu>
            <clip pos="1" side="tl" part="lem"/>
            <clip pos="1" side="tl" part="a_det"/>
            <clip pos="1" side="tl" part="gen"/>
            <clip pos="1" side="tl" part="nbr"/>
          </lu>
        </out>
      </action>
    </rule>
    <rule>
      <!-- REGLA 1: NOM -->
      <pattern>
        <pattern-item n="nom"/>
      </pattern>
      <action>
        <call-macro n="f_concord1">
          <with-param pos="1"/>
        </call-macro>
        <out>
          <lu>
            <clip pos="1" side="tl" part="lem"/>
            <clip pos="1" side="tl" part="a_nom"/>
            <clip pos="1" side="tl" part="gen"/>
            <clip pos="1" side="tl" part="nbr"/>
          </lu>
        </out>
      </action>
    </rule>
    <rule>
      <!-- REGLA 2: ADJECTIU -->
      <pattern>
        <pattern-item n="adj"/>
      </pattern>
      <action>
        <call-macro n="f_concord1">
          <with-param pos="1"/>
        </call-macro>
        <out>
          <lu>
            <clip pos="1" side="tl" part="lem"/>
            <clip pos="1" side="tl" part="a_adj"/>
            <clip pos="1" side="tl" part="gen"/>
            <clip pos="1" side="tl" part="nbr"/>
          </lu>
        </out>
      </action>
    </rule>
    <rule>
      <!-- REGLA 3: PRONOM -->
      <!--Special case, macro f_concord1 
                  is not applicable because gender and number cannot be taken from previous rules -->
      <pattern>
        <pattern-item n="prn"/>
      </pattern>
      <action>
        <choose>
          <when>
            <test>
              <equal>
                <clip pos="1" side="tl" part="gen"/>
                <lit-tag v="GD"/>
              </equal>
            </test>
            <let>
              <clip pos="1" side="tl" part="gen"/>
              <lit-tag v="m"/>
            </let>
          </when>
          <when>
            <test>
              <equal>
                <clip pos="1" side="tl" part="nbr"/>
                <lit-tag v="ND"/>
              </equal>
            </test>
            <let>
              <clip pos="1" side="tl" part="nbr"/>
              <lit-tag v="sg"/>
            </let>
          </when>
        </choose>
        <out>
          <lu>
            <clip pos="1" side="tl" part="lem"/>
            <clip pos="1" side="tl" part="a_prn"/>
            <clip pos="1" side="tl" part="gen"/>
            <clip pos="1" side="tl" part="nbr"/>
          </lu>
        </out>
      </action>
    </rule>
    <rule>
      <!-- REGLA 1: NUMERAL-->
      <pattern>
        <pattern-item n="num"/>
      </pattern>
      <action>
        <call-macro n="f_concord1">
          <with-param pos="1"/>
        </call-macro>
        <out>
          <lu>
            <clip pos="1" side="tl" part="lem"/>
            <clip pos="1" side="tl" part="a_num"/>
            <clip pos="1" side="tl" part="gen"/>
            <clip pos="1" side="tl" part="nbr"/>
          </lu>
        </out>
      </action>
    </rule>
    <rule>
      <!-- REGLA 4: DETERMINANT NOM -->
      <pattern>
        <pattern-item n="det"/>
        <pattern-item n="nom"/>
      </pattern>
      <action>
        <call-macro n="f_concord2">
          <with-param pos="2"/>
          <with-param pos="1"/>
        </call-macro>
        <out>
          <lu>
            <clip pos="1" side="tl" part="lem"/>
            <clip pos="1" side="tl" part="a_det"/>
            <clip pos="1" side="tl" part="gen"/>
            <clip pos="1" side="tl" part="nbr"/>
          </lu>
          <b pos="1"/>
          <lu>
            <clip pos="2" side="tl" part="lem"/>
            <clip pos="2" side="tl" part="a_nom"/>
            <clip pos="2" side="tl" part="gen"/>
            <clip pos="2" side="tl" part="nbr"/>
          </lu>
        </out>
      </action>
    </rule>
    <rule>
      <!-- REGLA 5: NOM ADJECTIU-->
      <pattern>
        <pattern-item n="nom"/>
        <pattern-item n="adjec"/>
      </pattern>
      <action>
        <call-macro n="f_concord2">
          <with-param pos="1"/>
          <with-param pos="2"/>
        </call-macro>
        <out>
          <lu>
            <clip pos="1" side="tl" part="lem"/>
            <clip pos="1" side="tl" part="a_nom"/>
            <clip pos="1" side="tl" part="gen"/>
            <clip pos="1" side="tl" part="nbr"/>
          </lu>
          <b pos="1"/>
          <lu>
            <clip pos="2" side="tl" part="lem"/>
            <clip pos="2" side="tl" part="a_adjec"/>
            <clip pos="2" side="tl" part="gen"/>
            <clip pos="2" side="tl" part="nbr"/>
          </lu>
        </out>
      </action>
    </rule>
    <rule>
      <!-- REGLA 6: ADJECTIU NOM -->
      <pattern>
        <pattern-item n="adj"/>
        <pattern-item n="nom"/>
      </pattern>
      <action>
        <call-macro n="f_concord2">
          <with-param pos="2"/>
          <with-param pos="1"/>
        </call-macro>
        <out>
          <lu>
            <clip pos="1" side="tl" part="lem"/>
            <clip pos="1" side="tl" part="a_adj"/>
            <clip pos="1" side="tl" part="gen"/>
            <clip pos="1" side="tl" part="nbr"/>
          </lu>
          <b pos="1"/>
          <lu>
            <clip pos="2" side="tl" part="lem"/>
            <clip pos="2" side="tl" part="a_nom"/>
            <clip pos="2" side="tl" part="gen"/>
            <clip pos="2" side="tl" part="nbr"/>
          </lu>
        </out>
      </action>
    </rule>
    <rule>
      <!-- REGLA 7: DET NOM ADJECTIU-->
      <pattern>
        <pattern-item n="det"/>
        <pattern-item n="nom"/>
        <pattern-item n="adjec"/>
      </pattern>
      <action>
        <call-macro n="f_concord3">
          <with-param pos="2"/>
          <with-param pos="3"/>
          <with-param pos="1"/>
        </call-macro>
        <out>
          <lu>
            <clip pos="1" side="tl" part="lem"/>
            <clip pos="1" side="tl" part="a_det"/>
            <clip pos="1" side="tl" part="gen"/>
            <clip pos="1" side="tl" part="nbr"/>
          </lu>
          <b pos="1"/>
          <lu>
            <clip pos="2" side="tl" part="lem"/>
            <clip pos="2" side="tl" part="a_nom"/>
            <clip pos="2" side="tl" part="gen"/>
            <clip pos="2" side="tl" part="nbr"/>
          </lu>
          <b pos="2"/>
          <lu>
            <clip pos="3" side="tl" part="lem"/>
            <clip pos="3" side="tl" part="a_adjec"/>
            <clip pos="3" side="tl" part="gen"/>
            <clip pos="3" side="tl" part="nbr"/>
          </lu>
        </out>
      </action>
    </rule>
    <rule>
      <!-- REGLA 8: DET ADJECTIU NOM-->
      <pattern>
        <pattern-item n="det"/>
        <pattern-item n="adjec"/>
        <pattern-item n="nom"/>
      </pattern>
      <action>
        <call-macro n="f_concord3">
          <with-param pos="3"/>
          <with-param pos="2"/>
          <with-param pos="1"/>
        </call-macro>
        <out>
          <lu>
            <clip pos="1" side="tl" part="lem"/>
            <clip pos="1" side="tl" part="a_det"/>
            <clip pos="1" side="tl" part="gen"/>
            <clip pos="1" side="tl" part="nbr"/>
          </lu>
          <b pos="1"/>
          <lu>
            <clip pos="2" side="tl" part="lem"/>
            <clip pos="2" side="tl" part="a_adjec"/>
            <clip pos="2" side="tl" part="gen"/>
            <clip pos="2" side="tl" part="nbr"/>
          </lu>
          <b pos="2"/>
          <lu>
            <clip pos="3" side="tl" part="lem"/>
            <clip pos="3" side="tl" part="a_nom"/>
            <clip pos="3" side="tl" part="gen"/>
            <clip pos="3" side="tl" part="nbr"/>
          </lu>
        </out>
      </action>
    </rule>
    <rule>
      <!-- REGLA 9: PREDET DET NOM-->
      <pattern>
        <pattern-item n="predet"/>
        <pattern-item n="det"/>
        <pattern-item n="nom"/>
      </pattern>
      <action>
        <call-macro n="f_concord3">
          <with-param pos="3"/>
          <with-param pos="2"/>
          <with-param pos="1"/>
        </call-macro>
        <out>
          <lu>
            <clip pos="1" side="tl" part="lem"/>
            <clip pos="1" side="tl" part="a_predet"/>
            <clip pos="1" side="tl" part="gen"/>
            <clip pos="1" side="tl" part="nbr"/>
          </lu>
          <b pos="1"/>
          <lu>
            <clip pos="2" side="tl" part="lem"/>
            <clip pos="2" side="tl" part="a_det"/>
            <clip pos="2" side="tl" part="gen"/>
            <clip pos="2" side="tl" part="nbr"/>
          </lu>
          <b pos="2"/>
          <lu>
            <clip pos="3" side="tl" part="lem"/>
            <clip pos="3" side="tl" part="a_nom"/>
            <clip pos="3" side="tl" part="gen"/>
            <clip pos="3" side="tl" part="nbr"/>
          </lu>
        </out>
      </action>
    </rule>
    <rule>
      <!-- REGLA 9: PREDET DET NOM ADJECTIU-->
      <pattern>
        <pattern-item n="predet"/>
        <pattern-item n="det"/>
        <pattern-item n="nom"/>
        <pattern-item n="adjec"/>
      </pattern>
      <action>
        <call-macro n="f_concord4">
          <with-param pos="3"/>
          <with-param pos="4"/>
          <with-param pos="2"/>
          <with-param pos="1"/>
        </call-macro>
        <out>
          <lu>
            <clip pos="1" side="tl" part="lem"/>
            <clip pos="1" side="tl" part="a_predet"/>
            <clip pos="1" side="tl" part="gen"/>
            <clip pos="1" side="tl" part="nbr"/>
          </lu>
          <b pos="1"/>
          <lu>
            <clip pos="2" side="tl" part="lem"/>
            <clip pos="2" side="tl" part="a_det"/>
            <clip pos="2" side="tl" part="gen"/>
            <clip pos="2" side="tl" part="nbr"/>
          </lu>
          <b pos="2"/>
          <lu>
            <clip pos="3" side="tl" part="lem"/>
            <clip pos="3" side="tl" part="a_nom"/>
            <clip pos="3" side="tl" part="gen"/>
            <clip pos="3" side="tl" part="nbr"/>
          </lu>
          <b pos="3"/>
          <lu>
            <clip pos="4" side="tl" part="lem"/>
            <clip pos="4" side="tl" part="a_adjec"/>
            <clip pos="4" side="tl" part="gen"/>
            <clip pos="4" side="tl" part="nbr"/>
          </lu>
        </out>
      </action>
    </rule>
    <rule>
      <!-- REGLA 10: DETERMINANT ADJECTIU-->
      <pattern>
        <pattern-item n="det"/>
        <pattern-item n="adjec"/>
      </pattern>
      <action>
        <call-macro n="f_concord2">
          <with-param pos="2"/>
          <with-param pos="1"/>
        </call-macro>
        <out>
          <lu>
            <clip pos="1" side="tl" part="lem"/>
            <clip pos="1" side="tl" part="a_det"/>
            <clip pos="1" side="tl" part="gen"/>
            <clip pos="1" side="tl" part="nbr"/>
          </lu>
          <b pos="1"/>
          <lu>
            <clip pos="2" side="tl" part="lem"/>
            <clip pos="2" side="tl" part="a_adjec"/>
            <clip pos="2" side="tl" part="gen"/>
            <clip pos="2" side="tl" part="nbr"/>
          </lu>
        </out>
      </action>
    </rule>
    <rule>
      <!-- REGLA 11: ADJECTIU NOM ADJECTIU-->
      <pattern>
        <pattern-item n="adj"/>
        <pattern-item n="nom"/>
        <pattern-item n="adjec"/>
      </pattern>
      <action>
        <call-macro n="f_concord3">
          <with-param pos="2"/>
          <with-param pos="3"/>
          <with-param pos="1"/>
        </call-macro>
        <out>
          <lu>
            <clip pos="1" side="tl" part="lem"/>
            <clip pos="1" side="tl" part="a_adj"/>
            <clip pos="1" side="tl" part="gen"/>
            <clip pos="1" side="tl" part="nbr"/>
          </lu>
          <b pos="1"/>
          <lu>
            <clip pos="2" side="tl" part="lem"/>
            <clip pos="2" side="tl" part="a_nom"/>
            <clip pos="2" side="tl" part="gen"/>
            <clip pos="2" side="tl" part="nbr"/>
          </lu>
          <b pos="2"/>
          <lu>
            <clip pos="3" side="tl" part="lem"/>
            <clip pos="3" side="tl" part="a_adjec"/>
            <clip pos="3" side="tl" part="gen"/>
            <clip pos="3" side="tl" part="nbr"/>
          </lu>
        </out>
      </action>
    </rule>
    <rule>
      <!-- REGLA 12: DET ADJECTIU NOM ADJECTIU -->
      <pattern>
        <pattern-item n="det"/>
        <pattern-item n="adjec"/>
        <pattern-item n="nom"/>
        <pattern-item n="adjec"/>
      </pattern>
      <action>
        <call-macro n="f_concord4">
          <with-param pos="3"/>
          <with-param pos="4"/>
          <with-param pos="2"/>
          <with-param pos="1"/>
        </call-macro>
        <out>
          <lu>
            <clip pos="1" side="tl" part="lem"/>
            <clip pos="1" side="tl" part="a_det"/>
            <clip pos="1" side="tl" part="gen"/>
            <clip pos="1" side="tl" part="nbr"/>
          </lu>
          <b pos="1"/>
          <lu>
            <clip pos="2" side="tl" part="lem"/>
            <clip pos="2" side="tl" part="a_adjec"/>
            <clip pos="2" side="tl" part="gen"/>
            <clip pos="2" side="tl" part="nbr"/>
          </lu>
          <b pos="2"/>
          <lu>
            <clip pos="3" side="tl" part="lem"/>
            <clip pos="3" side="tl" part="a_nom"/>
            <clip pos="3" side="tl" part="gen"/>
            <clip pos="3" side="tl" part="nbr"/>
          </lu>
          <b pos="3"/>
          <lu>
            <clip pos="4" side="tl" part="lem"/>
            <clip pos="4" side="tl" part="a_adjec"/>
            <clip pos="4" side="tl" part="gen"/>
            <clip pos="4" side="tl" part="nbr"/>
          </lu>
        </out>
      </action>
    </rule>
    <rule>
      <!-- REGLA 13: NOM ADVERBI ADJECTIU-->
      <pattern>
        <pattern-item n="nom"/>
        <pattern-item n="adv"/>
        <pattern-item n="adjec"/>
      </pattern>
      <action>
        <call-macro n="f_concord2">
          <with-param pos="1"/>
          <with-param pos="3"/>
        </call-macro>
        <out>
          <lu>
            <clip pos="1" side="tl" part="lem"/>
            <clip pos="1" side="tl" part="a_nom"/>
            <clip pos="1" side="tl" part="gen"/>
            <clip pos="1" side="tl" part="nbr"/>
          </lu>
          <b pos="1"/>
          <lu>
            <clip pos="2" side="tl" part="lem"/>
            <clip pos="2" side="tl" part="a_adv"/>
          </lu>
          <b pos="2"/>
          <lu>
            <clip pos="3" side="tl" part="lem"/>
            <clip pos="3" side="tl" part="a_adjec"/>
            <clip pos="3" side="tl" part="gen"/>
            <clip pos="3" side="tl" part="nbr"/>
          </lu>
        </out>
      </action>
    </rule>
    <rule>
      <!-- REGLA 14: DET NOM ADVERBI ADJECTIU -->
      <pattern>
        <pattern-item n="det"/>
        <pattern-item n="nom"/>
        <pattern-item n="adv"/>
        <pattern-item n="adjec"/>
      </pattern>
      <action>
        <call-macro n="f_concord3">
          <with-param pos="2"/>
          <with-param pos="1"/>
          <with-param pos="4"/>
        </call-macro>
        <out>
          <lu>
            <clip pos="1" side="tl" part="lem"/>
            <clip pos="1" side="tl" part="a_det"/>
            <clip pos="1" side="tl" part="gen"/>
            <clip pos="1" side="tl" part="nbr"/>
          </lu>
          <b pos="1"/>
          <lu>
            <clip pos="2" side="tl" part="lem"/>
            <clip pos="2" side="tl" part="a_nom"/>
            <clip pos="2" side="tl" part="gen"/>
            <clip pos="2" side="tl" part="nbr"/>
          </lu>
          <b pos="2"/>
          <lu>
            <clip pos="3" side="tl" part="lem"/>
            <clip pos="3" side="tl" part="a_adv"/>
          </lu>
          <b pos="3"/>
          <lu>
            <clip pos="4" side="tl" part="lem"/>
            <clip pos="4" side="tl" part="a_adjec"/>
            <clip pos="4" side="tl" part="gen"/>
            <clip pos="4" side="tl" part="nbr"/>
          </lu>
        </out>
      </action>
    </rule>
    <rule>
      <!-- REGLA 15: DET ADVERBI NOM-->
      <pattern>
        <pattern-item n="det"/>
        <pattern-item n="adv"/>
        <pattern-item n="nom"/>
      </pattern>
      <action>
        <call-macro n="f_concord2">
          <with-param pos="3"/>
          <with-param pos="1"/>
        </call-macro>
        <out>
          <lu>
            <clip pos="1" side="tl" part="lem"/>
            <clip pos="1" side="tl" part="a_det"/>
            <clip pos="1" side="tl" part="gen"/>
            <clip pos="1" side="tl" part="nbr"/>
          </lu>
          <b pos="1"/>
          <lu>
            <clip pos="2" side="tl" part="lem"/>
            <clip pos="2" side="tl" part="a_adv"/>
          </lu>
          <b pos="2"/>
          <lu>
            <clip pos="3" side="tl" part="lem"/>
            <clip pos="3" side="tl" part="a_nom"/>
            <clip pos="3" side="tl" part="gen"/>
            <clip pos="3" side="tl" part="nbr"/>
          </lu>
        </out>
      </action>
    </rule>
    <rule>
      <!-- REGLA 16: NUMERAL NOM -->
      <pattern>
        <pattern-item n="num"/>
        <pattern-item n="nom"/>
      </pattern>
      <action>
        <call-macro n="f_concord2">
          <with-param pos="2"/>
          <with-param pos="1"/>
        </call-macro>
        <out>
          <lu>
            <clip pos="1" side="tl" part="lem"/>
            <clip pos="1" side="tl" part="a_num"/>
            <clip pos="1" side="tl" part="gen"/>
            <clip pos="1" side="tl" part="nbr"/>
          </lu>
          <b pos="1"/>
          <lu>
            <clip pos="2" side="tl" part="lem"/>
            <clip pos="2" side="tl" part="a_nom"/>
            <clip pos="2" side="tl" part="gen"/>
            <clip pos="2" side="tl" part="nbr"/>
          </lu>
        </out>
      </action>
    </rule>
    <rule>
      <!-- REGLA 17: NUMERAL ADJECTIU -->
      <pattern>
        <pattern-item n="num"/>
        <pattern-item n="adjec"/>
      </pattern>
      <action>
        <call-macro n="f_concord2">
          <with-param pos="2"/>
          <with-param pos="1"/>
        </call-macro>
        <out>
          <lu>
            <clip pos="1" side="tl" part="lem"/>
            <clip pos="1" side="tl" part="a_num"/>
            <clip pos="1" side="tl" part="gen"/>
            <clip pos="1" side="tl" part="nbr"/>
          </lu>
          <b pos="1"/>
          <lu>
            <clip pos="2" side="tl" part="lem"/>
            <clip pos="2" side="tl" part="a_adjec"/>
            <clip pos="2" side="tl" part="gen"/>
            <clip pos="2" side="tl" part="nbr"/>
          </lu>
        </out>
      </action>
    </rule>
    <rule>
      <!-- REGLA 18: NUMERAL NOM ADJECTIU -->
      <pattern>
        <pattern-item n="num"/>
        <pattern-item n="nom"/>
        <pattern-item n="adjec"/>
      </pattern>
      <action>
        <call-macro n="f_concord3">
          <with-param pos="2"/>
          <with-param pos="1"/>
          <with-param pos="3"/>
        </call-macro>
        <out>
          <lu>
            <clip pos="1" side="tl" part="lem"/>
            <clip pos="1" side="tl" part="a_num"/>
            <clip pos="1" side="tl" part="gen"/>
            <clip pos="1" side="tl" part="nbr"/>
          </lu>
          <b pos="1"/>
          <lu>
            <clip pos="2" side="tl" part="lem"/>
            <clip pos="2" side="tl" part="a_nom"/>
            <clip pos="2" side="tl" part="gen"/>
            <clip pos="2" side="tl" part="nbr"/>
          </lu>
          <b pos="2"/>
          <lu>
            <clip pos="3" side="tl" part="lem"/>
            <clip pos="3" side="tl" part="a_adjec"/>
            <clip pos="3" side="tl" part="gen"/>
            <clip pos="3" side="tl" part="nbr"/>
          </lu>
        </out>
      </action>
    </rule>
    <rule>
      <!-- REGLA 19: NUMERAL ADJECTIU NOM -->
      <pattern>
        <pattern-item n="num"/>
        <pattern-item n="adjec"/>
        <pattern-item n="nom"/>
      </pattern>
      <action>
        <call-macro n="f_concord3">
          <with-param pos="3"/>
          <with-param pos="2"/>
          <with-param pos="1"/>
        </call-macro>
        <out>
          <lu>
            <clip pos="1" side="tl" part="lem"/>
            <clip pos="1" side="tl" part="a_num"/>
            <clip pos="1" side="tl" part="gen"/>
            <clip pos="1" side="tl" part="nbr"/>
          </lu>
          <b pos="1"/>
          <lu>
            <clip pos="2" side="tl" part="lem"/>
            <clip pos="2" side="tl" part="a_adjec"/>
            <clip pos="2" side="tl" part="gen"/>
            <clip pos="2" side="tl" part="nbr"/>
          </lu>
          <b pos="2"/>
          <lu>
            <clip pos="3" side="tl" part="lem"/>
            <clip pos="3" side="tl" part="a_nom"/>
            <clip pos="3" side="tl" part="gen"/>
            <clip pos="3" side="tl" part="nbr"/>
          </lu>
        </out>
      </action>
    </rule>
    <rule>
      <!-- REGLA 21: DET NUMERAL NOM -->
      <pattern>
        <pattern-item n="det"/>
        <pattern-item n="num"/>
        <pattern-item n="nom"/>
      </pattern>
      <action>
        <call-macro n="f_concord3">
          <with-param pos="3"/>
          <with-param pos="2"/>
          <with-param pos="1"/>
        </call-macro>
        <out>
          <lu>
            <clip pos="1" side="tl" part="lem"/>
            <clip pos="1" side="tl" part="a_det"/>
            <clip pos="1" side="tl" part="gen"/>
            <clip pos="1" side="tl" part="nbr"/>
          </lu>
          <b pos="1"/>
          <lu>
            <clip pos="2" side="tl" part="lem"/>
            <clip pos="2" side="tl" part="a_num"/>
            <clip pos="2" side="tl" part="gen"/>
            <clip pos="2" side="tl" part="nbr"/>
          </lu>
          <b pos="2"/>
          <lu>
            <clip pos="3" side="tl" part="lem"/>
            <clip pos="3" side="tl" part="a_nom"/>
            <clip pos="3" side="tl" part="gen"/>
            <clip pos="3" side="tl" part="nbr"/>
          </lu>
        </out>
      </action>
    </rule>
    <rule>
      
      <!--REGRA EGV01: verbos sen enclíticos)-->
      <pattern>
        <pattern-item n="verb"/>
      </pattern>
      <action>
        <out>
          <lu>
            <clip pos="1" side="tl" part="lemh"/>
            <clip pos="1" side="tl" part="a_verb"/>
            <clip pos="1" side="tl" part="temps"/>
            <clip pos="1" side="tl" part="persona"/>
            <clip pos="1" side="tl" part="gen"/>
            <clip pos="1" side="tl" part="nbr"/>
            <clip pos="1" side="tl" part="lemq"/>
          </lu>
        </out>
      </action>
    </rule>
    
    <!-- REGRA EGV02 para os verbos con enclise v+enc+enc--> 
    <rule>
      <pattern>
        <pattern-item n="verb"/>
        <pattern-item n="prnenc"/>
        <pattern-item n="prnenc"/>
      </pattern>
      <action>
        <choose>
          <when>
            <test>
              <and>
                <equal caseless="yes">
                  <clip pos="2" side="sl" part="lem"/>
                  <lit v="le"/>
                </equal>
                <equal caseless="yes">
                  <clip pos="3" side="sl" part="lem"/>
                  <lit v="le"/>
                </equal>
              </and>
            </test>
            <out>
              <mlu><lu>
                  <clip pos="1" side="tl" part="whole"/> 
                </lu> 
                <lu>
                  <get-case-from pos="2">
                    <lit v="se"/>
                  </get-case-from>
                  <lit-tag v="prn.enc.ref.p3.mf.sp"/>
                </lu>
                <lu>
                  <clip pos="3" side="tl" part="whole"/> 
                </lu></mlu>
            </out> 
          </when>
          <otherwise> 
            <out>
              <mlu><lu>
                  <clip pos="1" side="tl" part="whole"/> 
                </lu> 
                <lu>
                  <clip pos="2" side="tl" part="whole"/> 
                </lu>
                <lu>
                  <clip pos="3" side="tl" part="whole"/> 
                </lu></mlu>
            </out>
          </otherwise>
        </choose>
      </action>
    </rule>
    
    
    
    <!-- REGRA EGV03 v+enc--> 
    
    <rule>
      <pattern>
        <pattern-item n="verb"/>
        <pattern-item n="prnenc"/>
      </pattern>
      <action>
        <out>
          <mlu><lu>
              <clip pos="1" side="tl" part="whole"/> 
            </lu> 
            
            <lu>
              <clip pos="2" side="tl" part="whole"/> 
            </lu></mlu>
        </out> 
        
      </action>
    </rule>
    
    
    
    
    <rule>
      <pattern>
        <pattern-item n="longa_proclise"/>
        <pattern-item n="intermed"/>
        <pattern-item n="intermed"/>
        <pattern-item n="prnpro"/>
        <pattern-item n="haber"/>
        <pattern-item n="verb"/>
      </pattern>
      <action>
        <choose>
          
          
          
          <when>
            <test>
              <and>
                
                <in caseless="yes"><!--in-->
                  <clip pos="1" side="sl" part="lem"/>
                  <list n="pces"/>
                </in>
                
                <equal>
                  <clip pos="6" side="sl" part="temps"/>
                  <lit-tag v="pp"/>
                </equal>
                <equal>
                  <clip pos="6" side="sl" part="gen"/>
                  <lit-tag v="m"/>
                </equal>
                <equal>
                  <clip pos="6" side="sl" part="nbr"/>
                  <lit-tag v="sg"/>
                </equal>
              </and>
            </test>
            <out>
              <lu>
                <clip pos="1" side="tl" part="whole"/> 
              </lu> 
              <b/>
              <lu>
                <clip pos="2" side="tl" part="whole"/> 
              </lu> 
              <b/>
              <lu>
                <clip pos="3" side="tl" part="whole"/> 
              </lu> 
              <b/>
              <lu>
                <clip pos="4" side="tl" part="whole"/> 
              </lu> 
              <b/>
              <lu>
                <clip pos="6" side="tl" part="lem"/> 
                <clip pos="6" side="sl" part="a_verb"/>
                <lit-tag v="ifi"/>
                <clip pos="5" side="sl" part="persona"/>
                <clip pos="5" side="sl" part="nbr"/>
              </lu>
            </out> 
          </when>
          
          
          
          <when>
            <test>
              <and>
                <equal>
                  <clip pos="6" side="sl" part="temps"/>
                  <lit-tag v="pp"/>
                </equal>
                <equal>
                  <clip pos="6" side="sl" part="gen"/>
                  <lit-tag v="m"/>
                </equal>
                <equal>
                  <clip pos="6" side="sl" part="nbr"/>
                  <lit-tag v="sg"/>
                </equal>
              </and>
            </test>
            <out>
              <lu>
                <clip pos="1" side="tl" part="whole"/> 
              </lu> 
              <b/>
              <lu>
                <clip pos="2" side="tl" part="whole"/> 
              </lu> 
              <b/>
              <lu>
                <clip pos="3" side="tl" part="whole"/> 
              </lu> 
              <b/>
	      <lu>
		      <get-case-from pos="5">
			      <clip pos="4" side="tl" part="lem"/>
		      </get-case-from>
		      <lit-tag v="prn.enc"/>
		      <clip pos="4" side="tl" part="persona"/>
		      <clip pos="4" side="tl" part="gen"/>
		      <clip pos="4" side="tl" part="nbr"/>
                </lu>
		<b/>
		<lu>
                  <get-case-from pos="4">
                    <clip pos="6" side="tl" part="lem"/>
                  </get-case-from> 
                  <clip pos="6" side="sl" part="a_verb"/>
                  <lit-tag v="ifi"/>
                  <clip pos="5" side="sl" part="persona"/>
                  <clip pos="5" side="sl" part="nbr"/>
                </lu>

              
            </out> 
          </when>
          
          
          
          <otherwise>
            <out>
              <lu>
                <clip pos="1" side="tl" part="whole"/> 
              </lu> 
              <b/>
              <lu>
                <clip pos="2" side="tl" part="whole"/> 
              </lu> 
              <b/>
              <lu>
                <clip pos="3" side="tl" part="whole"/> 
              </lu> 
              <b/>
              <lu>
                <clip pos="4" side="tl" part="whole"/> 
              </lu> 
              <b/>
              <lu>
                <clip pos="5" side="tl" part="whole"/> 
              </lu>
              <b/>
              <lu>
                <clip pos="6" side="tl" part="whole"/> 
              </lu>
            </out> 
          </otherwise>
          
          
        </choose>
      </action>
    </rule>
    
    
    <rule>
      <pattern>
        <pattern-item n="longa_proclise"/>
        <pattern-item n="intermed"/>
        <pattern-item n="prnpro"/>
        <pattern-item n="haber"/>
        <pattern-item n="verb"/>
      </pattern>
      <action>
        <choose>
          
          
          
          <when>
            <test>
              <and>
                
                <in caseless="yes"><!--in-->
                <clip pos="1" side="sl" part="lem"/>
                <list n="pces"/>
              </in>
                
                <equal>
                  <clip pos="5" side="sl" part="temps"/>
                  <lit-tag v="pp"/>
                </equal>
                <equal>
                  <clip pos="5" side="sl" part="gen"/>
                  <lit-tag v="m"/>
                </equal>
                <equal>
                  <clip pos="5" side="sl" part="nbr"/>
                  <lit-tag v="sg"/>
                </equal>
              </and>
            </test>
            <out>
              <lu>
                <clip pos="1" side="tl" part="whole"/> 
              </lu> 
              <b/>
              <lu>
                <clip pos="2" side="tl" part="whole"/> 
              </lu> 
              <b/>
              <lu>
                <clip pos="3" side="tl" part="whole"/> 
              </lu> 
              <b/>
              <lu>
                <clip pos="5" side="tl" part="lem"/> 
                <clip pos="5" side="sl" part="a_verb"/>
                <lit-tag v="ifi"/>
                <clip pos="4" side="sl" part="persona"/>
                <clip pos="4" side="sl" part="nbr"/>
              </lu>
            </out> 
          </when>
          
          
          
          <when>
            <test>
              <and>
                <equal>
                  <clip pos="5" side="sl" part="temps"/>
                  <lit-tag v="pp"/>
                </equal>
                <equal>
                  <clip pos="5" side="sl" part="gen"/>
                  <lit-tag v="m"/>
                </equal>
                <equal>
                  <clip pos="5" side="sl" part="nbr"/>
                  <lit-tag v="sg"/>
                </equal>
              </and>
            </test>
            <out>
              <lu>
                <clip pos="1" side="tl" part="whole"/> 
              </lu> 
              <b/>
              <lu>
                <clip pos="2" side="tl" part="whole"/> 
              </lu> 
              <b/>
              <mlu><lu>
                  <get-case-from pos="3">
                    <clip pos="5" side="tl" part="lem"/>
                  </get-case-from> 
                  <clip pos="5" side="sl" part="a_verb"/>
                  <lit-tag v="ifi"/>
                  <clip pos="4" side="sl" part="persona"/>
                  <clip pos="4" side="sl" part="nbr"/>
                </lu>
                <lu>
                  <get-case-from pos="4">
                    <clip pos="3" side="tl" part="lem"/>
                  </get-case-from>
                  <lit-tag v="prn.enc"/>
                  <clip pos="3" side="tl" part="persona"/>
                  <clip pos="3" side="tl" part="gen"/>
                  <clip pos="3" side="tl" part="nbr"/>
                </lu></mlu>
              
            </out> 
          </when>
          
          
          
          <otherwise>
            <out>
              <lu>
                <clip pos="1" side="tl" part="whole"/> 
              </lu> 
              <b/>
              <lu>
                <clip pos="2" side="tl" part="whole"/> 
              </lu> 
              <b/>
              <lu>
                <clip pos="3" side="tl" part="whole"/> 
              </lu> 
              <b/>
              <lu>
                <clip pos="4" side="tl" part="whole"/> 
              </lu>
              <b/>
              <lu>
                <clip pos="5" side="tl" part="whole"/> 
              </lu>
            </out> 
          </otherwise>
          
          
        </choose>
      </action>
    </rule>
    
    
    <rule>
      <pattern>
        <pattern-item n="longa_proclise"/>
        <pattern-item n="intermed"/>
        <pattern-item n="intermed"/>
        <pattern-item n="prnproref"/>
        <pattern-item n="prnpro"/>
        <pattern-item n="haber"/>
        <pattern-item n="verb"/>
      </pattern>
      <action>
        <choose>
          
          
          
          <when>
            <test>
              <and>
                
                <in caseless="yes"><!--in-->
                  <clip pos="1" side="sl" part="lem"/>
                  <list n="pces"/>
                </in>
                
                <equal>
                  <clip pos="7" side="sl" part="temps"/>
                  <lit-tag v="pp"/>
                </equal>
                <equal>
                  <clip pos="7" side="sl" part="gen"/>
                  <lit-tag v="m"/>
                </equal>
                <equal>
                  <clip pos="7" side="sl" part="nbr"/>
                  <lit-tag v="sg"/>
                </equal>
              </and>
            </test>
            <out>
              <lu>
                <clip pos="1" side="tl" part="whole"/> 
              </lu> 
              <b/>
              <lu>
                <clip pos="2" side="tl" part="whole"/> 
              </lu> 
              <b/>
              <lu>
                <clip pos="3" side="tl" part="whole"/> 
              </lu> 
              <b/>
              <lu>
                <clip pos="4" side="tl" part="whole"/> 
              </lu> 
              <b/>
              <lu>
                <clip pos="5" side="tl" part="whole"/> 
              </lu> 
              <b/>
              <lu>
                <clip pos="7" side="tl" part="lem"/> 
                <clip pos="7" side="sl" part="a_verb"/>
                <lit-tag v="ifi"/>
                <clip pos="6" side="sl" part="persona"/>
                <clip pos="6" side="sl" part="nbr"/>
              </lu>
            </out> 
          </when>
          
          
          
          <when>
            <test>
              <and>
                <equal>
                  <clip pos="7" side="sl" part="temps"/>
                  <lit-tag v="pp"/>
                </equal>
                <equal>
                  <clip pos="7" side="sl" part="gen"/>
                  <lit-tag v="m"/>
                </equal>
                <equal>
                  <clip pos="7" side="sl" part="nbr"/>
                  <lit-tag v="sg"/>
                </equal>
              </and>
            </test>
            <out>
              <lu>
                <clip pos="1" side="tl" part="whole"/> 
              </lu> 
              <b/>
              <lu>
                <clip pos="2" side="tl" part="whole"/> 
              </lu> 
              <b/>
              <lu>
                <clip pos="3" side="tl" part="whole"/> 
              </lu> 
              <b/>
              <mlu><lu>
                  <get-case-from pos="4">
                    <clip pos="7" side="tl" part="lem"/>
                  </get-case-from> 
                  <clip pos="7" side="sl" part="a_verb"/>
                  <lit-tag v="ifi"/>
                  <clip pos="6" side="sl" part="persona"/>
                  <clip pos="6" side="sl" part="nbr"/>
                </lu>
                <lu>
                  <get-case-from pos="4">
                    <lit v="lle"/>
                  </get-case-from>
                  <lit-tag v="prn.enc.p3.mf.sg"/>
                </lu>
                <lu>
                  <get-case-from pos="6">
                    <clip pos="5" side="tl" part="lem"/>
                  </get-case-from>
                  <lit-tag v="prn.enc"/>
                  <clip pos="5" side="tl" part="persona"/>
                  <clip pos="5" side="tl" part="gen"/>
                  <clip pos="5" side="tl" part="nbr"/>
                </lu></mlu>
              
            </out> 
          </when>
          
          
          
          <otherwise>
            <out>
              <lu>
                <clip pos="1" side="tl" part="whole"/> 
              </lu> 
              <b/>
              <lu>
                <clip pos="2" side="tl" part="whole"/> 
              </lu> 
              <b/>
              <lu>
                <clip pos="3" side="tl" part="whole"/> 
              </lu>
              <b/>
              <lu>
                <clip pos="4" side="tl" part="whole"/> 
              </lu>
              <b/>
              <lu>
                <clip pos="5" side="tl" part="whole"/> 
              </lu>
              <b/>
              <lu>
                <clip pos="6" side="tl" part="whole"/> 
              </lu>
              <b/>
              <lu>
                <clip pos="7" side="tl" part="whole"/> 
              </lu>
            </out> 
          </otherwise>
          
          
        </choose>
      </action>
    </rule>
    
    
    <rule>
      <pattern>
        <pattern-item n="longa_proclise"/>
        <pattern-item n="intermed"/>
        <pattern-item n="prnproref"/>
        <pattern-item n="prnpro"/>
        <pattern-item n="haber"/>
        <pattern-item n="verb"/>
      </pattern>
      <action>
        <choose>
          
          
          
          <when>
            <test>
              <and>
                
                <in caseless="yes"><!--in-->
                  <clip pos="1" side="sl" part="lem"/>
                  <list n="pces"/>
                </in>
                
                <equal>
                  <clip pos="6" side="sl" part="temps"/>
                  <lit-tag v="pp"/>
                </equal>
                <equal>
                  <clip pos="6" side="sl" part="gen"/>
                  <lit-tag v="m"/>
                </equal>
                <equal>
                  <clip pos="6" side="sl" part="nbr"/>
                  <lit-tag v="sg"/>
                </equal>
              </and>
            </test>
            <out>
              <lu>
                <clip pos="1" side="tl" part="whole"/> 
              </lu> 
              <b/>
              <lu>
                <clip pos="2" side="tl" part="whole"/> 
              </lu> 
              <b/>
              <lu>
                <clip pos="3" side="tl" part="whole"/> 
              </lu> 
              <b/>
              <lu>
                <clip pos="4" side="tl" part="whole"/> 
              </lu> 
              <b/>
              <lu>
                <clip pos="6" side="tl" part="lem"/> 
                <clip pos="6" side="sl" part="a_verb"/>
                <lit-tag v="ifi"/>
                <clip pos="5" side="sl" part="persona"/>
                <clip pos="5" side="sl" part="nbr"/>
              </lu>
            </out> 
          </when>
          
          
          
          <when>
            <test>
              <and>
                <equal>
                  <clip pos="6" side="sl" part="temps"/>
                  <lit-tag v="pp"/>
                </equal>
                <equal>
                  <clip pos="6" side="sl" part="gen"/>
                  <lit-tag v="m"/>
                </equal>
                <equal>
                  <clip pos="6" side="sl" part="nbr"/>
                  <lit-tag v="sg"/>
                </equal>
              </and>
            </test>
            <out>
              <lu>
                <clip pos="1" side="tl" part="whole"/> 
              </lu> 
              <b/>
              <lu>
                <clip pos="2" side="tl" part="whole"/> 
              </lu> 
              <b/>
              <mlu><lu>
                  <get-case-from pos="3">
                    <clip pos="6" side="tl" part="lem"/>
                  </get-case-from> 
                  <clip pos="6" side="sl" part="a_verb"/>
                  <lit-tag v="ifi"/>
                  <clip pos="5" side="sl" part="persona"/>
                  <clip pos="5" side="sl" part="nbr"/>
                </lu>
                <lu>
                  <get-case-from pos="3">
                    <lit v="lle"/>
                  </get-case-from>
                  <lit-tag v="prn.enc.p3.mf.sg"/>
                </lu>
                <lu>
                  <get-case-from pos="5">
                    <clip pos="4" side="tl" part="lem"/>
                  </get-case-from>
                  <lit-tag v="prn.enc"/>
                  <clip pos="4" side="tl" part="persona"/>
                  <clip pos="4" side="tl" part="gen"/>
                  <clip pos="4" side="tl" part="nbr"/>
                </lu></mlu>
              
            </out> 
          </when>
          
          
          
          <otherwise>
            <out>
              <lu>
                <clip pos="1" side="tl" part="whole"/> 
              </lu> 
              <b/>
              <lu>
                <clip pos="2" side="tl" part="whole"/> 
              </lu> 
              <b/>
              <lu>
                <clip pos="3" side="tl" part="whole"/> 
              </lu>
              <b/>
              <lu>
                <clip pos="4" side="tl" part="whole"/> 
              </lu>
              <b/>
              <lu>
                <clip pos="5" side="tl" part="whole"/> 
              </lu>
              <b/>
              <lu>
                <clip pos="6" side="tl" part="whole"/> 
              </lu>
            </out> 
          </otherwise>
          
          
        </choose>
      </action>
    </rule>
    
    
    <!-- EGV15.REGRA: HABER + PP: propro+propro+vC
         me lo ha besado - bícoumo
         
         -->
    
    
    
    <rule>
      <pattern>
        <pattern-item n="longa_proclise"/>
        <pattern-item n="intermed"/>
        <pattern-item n="intermed"/>
        <pattern-item n="prnpro"/>
        <pattern-item n="prnpro"/>
        <pattern-item n="haber"/>
        <pattern-item n="verb"/>
      </pattern>
      <action>
        <choose>
          
          
          
          <when>
            <test>
              <and>
                
                <in caseless="yes"><!--in-->
                  <clip pos="1" side="sl" part="lem"/>
                  <list n="pces"/>
                </in>
                
                <equal>
                  <clip pos="7" side="sl" part="temps"/>
                  <lit-tag v="pp"/>
                </equal>
                <equal>
                  <clip pos="7" side="sl" part="gen"/>
                  <lit-tag v="m"/>
                </equal>
                <equal>
                  <clip pos="7" side="sl" part="nbr"/>
                  <lit-tag v="sg"/>
                </equal>
              </and>
            </test>
            <out>
              <lu>
                <clip pos="1" side="tl" part="whole"/> 
              </lu> 
              <b/>
              <lu>
                <clip pos="2" side="tl" part="whole"/> 
              </lu> 
              <b/>
              <lu>
                <clip pos="3" side="tl" part="whole"/> 
              </lu> 
              <b/>
              <lu>
                <clip pos="4" side="tl" part="whole"/> 
              </lu> 
              <b/>
              <lu>
                <clip pos="5" side="tl" part="whole"/> 
              </lu> 
              <b/>
              <lu>
                <clip pos="7" side="tl" part="lem"/> 
                <clip pos="7" side="sl" part="a_verb"/>
                <lit-tag v="ifi"/>
                <clip pos="5" side="sl" part="persona"/>
                <clip pos="5" side="sl" part="nbr"/>
              </lu>
            </out> 
          </when>
          
          
          
          <when>
            <test>
              <and>
                <equal>
                  <clip pos="7" side="sl" part="temps"/>
                  <lit-tag v="pp"/>
                </equal>
                <equal>
                  <clip pos="7" side="sl" part="gen"/>
                  <lit-tag v="m"/>
                </equal>
                <equal>
                  <clip pos="7" side="sl" part="nbr"/>
                  <lit-tag v="sg"/>
                </equal>
              </and>
            </test>
            <out>
              <lu>
                <clip pos="1" side="tl" part="whole"/> 
              </lu> 
              <b/>
              <lu>
                <clip pos="2" side="tl" part="whole"/> 
              </lu> 
              <b/>
              <lu>
                <clip pos="3" side="tl" part="whole"/> 
              </lu> 
              <b/>
              <mlu><lu>
                  <get-case-from pos="4">
                    <clip pos="7" side="tl" part="lem"/>
                  </get-case-from> 
                  <clip pos="7" side="sl" part="a_verb"/>
                  <lit-tag v="ifi"/>
                  <clip pos="6" side="sl" part="persona"/>
                  <clip pos="6" side="sl" part="nbr"/>
                </lu>
                <lu>
                  <get-case-from pos="6">
                    <clip pos="4" side="tl" part="lem"/>
                  </get-case-from>
                  <lit-tag v="prn.enc"/>
                  <clip pos="4" side="tl" part="persona"/>
                  <clip pos="4" side="tl" part="gen"/>
                  <clip pos="4" side="tl" part="nbr"/>
                </lu>
                <lu>
                  <get-case-from pos="6">
                    <clip pos="5" side="tl" part="lem"/>
                  </get-case-from>
                  <lit-tag v="prn.enc"/>
                  <clip pos="5" side="tl" part="persona"/>
                  <clip pos="5" side="tl" part="gen"/>
                  <clip pos="5" side="tl" part="nbr"/>
                </lu></mlu>
              
            </out> 
          </when>
          
          
          
          <otherwise>
            <out>
              <lu>
                <clip pos="1" side="tl" part="whole"/> 
              </lu> 
              <b/>
              <lu>
                <clip pos="2" side="tl" part="whole"/> 
              </lu> 
              <b/>
              <lu>
                <clip pos="3" side="tl" part="whole"/> 
              </lu>
              <b/>
              <lu>
                <clip pos="4" side="tl" part="whole"/> 
              </lu>
              <b/>
              <lu>
                <clip pos="5" side="tl" part="whole"/> 
              </lu>
              <b/>
              <lu>
                <clip pos="6" side="tl" part="whole"/> 
              </lu>
              <b/>
              <lu>
                <clip pos="7" side="tl" part="whole"/> 
              </lu>
            </out> 
          </otherwise>
          
          
        </choose>
      </action>
    </rule>
    
 
    
    
    <rule>
      <pattern>
        <pattern-item n="longa_proclise"/>
        <pattern-item n="intermed"/>
        <pattern-item n="prnpro"/>
        <pattern-item n="prnpro"/>
        <pattern-item n="haber"/>
        <pattern-item n="verb"/>
      </pattern>
      <action>
        <choose>
          
          
          
          <when>
            <test>
              <and>
                
                <in caseless="yes"><!--in-->
                  <clip pos="1" side="sl" part="lem"/>
                  <list n="pces"/>
                </in>
                
                <equal>
                  <clip pos="6" side="sl" part="temps"/>
                  <lit-tag v="pp"/>
                </equal>
                <equal>
                  <clip pos="6" side="sl" part="gen"/>
                  <lit-tag v="m"/>
                </equal>
                <equal>
                  <clip pos="6" side="sl" part="nbr"/>
                  <lit-tag v="sg"/>
                </equal>
              </and>
            </test>
            <out>
              <lu>
                <clip pos="1" side="tl" part="whole"/> 
              </lu> 
              <b/>
              <lu>
                <clip pos="2" side="tl" part="whole"/> 
              </lu> 
              <b/>
              <lu>
                <clip pos="3" side="tl" part="whole"/> 
              </lu> 
              <b/>
              <lu>
                <clip pos="4" side="tl" part="whole"/> 
              </lu> 
              <b/>
              <lu>
                <clip pos="6" side="tl" part="lem"/> 
                <clip pos="6" side="sl" part="a_verb"/>
                <lit-tag v="ifi"/>
                <clip pos="4" side="sl" part="persona"/>
                <clip pos="4" side="sl" part="nbr"/>
              </lu>
            </out> 
          </when>
          
          
          
          <when>
            <test>
              <and>
                <equal>
                  <clip pos="6" side="sl" part="temps"/>
                  <lit-tag v="pp"/>
                </equal>
                <equal>
                  <clip pos="6" side="sl" part="gen"/>
                  <lit-tag v="m"/>
                </equal>
                <equal>
                  <clip pos="6" side="sl" part="nbr"/>
                  <lit-tag v="sg"/>
                </equal>
              </and>
            </test>
            <out>
              <lu>
                <clip pos="1" side="tl" part="whole"/> 
              </lu> 
              <b/>
              <lu>
                <clip pos="2" side="tl" part="whole"/> 
              </lu> 
              <b/>
              <mlu><lu>
                  <get-case-from pos="3">
                    <clip pos="6" side="tl" part="lem"/>
                  </get-case-from> 
                  <clip pos="6" side="sl" part="a_verb"/>
                  <lit-tag v="ifi"/>
                  <clip pos="5" side="sl" part="persona"/>
                  <clip pos="5" side="sl" part="nbr"/>
                </lu>
                <lu>
                  <get-case-from pos="5">
                    <clip pos="3" side="tl" part="lem"/>
                  </get-case-from>
                  <lit-tag v="prn.enc"/>
                  <clip pos="3" side="tl" part="persona"/>
                  <clip pos="3" side="tl" part="gen"/>
                  <clip pos="3" side="tl" part="nbr"/>
                </lu>
                <lu>
                  <get-case-from pos="5">
                    <clip pos="4" side="tl" part="lem"/>
                  </get-case-from>
                  <lit-tag v="prn.enc"/>
                  <clip pos="4" side="tl" part="persona"/>
                  <clip pos="4" side="tl" part="gen"/>
                  <clip pos="4" side="tl" part="nbr"/>
                </lu></mlu>
              
            </out> 
          </when>
          
          
          
          <otherwise>
            <out>
              <lu>
                <clip pos="1" side="tl" part="whole"/> 
              </lu> 
              <b/>
              <lu>
                <clip pos="2" side="tl" part="whole"/> 
              </lu> 
              <b/>
              <lu>
                <clip pos="3" side="tl" part="whole"/> 
              </lu>
              <b/>
              <lu>
                <clip pos="4" side="tl" part="whole"/> 
              </lu>
              <b/>
              <lu>
                <clip pos="5" side="tl" part="whole"/> 
              </lu>
              <b/>
              <lu>
                <clip pos="6" side="tl" part="whole"/> 
              </lu>
            </out> 
          </otherwise>
          
          
        </choose>
      </action>
    </rule>
    
    
    

    <rule>
      <pattern>
        <pattern-item n="longa_proclise"/>
        <pattern-item n="intermed"/>
        <pattern-item n="intermed"/>
        <pattern-item n="prnpro"/>
        <pattern-item n="prnpro"/>
        <pattern-item n="verb"/>
      </pattern>
      
      <action>
        <choose>
          <when>
            <test>
              <in caseless="yes"><!--in-->
                <clip pos="1" side="sl" part="lem"/>
                <list n="pces"/>
              </in>
            </test>
            
            <out>
              <lu>
                <clip pos="1" side="tl" part="whole"/> 
              </lu>
              <b/>
              <lu>
                <clip pos="2" side="tl" part="whole"/> 
              </lu>
              <b/>
              <lu>
                <clip pos="3" side="tl" part="whole"/> 
              </lu>
              <b/>
              <lu>
                <clip pos="4" side="tl" part="whole"/> 
              </lu>
              <b/>
              <lu>
                <clip pos="5" side="tl" part="whole"/> 
              </lu>
              <b/>
              <lu>
                <clip pos="6" side="tl" part="whole"/>
                
              </lu>
            </out> 
            
          </when>
          
          <when>
            <test><and>
                <equal caseless="yes">
                  <clip pos="4" side="sl" part="lem"/>
                  <lit v="se"/>
                </equal>
                <equal caseless="yes">
                  <clip pos="5" side="sl" part="lem"/>
                  <lit v="le"/>
                </equal></and>
            </test>
            
            <out>
              <lu>
                <clip pos="1" side="tl" part="whole"/> 
              </lu> 
              <b/>
              <lu>
                <clip pos="2" side="tl" part="whole"/> 
              </lu> 
              <b/>
              <lu>
                <clip pos="3" side="tl" part="whole"/> 
              </lu> 
              <b/>
              <mlu><lu>
                  <clip pos="6" side="tl" part="whole"/> 
                </lu>
                <lu>
                  <get-case-from pos="4">
                    <lit v="se"/>
                  </get-case-from>
                  <lit-tag v="prn.enc.ref.p3.mf.sp"/>
                </lu>
                <lu>
                  <clip pos="5" side="tl" part="lem"/>
                  <lit-tag v="prn.enc"/>
                  <clip pos="5" side="tl" part="persona"/>
                  <clip pos="5" side="tl" part="gen"/>
                  <clip pos="5" side="tl" part="nbr"/>
                </lu></mlu>
            </out> 
            
          </when>
          
          
          <when>
            <test>
              <equal caseless="yes">
                <clip pos="4" side="sl" part="lem"/>
                <lit v="se"/>
              </equal>
            </test>
            
            <out>
              <lu>
                <clip pos="1" side="tl" part="whole"/> 
              </lu> 
              <b/>
              <lu>
                <clip pos="2" side="tl" part="whole"/> 
              </lu> 
              <b/>
              <lu>
                <clip pos="3" side="tl" part="whole"/> 
              </lu> 
              <b/>
              <mlu><lu>
                  <clip pos="6" side="tl" part="whole"/> 
                </lu>
                <lu>
                  <get-case-from pos="4">
                    <lit v="lle"/>
                  </get-case-from>
                  <lit-tag v="prn.enc.p3.mf.sg"/>
                </lu>
                <lu>
                  <clip pos="5" side="tl" part="lem"/>
                  <lit-tag v="prn.enc"/>
                  <clip pos="5" side="tl" part="persona"/>
                  <clip pos="5" side="tl" part="gen"/>
                  <clip pos="5" side="tl" part="nbr"/>
                </lu></mlu>
            </out> 
            
          </when>
          
          <otherwise>
            
            <out>
              <lu>
                <clip pos="1" side="tl" part="whole"/> 
              </lu> 
              <b/>
              <lu>
                <clip pos="2" side="tl" part="whole"/> 
              </lu> 
              <b/>
              <lu>
                <clip pos="3" side="tl" part="whole"/> 
              </lu> 
              <b/>
              <mlu><lu>
                  <clip pos="6" side="tl" part="whole"/> 
                </lu>
                <lu>
                  <clip pos="4" side="tl" part="lem"/>
                  <lit-tag v="prn.enc"/>
                  <clip pos="4" side="tl" part="persona"/>
                  <clip pos="4" side="tl" part="gen"/>
                  <clip pos="4" side="tl" part="nbr"/>
                </lu>
                <lu>
                  <clip pos="5" side="tl" part="lem"/>
                  <lit-tag v="prn.enc"/>
                  <clip pos="5" side="tl" part="persona"/>
                  <clip pos="5" side="tl" part="gen"/>
                  <clip pos="5" side="tl" part="nbr"/>
                </lu></mlu>
            </out> 
            
          </otherwise>
          
        </choose>
      </action>
    </rule> 
    
    
    <rule>
      <pattern>
        <pattern-item n="longa_proclise"/>
        <pattern-item n="intermed"/>
        <pattern-item n="prnpro"/>
        <pattern-item n="prnpro"/>
        <pattern-item n="verb"/>
      </pattern>
      
      <action>
        <choose>
          <when>
            <test>
              <in caseless="yes"><!--in-->
                <clip pos="1" side="sl" part="lem"/>
                <list n="pces"/>
              </in>
            </test>
            
            <out>
              <lu>
                <clip pos="1" side="tl" part="whole"/> 
              </lu>
              <b/>
              <lu>
                <clip pos="2" side="tl" part="whole"/> 
              </lu>
              <b/>
              <lu>
                <clip pos="3" side="tl" part="whole"/> 
              </lu>
              <b/>
              <lu>
                <clip pos="4" side="tl" part="whole"/> 
              </lu>
              <b/>
              <lu>
                <clip pos="5" side="tl" part="whole"/>
                
              </lu>
            </out> 
            
          </when>
          
          <when>
            <test><and>
                <equal caseless="yes">
                  <clip pos="3" side="sl" part="lem"/>
                  <lit v="se"/>
                </equal>
                <equal caseless="yes">
                  <clip pos="4" side="sl" part="lem"/>
                  <lit v="le"/>
                </equal></and>
            </test>
            
            <out>
              <lu>
                <clip pos="1" side="tl" part="whole"/> 
              </lu> 
              <b/>
              <lu>
                <clip pos="2" side="tl" part="whole"/> 
              </lu> 
              <b/>
              <mlu><lu>
                  <clip pos="5" side="tl" part="whole"/> 
                </lu>
                <lu>
                  <get-case-from pos="3">
                    <lit v="se"/>
                  </get-case-from>
                  <lit-tag v="prn.enc.ref.p3.mf.sp"/>
                </lu>
                <lu>
                  <clip pos="4" side="tl" part="lem"/>
                  <lit-tag v="prn.enc"/>
                  <clip pos="4" side="tl" part="persona"/>
                  <clip pos="4" side="tl" part="gen"/>
                  <clip pos="4" side="tl" part="nbr"/>
                </lu></mlu>
            </out> 
            
          </when>
          
          
          <when>
            <test>
              <equal caseless="yes">
                <clip pos="3" side="sl" part="lem"/>
                <lit v="se"/>
              </equal>
            </test>
            
            <out>
              <lu>
                <clip pos="1" side="tl" part="whole"/> 
              </lu> 
              <b/>
              <lu>
                <clip pos="2" side="tl" part="whole"/> 
              </lu> 
              <b/>
              <mlu><lu>
                  <clip pos="5" side="tl" part="whole"/> 
                </lu>
                <lu>
                  <get-case-from pos="3">
                    <lit v="lle"/>
                  </get-case-from>
                  <lit-tag v="prn.enc.p3.mf.sg"/>
                </lu>
                <lu>
                  <clip pos="4" side="tl" part="lem"/>
                  <lit-tag v="prn.enc"/>
                  <clip pos="4" side="tl" part="persona"/>
                  <clip pos="4" side="tl" part="gen"/>
                  <clip pos="4" side="tl" part="nbr"/>
                </lu></mlu>
            </out> 
            
          </when>
          
          <otherwise>
            
            <out>
              <lu>
                <clip pos="1" side="tl" part="whole"/> 
              </lu> 
              <b/>
              <lu>
                <clip pos="2" side="tl" part="whole"/> 
              </lu> 
              <b/>
              <mlu><lu>
                  <clip pos="5" side="tl" part="whole"/> 
                </lu>
                <lu>
                  <clip pos="3" side="tl" part="lem"/>
                  <lit-tag v="prn.enc"/>
                  <clip pos="3" side="tl" part="persona"/>
                  <clip pos="3" side="tl" part="gen"/>
                  <clip pos="3" side="tl" part="nbr"/>
                </lu>
                <lu>
                  <clip pos="4" side="tl" part="lem"/>
                  <lit-tag v="prn.enc"/>
                  <clip pos="4" side="tl" part="persona"/>
                  <clip pos="4" side="tl" part="gen"/>
                  <clip pos="4" side="tl" part="nbr"/>
                </lu></mlu>
            </out> 
            
          </otherwise>
          
        </choose>
      </action>
    </rule> 
    
    
    
    <rule>
      
      <pattern>
        <pattern-item n="longa_proclise"/>
        <pattern-item n="intermed"/>
        <pattern-item n="intermed"/>
        <pattern-item n="prnpro"/>
        <pattern-item n="verb"/>
      </pattern>
      
      <action>
        <choose>
          <when>
            <test>
              <in caseless="yes"><!--in-->
                <clip pos="1" side="sl" part="lem"/>
                <list n="pces"/>
              </in>
            </test>
            
            <out>
              <lu>
                <clip pos="1" side="tl" part="whole"/> 
              </lu>
              <b/>
              <lu>
                <clip pos="2" side="tl" part="whole"/> 
              </lu>
              <b/>
              <lu>
                <clip pos="3" side="tl" part="whole"/> 
              </lu>
              <b/>
              <lu>
                <clip pos="4" side="tl" part="whole"/> 
              </lu>
              <b/>
              <lu>
                <clip pos="5" side="tl" part="whole"/>
                
              </lu>
            </out> 
            
          </when>
          
          <otherwise>
            <out>
              <lu>
                <clip pos="1" side="tl" part="whole"/> 
              </lu> 
              <b/>
              <lu>
                <clip pos="2" side="tl" part="whole"/> 
              </lu>
              <b/>
              <lu>
                <clip pos="3" side="tl" part="whole"/> 
              </lu>
              <b/>
              <mlu><lu>
                  <clip pos="5" side="tl" part="lem"/>
                  <clip pos="5" side="tl" part="a_verb"/>
                  <clip pos="5" side="tl" part="temps"/>
                  <clip pos="5" side="tl" part="persona"/>
                  <clip pos="5" side="tl" part="nbr"/>
                </lu>
                <lu>
                  <clip pos="4" side="tl" part="lem"/>
                  <lit-tag v="prn.enc"/>
                  <clip pos="4" side="tl" part="persona"/>
                  <clip pos="4" side="tl" part="gen"/>
                  <clip pos="4" side="tl" part="nbr"/>
                </lu></mlu>
            </out> 
          </otherwise>
          
        </choose>
      </action>
    </rule>
    
    <rule>
      
      <pattern>
        <pattern-item n="longa_proclise"/>
        <pattern-item n="intermed"/>
        <pattern-item n="prnpro"/>
        <pattern-item n="verb"/>
      </pattern>
      
      <action>
        <choose>
          <when>
            <test>
              <in caseless="yes"><!--in-->
                <clip pos="1" side="sl" part="lem"/>
                <list n="pces"/>
              </in>
            </test>
            
            <out>
              <lu>
                <clip pos="1" side="tl" part="whole"/> 
              </lu>
              <b/>
              <lu>
                <clip pos="2" side="tl" part="whole"/> 
              </lu>
              <b/>
              <lu>
                <clip pos="3" side="tl" part="whole"/> 
              </lu>
              <b/>
              <lu>
                <clip pos="4" side="tl" part="whole"/>
                
              </lu>
            </out> 
            
          </when>
          
          <otherwise>
            <out>
              <lu>
                <clip pos="1" side="tl" part="whole"/> 
              </lu> 
              <b/>
              <lu>
                <clip pos="2" side="tl" part="whole"/> 
              </lu>
              <b/>
              <mlu><lu>
                  <clip pos="4" side="tl" part="lem"/>
                  <clip pos="4" side="tl" part="a_verb"/>
                  <clip pos="4" side="tl" part="temps"/>
                  <clip pos="4" side="tl" part="persona"/>
                  <clip pos="4" side="tl" part="nbr"/>
                </lu>
                <lu>
                  <clip pos="3" side="tl" part="lem"/>
                  <lit-tag v="prn.enc"/>
                  <clip pos="3" side="tl" part="persona"/>
                  <clip pos="3" side="tl" part="gen"/>
                  <clip pos="3" side="tl" part="nbr"/>
                </lu></mlu>
            </out> 
          </otherwise>
          
        </choose>
      </action>
    </rule>
    
    
    <!-- REGRA EGV04.REGRA: pro+pro+vC
         
         -->
    
    <rule>
      <pattern>
        <pattern-item n="proclise"/>
        <pattern-item n="prnpro"/>
        <pattern-item n="prnpro"/>
        <pattern-item n="verb"/>
      </pattern>
      
      <action>
        <choose>
          <when>
            <test>
              <in caseless="yes"><!--in-->
                <clip pos="1" side="sl" part="lem"/>
                <list n="pces"/>
              </in>
            </test>
            
            <out>
              <lu>
                <clip pos="1" side="tl" part="whole"/> 
              </lu>
              <b/>
              <lu>
                <clip pos="2" side="tl" part="whole"/> 
              </lu>
              <b/>
              <lu>
                <clip pos="3" side="tl" part="whole"/> 
              </lu>
              <b/>
              <lu>
                <clip pos="4" side="tl" part="whole"/>
                
              </lu>
            </out> 
            
          </when>
          
          <when>
            <test><and>
                <equal caseless="yes">
                  <clip pos="2" side="sl" part="lem"/>
                  <lit v="se"/>
                </equal>
                <equal caseless="yes">
                  <clip pos="3" side="sl" part="lem"/>
                  <lit v="le"/>
                </equal></and>
            </test>
            
            <out>
              <lu>
                <clip pos="1" side="tl" part="whole"/> 
              </lu> 
              <b/>
              <mlu><lu>
                  <clip pos="4" side="tl" part="whole"/> 
                </lu>
                <lu>
                  <get-case-from pos="2">
                    <lit v="se"/>
                  </get-case-from>
                  <lit-tag v="prn.enc.ref.p3.mf.sp"/>
                </lu>
                <lu>
                  <clip pos="3" side="tl" part="lem"/>
                  <lit-tag v="prn.enc"/>
                  <clip pos="3" side="tl" part="persona"/>
                  <clip pos="3" side="tl" part="gen"/>
                  <clip pos="3" side="tl" part="nbr"/>
                </lu></mlu>
            </out> 
            
          </when>
          
          
          <when>
            <test>
              <equal caseless="yes">
                <clip pos="2" side="sl" part="lem"/>
                <lit v="se"/>
              </equal>
            </test>
            
            <out>
              <lu>
                <clip pos="1" side="tl" part="whole"/> 
              </lu> 
              <b/>
              <mlu><lu>
                  <clip pos="4" side="tl" part="whole"/> 
                </lu>
                <lu>
                  <get-case-from pos="2">
                    <lit v="lle"/>
                  </get-case-from>
                  <lit-tag v="prn.enc.p3.mf.sg"/>
                </lu>
                <lu>
                  <clip pos="3" side="tl" part="lem"/>
                  <lit-tag v="prn.enc"/>
                  <clip pos="3" side="tl" part="persona"/>
                  <clip pos="3" side="tl" part="gen"/>
                  <clip pos="3" side="tl" part="nbr"/>
                </lu></mlu>
            </out> 
            
          </when>
          
          <otherwise>
            
            <out>
              <lu>
                <clip pos="1" side="tl" part="whole"/> 
              </lu> 
              <b/>
              <mlu><lu>
                  <clip pos="4" side="tl" part="whole"/> 
                </lu>
                <lu>
                  <clip pos="2" side="tl" part="lem"/>
                  <lit-tag v="prn.enc"/>
                  <clip pos="2" side="tl" part="persona"/>
                  <clip pos="2" side="tl" part="gen"/>
                  <clip pos="2" side="tl" part="nbr"/>
                </lu>
                <lu>
                  <clip pos="3" side="tl" part="lem"/>
                  <lit-tag v="prn.enc"/>
                  <clip pos="3" side="tl" part="persona"/>
                  <clip pos="3" side="tl" part="gen"/>
                  <clip pos="3" side="tl" part="nbr"/>
                </lu></mlu>
            </out> 
            
          </otherwise>
          
        </choose>
      </action>
    </rule>
    
    
    
    
    <!-- REGRA EGV05: proref+pro+v
         -->
    
    <rule>
      <pattern>
        <pattern-item n="prnproref"/>
        <pattern-item n="prnpro"/>
        <pattern-item n="verb"/>
      </pattern>
      
      <action>
        <choose>
          <when>
            <test>
              <and>
                <equal caseless="yes">
                  <clip pos="1" side="sl" part="lem"/>
                  <lit v="se"/>
                </equal>  
                <equal caseless="yes">
                  <clip pos="2" side="sl" part="lem"/>
                  <lit v="le"/>
                </equal>
              </and>           
            </test>
            <out>
              <mlu><lu>
                  <get-case-from pos="1">
                    <clip pos="3" side="tl" part="lem"/>
                  </get-case-from>
                  <clip pos="3" side="tl" part="a_verb"/>
                  <clip pos="3" side="tl" part="temps"/>
                  <clip pos="3" side="tl" part="persona"/>
                  <clip pos="3" side="tl" part="nbr"/>
                </lu>
                <lu>
                  <get-case-from pos="2">
                    <lit v="se"/>
                  </get-case-from>
                  <lit-tag v="prn.enc.ref.p3.mf.sp"/>
                </lu>
                <lu>
                  <get-case-from pos="2">
                    <clip pos="2" side="tl" part="lem"/>
                  </get-case-from>
                  <lit-tag v="prn.enc"/>
                  <clip pos="2" side="tl" part="persona"/>
                  <clip pos="2" side="tl" part="gen"/>
                  <clip pos="2" side="tl" part="nbr"/>
                </lu></mlu>
            </out> 
          </when>
          <otherwise>
            
            <out>
              <mlu><lu>
                  <get-case-from pos="1">
                    <clip pos="3" side="tl" part="lem"/>
                  </get-case-from>
                  <clip pos="3" side="tl" part="a_verb"/>
                  <clip pos="3" side="tl" part="temps"/>
                  <clip pos="3" side="tl" part="persona"/>
                  <clip pos="3" side="tl" part="nbr"/>
                </lu>
                <lu>
                  <get-case-from pos="2">
                    <lit v="lle"/>
                  </get-case-from>
                  <lit-tag v="prn.enc.p3.mf.sg"/>
                </lu>
                <lu>
                  <get-case-from pos="2">
                    <clip pos="2" side="tl" part="lem"/>
                  </get-case-from>
                  <lit-tag v="prn.enc"/>
                  <clip pos="2" side="tl" part="persona"/>
                  <clip pos="2" side="tl" part="gen"/>
                  <clip pos="2" side="tl" part="nbr"/>
                </lu></mlu>
            </out> 
          </otherwise>
          
        </choose>
      </action>
    </rule>
    
    <!--REGRA EGV06: pro+pro+vC
              -->
    
    <rule>
      <pattern>
        <pattern-item n="prnpro"/>
        <pattern-item n="prnpro"/>
        <pattern-item n="verb"/>
      </pattern>
      <action>
        <out>
          <mlu><lu>
              <get-case-from pos="1">
                <clip pos="3" side="tl" part="lem"/>
              </get-case-from>
              <clip pos="3" side="tl" part="a_verb"/>
              <clip pos="3" side="tl" part="temps"/>
              <clip pos="3" side="tl" part="persona"/>
              <clip pos="3" side="tl" part="nbr"/>
            </lu>
            <lu>
              <get-case-from pos="2">
                <clip pos="1" side="tl" part="lem"/>
              </get-case-from>
              <lit-tag v="prn.enc"/>
              <clip pos="1" side="tl" part="persona"/>
              <clip pos="1" side="tl" part="gen"/>
              <clip pos="1" side="tl" part="nbr"/>
            </lu>
            <lu>
              <get-case-from pos="2">
                <clip pos="2" side="tl" part="lem"/>
              </get-case-from>
              <lit-tag v="prn.enc"/>
              <clip pos="2" side="tl" part="persona"/>
              <clip pos="2" side="tl" part="gen"/>
              <clip pos="2" side="tl" part="nbr"/>
            </lu></mlu>
        </out> 
      </action>
    </rule>
    
    
    
    <!-- REGRA EGV07: proref+vC
         -->
    
    <rule>
      <pattern>
        <pattern-item n="prnproref"/>
        <pattern-item n="verb"/>
      </pattern>
      <action>
        <out>
          <mlu><lu>
              <get-case-from pos="1">
                <clip pos="2" side="tl" part="lem"/>
              </get-case-from>
              <clip pos="2" side="tl" part="a_verb"/>
              <clip pos="2" side="tl" part="temps"/>
              <clip pos="2" side="tl" part="persona"/>
              <clip pos="2" side="tl" part="nbr"/>
            </lu>
            <lu>
              <get-case-from pos="2">
                <clip pos="1" side="tl" part="lem"/>
              </get-case-from>
              <lit-tag v="prn.enc.ref"/>
              <clip pos="1" side="tl" part="persona"/>
              <clip pos="1" side="tl" part="gen"/>
              <clip pos="1" side="tl" part="nbr"/>
            </lu></mlu>
        </out> 
      </action>
    </rule>
    
    <!-- REGRA EGV08: pro+vC
         -->
    
    <rule>
      <pattern>
        <pattern-item n="prnpro"/>
        <pattern-item n="verb"/>
      </pattern>
      <action>
        <out>
          <mlu><lu>
              <get-case-from pos="1">
                <clip pos="2" side="tl" part="lem"/>
              </get-case-from>
              <clip pos="2" side="tl" part="a_verb"/>
              <clip pos="2" side="tl" part="temps"/>
              <clip pos="2" side="tl" part="persona"/>
              <clip pos="2" side="tl" part="nbr"/>
            </lu>
            <lu>
              <get-case-from pos="2">
                <clip pos="1" side="tl" part="lem"/>
              </get-case-from>
              <lit-tag v="prn.enc"/>
              <clip pos="1" side="tl" part="persona"/>
              <clip pos="1" side="tl" part="gen"/>
              <clip pos="1" side="tl" part="nbr"/>
            </lu></mlu>
        </out> 
      </action>
    </rule>
    
    
    <!-- REGRA EGV09: proref+vC
         
         -->
    
    <rule>
      <pattern>
        <pattern-item n="proclise"/>
        <pattern-item n="prnproref"/>
        <pattern-item n="verb"/>
      </pattern>
      
      <action>
        <choose>
          <when>
            <test>
              <in caseless="yes"><!--in-->
                <clip pos="1" side="sl" part="lem"/>
                <list n="pces"/>
              </in>
            </test>
            
            <out>
              <lu>
                <clip pos="1" side="tl" part="whole"/> 
              </lu>
              <b/>
              <lu>
                <clip pos="2" side="tl" part="whole"/> 
              </lu>
              <b/>
              <lu>
                <clip pos="3" side="tl" part="whole"/>
                
              </lu>
            </out> 
            
          </when>
          
          <otherwise>
            <out>
              <lu>
                <clip pos="1" side="tl" part="whole"/> 
              </lu> 
              <b/>
              <mlu><lu>
                  <clip pos="3" side="tl" part="lem"/>
                  <clip pos="3" side="tl" part="a_verb"/>
                  <clip pos="3" side="tl" part="temps"/>
                  <clip pos="3" side="tl" part="persona"/>
                  <clip pos="3" side="tl" part="nbr"/>
                </lu>
                <lu>
                  <clip pos="2" side="tl" part="lem"/>
                  <lit-tag v="prn.enc.ref"/>
                  <clip pos="2" side="tl" part="persona"/>
                  <clip pos="2" side="tl" part="gen"/>
                  <clip pos="2" side="tl" part="nbr"/>
                </lu></mlu>
            </out> 
          </otherwise>
          
        </choose>
      </action>
    </rule>
    
    
    
    <!-- REGLA EGV10: pro+vC
         
         -->
    
    <rule>
      
      <pattern>
        <pattern-item n="proclise"/>
        <pattern-item n="prnpro"/>
        <pattern-item n="verb"/>
      </pattern>
      
      <action>
        <choose>
          <when>
            <test>
              <in caseless="yes"><!--in-->
                <clip pos="1" side="sl" part="lem"/>
                <list n="pces"/>
              </in>
            </test>
            
            <out>
              <lu>
                <clip pos="1" side="tl" part="whole"/> 
              </lu>
              <b/>
              <lu>
                <clip pos="2" side="tl" part="whole"/> 
              </lu>
              <b/>
              <lu>
                <clip pos="3" side="tl" part="whole"/>
                
              </lu>
            </out> 
            
          </when>
          
          <otherwise>
            <out>
              <lu>
                <clip pos="1" side="tl" part="whole"/> 
              </lu> 
              <b/>
              <mlu><lu>
                  <clip pos="3" side="tl" part="lem"/>
                  <clip pos="3" side="tl" part="a_verb"/>
                  <clip pos="3" side="tl" part="temps"/>
                  <clip pos="3" side="tl" part="persona"/>
                  <clip pos="3" side="tl" part="nbr"/>
                </lu>
                <lu>
                  <clip pos="2" side="tl" part="lem"/>
                  <lit-tag v="prn.enc"/>
                  <clip pos="2" side="tl" part="persona"/>
                  <clip pos="2" side="tl" part="gen"/>
                  <clip pos="2" side="tl" part="nbr"/>
                </lu></mlu>
            </out> 
          </otherwise>
          
        </choose>
      </action>
    </rule>
    
    <!-- REGRA EGV11: HABER + PP -->
    <rule>
      <pattern>
        <pattern-item n="haber"/>
        <pattern-item n="verb"/>
      </pattern>
      <action>
        <choose>
          <when>
            <test>
              <and>
                <equal>
                  <clip pos="1" side="sl" part="temps"/>
                  <lit-tag v="pri"/>
                </equal>
                <equal>
                  <clip pos="2" side="sl" part="temps"/>
                  <lit-tag v="pp"/>
                </equal>
                <equal>
                  <clip pos="2" side="sl" part="gen"/>
                  <lit-tag v="m"/>
                </equal>
                <equal>
                  <clip pos="2" side="sl" part="nbr"/>
                  <lit-tag v="sg"/>
                </equal>
              </and>
            </test>
            <out>
              <lu>
                <clip pos="2" side="tl" part="lemh"/>
                <clip pos="2" side="sl" part="a_verb"/>
                <lit-tag v="ifi"/>
                <clip pos="1" side="sl" part="persona"/>
                <clip pos="1" side="sl" part="nbr"/>
                <clip pos="2" side="tl" part="lemq"/>
              </lu>
            </out>
            <call-macro n="f_bcond">
              <with-param pos="1"/>
            </call-macro>
          </when>
          
          
          <when>
            <test>
              <and>
                <equal>
                  <clip pos="1" side="sl" part="temps"/>
                  <lit-tag v="pii"/>
                </equal>
                <equal>
                  <clip pos="2" side="sl" part="temps"/>
                  <lit-tag v="pp"/>
                </equal>
                <equal>
                  <clip pos="2" side="sl" part="gen"/>
                  <lit-tag v="m"/>
                </equal>
                <equal>
                  <clip pos="2" side="sl" part="nbr"/>
                  <lit-tag v="sg"/>
                </equal>
              </and>
            </test>
            <out>
              <lu>
                <clip pos="2" side="tl" part="lemh"/>
                <clip pos="2" side="sl" part="a_verb"/>
                <lit-tag v="pmp"/>
                <clip pos="1" side="sl" part="persona"/>
                <clip pos="1" side="sl" part="nbr"/>
                <clip pos="2" side="tl" part="lemq"/>
              </lu>
            </out>
            <call-macro n="f_bcond">
              <with-param pos="1"/>
            </call-macro>
          </when>
          
          <when>
            <test>
              <and>
                <or><equal>
                    <clip pos="1" side="sl" part="temps"/>
                    <lit-tag v="fti"/>
                  </equal>
                  <equal>
                    <clip pos="1" side="sl" part="temps"/>
                    <lit-tag v="cni"/>
                  </equal></or>
                <equal>
                  <clip pos="2" side="sl" part="temps"/>
                  <lit-tag v="pp"/>
                </equal>
                <equal>
                  <clip pos="2" side="sl" part="gen"/>
                  <lit-tag v="m"/>
                </equal>
                <equal>
                  <clip pos="2" side="sl" part="nbr"/>
                  <lit-tag v="sg"/>
                </equal>
              </and>
            </test>
            <out>
              <lu>
                <clip pos="2" side="tl" part="lemh"/>
                <clip pos="2" side="sl" part="a_verb"/>
                <lit-tag v="cni"/>
                <clip pos="1" side="sl" part="persona"/>
                <clip pos="1" side="sl" part="nbr"/>
                <clip pos="2" side="tl" part="lemq"/>
              </lu>
            </out>
            <call-macro n="f_bcond">
              <with-param pos="1"/>
            </call-macro>
          </when>
          
          <when>
            <test>
              <and>
                <or>
                  <equal>
                    <clip pos="1" side="sl" part="temps"/>
                    <lit-tag v="pis"/>
                  </equal>
                  <equal>
                    <clip pos="1" side="sl" part="temps"/>
                    <lit-tag v="prs"/>
                  </equal>
                  <equal>
                    <clip pos="1" side="sl" part="temps"/>
                    <lit-tag v="inf"/>
                  </equal>
                  <equal>
                    <clip pos="1" side="sl" part="temps"/>
                    <lit-tag v="xer"/>
                  </equal></or>
                <equal>
                  <clip pos="2" side="sl" part="temps"/>
                  <lit-tag v="pp"/>
                </equal>
                <equal>
                  <clip pos="2" side="sl" part="gen"/>
                  <lit-tag v="m"/>
                </equal>
                <equal>
                  <clip pos="2" side="sl" part="nbr"/>
                  <lit-tag v="sg"/>
                </equal>
              </and>
            </test>
            <out>
              <lu>
                <clip pos="2" side="tl" part="lemh"/>
                <clip pos="2" side="sl" part="a_verb"/>
                <clip pos="1" side="sl" part="temps"/>
                <clip pos="1" side="sl" part="persona"/>
                <clip pos="1" side="sl" part="nbr"/>
                <clip pos="2" side="tl" part="lemq"/>
              </lu>
            </out>
            <call-macro n="f_bcond">
              <with-param pos="1"/>
            </call-macro>
          </when>
          
          <otherwise>
            <out>
              <lu>
                <clip pos="1" side="tl" part="whole"/> 
              </lu> 
              <b/>
              <lu>
                <clip pos="2" side="tl" part="whole"/> 
              </lu>
            </out> 
          </otherwise>
          
          
        </choose>
      </action>
    </rule>
    
    
    <rule>
      <pattern>
        <pattern-item n="prnproref"/>
        <pattern-item n="prnpro"/>
        <pattern-item n="haber"/>
        <pattern-item n="verb"/>
      </pattern>
      <action>
        <choose>
          <when>
            <test>
              <and>
                <equal caseless="yes">
                  <clip pos="1" side="sl" part="lem"/>
                  <lit v="se"/>
                </equal>  
                <equal caseless="yes">
                  <clip pos="2" side="sl" part="lem"/>
                  <lit v="le"/>
                </equal>
                <equal>
                  <clip pos="3" side="sl" part="temps"/>
                  <lit-tag v="pri"/>
                </equal>
                <equal>
                  <clip pos="4" side="sl" part="temps"/>
                  <lit-tag v="pp"/>
                </equal>
                <equal>
                  <clip pos="4" side="sl" part="gen"/>
                  <lit-tag v="m"/>
                </equal>
                <equal>
                  <clip pos="4" side="sl" part="nbr"/>
                  <lit-tag v="sg"/>
                </equal>
              </and>
            </test>
            <out>
              <mlu><lu>
                  <get-case-from pos="1">
                    <clip pos="4" side="tl" part="lem"/>
                  </get-case-from> 
                  <clip pos="4" side="sl" part="a_verb"/>
                  <lit-tag v="ifi"/>
                  <clip pos="3" side="sl" part="persona"/>
                  <clip pos="3" side="sl" part="nbr"/>
                </lu>
                
                <lu>
                  <get-case-from pos="2">
                    <lit v="se"/>
                  </get-case-from>
                  <lit-tag v="prn.enc.ref.p3.mf.sp"/>
                </lu>
                
                <lu>
                  <get-case-from pos="2">
                    <clip pos="2" side="tl" part="lem"/>
                  </get-case-from>
                  <lit-tag v="prn.enc"/>
                  <clip pos="2" side="tl" part="persona"/>
                  <clip pos="2" side="tl" part="gen"/>
                  <clip pos="2" side="tl" part="nbr"/>
                </lu></mlu>
              
            </out> 
          </when>
          <when>
            <test>
              <and>
                <equal>
                  <clip pos="3" side="sl" part="temps"/>
                  <lit-tag v="pri"/>
                </equal>
                <equal>
                  <clip pos="4" side="sl" part="temps"/>
                  <lit-tag v="pp"/>
                </equal>
                <equal>
                  <clip pos="4" side="sl" part="gen"/>
                  <lit-tag v="m"/>
                </equal>
                <equal>
                  <clip pos="4" side="sl" part="nbr"/>
                  <lit-tag v="sg"/>
                </equal>
              </and>
            </test>
            <out>
              <mlu><lu>
                  <get-case-from pos="1">
                    <clip pos="4" side="tl" part="lem"/>
                  </get-case-from> 
                  <clip pos="4" side="sl" part="a_verb"/>
                  <lit-tag v="ifi"/>
                  <clip pos="3" side="sl" part="persona"/>
                  <clip pos="3" side="sl" part="nbr"/>
                </lu>
                
                <lu>
                  <get-case-from pos="2">
                    <lit v="lle"/>
                  </get-case-from>
                  <lit-tag v="prn.enc.p3.mf.sg"/>
                </lu>
                
                <lu>
                  <get-case-from pos="2">
                    <clip pos="2" side="tl" part="lem"/>
                  </get-case-from>
                  <lit-tag v="prn.enc"/>
                  <clip pos="2" side="tl" part="persona"/>
                  <clip pos="2" side="tl" part="gen"/>
                  <clip pos="2" side="tl" part="nbr"/>
                </lu></mlu>
              
            </out> 
          </when>
          
          <when>
            <test>
              <and>
                <equal caseless="yes">
                  <clip pos="1" side="sl" part="lem"/>
                  <lit v="se"/>
                </equal>  
                <equal caseless="yes">
                  <clip pos="2" side="sl" part="lem"/>
                  <lit v="le"/>
                </equal>
                <equal>
                  <clip pos="3" side="sl" part="temps"/>
                  <lit-tag v="pii"/>
                </equal>
                <equal>
                  <clip pos="4" side="sl" part="temps"/>
                  <lit-tag v="pp"/>
                </equal>
                <equal>
                  <clip pos="4" side="sl" part="gen"/>
                  <lit-tag v="m"/>
                </equal>
                <equal>
                  <clip pos="4" side="sl" part="nbr"/>
                  <lit-tag v="sg"/>
                </equal>
              </and>
            </test>
            <out>
              <mlu><lu>
                  <get-case-from pos="1">
                    <clip pos="4" side="tl" part="lem"/>
                  </get-case-from> 
                  <clip pos="4" side="sl" part="a_verb"/>
                  <lit-tag v="pmp.p3"/>
                  <!--clip pos="3" side="sl" part="persona"/-->
                  <clip pos="3" side="sl" part="nbr"/>
                </lu>
                
                <lu>
                  <get-case-from pos="2">
                    <lit v="se"/>
                  </get-case-from>
                  <lit-tag v="prn.enc.ref.p3.mf.sp"/>
                </lu>
                
                <lu>
                  <get-case-from pos="2">
                    <clip pos="2" side="tl" part="lem"/>
                  </get-case-from>
                  <lit-tag v="prn.enc"/>
                  <clip pos="2" side="tl" part="persona"/>
                  <clip pos="2" side="tl" part="gen"/>
                  <clip pos="2" side="tl" part="nbr"/>
                </lu></mlu>
              
            </out> 
          </when>       
          <when>
            <test>
              <and>
                <equal>
                  <clip pos="3" side="sl" part="temps"/>
                  <lit-tag v="pii"/>
                </equal>
                <equal>
                  <clip pos="4" side="sl" part="temps"/>
                  <lit-tag v="pp"/>
                </equal>
                <equal>
                  <clip pos="4" side="sl" part="gen"/>
                  <lit-tag v="m"/>
                </equal>
                <equal>
                  <clip pos="4" side="sl" part="nbr"/>
                  <lit-tag v="sg"/>
                </equal>
              </and>
            </test>
            <out>
              <mlu><lu>
                  <get-case-from pos="1">
                    <clip pos="4" side="tl" part="lem"/>
                  </get-case-from> 
                  <clip pos="4" side="sl" part="a_verb"/>
                  <lit-tag v="pmp"/>
                  <clip pos="3" side="sl" part="persona"/>
                  <clip pos="3" side="sl" part="nbr"/>
                </lu>
                
                <lu>
                  <get-case-from pos="2">
                    <lit v="lle"/>
                  </get-case-from>
                  <lit-tag v="prn.enc.p3.mf.sg"/>
                </lu>
                
                <lu>
                  <get-case-from pos="2">
                    <clip pos="2" side="tl" part="lem"/>
                  </get-case-from>
                  <lit-tag v="prn.enc"/>
                  <clip pos="2" side="tl" part="persona"/>
                  <clip pos="2" side="tl" part="gen"/>
                  <clip pos="2" side="tl" part="nbr"/>
                </lu></mlu>
              
            </out> 
          </when>
          
          <when>
            <test>
              <and>
                <or>
                  <equal>
                    <clip pos="3" side="sl" part="temps"/>
                    <lit-tag v="fti"/>
                  </equal>
                  <equal>
                    <clip pos="3" side="sl" part="temps"/>
                    <lit-tag v="cni"/>
                  </equal>
                </or>
                <equal caseless="yes">
                  <clip pos="1" side="sl" part="lem"/>
                  <lit v="se"/>
                </equal>  
                <equal caseless="yes">
                  <clip pos="2" side="sl" part="lem"/>
                  <lit v="le"/>
                </equal>
                <equal>
                  <clip pos="4" side="sl" part="temps"/>
                  <lit-tag v="pp"/>
                </equal>
                <equal>
                  <clip pos="4" side="sl" part="gen"/>
                  <lit-tag v="m"/>
                </equal>
                <equal>
                  <clip pos="4" side="sl" part="nbr"/>
                  <lit-tag v="sg"/>
                </equal>
              </and>
            </test>
            <out>
              <mlu><lu>
                  <get-case-from pos="1">
                    <clip pos="4" side="tl" part="lem"/>
                  </get-case-from> 
                  <clip pos="4" side="sl" part="a_verb"/>
                  <lit-tag v="cni.p3"/>
                  <clip pos="3" side="sl" part="nbr"/>
                </lu>
                
                <lu>
                  <get-case-from pos="2">
                    <lit v="se"/>
                  </get-case-from>
                  <lit-tag v="prn.enc.ref.p3.mf.sp"/>
                </lu>
                
                <lu>
                  <get-case-from pos="2">
                    <clip pos="2" side="tl" part="lem"/>
                  </get-case-from>
                  <lit-tag v="prn.enc"/>
                  <clip pos="2" side="tl" part="persona"/>
                  <clip pos="2" side="tl" part="gen"/>
                  <clip pos="2" side="tl" part="nbr"/>
                </lu></mlu>
              
            </out> 
          </when>         
          <when>
            <test>
              <and>
                <or>
                  <equal>
                    <clip pos="3" side="sl" part="temps"/>
                    <lit-tag v="fti"/>
                  </equal>
                  <equal>
                    <clip pos="3" side="sl" part="temps"/>
                    <lit-tag v="cni"/>
                  </equal>
                </or>
                <equal>
                  <clip pos="4" side="sl" part="temps"/>
                  <lit-tag v="pp"/>
                </equal>
                <equal>
                  <clip pos="4" side="sl" part="gen"/>
                  <lit-tag v="m"/>
                </equal>
                <equal>
                  <clip pos="4" side="sl" part="nbr"/>
                  <lit-tag v="sg"/>
                </equal>
              </and>
            </test>
            <out>
              <mlu><lu>
                  <get-case-from pos="1">
                    <clip pos="4" side="tl" part="lem"/>
                  </get-case-from> 
                  <clip pos="4" side="sl" part="a_verb"/>
                  <lit-tag v="cni"/>
                  <clip pos="3" side="sl" part="persona"/>
                  <clip pos="3" side="sl" part="nbr"/>
                </lu>
                
                <lu>
                  <get-case-from pos="2">
                    <lit v="lle"/>
                  </get-case-from>
                  <lit-tag v="prn.enc.p3.mf.sg"/>
                </lu>
                
                <lu>
                  <get-case-from pos="2">
                    <clip pos="2" side="tl" part="lem"/>
                  </get-case-from>
                  <lit-tag v="prn.enc"/>
                  <clip pos="2" side="tl" part="persona"/>
                  <clip pos="2" side="tl" part="gen"/>
                  <clip pos="2" side="tl" part="nbr"/>
                </lu></mlu>
              
            </out> 
          </when>
          
          <when>
            <test>
              <and>
                <or>
                  <equal>
                    <clip pos="3" side="sl" part="temps"/>
                    <lit-tag v="pis"/>
                  </equal>
                  <equal>
                    <clip pos="3" side="sl" part="temps"/>
                    <lit-tag v="prs"/>
                  </equal>
                </or>
                <equal caseless="yes">
                  <clip pos="1" side="sl" part="lem"/>
                  <lit v="se"/>
                </equal>  
                <equal caseless="yes">
                  <clip pos="2" side="sl" part="lem"/>
                  <lit v="le"/>
                </equal>
                <equal>
                  <clip pos="4" side="sl" part="temps"/>
                  <lit-tag v="pp"/>
                </equal>
                <equal>
                  <clip pos="4" side="sl" part="gen"/>
                  <lit-tag v="m"/>
                </equal>
                <equal>
                  <clip pos="4" side="sl" part="nbr"/>
                  <lit-tag v="sg"/>
                </equal>
              </and>
            </test>
            <out>
              <mlu><lu>
                  <get-case-from pos="1">
                    <clip pos="4" side="tl" part="lem"/>
                  </get-case-from> 
                  <clip pos="4" side="sl" part="a_verb"/>
                  <clip pos="3" side="sl" part="temps"/>
                  <lit-tag v="p3"/>
                  <clip pos="3" side="sl" part="nbr"/>
                </lu>
                
                <lu>
                  <get-case-from pos="2">
                    <lit v="se"/>
                  </get-case-from>
                  <lit-tag v="prn.enc.ref.p3.mf.sp"/>
                </lu>
                
                <lu>
                  <get-case-from pos="2">
                    <clip pos="2" side="tl" part="lem"/>
                  </get-case-from>
                  <lit-tag v="prn.enc"/>
                  <clip pos="2" side="tl" part="persona"/>
                  <clip pos="2" side="tl" part="gen"/>
                  <clip pos="2" side="tl" part="nbr"/>
                </lu></mlu>
              
            </out> 
          </when>        
          <when>
            <test>
              <and>
                <or>
                  <equal>
                    <clip pos="3" side="sl" part="temps"/>
                    <lit-tag v="pis"/>
                  </equal>
                  <equal>
                    <clip pos="3" side="sl" part="temps"/>
                    <lit-tag v="prs"/>
                  </equal>
                </or>
                <equal>
                  <clip pos="4" side="sl" part="temps"/>
                  <lit-tag v="pp"/>
                </equal>
                <equal>
                  <clip pos="4" side="sl" part="gen"/>
                  <lit-tag v="m"/>
                </equal>
                <equal>
                  <clip pos="4" side="sl" part="nbr"/>
                  <lit-tag v="sg"/>
                </equal>
              </and>
            </test>
            <out>
              <mlu><lu>
                  <get-case-from pos="1">
                    <clip pos="4" side="tl" part="lem"/>
                  </get-case-from> 
                  <clip pos="4" side="sl" part="a_verb"/>
                  <clip pos="3" side="sl" part="temps"/>
                  <clip pos="3" side="sl" part="persona"/>
                  <clip pos="3" side="sl" part="nbr"/>
                </lu>
                
                <lu>
                  <get-case-from pos="2">
                    <lit v="lle"/>
                  </get-case-from>
                  <lit-tag v="prn.enc.p3.mf.sg"/>
                </lu>
                
                <lu>
                  <get-case-from pos="2">
                    <clip pos="2" side="tl" part="lem"/>
                  </get-case-from>
                  <lit-tag v="prn.enc"/>
                  <clip pos="2" side="tl" part="persona"/>
                  <clip pos="2" side="tl" part="gen"/>
                  <clip pos="2" side="tl" part="nbr"/>
                </lu></mlu>
              
            </out> 
          </when>
          
          
          
          <otherwise>
            <out>
              <lu>
                <clip pos="1" side="tl" part="whole"/> 
              </lu> 
              <b/>
              <lu>
                <clip pos="2" side="tl" part="whole"/> 
              </lu>
              <b/>
              <lu>
                <clip pos="3" side="tl" part="whole"/> 
              </lu>
              <b/>
              <lu>
                <clip pos="4" side="tl" part="whole"/> 
              </lu>
            </out> 
          </otherwise>
          
          
        </choose>
      </action>
    </rule>
    
    
    <rule>
      <pattern>
        <pattern-item n="prnpro"/>
        <pattern-item n="prnpro"/>
        <pattern-item n="haber"/>
        <pattern-item n="verb"/>
      </pattern>
      <action>
        <choose>
          <when>
            <test>
              <and>
                <equal>
                  <clip pos="3" side="sl" part="temps"/>
                  <lit-tag v="pri"/>
                </equal>
                <equal>
                  <clip pos="4" side="sl" part="temps"/>
                  <lit-tag v="pp"/>
                </equal>
                <equal>
                  <clip pos="4" side="sl" part="gen"/>
                  <lit-tag v="m"/>
                </equal>
                <equal>
                  <clip pos="4" side="sl" part="nbr"/>
                  <lit-tag v="sg"/>
                </equal>
              </and>
            </test>
            <out>
              <mlu><lu>
                  <get-case-from pos="1">
                    <clip pos="4" side="tl" part="lem"/>
                  </get-case-from> 
                  <clip pos="4" side="sl" part="a_verb"/>
                  <lit-tag v="ifi"/>
                  <clip pos="3" side="sl" part="persona"/>
                  <clip pos="3" side="sl" part="nbr"/>
                </lu>
                <lu>
                  <get-case-from pos="2">
                    <clip pos="1" side="tl" part="lem"/>
                  </get-case-from>
                  <lit-tag v="prn.enc"/>
                  <clip pos="1" side="tl" part="persona"/>
                  <clip pos="1" side="tl" part="gen"/>
                  <clip pos="1" side="tl" part="nbr"/>
                </lu>
                <lu>
                  <get-case-from pos="2">
                    <clip pos="2" side="tl" part="lem"/>
                  </get-case-from>
                  <lit-tag v="prn.enc"/>
                  <clip pos="2" side="tl" part="persona"/>
                  <clip pos="2" side="tl" part="gen"/>
                  <clip pos="2" side="tl" part="nbr"/>
                </lu></mlu>
              
            </out> 
          </when>
          
          <when>
            <test>
              <and>
                <equal>
                  <clip pos="3" side="sl" part="temps"/>
                  <lit-tag v="pii"/>
                </equal>
                <equal>
                  <clip pos="4" side="sl" part="temps"/>
                  <lit-tag v="pp"/>
                </equal>
                <equal>
                  <clip pos="4" side="sl" part="gen"/>
                  <lit-tag v="m"/>
                </equal>
                <equal>
                  <clip pos="4" side="sl" part="nbr"/>
                  <lit-tag v="sg"/>
                </equal>
              </and>
            </test>
            <out>
              <mlu><lu>
                  <get-case-from pos="1">
                    <clip pos="4" side="tl" part="lem"/>
                  </get-case-from> 
                  <clip pos="4" side="sl" part="a_verb"/>
                  <lit-tag v="pmp"/>
                  <clip pos="3" side="sl" part="persona"/>
                  <clip pos="3" side="sl" part="nbr"/>
                </lu>
                <lu>
                  <get-case-from pos="2">
                    <clip pos="1" side="tl" part="lem"/>
                  </get-case-from>
                  <lit-tag v="prn.enc"/>
                  <clip pos="1" side="tl" part="persona"/>
                  <clip pos="1" side="tl" part="gen"/>
                  <clip pos="1" side="tl" part="nbr"/>
                </lu>
                <lu>
                  <get-case-from pos="2">
                    <clip pos="2" side="tl" part="lem"/>
                  </get-case-from>
                  <lit-tag v="prn.enc"/>
                  <clip pos="2" side="tl" part="persona"/>
                  <clip pos="2" side="tl" part="gen"/>
                  <clip pos="2" side="tl" part="nbr"/>
                </lu></mlu>
              
            </out> 
          </when>
          
          <when>
            <test>
              <and>
                <or><equal>
                    <clip pos="3" side="sl" part="temps"/>
                    <lit-tag v="fti"/>
                  </equal>
                  <equal>
                    <clip pos="3" side="sl" part="temps"/>
                    <lit-tag v="cni"/>
                  </equal></or>
                <equal>
                  <clip pos="4" side="sl" part="temps"/>
                  <lit-tag v="pp"/>
                </equal>
                <equal>
                  <clip pos="4" side="sl" part="gen"/>
                  <lit-tag v="m"/>
                </equal>
                <equal>
                  <clip pos="4" side="sl" part="nbr"/>
                  <lit-tag v="sg"/>
                </equal>
              </and>
            </test>
            <out>
              <mlu><lu>
                  <get-case-from pos="1">
                    <clip pos="4" side="tl" part="lem"/>
                  </get-case-from> 
                  <clip pos="4" side="sl" part="a_verb"/>
                  <lit-tag v="cni"/>
                  <clip pos="3" side="sl" part="persona"/>
                  <clip pos="3" side="sl" part="nbr"/>
                </lu>
                <lu>
                  <get-case-from pos="2">
                    <clip pos="1" side="tl" part="lem"/>
                  </get-case-from>
                  <lit-tag v="prn.enc"/>
                  <clip pos="1" side="tl" part="persona"/>
                  <clip pos="1" side="tl" part="gen"/>
                  <clip pos="1" side="tl" part="nbr"/>
                </lu>
                <lu>
                  <get-case-from pos="2">
                    <clip pos="2" side="tl" part="lem"/>
                  </get-case-from>
                  <lit-tag v="prn.enc"/>
                  <clip pos="2" side="tl" part="persona"/>
                  <clip pos="2" side="tl" part="gen"/>
                  <clip pos="2" side="tl" part="nbr"/>
                </lu></mlu>
              
            </out> 
          </when>
          
          
          <when>
            <test>
              <and>
                <or><equal>
                    <clip pos="3" side="sl" part="temps"/>
                    <lit-tag v="pis"/>
                  </equal>
                  <equal>
                    <clip pos="3" side="sl" part="temps"/>
                    <lit-tag v="prs"/>
                  </equal>
                  <equal>
                    <clip pos="3" side="sl" part="temps"/>
                    <lit-tag v="inf"/>
                  </equal>
                  <equal>
                    <clip pos="3" side="sl" part="temps"/>
                    <lit-tag v="xer"/>
                  </equal></or>
                <equal>
                  <clip pos="4" side="sl" part="temps"/>
                  <lit-tag v="pp"/>
                </equal>
                <equal>
                  <clip pos="4" side="sl" part="gen"/>
                  <lit-tag v="m"/>
                </equal>
                <equal>
                  <clip pos="4" side="sl" part="nbr"/>
                  <lit-tag v="sg"/>
                </equal>
              </and>
            </test>
            <out>
              <mlu><lu>
                  <get-case-from pos="1">
                    <clip pos="4" side="tl" part="lem"/>
                  </get-case-from> 
                  <clip pos="4" side="sl" part="a_verb"/>
                  <clip pos="3" side="sl" part="temps"/>
                  <clip pos="3" side="sl" part="persona"/>
                  <clip pos="3" side="sl" part="nbr"/>
                </lu>
                <lu>
                  <get-case-from pos="2">
                    <clip pos="1" side="tl" part="lem"/>
                  </get-case-from>
                  <lit-tag v="prn.enc"/>
                  <clip pos="1" side="tl" part="persona"/>
                  <clip pos="1" side="tl" part="gen"/>
                  <clip pos="1" side="tl" part="nbr"/>
                </lu>
                <lu>
                  <get-case-from pos="2">
                    <clip pos="2" side="tl" part="lem"/>
                  </get-case-from>
                  <lit-tag v="prn.enc"/>
                  <clip pos="2" side="tl" part="persona"/>
                  <clip pos="2" side="tl" part="gen"/>
                  <clip pos="2" side="tl" part="nbr"/>
                </lu></mlu>
              
            </out> 
          </when>
          
          
          <otherwise>
            <out>
              <lu>
                <clip pos="1" side="tl" part="whole"/> 
              </lu> 
              <b/>
              <lu>
                <clip pos="2" side="tl" part="whole"/> 
              </lu>
              <b/>
              <lu>
                <clip pos="3" side="tl" part="whole"/> 
              </lu>
              <b/>
              <lu>
                <clip pos="4" side="tl" part="whole"/> 
              </lu>
            </out> 
          </otherwise>
          
          
        </choose>
      </action>
    </rule>
    
    
    <!-- REGRA EGV12: HABER + PP: proref+vC
         -->
    
    
    <rule>
      <pattern>
        <pattern-item n="proclise"/>
        <pattern-item n="prnproref"/>
        <pattern-item n="haber"/>
        <pattern-item n="verb"/>
      </pattern>
      <action>
        <choose>
          
          
          
          <when>
            <test>
              <and>
                <in caseless="yes"><!--in-->
                  <clip pos="1" side="sl" part="lem"/>
                  <list n="pces"/>
                </in>
                <equal>
                  <clip pos="4" side="sl" part="temps"/>
                  <lit-tag v="pp"/>
                </equal>
                <equal>
                  <clip pos="4" side="sl" part="gen"/>
                  <lit-tag v="m"/>
                </equal>
                <equal>
                  <clip pos="4" side="sl" part="nbr"/>
                  <lit-tag v="sg"/>
                </equal>
              </and>
            </test>
            <out>
              <lu>
                <clip pos="1" side="tl" part="whole"/> 
              </lu> 
              <b/>
              <lu>
                <clip pos="2" side="tl" part="whole"/> 
              </lu> 
              <b/>
              <lu>
                <clip pos="4" side="tl" part="lem"/> 
                <clip pos="4" side="sl" part="a_verb"/>
                <lit-tag v="ifi"/>
                <clip pos="3" side="sl" part="persona"/>
                <clip pos="3" side="sl" part="nbr"/>
              </lu>
            </out> 
          </when>
          
          
          
          <when>
            <test>
              <and>
                <equal>
                  <clip pos="4" side="sl" part="temps"/>
                  <lit-tag v="pp"/>
                </equal>
                <equal>
                  <clip pos="4" side="sl" part="gen"/>
                  <lit-tag v="m"/>
                </equal>
                <equal>
                  <clip pos="4" side="sl" part="nbr"/>
                  <lit-tag v="sg"/>
                </equal>
              </and>
            </test>
            <out>
              <lu>
                <clip pos="1" side="tl" part="whole"/> 
              </lu> 
              <b/>
              <mlu><lu>
                  <get-case-from pos="2">
                    <clip pos="4" side="tl" part="lem"/>
                  </get-case-from> 
                  <clip pos="4" side="sl" part="a_verb"/>
                  <lit-tag v="ifi"/>
                  <clip pos="3" side="sl" part="persona"/>
                  <clip pos="3" side="sl" part="nbr"/>
                </lu>
                <lu>
                  <get-case-from pos="3">
                    <clip pos="2" side="tl" part="lem"/>
                  </get-case-from>
                  <lit-tag v="prn.enc.ref"/>
                  <clip pos="2" side="tl" part="persona"/>
                  <clip pos="2" side="tl" part="gen"/>
                  <clip pos="2" side="tl" part="nbr"/>
                </lu></mlu>
              
            </out> 
          </when>
          
          
          
          <otherwise>
            <out>
              <lu>
                <clip pos="1" side="tl" part="whole"/> 
              </lu> 
              <b/>
              <lu>
                <clip pos="2" side="tl" part="whole"/> 
              </lu> 
              <b/>
              <lu>
                <clip pos="3" side="tl" part="whole"/> 
              </lu>
              <b/>
              <lu>
                <clip pos="4" side="tl" part="whole"/> 
              </lu>
            </out> 
          </otherwise>
          
          
        </choose>
      </action>
    </rule>
    
    <rule>
      <pattern>
        <pattern-item n="prnproref"/>
        <pattern-item n="haber"/>
        <pattern-item n="verb"/>
      </pattern>
      <action>
        <choose>
          <when>
            <test>
              <and>
                <equal>
                  <clip pos="3" side="sl" part="temps"/>
                  <lit-tag v="pp"/>
                </equal>
                <equal>
                  <clip pos="3" side="sl" part="gen"/>
                  <lit-tag v="m"/>
                </equal>
                <equal>
                  <clip pos="3" side="sl" part="nbr"/>
                  <lit-tag v="sg"/>
                </equal>
              </and>
            </test>
            <out>
              <mlu><lu>
                  <get-case-from pos="1">
                    <clip pos="3" side="tl" part="lem"/>
                  </get-case-from> 
                  <clip pos="3" side="sl" part="a_verb"/>
                  <lit-tag v="ifi"/>
                  <clip pos="2" side="sl" part="persona"/>
                  <clip pos="2" side="sl" part="nbr"/>
                </lu>
                <lu>
                  <get-case-from pos="2">
                    <clip pos="1" side="tl" part="lem"/>
                  </get-case-from>
                  <lit-tag v="prn.enc.ref"/>
                  <clip pos="1" side="tl" part="persona"/>
                  <clip pos="1" side="tl" part="gen"/>
                  <clip pos="1" side="tl" part="nbr"/>
                </lu></mlu>
              
            </out> 
          </when>
          
          
          <otherwise>
            <out>
              <lu>
                <clip pos="1" side="tl" part="whole"/> 
              </lu> 
              <b/>
              <lu>
                <clip pos="2" side="tl" part="whole"/> 
              </lu>
              <b/>
              <lu>
                <clip pos="3" side="tl" part="whole"/> 
              </lu>
            </out> 
          </otherwise>
          
          
        </choose>
      </action>
    </rule>
    
    
    <!-- REGRA EGV13: HABER + PP: pro+vC
         -->
    
    <rule>
      <pattern>
        <pattern-item n="proclise"/>
        <pattern-item n="prnpro"/>
        <pattern-item n="haber"/>
        <pattern-item n="verb"/>
      </pattern>
      <action>
        <choose>
          
          
          
          <when>
            <test>
              <and>
                
                <in caseless="yes"><!--in-->
                  <clip pos="1" side="sl" part="lem"/>
                  <list n="pces"/>
                </in>
                
                <equal>
                  <clip pos="4" side="sl" part="temps"/>
                  <lit-tag v="pp"/>
                </equal>
                <equal>
                  <clip pos="4" side="sl" part="gen"/>
                  <lit-tag v="m"/>
                </equal>
                <equal>
                  <clip pos="4" side="sl" part="nbr"/>
                  <lit-tag v="sg"/>
                </equal>
              </and>
            </test>
            <out>
              <lu>
                <clip pos="1" side="tl" part="whole"/> 
              </lu> 
              <b/>
              <lu>
                <clip pos="2" side="tl" part="whole"/> 
              </lu> 
              <b/>
              <lu>
                <clip pos="4" side="tl" part="lem"/> 
                <clip pos="4" side="sl" part="a_verb"/>
                <lit-tag v="ifi"/>
                <clip pos="3" side="sl" part="persona"/>
                <clip pos="3" side="sl" part="nbr"/>
              </lu>
            </out> 
          </when>
          
          
          
          <when>
            <test>
              <and>
                <equal>
                  <clip pos="4" side="sl" part="temps"/>
                  <lit-tag v="pp"/>
                </equal>
                <equal>
                  <clip pos="4" side="sl" part="gen"/>
                  <lit-tag v="m"/>
                </equal>
                <equal>
                  <clip pos="4" side="sl" part="nbr"/>
                  <lit-tag v="sg"/>
                </equal>
              </and>
            </test>
            <out>
              <lu>
                <clip pos="1" side="tl" part="whole"/> 
              </lu> 
              <b/>
              <mlu><lu>
                  <get-case-from pos="2">
                    <clip pos="4" side="tl" part="lem"/>
                  </get-case-from> 
                  <clip pos="4" side="sl" part="a_verb"/>
                  <lit-tag v="ifi"/>
                  <clip pos="3" side="sl" part="persona"/>
                  <clip pos="3" side="sl" part="nbr"/>
                </lu>
                <lu>
                  <get-case-from pos="3">
                    <clip pos="2" side="tl" part="lem"/>
                  </get-case-from>
                  <lit-tag v="prn.enc"/>
                  <clip pos="2" side="tl" part="persona"/>
                  <clip pos="2" side="tl" part="gen"/>
                  <clip pos="2" side="tl" part="nbr"/>
                </lu></mlu>
              
            </out> 
          </when>
          
          
          
          <otherwise>
            <out>
              <lu>
                <clip pos="1" side="tl" part="whole"/> 
              </lu> 
              <b/>
              <lu>
                <clip pos="2" side="tl" part="whole"/> 
              </lu> 
              <b/>
              <lu>
                <clip pos="3" side="tl" part="whole"/> 
              </lu>
              <b/>
              <lu>
                <clip pos="4" side="tl" part="whole"/> 
              </lu>
            </out> 
          </otherwise>
          
          
        </choose>
      </action>
    </rule>
    
    <rule>
      <pattern>
        <pattern-item n="prnpro"/>
        <pattern-item n="haber"/>
        <pattern-item n="verb"/>
      </pattern>
      <action>
        <choose>
          <when>
            <test>
              <and>
                <equal>
                  <clip pos="3" side="sl" part="temps"/>
                  <lit-tag v="pp"/>
                </equal>
                <equal>
                  <clip pos="3" side="sl" part="gen"/>
                  <lit-tag v="m"/>
                </equal>
                <equal>
                  <clip pos="3" side="sl" part="nbr"/>
                  <lit-tag v="sg"/>
                </equal>
              </and>
            </test>
            <out>
              <mlu><lu>
                  <get-case-from pos="1">
                    <clip pos="3" side="tl" part="lem"/>
                  </get-case-from> 
                  <clip pos="3" side="sl" part="a_verb"/>
                  <lit-tag v="ifi"/>
                  <clip pos="2" side="sl" part="persona"/>
                  <clip pos="2" side="sl" part="nbr"/>
                </lu>
                <lu>
                  <get-case-from pos="2">
                    <clip pos="1" side="tl" part="lem"/>
                  </get-case-from>
                  <lit-tag v="prn.enc"/>
                  <clip pos="1" side="tl" part="persona"/>
                  <clip pos="1" side="tl" part="gen"/>
                  <clip pos="1" side="tl" part="nbr"/>
                </lu></mlu>
              
            </out> 
          </when>
          
          
          <otherwise>
            <out>
              <lu>
                <clip pos="1" side="tl" part="whole"/> 
              </lu> 
              <b/>
              <lu>
                <clip pos="2" side="tl" part="whole"/> 
              </lu>
              <b/>
              <lu>
                <clip pos="3" side="tl" part="whole"/> 
              </lu>
            </out> 
          </otherwise>
          
          
        </choose>
      </action>
    </rule>
    
    
    
    
    
    <!-- EGV14.REGRA: HABER + PP: proref+propro+vC
         se lo ha besado - bicoullo
         
         -->
    
    
    
    <rule>
      <pattern>
        <pattern-item n="proclise"/>
        <pattern-item n="prnproref"/>
        <pattern-item n="prnpro"/>
        <pattern-item n="haber"/>
        <pattern-item n="verb"/>
      </pattern>
      <action>
        <choose>
          
          
          
          <when>
            <test>
              <and>
                
                <in caseless="yes"><!--in-->
                  <clip pos="1" side="sl" part="lem"/>
                  <list n="pces"/>
                </in>
                
                <equal>
                  <clip pos="5" side="sl" part="temps"/>
                  <lit-tag v="pp"/>
                </equal>
                <equal>
                  <clip pos="5" side="sl" part="gen"/>
                  <lit-tag v="m"/>
                </equal>
                <equal>
                  <clip pos="5" side="sl" part="nbr"/>
                  <lit-tag v="sg"/>
                </equal>
              </and>
            </test>
            <out>
              <lu>
                <clip pos="1" side="tl" part="whole"/> 
              </lu> 
              <b/>
              <lu>
                <clip pos="2" side="tl" part="whole"/> 
              </lu> 
              <b/>
              <lu>
                <clip pos="3" side="tl" part="whole"/> 
              </lu> 
              <b/>
              <lu>
                <clip pos="5" side="tl" part="lem"/> 
                <clip pos="5" side="sl" part="a_verb"/>
                <lit-tag v="ifi"/>
                <clip pos="4" side="sl" part="persona"/>
                <clip pos="4" side="sl" part="nbr"/>
              </lu>
            </out> 
          </when>
          
          
          
          <when>
            <test>
              <and>
                <equal>
                  <clip pos="5" side="sl" part="temps"/>
                  <lit-tag v="pp"/>
                </equal>
                <equal>
                  <clip pos="5" side="sl" part="gen"/>
                  <lit-tag v="m"/>
                </equal>
                <equal>
                  <clip pos="5" side="sl" part="nbr"/>
                  <lit-tag v="sg"/>
                </equal>
              </and>
            </test>
            <out>
              <lu>
                <clip pos="1" side="tl" part="whole"/> 
              </lu> 
              <b/>
              <mlu><lu>
                  <get-case-from pos="2">
                    <clip pos="5" side="tl" part="lem"/>
                  </get-case-from> 
                  <clip pos="5" side="sl" part="a_verb"/>
                  <lit-tag v="ifi"/>
                  <clip pos="4" side="sl" part="persona"/>
                  <clip pos="4" side="sl" part="nbr"/>
                </lu>
                <lu>
                  <get-case-from pos="2">
                    <lit v="lle"/>
                  </get-case-from>
                  <lit-tag v="prn.enc.p3.mf.sg"/>
                </lu>
                <lu>
                  <get-case-from pos="4">
                    <clip pos="3" side="tl" part="lem"/>
                  </get-case-from>
                  <lit-tag v="prn.enc"/>
                  <clip pos="3" side="tl" part="persona"/>
                  <clip pos="3" side="tl" part="gen"/>
                  <clip pos="3" side="tl" part="nbr"/>
                </lu></mlu>
              
            </out> 
          </when>
          
          
          
          <otherwise>
            <out>
              <lu>
                <clip pos="1" side="tl" part="whole"/> 
              </lu> 
              <b/>
              <lu>
                <clip pos="2" side="tl" part="whole"/> 
              </lu> 
              <b/>
              <lu>
                <clip pos="3" side="tl" part="whole"/> 
              </lu>
              <b/>
              <lu>
                <clip pos="4" side="tl" part="whole"/> 
              </lu>
              <b/>
              <lu>
                <clip pos="5" side="tl" part="whole"/> 
              </lu>
            </out> 
          </otherwise>
          
          
        </choose>
      </action>
    </rule>
    
    
    
    
    <!-- EGV15.REGRA: HABER + PP: propro+propro+vC
         me lo ha besado - bicoumo
         
         -->
    
    
    
    <rule>
      <pattern>
        <pattern-item n="proclise"/>
        <pattern-item n="prnpro"/>
        <pattern-item n="prnpro"/>
        <pattern-item n="haber"/>
        <pattern-item n="verb"/>
      </pattern>
      <action>
        <choose>
          
          
          
          <when>
            <test>
              <and>
                
                <in caseless="yes"><!--in-->
                  <clip pos="1" side="sl" part="lem"/>
                  <list n="pces"/>
                </in>
                
                <equal>
                  <clip pos="5" side="sl" part="temps"/>
                  <lit-tag v="pp"/>
                </equal>
                <equal>
                  <clip pos="5" side="sl" part="gen"/>
                  <lit-tag v="m"/>
                </equal>
                <equal>
                  <clip pos="5" side="sl" part="nbr"/>
                  <lit-tag v="sg"/>
                </equal>
              </and>
            </test>
            <out>
              <lu>
                <clip pos="1" side="tl" part="whole"/> 
              </lu> 
              <b/>
              <lu>
                <clip pos="2" side="tl" part="whole"/> 
              </lu> 
              <b/>
              <lu>
                <clip pos="3" side="tl" part="whole"/> 
              </lu> 
              <b/>
              <lu>
                <clip pos="5" side="tl" part="lem"/> 
                <clip pos="5" side="sl" part="a_verb"/>
                <lit-tag v="ifi"/>
                <clip pos="4" side="sl" part="persona"/>
                <clip pos="4" side="sl" part="nbr"/>
              </lu>
            </out> 
          </when>
          
          
          
          <when>
            <test>
              <and>
                <equal>
                  <clip pos="5" side="sl" part="temps"/>
                  <lit-tag v="pp"/>
                </equal>
                <equal>
                  <clip pos="5" side="sl" part="gen"/>
                  <lit-tag v="m"/>
                </equal>
                <equal>
                  <clip pos="5" side="sl" part="nbr"/>
                  <lit-tag v="sg"/>
                </equal>
              </and>
            </test>
            <out>
              <lu>
                <clip pos="1" side="tl" part="whole"/> 
              </lu> 
              <b/>
              <mlu><lu>
                  <get-case-from pos="2">
                    <clip pos="5" side="tl" part="lem"/>
                  </get-case-from> 
                  <clip pos="5" side="sl" part="a_verb"/>
                  <lit-tag v="ifi"/>
                  <clip pos="4" side="sl" part="persona"/>
                  <clip pos="4" side="sl" part="nbr"/>
                </lu>
                <lu>
                  <get-case-from pos="4">
                    <clip pos="2" side="tl" part="lem"/>
                  </get-case-from>
                  <lit-tag v="prn.enc"/>
                  <clip pos="2" side="tl" part="persona"/>
                  <clip pos="2" side="tl" part="gen"/>
                  <clip pos="2" side="tl" part="nbr"/>
                </lu>
                <lu>
                  <get-case-from pos="4">
                    <clip pos="3" side="tl" part="lem"/>
                  </get-case-from>
                  <lit-tag v="prn.enc"/>
                  <clip pos="3" side="tl" part="persona"/>
                  <clip pos="3" side="tl" part="gen"/>
                  <clip pos="3" side="tl" part="nbr"/>
                </lu></mlu>
              
            </out> 
          </when>
          
          
          
          <otherwise>
            <out>
              <lu>
                <clip pos="1" side="tl" part="whole"/> 
              </lu> 
              <b/>
              <lu>
                <clip pos="2" side="tl" part="whole"/> 
              </lu> 
              <b/>
              <lu>
                <clip pos="3" side="tl" part="whole"/> 
              </lu>
              <b/>
              <lu>
                <clip pos="4" side="tl" part="whole"/> 
              </lu>
              <b/>
              <lu>
                <clip pos="5" side="tl" part="whole"/> 
              </lu>
            </out> 
          </otherwise>
          
          
        </choose>
      </action>
    </rule>
    
    
    
    <!--REGRA EGV16 para IR/VOLVER/...+INF en distintas combinacións con clíticos e perífrases -->
    
    <rule>
      <pattern>
        <pattern-item n="verbir"/>
        <pattern-item n="prep"/>
        <pattern-item n="inf"/>
      </pattern>
      <action>
        <choose>
          <when>
            <test>
              <equal> 
                <clip pos="2" side="sl" part="lem"/>
                <lit v="a"/>
              </equal>
            </test>
            <out>
              <lu>
                <clip pos="1" side="tl" part="whole"/> 
              </lu>
              <b/>
              <lu>
                <clip pos="3" side="tl" part="whole"/> 
              </lu>
            </out>
          </when>
          
          <otherwise>
            <out>
              <lu>
                <clip pos="1" side="tl" part="whole"/> 
              </lu> 
              <b/>
              <lu>
                <clip pos="2" side="tl" part="whole"/> 
              </lu> 
              <b/>
              <lu>
                <clip pos="3" side="tl" part="whole"/> 
              </lu>
            </out> 
          </otherwise>
          
        </choose>
      </action>
    </rule>
    
    
    <rule>
      <pattern>
        <pattern-item n="verbir"/>
        <pattern-item n="prep"/>
        <pattern-item n="inf"/>
        <pattern-item n="prnenc"/>
      </pattern>
      <action>
        <choose>
          <when>
            <test>
              <equal> 
                <clip pos="2" side="sl" part="lem"/>
                <lit v="a"/>
              </equal>
            </test>
            <out>
              <lu>
                <clip pos="1" side="tl" part="whole"/> 
              </lu> 
              <b/>
              <mlu><lu>
                  <clip pos="3" side="tl" part="whole"/> 
                </lu>
                <lu>
                  <clip pos="4" side="tl" part="whole"/> 
                </lu></mlu>
            </out>
          </when>
          
          <otherwise>
            <out>
              <lu>
                <clip pos="1" side="tl" part="whole"/> 
              </lu> 
              <b/>
              <lu>
                <clip pos="2" side="tl" part="whole"/> 
              </lu> 
              <b/>
              <mlu><lu>
                  <clip pos="3" side="tl" part="whole"/> 
                </lu>
                <lu>
                  <clip pos="4" side="tl" part="whole"/> 
                </lu></mlu>
            </out> 
          </otherwise>
          
        </choose>
      </action>
    </rule>
    
    
    <rule>
      <pattern>
        <pattern-item n="verbir"/>
        <pattern-item n="prep"/>
        <pattern-item n="inf"/>
        <pattern-item n="prnenc"/>
        <pattern-item n="prnenc"/>
      </pattern>
      <action>
        <choose>
          <when>
            <test>
              <equal> 
                <clip pos="2" side="sl" part="lem"/>
                <lit v="a"/>
              </equal>
            </test>
            <out>
              <lu>
                <clip pos="1" side="tl" part="whole"/> 
              </lu> 
              <b/>
              <mlu><lu>
                  <clip pos="3" side="tl" part="whole"/> 
                </lu>
                <lu>
                  <clip pos="4" side="tl" part="whole"/> 
                </lu>
                <lu>
                  <clip pos="5" side="tl" part="whole"/> 
                </lu></mlu>
            </out>
          </when>
          
          <otherwise>
            <out>
              <lu>
                <clip pos="1" side="tl" part="whole"/> 
              </lu> 
              <b/>
              <lu>
                <clip pos="2" side="tl" part="whole"/> 
              </lu> 
              <b/>
              <mlu><lu>
                  <clip pos="3" side="tl" part="whole"/> 
                </lu>
                <lu>
                  <clip pos="4" side="tl" part="whole"/> 
                </lu>
                <lu>
                  <clip pos="5" side="tl" part="whole"/> 
                </lu></mlu>
            </out> 
          </otherwise>
          
        </choose>
      </action>
    </rule>
    
    
    
    <rule> <!--REGLA: fóra ¿ e ¡ -->
      <pattern>
        <pattern-item n="lquest"/>
      </pattern>
      <action>
        <!--<let>
          <var n="interrogativa"/>
          <lit v="true"/>
        </let>  -->      
      </action>
    </rule>
    
    <rule><!-- REGLA: reset variables-->
      <pattern>
        <pattern-item n="sent"/>
      </pattern>
      <action>
        <let>
          <var n="numero"/>
          <lit-tag v="sg"/>
        </let>
        <let>
          <var n="genero"/>
          <lit-tag v="m"/>
        </let>
        <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
        </out>
      </action>
    </rule>
    
    
  </section-rules>
</transfer>
