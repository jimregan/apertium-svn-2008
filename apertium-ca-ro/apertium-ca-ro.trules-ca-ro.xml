?xml version="1.0" encoding="ISO-8859-1"?>
<!-- -*- nxml -*- -->
<transfer>
  <section-def-cats>
    <def-cat n="nom">
      <cat-item tags="n.*"/>
    </def-cat>
    <def-cat n="npant">
      <cat-item tags="np.ant"/>
    </def-cat>
    <def-cat n="nploc">
      <cat-item tags="np.loc"/>
    </def-cat>
    <def-cat n="det">
      <cat-item tags="det.*"/>
      <cat-item tags="predet.*"/>
    </def-cat>
    <def-cat n="detcel">
      <cat-item lemma="cel" tags="det.*"/>
    </def-cat>
    <def-cat n="detdem">
      <cat-item tags="det.dem.*"/>
    </def-cat>
    <def-cat n="detdef">
      <cat-item tags="det.def.*"/>
    </def-cat>
    <def-cat n="predet">
      <cat-item tags="predet.*"/>
    </def-cat>
    <def-cat n="adjec">
      <cat-item tags="adj.*"/>
      <cat-item tags="vblex.pp.*"/>
    </def-cat>
    <def-cat n="adj">
      <cat-item tags="adj.*"/>
    </def-cat>
    <def-cat n="adv">
      <cat-item tags="adv"/>
      <cat-item tags="adv.itg"/>
      <cat-item tags="preadv"/>
    </def-cat>
    <def-cat n="advnespus">
      <cat-item lemma="nespus" tags="adv"/>
    </def-cat>
    <def-cat n="advmai">
      <cat-item lemma="mai" tags="adv"/>
    </def-cat>
    <def-cat n="prep">
      <cat-item tags="pr"/>
    </def-cat>
    <def-cat n="advno">
      <cat-item lemma="no" tags="adv"/>
    </def-cat>
    <def-cat n="prepde">
      <cat-item lemma="de" tags="pr"/>
    </def-cat>
<!--  <def-cat n="que">
          <cat-item lemma="que" tags="cnjsub"/>
	  <cat-item lemma="que" tags="rel.an.mf.sp"/>
     </def-cat> -->
    <def-cat n="conjsub">
      <cat-item lemma="sä" tags="cnjsub"/>
    </def-cat>
    <def-cat n="relat">
      <cat-item tags="rel.*"/>
    </def-cat>
    <def-cat n="prn">
      <cat-item tags="prn.tn.*"/>
      <cat-item tags="prn.itg.*"/>
    </def-cat>
    <def-cat n="prnenc">
      <cat-item tags="prn.enc.*"/>
    </def-cat>
    <def-cat n="prnpro">
      <cat-item tags="prn.pro.*"/>
    </def-cat>
    <def-cat n="prnproref">
      <cat-item lemma="mä" tags="prn.pro.p1.mf.sg"/>
      <cat-item lemma="te" tags="prn.pro.p2.mf.sg"/>
      <cat-item lemma="se" tags="prn.pro.ref.p3.mfn.sp"/>
      <cat-item lemma="îçi" tags="prn.pro.ref.p3.mfn.sp"/>
      <cat-item lemma="ne" tags="prn.pro.p1.mf.pl"/>
      <cat-item lemma="vä" tags="prn.pro.p2.mf.pl"/>
    </def-cat>
    <def-cat n="prnpro3">
      <cat-item lemma="îl" tags="prn.pro.*"/>
<!-- eliminat EN pr adv -->
    </def-cat>
    <def-cat n="opronom">
      <cat-item lemma="o" tags="prn.pro.p3.f.sg"/>
    </def-cat>
    <def-cat n="verb">
      <cat-item tags="vblex.*"/>
<!-- eliminat vb SER-->
      <cat-item tags="vbavea.*"/>
      <cat-item tags="vbmod.*"/>
    </def-cat>
    <def-cat n="vbaveapri">
      <cat-item tags="vbavea.pri.*"/>
      <cat-item lemma="avea" tags="vblex.prs.*"/>
<!-- el tagger no tria vbavea pri, afegim  vblex prs mentre el millorem-->
    </def-cat>
    <def-cat n="vbaveacni">
      <cat-item tags="vbavea.cni.*"/>
      <cat-item lemma="avea" tags="vblex.prs.*"/>
<!-- el tagger no tria vbavea pri, afegim  vblex prs mentre el millorem-->
    </def-cat>
    <def-cat n="verbind">
      <cat-item tags="vblex.pri.*"/>
      <cat-item tags="vblex.pii.*"/>
      <cat-item tags="vblex.pper.*"/>
      <cat-item tags="vblex.imp.*"/>
      <cat-item tags="vbmod.pri.*"/>
      <cat-item tags="vbmod.pii.*"/>
      <cat-item tags="vbmod.pper.*"/>
      <cat-item tags="vbmod.imp.*"/>
    </def-cat>
    <def-cat n="verbpper">
      <cat-item tags="vblex.pper.*"/>
      <cat-item tags="vbmod.pper.*"/>
    </def-cat>
    <def-cat n="verbprs">
      <cat-item tags="vblex.prs.*"/>
      <cat-item tags="vbmod.prs.*"/>
    </def-cat>
    <def-cat n="vrea">
      <cat-item lemma="vrea" tags="vaux.*"/>
    </def-cat>
    <def-cat n="inf">
      <cat-item tags="vblex.inf"/>
<!--eliminat SER inf -->
      <cat-item tags="vbavea.inf"/>
      <cat-item tags="vbmod.inf"/>
    </def-cat>
    <def-cat n="infnm">
      <cat-item tags="vblex.inf"/>
<!-- eliminat SER inf -->
      <cat-item tags="vbavea.inf"/>
    </def-cat>
    <def-cat n="infnh">
      <cat-item tags="vblex.inf"/>
<!-- eliminat SER inf -->
      <cat-item tags="vbmod.inf"/>
    </def-cat>
    <def-cat n="pp">
      <cat-item tags="vblex.pp.*"/>
<!-- eliminat SER pp -->
      <cat-item tags="vbavea.pp.*"/>
      <cat-item tags="vbmod.pp.*"/>
    </def-cat>
    <def-cat n="ppf">
      <cat-item tags="vblex.pp.f.sg"/>
      <cat-item tags="vbavea.pp.f.sg"/>
      <cat-item tags="vbmod.pp.f.sg"/>
    </def-cat>
    <def-cat n="ppfmpl">
      <cat-item tags="vblex.pp.f.*"/>
<!-- eliminat AVEA pp m &f -->
      <cat-item tags="vbmod.pp.f.*"/>
      <cat-item tags="vblex.pp.m.pl"/>
      <cat-item tags="vbmod.pp.m.pl"/>
    </def-cat>
    <def-cat n="num">
      <cat-item tags="num.*"/>
    </def-cat>
    <def-cat n="anar">
      <cat-item lemma="anar" tags="vblex.pri.*"/>
    </def-cat>
    <def-cat n="molt">
      <cat-item lemma="molt" tags="preadv"/>
      <cat-item lemma="molt" tags="adv"/>
      <cat-item lemma="molt" tags="adj.m.sg"/>
    </def-cat>
<!-- introduiria tb. la prep.inf. a __ a vedea/to see__, pq apareix amb determinades prep.: sense saber-ho = färä a çti nimic. QQQ Es podria ficar una paraula en ro.ro que tingui una casella buida en espanyol, p.ex. que aq. prep.inf. A no es traduisqui? -->
    <def-cat n="in">
      <cat-item lemma="in" tags="pr"/>
    </def-cat>
    <def-cat n="la">
      <cat-item lemma="la" tags="pr"/>
    </def-cat>
    <def-cat n="pentru">
      <cat-item lemma="pentru" tags="pr"/>
    </def-cat>
<!-- s'ha de veure en romanès si fa falta aquesta categoria /// def-cat n="dir">
       <cat-item lemma="dir" tags="vblex.pri.*"/>
       <cat-item lemma="dir" tags="vblex.fti.*"/>
     </def-cat> -->
    <def-cat n="avea">
      <cat-item lemma="avea" tags="vbavea.*"/>
    </def-cat>
    <def-cat n="sent">
      <cat-item tags="sent"/>
    </def-cat>
  </section-def-cats>
  <section-def-attrs>
    <def-attr n="a_nom">
      <attr-item tags="n"/>
      <attr-item tags="n.acr"/>
    </def-attr>
    <def-attr n="a_npant">
      <attr-item tags="np.ant"/>
    </def-attr>
    <def-attr n="a_nploc">
      <attr-item tags="np.loc"/>
    </def-attr>
    <def-attr n="a_det">
      <attr-item tags="det.def"/>
      <attr-item tags="det.ind"/>
      <attr-item tags="det.dem"/>
      <attr-item tags="det.pos"/>
      <attr-item tags="predet"/>
    </def-attr>
    <def-attr n="a_detdef">
      <attr-item tags="det.def"/>
    </def-attr>
    <def-attr n="a_predet">
      <attr-item tags="predet"/>
    </def-attr>
    <def-attr n="a_adjec">
      <attr-item tags="adj.ind"/>
<!-- en romanès hi ha una funció analítica per a construir el superlatiu: molt bella = FOARTE (en ro.ro preadv) frumoasä, bellíssima = EXTREM DE FRUMOASÄ, EXTRAORDINAR DE FRUMOASÄ, NEMAIPOMENIT DE FRUMOASÄ /// attr-item tags="adj.sup"/> -->
      <attr-item tags="adj.itg"/>
      <attr-item tags="adj.pos"/>
      <attr-item tags="adj"/>
      <attr-item tags="vblex.pp"/>
    </def-attr>
    <def-attr n="a_adj">
      <attr-item tags="adj.ind"/>
<!-- ib. damunt /// <attr-item tags="adj.sup"/> -->
      <attr-item tags="adj.itg"/>
      <attr-item tags="adj.pos"/>
      <attr-item tags="adj"/>
    </def-attr>
    <def-attr n="a_adv">
      <attr-item tags="adv"/>
      <attr-item tags="preadv"/>
    </def-attr>
    <def-attr n="a_prep">
      <attr-item tags="pr"/>
    </def-attr>
    <def-attr n="a_relat">
      <attr-item tags="rel.adv"/>
      <attr-item tags="rel.nn"/>
      <attr-item tags="rel.aa"/>
      <attr-item tags="rel.an"/>
    </def-attr>
    <def-attr n="a_prn">
      <attr-item tags="prn.tn.p1"/>
      <attr-item tags="prn.tn.p2"/>
      <attr-item tags="prn.tn.p3"/>
      <attr-item tags="prn.tn"/>
      <attr-item tags="prn.tn.ref.p3"/>
      <attr-item tags="prn.tn.pos"/>
      <attr-item tags="prn.itg"/>
    </def-attr>
    <def-attr n="a_prnenc">
      <attr-item tags="prn.enc"/>
      <attr-item tags="prn.enc.ref"/>
    </def-attr>
    <def-attr n="a_prnpro">
      <attr-item tags="prn.pro"/>
      <attr-item tags="prn.pro.ref"/>
    </def-attr>
    <def-attr n="a_verb">
      <attr-item tags="vblex"/>
      <attr-item tags="vbser"/>
      <attr-item tags="vbhaver"/>
      <attr-item tags="vbmod"/>
    </def-attr>
    <def-attr n="a_inf">
      <attr-item tags="vblex.inf"/>
      <attr-item tags="vbavea.inf"/>
      <attr-item tags="vbmod.inf"/>
    </def-attr>
    <def-attr n="a_infnm">
      <attr-item tags="vblex.inf"/>
      <attr-item tags="vbavea.inf"/>
    </def-attr>
    <def-attr n="a_infnh">
      <attr-item tags="vblex.inf"/>
<!-- eliminat SER -->
      <attr-item tags="vbmod.inf"/>
    </def-attr>
    <def-attr n="a_pp">
      <attr-item tags="vblex.pp"/>
<!-- VBAVEA no té més que pri i cni!!! així que eliminaria: attr-item tags="vbavea.pp"/> -->
      <attr-item tags="vbmod.pp"/>
    </def-attr>
    <def-attr n="a_num">
      <attr-item tags="num"/>
    </def-attr>
    <def-attr n="a_def">
      <attr-item tags="def"/>
      <attr-item tags="ind"/>
    </def-attr>
    <def-attr n="a_case">
      <attr-item tags="nom"/>
      <attr-item tags="dg"/>
    </def-attr>
    <def-attr n="gen">
      <attr-item tags="m"/>
      <attr-item tags="f"/>
      <attr-item tags="mf"/>
      <attr-item tags="mn"/>
      <attr-item tags="fn"/>
      <attr-item tags="mfn"/>
      <attr-item tags="GD"/>
      <attr-item tags="nt"/>
    </def-attr>
    <def-attr n="nbr">
      <attr-item tags="sg"/>
      <attr-item tags="pl"/>
      <attr-item tags="sp"/>
      <attr-item tags="ND"/>
    </def-attr>
    <def-attr n="persona">
      <attr-item tags="p1"/>
      <attr-item tags="p2"/>
      <attr-item tags="p3"/>
    </def-attr>
    <def-attr n="tipoadv">
      <attr-item tags="itg"/>
    </def-attr>
    <def-attr n="tipoenc_pro">
      <attr-item tags="ref.p3.mf.sp"/>
      <attr-item tags="p1.mf.sg"/>
      <attr-item tags="p1.mf.pl"/>
      <attr-item tags="p2.mf.sg"/>
      <attr-item tags="p2.mf.pl"/>
<!-- s'introduiria tb el neutre: Väd caietul(n.nt.sg.).Väzându-l (nt.sg.), i en pl. Väd caietele (n.nt.pl.) Väzându-le (nt.pl.)  <attr-item tags="p3.mfn.sg"/> -->
      <attr-item tags="p3.mfn.pl"/>
      <attr-item tags="p3.mf.sp"/>
<!--incorrecte, tradueix "li<prn><enc><p3><mf><sp>" per "se", cal canviar diccionari ja que és li-ho<sg> i los-ho<pl> (dárselo)-->
      <attr-item tags="p3.m.sg"/>
      <attr-item tags="p3.m.pl"/>
      <attr-item tags="p3.f.sg"/>
      <attr-item tags="p3.f.pl"/>
<!-- No crec que n'hi ha cap en romanès ///  attr-item tags="p3.nt"/> -->
    </def-attr>
    <def-attr n="temps">
      <attr-item tags="inf"/>
      <attr-item tags="ger"/>
      <attr-item tags="cni"/>
      <attr-item tags="fti"/>
      <attr-item tags="pp"/>
      <attr-item tags="pri"/>
      <attr-item tags="pii"/>
      <attr-item tags="pper"/>
      <attr-item tags="prs"/>
      <attr-item tags="imp"/>
    </def-attr>
<!-- Eliminat ifi que es traduiria per un perfect compost: Fuimos al cine/Hemos ido al cine. = AM MERS la cinema. /// attr-item tags="ifi"/> 
	 
           s'afegeix en romanés el PPER: fäcusem (vblex, pper)= había hecho (vblex, plusquamperfect)
	  S'ha de fer funció: FTI romanès = VREA vaux + INF: Lo haré. = (O) voi face. <attr-item tags="fti"/> ///
	    ib. per a cond. CNI romanès = VBAVEAcni + INF. <attr-item tags="cni"/> /// 
	  
	  es deixa tan sols el subjuntiu present, sense <attr-item tags=pis/>
	  <attr-item tags=fts/> -->
  </section-def-attrs>
  <section-def-vars>
    <def-var n="uno"/>
    <def-var n="genero"/>
    <def-var n="numero"/>
    <def-var n="concDet"/>
    <def-var n="concAdj"/>
    <def-var n="concPrimero"/>
    <def-var n="concSegundo"/>
    <def-var n="concTercero"/>
    <def-var n="interrogativa"/>
    <def-var n="exclamativa"/>
  </section-def-vars>
  <section-def-lists>
    <def-list n="verbs_moviment">
      <list-item v="anar"/>
      <list-item v="traslladar"/>
      <list-item v="viatjar"/>
      <list-item v="emigrar"/>
      <list-item v="inmigrar"/>
      <list-item v="moure"/>
      <list-item v="venir"/>
      <list-item v="vindre"/>
      <list-item v="eixir"/>
      <list-item v="sortir"/>
      <list-item v="entrar"/>
      <list-item v="pujar"/>
      <list-item v="baixar"/>
      <list-item v="caminar"/>
      <list-item v="dirigir"/>
      <list-item v="apropar"/>
      <list-item v="córrer"/>
      <list-item v="portar"/>
      <list-item v="passar"/>
      <list-item v="tornar"/>
      <list-item v="regressar"/>
      <list-item v="arribar"/>
      <list-item v="marxar"/>
    </def-list>
    <def-list n="verbs_estat">
      <list-item v="conviure"/>
      <list-item v="viure"/>
      <list-item v="actuar"/>
      <list-item v="allotjar"/>
      <list-item v="assentar"/>
      <list-item v="buscar"/>
      <list-item v="celebrar"/>
      <list-item v="centralitzar"/>
      <list-item v="cercar"/>
      <list-item v="col·locar"/>
      <list-item v="concentrar"/>
      <list-item v="desembocar"/>
      <list-item v="endinsar"/>
      <list-item v="establir"/>
      <list-item v="estrenar"/>
      <list-item v="excavar"/>
      <list-item v="exercir"/>
      <list-item v="existir"/>
      <list-item v="exposar"/>
      <list-item v="ficar"/>
      <list-item v="inaugurar"/>
      <list-item v="incloure"/>
      <list-item v="indagar"/>
      <list-item v="ingressar"/>
      <list-item v="inserir"/>
      <list-item v="instal·lar"/>
      <list-item v="introduir"/>
      <list-item v="irrompre"/>
      <list-item v="penetrar"/>
      <list-item v="pescar"/>
      <list-item v="publicar"/>
      <list-item v="reunir"/>
      <list-item v="romandre"/>
      <list-item v="treballar"/>
      <list-item v="trobar"/>
      <list-item v="ubicar"/>
      <list-item v="estudiar"/>
    </def-list>
  </section-def-lists>
  <section-def-macros>
    <def-macro n="f_bcond" npar="1">
<!--Per mirar si el blanc conté o no format -->
      <choose>
        <when>
          <test>
            <not>
              <equal>
                <b pos="1"/>
                <lit v=" "/>
              </equal>
            </not>
          </test>
          <out>
            <b pos="1"/>
          </out>
        </when>
      </choose>
    </def-macro>
    <def-macro n="f_outverb2" npar="2">
<!--Comprueba si hay pronombres que se traducen por nada de catalán a español según el diccionario ("hi" y "en") y envía el verbo con o sin pronombres de acuerdo con esta comprobación. Esta función es para el caso de verbo + 1 enclítico. Función necesaria para el correcto colocamiento de la cola en multipalabras con flexión intercalada. -->
      <choose>
        <when>
          <test>
            <not>
              <equal>
                <clip pos="2" side="tl" part="lem"/>
                <lit v=""/>
              </equal>
            </not>
          </test>
          <out>
            <mlu>
              <lu>
                <clip pos="1" side="tl" part="lemh"/>
                <clip pos="1" side="tl" part="a_verb"/>
                <clip pos="1" side="tl" part="temps"/>
                <clip pos="1" side="tl" part="persona"/>
                <clip pos="1" side="tl" part="nbr"/>
              </lu>
              <lu>
                <clip pos="2" side="tl" part="lem"/>
                <clip pos="2" side="tl" part="a_prnenc"/>
                <clip pos="2" side="tl" part="persona"/>
                <clip pos="2" side="tl" part="gen"/>
                <clip pos="2" side="tl" part="nbr"/>
                <clip pos="1" side="tl" part="lemq"/>
              </lu>
            </mlu>
          </out>
        </when>
        <otherwise>
          <out>
            <lu>
              <clip pos="1" side="tl" part="lemh"/>
              <clip pos="1" side="tl" part="a_verb"/>
              <clip pos="1" side="tl" part="temps"/>
              <clip pos="1" side="tl" part="persona"/>
              <clip pos="1" side="tl" part="nbr"/>
              <clip pos="1" side="tl" part="lemq"/>
            </lu>
          </out>
        </otherwise>
      </choose>
    </def-macro>
    <def-macro n="f_outverb3" npar="3">
<!--Comprueba si hay pronombres que se traducen por nada de catalán a español según el diccionario ("hi" y "en") y envía el verbo con o sin pronombres de acuerdo con esta comprobación. Esta función es para el caso de verbo + 2 enclíticos.-->
      <choose>
        <when>
          <test>
            <not>
              <equal>
                <clip pos="2" side="tl" part="lem"/>
                <lit v=""/>
              </equal>
            </not>
          </test>
          <choose>
            <when>
              <test>
                <not>
                  <equal>
                    <clip pos="3" side="tl" part="lem"/>
                    <lit v=""/>
                  </equal>
                </not>
              </test>
              <out>
                <mlu>
                  <lu>
                    <clip pos="1" side="tl" part="lemh"/>
                    <clip pos="1" side="tl" part="a_verb"/>
                    <clip pos="1" side="tl" part="temps"/>
                    <clip pos="1" side="tl" part="persona"/>
                    <clip pos="1" side="tl" part="nbr"/>
                  </lu>
                  <lu>
                    <clip pos="2" side="tl" part="lem"/>
                    <clip pos="2" side="tl" part="a_prnenc"/>
                    <clip pos="2" side="tl" part="persona"/>
                    <clip pos="2" side="tl" part="gen"/>
                    <clip pos="2" side="tl" part="nbr"/>
                  </lu>
                  <lu>
                    <clip pos="3" side="tl" part="lem"/>
                    <clip pos="3" side="tl" part="a_prnenc"/>
                    <clip pos="3" side="tl" part="persona"/>
                    <clip pos="3" side="tl" part="gen"/>
                    <clip pos="3" side="tl" part="nbr"/>
                    <clip pos="1" side="tl" part="lemq"/>
                  </lu>
                </mlu>
              </out>
            </when>
            <otherwise>
              <out>
                <mlu>
                  <lu>
                    <clip pos="1" side="tl" part="lemh"/>
                    <clip pos="1" side="tl" part="a_verb"/>
                    <clip pos="1" side="tl" part="temps"/>
                    <clip pos="1" side="tl" part="persona"/>
                    <clip pos="1" side="tl" part="nbr"/>
                  </lu>
                  <lu>
                    <clip pos="2" side="tl" part="lem"/>
                    <clip pos="2" side="tl" part="a_prnenc"/>
                    <clip pos="2" side="tl" part="persona"/>
                    <clip pos="2" side="tl" part="gen"/>
                    <clip pos="2" side="tl" part="nbr"/>
                    <clip pos="1" side="tl" part="lemq"/>
                  </lu>
                </mlu>
              </out>
            </otherwise>
          </choose>
        </when>
        <otherwise>
          <out>
            <lu>
              <clip pos="1" side="tl" part="lemh"/>
              <clip pos="1" side="tl" part="a_verb"/>
              <clip pos="1" side="tl" part="temps"/>
              <clip pos="1" side="tl" part="persona"/>
              <clip pos="1" side="tl" part="nbr"/>
              <clip pos="1" side="tl" part="lemq"/>
            </lu>
          </out>
        </otherwise>
      </choose>
    </def-macro>
    <def-macro n="f_modgen" npar="1">
      <choose>
        <when>
          <test>
            <equal>
              <clip pos="1" side="tl" part="gen"/>
              <lit-tag v="mfn"/>
            </equal>
          </test>
          <let>
            <clip pos="1" side="tl" part="gen"/>
            <lit-tag v="mf"/>
          </let>
          <let>
            <var n="genero"/>
            <lit-tag v="mf"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="1" side="tl" part="gen"/>
              <lit-tag v="fn"/>
            </equal>
          </test>
          <let>
            <clip pos="1" side="tl" part="gen"/>
            <lit-tag v="f"/>
          </let>
          <let>
            <var n="genero"/>
            <lit-tag v="f"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="1" side="tl" part="gen"/>
              <lit-tag v="mn"/>
            </equal>
          </test>
          <let>
            <clip pos="1" side="tl" part="gen"/>
            <lit-tag v="m"/>
          </let>
          <let>
            <var n="genero"/>
            <lit-tag v="m"/>
          </let>
        </when>
      </choose>
    </def-macro>
    <def-macro n="f_concord1" npar="1">
      <choose>
<!--To determine value of variables of gender and
                 number and propagate to other rules.  Variables are
                 not used again in this rule -->
        <when>
          <test>
            <equal>
              <clip pos="1" side="tl" part="gen"/>
              <lit-tag v="m"/>
            </equal>
          </test>
          <let>
            <var n="genero"/>
            <lit-tag v="m"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="1" side="tl" part="gen"/>
              <lit-tag v="f"/>
            </equal>
          </test>
          <let>
            <var n="genero"/>
            <lit-tag v="f"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="1" side="tl" part="gen"/>
              <lit-tag v="mn"/>
            </equal>
          </test>
          <let>
            <clip pos="1" side="tl" part="gen"/>
            <lit-tag v="m"/>
          </let>
          <let>
            <var n="genero"/>
            <lit-tag v="m"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="1" side="tl" part="gen"/>
              <lit-tag v="fn"/>
            </equal>
          </test>
          <let>
            <clip pos="1" side="tl" part="gen"/>
            <lit-tag v="f"/>
          </let>
          <let>
            <var n="genero"/>
            <lit-tag v="f"/>
          </let>
        </when>
      </choose>
      <choose>
        <when>
          <test>
            <equal>
              <clip pos="1" side="tl" part="nbr"/>
              <lit-tag v="sg"/>
            </equal>
          </test>
          <let>
            <var n="numero"/>
            <lit-tag v="sg"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="1" side="tl" part="nbr"/>
              <lit-tag v="pl"/>
            </equal>
          </test>
          <let>
            <var n="numero"/>
            <lit-tag v="pl"/>
          </let>
        </when>
      </choose>
      <choose>
        <when>
          <test>
<!-- If word has GD or ND, we try to assign the
              gender or number of the previous rule. If there is no
              value for the gender or number variable from previous
              rules, gender will be masculine and number singular.-->
            <equal>
              <clip pos="1" side="tl" part="gen"/>
              <lit-tag v="GD"/>
            </equal>
          </test>
          <choose>
            <when>
              <test>
                <equal>
                  <var n="genero"/>
                  <lit-tag v="f"/>
                </equal>
              </test>
              <let>
                <clip pos="1" side="tl" part="gen"/>
                <lit-tag v="f"/>
              </let>
            </when>
            <otherwise>
              <let>
                <clip pos="1" side="tl" part="gen"/>
                <lit-tag v="m"/>
              </let>
            </otherwise>
          </choose>
        </when>
      </choose>
      <choose>
        <when>
          <test>
            <equal>
              <clip pos="1" side="tl" part="nbr"/>
              <lit-tag v="ND"/>
            </equal>
          </test>
          <choose>
            <when>
              <test>
                <equal>
                  <var n="numero"/>
                  <lit-tag v="pl"/>
                </equal>
              </test>
              <let>
                <clip pos="1" side="tl" part="nbr"/>
                <lit-tag v="pl"/>
              </let>
            </when>
            <otherwise>
              <let>
                <clip pos="1" side="tl" part="nbr"/>
                <lit-tag v="sg"/>
              </let>
            </otherwise>
          </choose>
        </when>
      </choose>
    </def-macro>
    <def-macro n="f_concord2" npar="2">
      <choose>
        <when>
          <test>
<!-- do the main and second parameter gender agree?-->
            <and>
              <or>
                <equal>
                  <clip pos="2" side="sl" part="gen"/>
                  <clip pos="1" side="sl" part="gen"/>
                </equal>
                <equal>
                  <clip pos="2" side="sl" part="gen"/>
                  <lit-tag v="mf"/>
                </equal>
                <equal>
                  <clip pos="1" side="sl" part="gen"/>
                  <lit-tag v="mf"/>
                </equal>
              </or>
              <or>
                <equal>
<!-- do the main and second parameter number agree?-->
                  <clip pos="2" side="sl" part="nbr"/>
                  <clip pos="1" side="sl" part="nbr"/>
                </equal>
                <equal>
                  <clip pos="2" side="sl" part="nbr"/>
                  <lit-tag v="sp"/>
                </equal>
                <equal>
                  <clip pos="1" side="sl" part="nbr"/>
                  <lit-tag v="sp"/>
                </equal>
              </or>
            </and>
          </test>
          <let>
            <var n="concPrimero"/>
            <lit v="true"/>
          </let>
<!-- there is gender and number agreement-->
        </when>
        <otherwise>
          <let>
            <var n="concPrimero"/>
            <lit v="false"/>
          </let>
<!-- there isn't gender and number agreement-->
        </otherwise>
      </choose>
      <choose>
        <when>
          <test>
<!-- Propagate the main parameter gender if it has been modified during the translation  -->
            <and>
              <not>
                <equal>
                  <clip pos="1" side="tl" part="gen"/>
                  <clip pos="1" side="sl" part="gen"/>
                </equal>
              </not>
              <not>
                <equal>
                  <clip pos="1" side="tl" part="gen"/>
                  <lit-tag v="mf"/>
                </equal>
              </not>
              <not>
                <equal>
                  <clip pos="1" side="tl" part="gen"/>
                  <lit-tag v="GD"/>
                </equal>
              </not>
            </and>
          </test>
          <choose>
            <when>
              <test>
                <and>
                  <not>
                    <equal>
                      <clip pos="2" side="tl" part="gen"/>
                      <lit-tag v="mf"/>
                    </equal>
                  </not>
                  <not>
                    <and>
                      <equal>
                        <clip pos="2" side="sl" part="gen"/>
                        <lit-tag v="mf"/>
                      </equal>
                      <not>
                        <equal>
                          <clip pos="2" side="tl" part="gen"/>
                          <lit-tag v="GD"/>
                        </equal>
                      </not>
                    </and>
                  </not>
                  <equal>
                    <var n="concPrimero"/>
                    <lit v="true"/>
                  </equal>
                </and>
              </test>
              <let>
                <clip pos="2" side="tl" part="gen"/>
                <clip pos="1" side="tl" part="gen"/>
              </let>
            </when>
          </choose>
        </when>
      </choose>
      <choose>
        <when>
          <test>
<!-- Propagate the main parameter number if it has been modified during the translation  -->
            <and>
              <not>
                <equal>
                  <clip pos="1" side="tl" part="nbr"/>
                  <clip pos="1" side="sl" part="nbr"/>
                </equal>
              </not>
              <not>
                <equal>
                  <clip pos="1" side="tl" part="nbr"/>
                  <lit-tag v="sp"/>
                </equal>
              </not>
              <not>
                <equal>
                  <clip pos="1" side="tl" part="nbr"/>
                  <lit-tag v="ND"/>
                </equal>
              </not>
            </and>
          </test>
          <choose>
            <when>
              <test>
                <and>
                  <not>
                    <equal>
                      <clip pos="2" side="tl" part="nbr"/>
                      <lit-tag v="sp"/>
                    </equal>
                  </not>
                  <not>
                    <and>
                      <equal>
                        <clip pos="2" side="sl" part="nbr"/>
                        <lit-tag v="sp"/>
                      </equal>
                      <not>
                        <equal>
                          <clip pos="2" side="tl" part="nbr"/>
                          <lit-tag v="ND"/>
                        </equal>
                      </not>
                    </and>
                  </not>
                  <equal>
                    <var n="concPrimero"/>
                    <lit v="true"/>
                  </equal>
                </and>
              </test>
              <let>
                <clip pos="2" side="tl" part="nbr"/>
                <clip pos="1" side="tl" part="nbr"/>
              </let>
            </when>
          </choose>
        </when>
      </choose>
      <choose>
        <when>
          <test>
<!-- Which is the rule general gender? -->
            <equal>
              <clip pos="1" side="tl" part="gen"/>
              <lit-tag v="m"/>
            </equal>
          </test>
          <let>
            <var n="genero"/>
            <lit-tag v="m"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="1" side="tl" part="gen"/>
              <lit-tag v="f"/>
            </equal>
          </test>
          <let>
            <var n="genero"/>
            <lit-tag v="f"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="2" side="tl" part="gen"/>
              <lit-tag v="m"/>
            </equal>
          </test>
          <let>
            <var n="genero"/>
            <lit-tag v="m"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="2" side="tl" part="gen"/>
              <lit-tag v="f"/>
            </equal>
          </test>
          <let>
            <var n="genero"/>
            <lit-tag v="f"/>
          </let>
        </when>
        <when>
          <test>
            <and>
              <equal>
                <clip pos="1" side="tl" part="gen"/>
                <lit-tag v="mf"/>
              </equal>
              <not>
                <equal>
                  <clip pos="1" side="sl" part="gen"/>
                  <lit-tag v="mf"/>
                </equal>
              </not>
            </and>
          </test>
          <let>
            <var n="genero"/>
            <clip pos="1" side="sl" part="gen"/>
          </let>
        </when>
        <when>
          <test>
            <and>
              <equal>
                <clip pos="2" side="tl" part="gen"/>
                <lit-tag v="mf"/>
              </equal>
              <not>
                <equal>
                  <clip pos="2" side="sl" part="gen"/>
                  <lit-tag v="mf"/>
                </equal>
              </not>
            </and>
          </test>
          <let>
            <var n="genero"/>
            <clip pos="2" side="sl" part="gen"/>
          </let>
        </when>
        <otherwise>
          <let>
            <var n="genero"/>
            <lit-tag v="m"/>
          </let>
        </otherwise>
      </choose>
      <choose>
        <when>
<!-- Which is the rule general number? -->
          <test>
            <equal>
              <clip pos="1" side="tl" part="nbr"/>
              <lit-tag v="sg"/>
            </equal>
          </test>
          <let>
            <var n="numero"/>
            <lit-tag v="sg"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="1" side="tl" part="nbr"/>
              <lit-tag v="pl"/>
            </equal>
          </test>
          <let>
            <var n="numero"/>
            <lit-tag v="pl"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="2" side="tl" part="nbr"/>
              <lit-tag v="sg"/>
            </equal>
          </test>
          <let>
            <var n="numero"/>
            <lit-tag v="sg"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="2" side="tl" part="nbr"/>
              <lit-tag v="pl"/>
            </equal>
          </test>
          <let>
            <var n="numero"/>
            <lit-tag v="pl"/>
          </let>
        </when>
        <when>
          <test>
            <and>
              <equal>
                <clip pos="1" side="tl" part="nbr"/>
                <lit-tag v="sp"/>
              </equal>
              <not>
                <equal>
                  <clip pos="1" side="sl" part="nbr"/>
                  <lit-tag v="sp"/>
                </equal>
              </not>
            </and>
          </test>
          <let>
            <var n="numero"/>
            <clip pos="1" side="sl" part="nbr"/>
          </let>
        </when>
        <when>
          <test>
            <and>
              <equal>
                <clip pos="2" side="tl" part="nbr"/>
                <lit-tag v="sp"/>
              </equal>
              <not>
                <equal>
                  <clip pos="2" side="sl" part="nbr"/>
                  <lit-tag v="sp"/>
                </equal>
              </not>
            </and>
          </test>
          <let>
            <var n="numero"/>
            <clip pos="2" side="sl" part="nbr"/>
          </let>
        </when>
        <otherwise>
          <let>
            <var n="numero"/>
            <lit-tag v="sg"/>
          </let>
        </otherwise>
      </choose>
      <choose>
<!-- Determine gender and number value if they are undetermined -->
        <when>
          <test>
            <equal>
              <clip pos="1" side="tl" part="gen"/>
              <lit-tag v="GD"/>
            </equal>
          </test>
          <let>
            <clip pos="1" side="tl" part="gen"/>
            <var n="genero"/>
          </let>
        </when>
      </choose>
      <choose>
        <when>
          <test>
            <equal>
              <clip pos="2" side="tl" part="gen"/>
              <lit-tag v="GD"/>
            </equal>
          </test>
          <let>
            <clip pos="2" side="tl" part="gen"/>
            <var n="genero"/>
          </let>
        </when>
      </choose>
      <choose>
        <when>
          <test>
            <equal>
              <clip pos="1" side="tl" part="nbr"/>
              <lit-tag v="ND"/>
            </equal>
          </test>
          <let>
            <clip pos="1" side="tl" part="nbr"/>
            <var n="numero"/>
          </let>
        </when>
      </choose>
      <choose>
        <when>
          <test>
            <equal>
              <clip pos="2" side="tl" part="nbr"/>
              <lit-tag v="ND"/>
            </equal>
          </test>
          <let>
            <clip pos="2" side="tl" part="nbr"/>
            <var n="numero"/>
          </let>
        </when>
      </choose>
    </def-macro>
    <def-macro n="f_concord3" npar="3">
      <choose>
<!-- Look if in source language there is concordance between first and second element -->
        <when>
          <test>
            <and>
              <or>
                <equal>
                  <clip pos="2" side="sl" part="gen"/>
                  <clip pos="1" side="sl" part="gen"/>
                </equal>
                <equal>
                  <clip pos="2" side="sl" part="gen"/>
                  <lit-tag v="mf"/>
                </equal>
                <equal>
                  <clip pos="1" side="sl" part="gen"/>
                  <lit-tag v="mf"/>
                </equal>
              </or>
              <or>
                <equal>
                  <clip pos="2" side="sl" part="nbr"/>
                  <clip pos="1" side="sl" part="nbr"/>
                </equal>
                <equal>
                  <clip pos="2" side="sl" part="nbr"/>
                  <lit-tag v="sp"/>
                </equal>
                <equal>
                  <clip pos="1" side="sl" part="nbr"/>
                  <lit-tag v="sp"/>
                </equal>
              </or>
            </and>
          </test>
          <let>
            <var n="concPrimero"/>
            <lit v="true"/>
          </let>
        </when>
        <otherwise>
          <let>
            <var n="concPrimero"/>
            <lit v="false"/>
          </let>
        </otherwise>
      </choose>
      <choose>
<!-- Look if in source language there is concordance between second and third element -->
        <when>
          <test>
            <and>
              <or>
                <equal>
                  <clip pos="3" side="sl" part="gen"/>
                  <clip pos="1" side="sl" part="gen"/>
                </equal>
                <equal>
                  <clip pos="3" side="sl" part="gen"/>
                  <lit-tag v="mf"/>
                </equal>
                <equal>
                  <clip pos="1" side="sl" part="gen"/>
                  <lit-tag v="mf"/>
                </equal>
              </or>
              <or>
                <equal>
                  <clip pos="3" side="sl" part="nbr"/>
                  <clip pos="1" side="sl" part="nbr"/>
                </equal>
                <equal>
                  <clip pos="3" side="sl" part="nbr"/>
                  <lit-tag v="sp"/>
                </equal>
                <equal>
                  <clip pos="1" side="sl" part="nbr"/>
                  <lit-tag v="sp"/>
                </equal>
              </or>
            </and>
          </test>
          <let>
            <var n="concSegundo"/>
            <lit v="true"/>
          </let>
        </when>
        <otherwise>
          <let>
            <var n="concSegundo"/>
            <lit v="false"/>
          </let>
        </otherwise>
      </choose>
      <choose>
<!-- Propagate the main parameter gender if it has been modified during the translation -->
        <when>
          <test>
            <and>
              <not>
                <equal>
                  <clip pos="1" side="tl" part="gen"/>
                  <clip pos="1" side="sl" part="gen"/>
                </equal>
              </not>
              <not>
                <equal>
                  <clip pos="1" side="tl" part="gen"/>
                  <lit-tag v="mf"/>
                </equal>
              </not>
              <not>
                <equal>
                  <clip pos="1" side="tl" part="gen"/>
                  <lit-tag v="GD"/>
                </equal>
              </not>
            </and>
          </test>
          <choose>
            <when>
              <test>
                <and>
                  <not>
                    <equal>
                      <clip pos="2" side="tl" part="gen"/>
                      <lit-tag v="mf"/>
                    </equal>
                  </not>
                  <not>
                    <and>
                      <equal>
                        <clip pos="2" side="sl" part="gen"/>
                        <lit-tag v="mf"/>
                      </equal>
                      <not>
                        <equal>
                          <clip pos="2" side="tl" part="gen"/>
                          <lit-tag v="GD"/>
                        </equal>
                      </not>
                    </and>
                  </not>
                  <equal>
                    <var n="concPrimero"/>
                    <lit v="true"/>
                  </equal>
                </and>
              </test>
              <let>
                <clip pos="2" side="tl" part="gen"/>
                <clip pos="1" side="tl" part="gen"/>
              </let>
            </when>
          </choose>
          <choose>
            <when>
              <test>
                <and>
                  <not>
                    <equal>
                      <clip pos="3" side="tl" part="gen"/>
                      <lit-tag v="mf"/>
                    </equal>
                  </not>
                  <not>
                    <and>
                      <equal>
                        <clip pos="3" side="sl" part="gen"/>
                        <lit-tag v="mf"/>
                      </equal>
                      <not>
                        <equal>
                          <clip pos="3" side="tl" part="gen"/>
                          <lit-tag v="GD"/>
                        </equal>
                      </not>
                    </and>
                  </not>
                  <equal>
                    <var n="concSegundo"/>
                    <lit v="true"/>
                  </equal>
                </and>
              </test>
              <let>
                <clip pos="3" side="tl" part="gen"/>
                <clip pos="1" side="tl" part="gen"/>
              </let>
            </when>
          </choose>
        </when>
      </choose>
      <choose>
<!-- Propagate the main parameter number if it has been modified during the translation -->
        <when>
          <test>
            <and>
              <not>
                <equal>
                  <clip pos="1" side="tl" part="nbr"/>
                  <clip pos="1" side="sl" part="nbr"/>
                </equal>
              </not>
              <not>
                <equal>
                  <clip pos="1" side="tl" part="nbr"/>
                  <lit-tag v="sp"/>
                </equal>
              </not>
              <not>
                <equal>
                  <clip pos="1" side="tl" part="nbr"/>
                  <lit-tag v="ND"/>
                </equal>
              </not>
            </and>
          </test>
          <choose>
            <when>
              <test>
                <and>
                  <not>
                    <equal>
                      <clip pos="2" side="tl" part="nbr"/>
                      <lit-tag v="sp"/>
                    </equal>
                  </not>
                  <not>
                    <and>
                      <equal>
                        <clip pos="2" side="sl" part="nbr"/>
                        <lit-tag v="sp"/>
                      </equal>
                      <not>
                        <equal>
                          <clip pos="2" side="tl" part="nbr"/>
                          <lit-tag v="ND"/>
                        </equal>
                      </not>
                    </and>
                  </not>
                  <equal>
                    <var n="concPrimero"/>
                    <lit v="true"/>
                  </equal>
                </and>
              </test>
              <let>
                <clip pos="2" side="tl" part="nbr"/>
                <clip pos="1" side="tl" part="nbr"/>
              </let>
            </when>
          </choose>
          <choose>
            <when>
              <test>
                <and>
                  <not>
                    <equal>
                      <clip pos="3" side="tl" part="nbr"/>
                      <lit-tag v="sp"/>
                    </equal>
                  </not>
                  <not>
                    <and>
                      <equal>
                        <clip pos="3" side="sl" part="nbr"/>
                        <lit-tag v="sp"/>
                      </equal>
                      <not>
                        <equal>
                          <clip pos="3" side="tl" part="nbr"/>
                          <lit-tag v="ND"/>
                        </equal>
                      </not>
                    </and>
                  </not>
                  <equal>
                    <var n="concSegundo"/>
                    <lit v="true"/>
                  </equal>
                </and>
              </test>
              <let>
                <clip pos="3" side="tl" part="nbr"/>
                <clip pos="1" side="tl" part="nbr"/>
              </let>
            </when>
          </choose>
        </when>
      </choose>
      <choose>
<!-- Determine the rule general gender. Priority order: main, second and third element -->
        <when>
          <test>
            <equal>
              <clip pos="1" side="tl" part="gen"/>
              <lit-tag v="m"/>
            </equal>
          </test>
          <let>
            <var n="genero"/>
            <lit-tag v="m"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="1" side="tl" part="gen"/>
              <lit-tag v="f"/>
            </equal>
          </test>
          <let>
            <var n="genero"/>
            <lit-tag v="f"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="2" side="tl" part="gen"/>
              <lit-tag v="m"/>
            </equal>
          </test>
          <let>
            <var n="genero"/>
            <lit-tag v="m"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="2" side="tl" part="gen"/>
              <lit-tag v="f"/>
            </equal>
          </test>
          <let>
            <var n="genero"/>
            <lit-tag v="f"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="3" side="tl" part="gen"/>
              <lit-tag v="m"/>
            </equal>
          </test>
          <let>
            <var n="genero"/>
            <lit-tag v="m"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="3" side="tl" part="gen"/>
              <lit-tag v="f"/>
            </equal>
          </test>
          <let>
            <var n="genero"/>
            <lit-tag v="f"/>
          </let>
        </when>
        <when>
          <test>
            <and>
              <equal>
                <clip pos="1" side="tl" part="gen"/>
                <lit-tag v="mf"/>
              </equal>
              <not>
                <equal>
                  <clip pos="1" side="sl" part="gen"/>
                  <lit-tag v="mf"/>
                </equal>
              </not>
            </and>
          </test>
          <let>
            <var n="genero"/>
            <clip pos="1" side="sl" part="gen"/>
          </let>
        </when>
        <when>
          <test>
            <and>
              <equal>
                <clip pos="2" side="tl" part="gen"/>
                <lit-tag v="mf"/>
              </equal>
              <not>
                <equal>
                  <clip pos="2" side="sl" part="gen"/>
                  <lit-tag v="mf"/>
                </equal>
              </not>
            </and>
          </test>
          <let>
            <var n="genero"/>
            <clip pos="2" side="sl" part="gen"/>
          </let>
        </when>
        <when>
          <test>
            <and>
              <equal>
                <clip pos="3" side="tl" part="gen"/>
                <lit-tag v="mf"/>
              </equal>
              <not>
                <equal>
                  <clip pos="3" side="sl" part="gen"/>
                  <lit-tag v="mf"/>
                </equal>
              </not>
            </and>
          </test>
          <let>
            <var n="genero"/>
            <clip pos="3" side="sl" part="gen"/>
          </let>
        </when>
        <otherwise>
          <let>
            <var n="genero"/>
            <lit-tag v="m"/>
          </let>
        </otherwise>
      </choose>
      <choose>
<!-- Determine the rule general number. Priority order: main, second and third element -->
        <when>
          <test>
            <equal>
              <clip pos="1" side="tl" part="nbr"/>
              <lit-tag v="sg"/>
            </equal>
          </test>
          <let>
            <var n="numero"/>
            <lit-tag v="sg"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="1" side="tl" part="nbr"/>
              <lit-tag v="pl"/>
            </equal>
          </test>
          <let>
            <var n="numero"/>
            <lit-tag v="pl"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="2" side="tl" part="nbr"/>
              <lit-tag v="sg"/>
            </equal>
          </test>
          <let>
            <var n="numero"/>
            <lit-tag v="sg"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="2" side="tl" part="nbr"/>
              <lit-tag v="pl"/>
            </equal>
          </test>
          <let>
            <var n="numero"/>
            <lit-tag v="pl"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="3" side="tl" part="nbr"/>
              <lit-tag v="sg"/>
            </equal>
          </test>
          <let>
            <var n="numero"/>
            <lit-tag v="sg"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="3" side="tl" part="nbr"/>
              <lit-tag v="pl"/>
            </equal>
          </test>
          <let>
            <var n="numero"/>
            <lit-tag v="pl"/>
          </let>
        </when>
        <when>
          <test>
            <and>
              <equal>
                <clip pos="1" side="tl" part="nbr"/>
                <lit-tag v="sp"/>
              </equal>
              <not>
                <equal>
                  <clip pos="1" side="sl" part="nbr"/>
                  <lit-tag v="sp"/>
                </equal>
              </not>
            </and>
          </test>
          <let>
            <var n="numero"/>
            <clip pos="1" side="sl" part="nbr"/>
          </let>
        </when>
        <when>
          <test>
            <and>
              <equal>
                <clip pos="2" side="tl" part="nbr"/>
                <lit-tag v="sp"/>
              </equal>
              <not>
                <equal>
                  <clip pos="2" side="sl" part="nbr"/>
                  <lit-tag v="sp"/>
                </equal>
              </not>
            </and>
          </test>
          <let>
            <var n="numero"/>
            <clip pos="2" side="sl" part="nbr"/>
          </let>
        </when>
        <when>
          <test>
            <and>
              <equal>
                <clip pos="3" side="tl" part="nbr"/>
                <lit-tag v="sp"/>
              </equal>
              <not>
                <equal>
                  <clip pos="3" side="sl" part="nbr"/>
                  <lit-tag v="sp"/>
                </equal>
              </not>
            </and>
          </test>
          <let>
            <var n="numero"/>
            <clip pos="3" side="sl" part="nbr"/>
          </let>
        </when>
        <otherwise>
          <let>
            <var n="numero"/>
            <lit-tag v="sg"/>
          </let>
        </otherwise>
      </choose>
      <choose>
<!-- Assign values to GD and ND -->
        <when>
          <test>
            <equal>
              <clip pos="1" side="tl" part="gen"/>
              <lit-tag v="GD"/>
            </equal>
          </test>
          <let>
            <clip pos="1" side="tl" part="gen"/>
            <var n="genero"/>
          </let>
        </when>
      </choose>
      <choose>
        <when>
          <test>
            <equal>
              <clip pos="2" side="tl" part="gen"/>
              <lit-tag v="GD"/>
            </equal>
          </test>
          <let>
            <clip pos="2" side="tl" part="gen"/>
            <var n="genero"/>
          </let>
        </when>
      </choose>
      <choose>
        <when>
          <test>
            <equal>
              <clip pos="3" side="tl" part="gen"/>
              <lit-tag v="GD"/>
            </equal>
          </test>
          <let>
            <clip pos="3" side="tl" part="gen"/>
            <var n="genero"/>
          </let>
        </when>
      </choose>
      <choose>
        <when>
          <test>
            <equal>
              <clip pos="1" side="tl" part="nbr"/>
              <lit-tag v="ND"/>
            </equal>
          </test>
          <let>
            <clip pos="1" side="tl" part="nbr"/>
            <var n="numero"/>
          </let>
        </when>
      </choose>
      <choose>
        <when>
          <test>
            <equal>
              <clip pos="2" side="tl" part="nbr"/>
              <lit-tag v="ND"/>
            </equal>
          </test>
          <let>
            <clip pos="2" side="tl" part="nbr"/>
            <var n="numero"/>
          </let>
        </when>
      </choose>
      <choose>
        <when>
          <test>
            <equal>
              <clip pos="3" side="tl" part="nbr"/>
              <lit-tag v="ND"/>
            </equal>
          </test>
          <let>
            <clip pos="3" side="tl" part="nbr"/>
            <var n="numero"/>
          </let>
        </when>
      </choose>
    </def-macro>
    <def-macro n="f_concord4" npar="4">
      <choose>
        <when>
          <test>
            <and>
              <or>
                <equal>
                  <clip pos="2" side="sl" part="gen"/>
                  <clip pos="1" side="sl" part="gen"/>
                </equal>
                <equal>
                  <clip pos="2" side="sl" part="gen"/>
                  <lit-tag v="mf"/>
                </equal>
                <equal>
                  <clip pos="1" side="sl" part="gen"/>
                  <lit-tag v="mf"/>
                </equal>
              </or>
              <or>
                <equal>
                  <clip pos="2" side="sl" part="nbr"/>
                  <clip pos="1" side="sl" part="nbr"/>
                </equal>
                <equal>
                  <clip pos="2" side="sl" part="nbr"/>
                  <lit-tag v="sp"/>
                </equal>
                <equal>
                  <clip pos="1" side="sl" part="nbr"/>
                  <lit-tag v="sp"/>
                </equal>
              </or>
            </and>
          </test>
          <let>
            <var n="concPrimero"/>
            <lit v="true"/>
          </let>
        </when>
        <otherwise>
          <let>
            <var n="concPrimero"/>
            <lit v="false"/>
          </let>
        </otherwise>
      </choose>
      <choose>
        <when>
          <test>
            <and>
              <or>
                <equal>
                  <clip pos="3" side="sl" part="gen"/>
                  <clip pos="1" side="sl" part="gen"/>
                </equal>
                <equal>
                  <clip pos="3" side="sl" part="gen"/>
                  <lit-tag v="mf"/>
                </equal>
                <equal>
                  <clip pos="1" side="sl" part="gen"/>
                  <lit-tag v="mf"/>
                </equal>
              </or>
              <or>
                <equal>
                  <clip pos="3" side="sl" part="nbr"/>
                  <clip pos="1" side="sl" part="nbr"/>
                </equal>
                <equal>
                  <clip pos="3" side="sl" part="nbr"/>
                  <lit-tag v="sp"/>
                </equal>
                <equal>
                  <clip pos="1" side="sl" part="nbr"/>
                  <lit-tag v="sp"/>
                </equal>
              </or>
            </and>
          </test>
          <let>
            <var n="concSegundo"/>
            <lit v="true"/>
          </let>
        </when>
        <otherwise>
          <let>
            <var n="concSegundo"/>
            <lit v="false"/>
          </let>
        </otherwise>
      </choose>
      <choose>
        <when>
          <test>
            <and>
              <or>
                <equal>
                  <clip pos="4" side="sl" part="gen"/>
                  <clip pos="1" side="sl" part="gen"/>
                </equal>
                <equal>
                  <clip pos="4" side="sl" part="gen"/>
                  <lit-tag v="mf"/>
                </equal>
                <equal>
                  <clip pos="1" side="sl" part="gen"/>
                  <lit-tag v="mf"/>
                </equal>
              </or>
              <or>
                <equal>
                  <clip pos="4" side="sl" part="nbr"/>
                  <clip pos="1" side="sl" part="nbr"/>
                </equal>
                <equal>
                  <clip pos="4" side="sl" part="nbr"/>
                  <lit-tag v="sp"/>
                </equal>
                <equal>
                  <clip pos="1" side="sl" part="nbr"/>
                  <lit-tag v="sp"/>
                </equal>
              </or>
            </and>
          </test>
          <let>
            <var n="concTercero"/>
            <lit v="true"/>
          </let>
        </when>
        <otherwise>
          <let>
            <var n="concTercero"/>
            <lit v="false"/>
          </let>
        </otherwise>
      </choose>
      <choose>
        <when>
          <test>
            <and>
              <not>
                <equal>
                  <clip pos="1" side="tl" part="gen"/>
                  <clip pos="1" side="sl" part="gen"/>
                </equal>
              </not>
              <not>
                <equal>
                  <clip pos="1" side="tl" part="gen"/>
                  <lit-tag v="mf"/>
                </equal>
              </not>
              <not>
                <equal>
                  <clip pos="1" side="tl" part="gen"/>
                  <lit-tag v="GD"/>
                </equal>
              </not>
            </and>
          </test>
          <choose>
            <when>
              <test>
                <and>
                  <not>
                    <equal>
                      <clip pos="2" side="tl" part="gen"/>
                      <lit-tag v="mf"/>
                    </equal>
                  </not>
                  <not>
                    <and>
                      <equal>
                        <clip pos="2" side="sl" part="gen"/>
                        <lit-tag v="mf"/>
                      </equal>
                      <not>
                        <equal>
                          <clip pos="2" side="tl" part="gen"/>
                          <lit-tag v="GD"/>
                        </equal>
                      </not>
                    </and>
                  </not>
                  <equal>
                    <var n="concPrimero"/>
                    <lit v="true"/>
                  </equal>
                </and>
              </test>
              <let>
                <clip pos="2" side="tl" part="gen"/>
                <clip pos="1" side="tl" part="gen"/>
              </let>
            </when>
          </choose>
          <choose>
            <when>
              <test>
                <and>
                  <not>
                    <equal>
                      <clip pos="3" side="tl" part="gen"/>
                      <lit-tag v="mf"/>
                    </equal>
                  </not>
                  <not>
                    <and>
                      <equal>
                        <clip pos="3" side="sl" part="gen"/>
                        <lit-tag v="mf"/>
                      </equal>
                      <not>
                        <equal>
                          <clip pos="3" side="tl" part="gen"/>
                          <lit-tag v="GD"/>
                        </equal>
                      </not>
                    </and>
                  </not>
                  <equal>
                    <var n="concSegundo"/>
                    <lit v="true"/>
                  </equal>
                </and>
              </test>
              <let>
                <clip pos="3" side="tl" part="gen"/>
                <clip pos="1" side="tl" part="gen"/>
              </let>
            </when>
          </choose>
          <choose>
            <when>
              <test>
                <and>
                  <not>
                    <equal>
                      <clip pos="4" side="tl" part="gen"/>
                      <lit-tag v="mf"/>
                    </equal>
                  </not>
                  <not>
                    <and>
                      <equal>
                        <clip pos="4" side="sl" part="gen"/>
                        <lit-tag v="mf"/>
                      </equal>
                      <not>
                        <equal>
                          <clip pos="4" side="tl" part="gen"/>
                          <lit-tag v="GD"/>
                        </equal>
                      </not>
                    </and>
                  </not>
                  <equal>
                    <var n="concTercero"/>
                    <lit v="true"/>
                  </equal>
                </and>
              </test>
              <let>
                <clip pos="4" side="tl" part="gen"/>
                <clip pos="1" side="tl" part="gen"/>
              </let>
            </when>
          </choose>
        </when>
      </choose>
      <choose>
        <when>
          <test>
            <and>
              <not>
                <equal>
                  <clip pos="1" side="tl" part="nbr"/>
                  <clip pos="1" side="sl" part="nbr"/>
                </equal>
              </not>
              <not>
                <equal>
                  <clip pos="1" side="tl" part="nbr"/>
                  <lit-tag v="sp"/>
                </equal>
              </not>
              <not>
                <equal>
                  <clip pos="1" side="tl" part="nbr"/>
                  <lit-tag v="ND"/>
                </equal>
              </not>
            </and>
          </test>
          <choose>
            <when>
              <test>
                <and>
                  <not>
                    <equal>
                      <clip pos="2" side="tl" part="nbr"/>
                      <lit-tag v="sp"/>
                    </equal>
                  </not>
                  <not>
                    <and>
                      <equal>
                        <clip pos="2" side="sl" part="nbr"/>
                        <lit-tag v="sp"/>
                      </equal>
                      <not>
                        <equal>
                          <clip pos="2" side="tl" part="nbr"/>
                          <lit-tag v="ND"/>
                        </equal>
                      </not>
                    </and>
                  </not>
                  <equal>
                    <var n="concPrimero"/>
                    <lit v="true"/>
                  </equal>
                </and>
              </test>
              <let>
                <clip pos="2" side="tl" part="nbr"/>
                <clip pos="1" side="tl" part="nbr"/>
              </let>
            </when>
          </choose>
          <choose>
            <when>
              <test>
                <and>
                  <not>
                    <equal>
                      <clip pos="3" side="tl" part="nbr"/>
                      <lit-tag v="sp"/>
                    </equal>
                  </not>
                  <not>
                    <and>
                      <equal>
                        <clip pos="3" side="sl" part="nbr"/>
                        <lit-tag v="sp"/>
                      </equal>
                      <not>
                        <equal>
                          <clip pos="3" side="tl" part="nbr"/>
                          <lit-tag v="ND"/>
                        </equal>
                      </not>
                    </and>
                  </not>
                  <equal>
                    <var n="concSegundo"/>
                    <lit v="true"/>
                  </equal>
                </and>
              </test>
              <let>
                <clip pos="3" side="tl" part="nbr"/>
                <clip pos="1" side="tl" part="nbr"/>
              </let>
            </when>
          </choose>
          <choose>
            <when>
              <test>
                <and>
                  <not>
                    <equal>
                      <clip pos="4" side="tl" part="nbr"/>
                      <lit-tag v="sp"/>
                    </equal>
                  </not>
                  <not>
                    <and>
                      <equal>
                        <clip pos="4" side="sl" part="nbr"/>
                        <lit-tag v="sp"/>
                      </equal>
                      <not>
                        <equal>
                          <clip pos="4" side="tl" part="nbr"/>
                          <lit-tag v="ND"/>
                        </equal>
                      </not>
                    </and>
                  </not>
                  <equal>
                    <var n="concTercero"/>
                    <lit v="true"/>
                  </equal>
                </and>
              </test>
              <let>
                <clip pos="4" side="tl" part="nbr"/>
                <clip pos="1" side="tl" part="nbr"/>
              </let>
            </when>
          </choose>
        </when>
      </choose>
      <choose>
        <when>
          <test>
            <equal>
              <clip pos="1" side="tl" part="gen"/>
              <lit-tag v="m"/>
            </equal>
          </test>
          <let>
            <var n="genero"/>
            <lit-tag v="m"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="1" side="tl" part="gen"/>
              <lit-tag v="f"/>
            </equal>
          </test>
          <let>
            <var n="genero"/>
            <lit-tag v="f"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="2" side="tl" part="gen"/>
              <lit-tag v="m"/>
            </equal>
          </test>
          <let>
            <var n="genero"/>
            <lit-tag v="m"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="2" side="tl" part="gen"/>
              <lit-tag v="f"/>
            </equal>
          </test>
          <let>
            <var n="genero"/>
            <lit-tag v="f"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="3" side="tl" part="gen"/>
              <lit-tag v="m"/>
            </equal>
          </test>
          <let>
            <var n="genero"/>
            <lit-tag v="m"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="3" side="tl" part="gen"/>
              <lit-tag v="f"/>
            </equal>
          </test>
          <let>
            <var n="genero"/>
            <lit-tag v="f"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="4" side="tl" part="gen"/>
              <lit-tag v="m"/>
            </equal>
          </test>
          <let>
            <var n="genero"/>
            <lit-tag v="m"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="4" side="tl" part="gen"/>
              <lit-tag v="f"/>
            </equal>
          </test>
          <let>
            <var n="genero"/>
            <lit-tag v="f"/>
          </let>
        </when>
        <otherwise>
          <let>
            <var n="genero"/>
            <lit-tag v="m"/>
          </let>
        </otherwise>
      </choose>
      <choose>
        <when>
          <test>
            <equal>
              <clip pos="1" side="tl" part="nbr"/>
              <lit-tag v="sg"/>
            </equal>
          </test>
          <let>
            <var n="numero"/>
            <lit-tag v="sg"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="1" side="tl" part="nbr"/>
              <lit-tag v="pl"/>
            </equal>
          </test>
          <let>
            <var n="numero"/>
            <lit-tag v="pl"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="2" side="tl" part="nbr"/>
              <lit-tag v="sg"/>
            </equal>
          </test>
          <let>
            <var n="numero"/>
            <lit-tag v="sg"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="2" side="tl" part="nbr"/>
              <lit-tag v="pl"/>
            </equal>
          </test>
          <let>
            <var n="numero"/>
            <lit-tag v="pl"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="3" side="tl" part="nbr"/>
              <lit-tag v="sg"/>
            </equal>
          </test>
          <let>
            <var n="numero"/>
            <lit-tag v="sg"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="3" side="tl" part="nbr"/>
              <lit-tag v="pl"/>
            </equal>
          </test>
          <let>
            <var n="numero"/>
            <lit-tag v="pl"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="4" side="tl" part="nbr"/>
              <lit-tag v="sg"/>
            </equal>
          </test>
          <let>
            <var n="numero"/>
            <lit-tag v="sg"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="4" side="tl" part="nbr"/>
              <lit-tag v="pl"/>
            </equal>
          </test>
          <let>
            <var n="numero"/>
            <lit-tag v="pl"/>
          </let>
        </when>
        <otherwise>
          <let>
            <var n="numero"/>
            <lit-tag v="sg"/>
          </let>
        </otherwise>
      </choose>
      <choose>
        <when>
          <test>
            <equal>
              <clip pos="1" side="tl" part="gen"/>
              <lit-tag v="GD"/>
            </equal>
          </test>
          <let>
            <clip pos="1" side="tl" part="gen"/>
            <var n="genero"/>
          </let>
        </when>
      </choose>
      <choose>
        <when>
          <test>
            <equal>
              <clip pos="2" side="tl" part="gen"/>
              <lit-tag v="GD"/>
            </equal>
          </test>
          <let>
            <clip pos="2" side="tl" part="gen"/>
            <var n="genero"/>
          </let>
        </when>
      </choose>
      <choose>
        <when>
          <test>
            <equal>
              <clip pos="3" side="tl" part="gen"/>
              <lit-tag v="GD"/>
            </equal>
          </test>
          <let>
            <clip pos="3" side="tl" part="gen"/>
            <var n="genero"/>
          </let>
        </when>
      </choose>
      <choose>
        <when>
          <test>
            <equal>
              <clip pos="4" side="tl" part="gen"/>
              <lit-tag v="GD"/>
            </equal>
          </test>
          <let>
            <clip pos="4" side="tl" part="gen"/>
            <var n="genero"/>
          </let>
        </when>
      </choose>
      <choose>
        <when>
          <test>
            <equal>
              <clip pos="1" side="tl" part="nbr"/>
              <lit-tag v="ND"/>
            </equal>
          </test>
          <let>
            <clip pos="1" side="tl" part="nbr"/>
            <var n="numero"/>
          </let>
        </when>
      </choose>
      <choose>
        <when>
          <test>
            <equal>
              <clip pos="2" side="tl" part="nbr"/>
              <lit-tag v="ND"/>
            </equal>
          </test>
          <let>
            <clip pos="2" side="tl" part="nbr"/>
            <var n="numero"/>
          </let>
        </when>
      </choose>
      <choose>
        <when>
          <test>
            <equal>
              <clip pos="3" side="tl" part="nbr"/>
              <lit-tag v="ND"/>
            </equal>
          </test>
          <let>
            <clip pos="3" side="tl" part="nbr"/>
            <var n="numero"/>
          </let>
        </when>
      </choose>
      <choose>
        <when>
          <test>
            <equal>
              <clip pos="4" side="tl" part="nbr"/>
              <lit-tag v="ND"/>
            </equal>
          </test>
          <let>
            <clip pos="4" side="tl" part="nbr"/>
            <var n="numero"/>
          </let>
        </when>
      </choose>
    </def-macro>
    <def-macro n="f_lexicAdj" npar="1">
      <choose>
        <when>
          <test>
            <and>
              <equal caseless="yes">
                <clip pos="1" side="tl" part="lem"/>
                <lit v="bueno"/>
              </equal>
              <equal>
                <clip pos="1" side="tl" part="gen"/>
                <lit-tag v="m"/>
              </equal>
              <equal>
                <clip pos="1" side="tl" part="nbr"/>
                <lit-tag v="sg"/>
              </equal>
            </and>
          </test>
          <let>
            <clip pos="1" side="tl" part="lem"/>
            <get-case-from pos="1">
              <lit v="buen"/>
            </get-case-from>
          </let>
        </when>
        <when>
          <test>
            <and>
              <equal caseless="yes">
                <clip pos="1" side="tl" part="lem"/>
                <lit v="grande"/>
              </equal>
              <equal>
                <clip pos="1" side="tl" part="gen"/>
                <lit-tag v="mf"/>
              </equal>
              <equal>
                <clip pos="1" side="tl" part="nbr"/>
                <lit-tag v="sg"/>
              </equal>
            </and>
          </test>
          <let>
            <clip pos="1" side="tl" part="lem"/>
            <get-case-from pos="1">
              <lit v="gran"/>
            </get-case-from>
          </let>
        </when>
        <when>
          <test>
            <and>
              <equal caseless="yes">
                <clip pos="1" side="tl" part="lem"/>
                <lit v="primero"/>
              </equal>
              <equal>
                <clip pos="1" side="tl" part="gen"/>
                <lit-tag v="m"/>
              </equal>
              <equal>
                <clip pos="1" side="tl" part="nbr"/>
                <lit-tag v="sg"/>
              </equal>
            </and>
          </test>
          <let>
            <clip pos="1" side="tl" part="lem"/>
            <get-case-from pos="1">
              <lit v="primer"/>
            </get-case-from>
          </let>
        </when>
        <when>
          <test>
            <and>
              <equal caseless="yes">
                <clip pos="1" side="tl" part="lem"/>
                <lit v="tercero"/>
              </equal>
              <equal>
                <clip pos="1" side="tl" part="gen"/>
                <lit-tag v="m"/>
              </equal>
              <equal>
                <clip pos="1" side="tl" part="nbr"/>
                <lit-tag v="sg"/>
              </equal>
            </and>
          </test>
          <let>
            <clip pos="1" side="tl" part="lem"/>
            <get-case-from pos="1">
              <lit v="tercer"/>
            </get-case-from>
          </let>
        </when>
      </choose>
    </def-macro>
  </section-def-macros>
  <section-rules>
    <rule>
<!-- REGLA: NOM-->
      <pattern>
        <pattern-item n="nom"/>
      </pattern>
      <action>
        <choose>
          <when>
            <test>
              <and>
                <equal>
                  <clip pos="1" side="sl" part="a_def"/>
                  <lit-tag v="def"/>
                </equal>
                <equal>
                  <clip pos="1" side="sl" part="a_case"/>
                  <lit-tag v="nom"/>
                </equal>
              </and>
            </test>
            <call-macro n="f_concord1">
              <with-param pos="1"/>
            </call-macro>
            <choose>
              <when>
                <test>
                  <equal>
                    <clip pos="1" side="tl" part="gen"/>
                    <lit-tag v="mf"/>
                  </equal>
                </test>
                <out>
                  <lu>
                    <lit v="el"/>
                    <lit-tag v="det.def"/>
                    <clip pos="1" side="sl" part="gen"/>
                    <clip pos="1" side="tl" part="nbr"/>
                  </lu>
                  <b/>
                  <lu>
                    <clip pos="1" side="tl" part="lem"/>
                    <clip pos="1" side="tl" part="a_nom"/>
                    <clip pos="1" side="tl" part="gen"/>
                    <clip pos="1" side="tl" part="nbr"/>
                  </lu>
                </out>
              </when>
              <otherwise>
                <out>
                  <lu>
                    <lit v="el"/>
                    <lit-tag v="det.def"/>
                    <clip pos="1" side="tl" part="gen"/>
                    <clip pos="1" side="tl" part="nbr"/>
                  </lu>
                  <b/>
                  <lu>
                    <clip pos="1" side="tl" part="lem"/>
                    <clip pos="1" side="tl" part="a_nom"/>
                    <clip pos="1" side="tl" part="gen"/>
                    <clip pos="1" side="tl" part="nbr"/>
                  </lu>
                </out>
              </otherwise>
            </choose>
          </when>
          <otherwise>
            <choose>
              <when>
                <test>
                  <equal>
                    <clip pos="1" side="sl" part="a_case"/>
                    <lit-tag v="nom"/>
                  </equal>
                </test>
                <out>
                  <lu>
                    <clip pos="1" side="tl" part="lem"/>
                    <clip pos="1" side="tl" part="a_nom"/>
                    <clip pos="1" side="tl" part="gen"/>
                    <clip pos="1" side="tl" part="nbr"/>
                  </lu>
                </out>
              </when>
            </choose>
          </otherwise>
        </choose>
        <choose>
          <when>
            <test>
              <and>
                <equal>
                  <clip pos="1" side="sl" part="a_def"/>
                  <lit-tag v="def"/>
                </equal>
                <equal>
                  <clip pos="1" side="sl" part="a_case"/>
                  <lit-tag v="dg"/>
                </equal>
              </and>
            </test>
            <call-macro n="f_concord1">
              <with-param pos="1"/>
            </call-macro>
            <choose>
              <when>
                <test>
                  <equal>
                    <clip pos="1" side="tl" part="gen"/>
                    <lit-tag v="mf"/>
                  </equal>
                </test>
                <out>
                  <lu>
                    <lit v="de"/>
                    <lit-tag v="pr"/>
                  </lu>
                  <b/>
                  <lu>
                    <lit v="el"/>
                    <lit-tag v="det.def"/>
                    <clip pos="1" side="sl" part="gen"/>
                    <clip pos="1" side="tl" part="nbr"/>
                  </lu>
                  <b/>
                  <lu>
                    <clip pos="1" side="tl" part="lem"/>
                    <clip pos="1" side="tl" part="a_nom"/>
                    <clip pos="1" side="tl" part="gen"/>
                    <clip pos="1" side="tl" part="nbr"/>
                  </lu>
                </out>
              </when>
              <otherwise>
                <out>
                  <lu>
                    <lit v="de"/>
                    <lit-tag v="pr"/>
                  </lu>
                  <b/>
                  <lu>
                    <lit v="el"/>
                    <lit-tag v="det.def"/>
                    <clip pos="1" side="tl" part="gen"/>
                    <clip pos="1" side="tl" part="nbr"/>
                  </lu>
                  <b/>
                  <lu>
                    <clip pos="1" side="tl" part="lem"/>
                    <clip pos="1" side="tl" part="a_nom"/>
                    <clip pos="1" side="tl" part="gen"/>
                    <clip pos="1" side="tl" part="nbr"/>
                  </lu>
                </out>
              </otherwise>
            </choose>
          </when>
<!-- <otherwise>
	          <out>
                   <lu>
                     <lit v="aquí" /> 
           	     <clip pos="1" side="tl" part="lem"/>
	      	     <clip pos="1" side="tl" part="a_nom"/>
	             <clip pos="1" side="tl" part="gen"/>
	      	     <clip pos="1" side="tl" part="nbr"/>
       	           </lu>
         	 </out> 
	     </otherwise> -->
        </choose>
      </action>
    </rule>
    <rule>
<!-- REGLA: pp -->
      <pattern>
        <pattern-item n="pp"/>
      </pattern>
      <action>
        <call-macro n="f_modgen">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_concord1">
          <with-param pos="1"/>
        </call-macro>
        <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
        </out>
      </action>
    </rule>
    <rule>
<!-- REGLA: ADJECTIU -->
      <pattern>
        <pattern-item n="adj"/>
      </pattern>
      <action>
        <choose>
          <when>
            <test>
              <and>
                <equal>
                  <clip pos="1" side="sl" part="a_def"/>
                  <lit-tag v="def"/>
                </equal>
                <equal>
                  <clip pos="1" side="sl" part="a_case"/>
                  <lit-tag v="nom"/>
                </equal>
              </and>
            </test>
            <call-macro n="f_modgen">
              <with-param pos="1"/>
            </call-macro>
            <call-macro n="f_concord1">
              <with-param pos="1"/>
            </call-macro>
            <choose>
              <when>
                <test>
                  <equal>
                    <clip pos="1" side="tl" part="gen"/>
                    <lit-tag v="mf"/>
                  </equal>
                </test>
                <out>
                  <lu>
                    <lit v="el"/>
                    <lit-tag v="det.def.m"/>
<!--<clip pos="1" side="sl" part="gen"/>-->
                    <clip pos="1" side="tl" part="nbr"/>
                  </lu>
                  <b/>
                  <lu>
                    <clip pos="1" side="tl" part="lem"/>
                    <clip pos="1" side="tl" part="a_adj"/>
                    <clip pos="1" side="tl" part="gen"/>
                    <clip pos="1" side="tl" part="nbr"/>
                  </lu>
                </out>
              </when>
              <otherwise>
                <out>
                  <lu>
                    <lit v="el"/>
                    <lit-tag v="det.def"/>
                    <clip pos="1" side="tl" part="gen"/>
                    <clip pos="1" side="tl" part="nbr"/>
                  </lu>
                  <b/>
                  <lu>
                    <clip pos="1" side="tl" part="lem"/>
                    <clip pos="1" side="tl" part="a_adj"/>
                    <clip pos="1" side="tl" part="gen"/>
                    <clip pos="1" side="tl" part="nbr"/>
                  </lu>
                </out>
              </otherwise>
            </choose>
          </when>
          <otherwise>
            <call-macro n="f_modgen">
              <with-param pos="1"/>
            </call-macro>
            <choose>
              <when>
                <test>
                  <equal>
                    <clip pos="1" side="sl" part="a_case"/>
                    <lit-tag v="nom"/>
                  </equal>
                </test>
                <out>
                  <lu>
                    <clip pos="1" side="tl" part="lem"/>
                    <clip pos="1" side="tl" part="a_adj"/>
                    <clip pos="1" side="tl" part="gen"/>
                    <clip pos="1" side="tl" part="nbr"/>
                  </lu>
                </out>
              </when>
            </choose>
          </otherwise>
        </choose>
        <choose>
          <when>
            <test>
              <and>
                <equal>
                  <clip pos="1" side="sl" part="a_def"/>
                  <lit-tag v="def"/>
                </equal>
                <equal>
                  <clip pos="1" side="sl" part="a_case"/>
                  <lit-tag v="dg"/>
                </equal>
              </and>
            </test>
            <call-macro n="f_modgen">
              <with-param pos="1"/>
            </call-macro>
            <call-macro n="f_concord1">
              <with-param pos="1"/>
            </call-macro>
            <choose>
              <when>
                <test>
                  <equal>
                    <clip pos="1" side="tl" part="gen"/>
                    <lit-tag v="mf"/>
                  </equal>
                </test>
                <out>
                  <lu>
                    <lit v="de"/>
                    <lit-tag v="pr"/>
                  </lu>
                  <b/>
                  <lu>
                    <lit v="el"/>
                    <lit-tag v="det.def.m"/>
<!--<clip pos="1" side="sl" part="gen"/>-->
                    <clip pos="1" side="tl" part="nbr"/>
                  </lu>
                  <b/>
                  <lu>
                    <clip pos="1" side="tl" part="lem"/>
                    <clip pos="1" side="tl" part="a_adj"/>
                    <clip pos="1" side="tl" part="gen"/>
                    <clip pos="1" side="tl" part="nbr"/>
                  </lu>
                </out>
              </when>
              <otherwise>
                <out>
                  <lu>
                    <lit v="de"/>
                    <lit-tag v="pr"/>
                  </lu>
                  <b/>
                  <lu>
                    <lit v="el"/>
                    <lit-tag v="det.def"/>
                    <clip pos="1" side="tl" part="gen"/>
                    <clip pos="1" side="tl" part="nbr"/>
                  </lu>
                  <b/>
                  <lu>
                    <clip pos="1" side="tl" part="lem"/>
                    <clip pos="1" side="tl" part="a_adj"/>
                    <clip pos="1" side="tl" part="gen"/>
                    <clip pos="1" side="tl" part="nbr"/>
                  </lu>
                </out>
              </otherwise>
            </choose>
          </when>
<!--  <otherwise>
	          <out>
                    <lu> 
           	     <clip pos="1" side="tl" part="lem"/>
	      	     <clip pos="1" side="tl" part="a_adj"/>
	             <clip pos="1" side="tl" part="gen"/>
	      	     <clip pos="1" side="tl" part="nbr"/>
       	           </lu>
         	 </out> 
	     </otherwise> -->
        </choose>
      </action>
    </rule>
    <rule>
<!-- REGLA: ADJECTIU NOM -->
      <pattern>
        <pattern-item n="adj"/>
        <pattern-item n="nom"/>
      </pattern>
      <action>
        <choose>
          <when>
            <test>
              <and>
                <equal>
                  <clip pos="1" side="sl" part="a_def"/>
                  <lit-tag v="def"/>
                </equal>
                <equal>
                  <clip pos="1" side="sl" part="a_case"/>
                  <lit-tag v="nom"/>
                </equal>
              </and>
            </test>
            <call-macro n="f_modgen">
              <with-param pos="1"/>
            </call-macro>
            <call-macro n="f_concord2">
              <with-param pos="2"/>
              <with-param pos="1"/>
            </call-macro>
            <choose>
              <when>
                <test>
                  <equal>
                    <clip pos="1" side="tl" part="gen"/>
                    <lit-tag v="mf"/>
                  </equal>
                </test>
                <out>
                  <lu>
                    <lit v="el"/>
                    <lit-tag v="det.def"/>
                    <clip pos="1" side="sl" part="gen"/>
                    <clip pos="1" side="tl" part="nbr"/>
                  </lu>
                  <b/>
                  <lu>
                    <clip pos="1" side="tl" part="lem"/>
                    <clip pos="1" side="tl" part="a_adj"/>
                    <clip pos="1" side="tl" part="gen"/>
                    <clip pos="1" side="tl" part="nbr"/>
                  </lu>
                  <b/>
                  <lu>
                    <clip pos="2" side="tl" part="lem"/>
                    <clip pos="2" side="tl" part="a_nom"/>
                    <clip pos="2" side="tl" part="gen"/>
                    <clip pos="2" side="tl" part="nbr"/>
                  </lu>
                </out>
              </when>
              <otherwise>
                <out>
                  <lu>
                    <lit v="el"/>
                    <lit-tag v="det.def"/>
                    <clip pos="1" side="tl" part="gen"/>
                    <clip pos="1" side="tl" part="nbr"/>
                  </lu>
                  <b/>
                  <lu>
                    <clip pos="1" side="tl" part="lem"/>
                    <clip pos="1" side="tl" part="a_adj"/>
                    <clip pos="1" side="tl" part="gen"/>
                    <clip pos="1" side="tl" part="nbr"/>
                  </lu>
                  <b/>
                  <lu>
                    <clip pos="2" side="tl" part="lem"/>
                    <clip pos="2" side="tl" part="a_nom"/>
                    <clip pos="2" side="tl" part="gen"/>
                    <clip pos="2" side="tl" part="nbr"/>
                  </lu>
                </out>
              </otherwise>
            </choose>
          </when>
          <when>
            <test>
              <and>
                <equal>
                  <clip pos="1" side="sl" part="a_def"/>
                  <lit-tag v="def"/>
                </equal>
                <equal>
                  <clip pos="1" side="sl" part="a_case"/>
                  <lit-tag v="dg"/>
                </equal>
              </and>
            </test>
            <call-macro n="f_modgen">
              <with-param pos="1"/>
            </call-macro>
            <call-macro n="f_concord2">
              <with-param pos="2"/>
              <with-param pos="1"/>
            </call-macro>
            <choose>
              <when>
                <test>
                  <equal>
                    <clip pos="1" side="tl" part="gen"/>
                    <lit-tag v="mf"/>
                  </equal>
                </test>
                <out>
                  <lu>
                    <lit v="de"/>
                    <lit-tag v="pr"/>
                  </lu>
                  <b/>
                  <lu>
                    <lit v="el"/>
                    <lit-tag v="det.def"/>
                    <clip pos="1" side="sl" part="gen"/>
                    <clip pos="1" side="tl" part="nbr"/>
                  </lu>
                  <b/>
                  <lu>
                    <clip pos="1" side="tl" part="lem"/>
                    <clip pos="1" side="tl" part="a_adj"/>
                    <clip pos="1" side="tl" part="gen"/>
                    <clip pos="1" side="tl" part="nbr"/>
                  </lu>
                  <b/>
                  <lu>
                    <clip pos="2" side="tl" part="lem"/>
                    <clip pos="2" side="tl" part="a_nom"/>
                    <clip pos="2" side="tl" part="gen"/>
                    <clip pos="2" side="tl" part="nbr"/>
                  </lu>
                </out>
              </when>
              <otherwise>
                <out>
                  <lu>
                    <lit v="de"/>
                    <lit-tag v="pr"/>
                  </lu>
                  <b/>
                  <lu>
                    <lit v="el"/>
                    <lit-tag v="det.def"/>
                    <clip pos="1" side="tl" part="gen"/>
                    <clip pos="1" side="tl" part="nbr"/>
                  </lu>
                  <b/>
                  <lu>
                    <clip pos="1" side="tl" part="lem"/>
                    <clip pos="1" side="tl" part="a_adj"/>
                    <clip pos="1" side="tl" part="gen"/>
                    <clip pos="1" side="tl" part="nbr"/>
                  </lu>
                  <b/>
                  <lu>
                    <clip pos="2" side="tl" part="lem"/>
                    <clip pos="2" side="tl" part="a_nom"/>
                    <clip pos="2" side="tl" part="gen"/>
                    <clip pos="2" side="tl" part="nbr"/>
                  </lu>
                </out>
              </otherwise>
            </choose>
          </when>
          <otherwise>
            <call-macro n="f_modgen">
              <with-param pos="1"/>
            </call-macro>
            <call-macro n="f_concord2">
              <with-param pos="2"/>
              <with-param pos="1"/>
            </call-macro>
            <out>
              <lu>
                <clip pos="1" side="tl" part="lem"/>
                <clip pos="1" side="tl" part="a_adj"/>
                <clip pos="1" side="tl" part="gen"/>
                <clip pos="1" side="tl" part="nbr"/>
              </lu>
              <b pos="1"/>
              <lu>
                <clip pos="2" side="tl" part="lem"/>
                <clip pos="2" side="tl" part="a_nom"/>
                <clip pos="2" side="tl" part="gen"/>
                <clip pos="2" side="tl" part="nbr"/>
              </lu>
            </out>
          </otherwise>
        </choose>
      </action>
    </rule>
<!--Encara no funciona: Dóna per a NOUÁ FETE = NUEVE #CHICA i no NUEVE CHICAS com hauria de fer-ho -->
    <rule>
<!-- REGLA: NUMERAL NOM-->
      <pattern>
        <pattern-item n="num"/>
        <pattern-item n="nom"/>
      </pattern>
      <action>
        <call-macro n="f_concord2">
          <with-param pos="2"/>
          <with-param pos="1"/>
        </call-macro>
        <choose>
          <when>
            <test>
              <equal>
                <clip pos="2" side="tl" part="gen"/>
                <lit-tag v="mf"/>
              </equal>
            </test>
            <out>
              <lu>
                <clip pos="1" side="tl" part="lem"/>
                <clip pos="1" side="tl" part="a_num"/>
                <clip pos="1" side="tl" part="gen"/>
                <clip pos="1" side="tl" part="nbr"/>
              </lu>
              <b/>
              <lu>
                <clip pos="2" side="tl" part="lem"/>
                <clip pos="2" side="tl" part="a_nom"/>
                <clip pos="2" side="sl" part="gen"/>
                <clip pos="2" side="tl" part="nbr"/>
              </lu>
            </out>
          </when>
          <otherwise>
            <call-macro n="f_concord2">
              <with-param pos="2"/>
              <with-param pos="1"/>
            </call-macro>
            <out>
              <lu>
                <clip pos="1" side="tl" part="lem"/>
                <clip pos="1" side="tl" part="a_num"/>
                <clip pos="1" side="tl" part="gen"/>
                <clip pos="1" side="tl" part="nbr"/>
              </lu>
              <b pos="1"/>
              <lu>
                <clip pos="2" side="tl" part="lem"/>
                <clip pos="2" side="tl" part="a_nom"/>
                <clip pos="2" side="tl" part="gen"/>
                <clip pos="2" side="tl" part="nbr"/>
              </lu>
            </out>
          </otherwise>
        </choose>
      </action>
    </rule>
    <rule>
<!-- REGLA: NOM ADJECTIU -->
      <pattern>
        <pattern-item n="nom"/>
        <pattern-item n="adj"/>
      </pattern>
      <action>
        <choose>
          <when>
            <test>
              <and>
                <equal>
                  <clip pos="1" side="sl" part="a_def"/>
                  <lit-tag v="def"/>
                </equal>
                <equal>
                  <clip pos="1" side="sl" part="a_case"/>
                  <lit-tag v="nom"/>
                </equal>
              </and>
            </test>
            <call-macro n="f_modgen">
              <with-param pos="2"/>
            </call-macro>
            <call-macro n="f_concord2">
              <with-param pos="1"/>
              <with-param pos="2"/>
            </call-macro>
            <choose>
              <when>
                <test>
                  <equal>
                    <clip pos="1" side="tl" part="gen"/>
                    <lit-tag v="mf"/>
                  </equal>
                </test>
                <out>
                  <lu>
                    <lit v="el"/>
                    <lit-tag v="det.def"/>
                    <clip pos="1" side="sl" part="gen"/>
                    <clip pos="1" side="tl" part="nbr"/>
                  </lu>
                  <b/>
                  <lu>
                    <clip pos="1" side="tl" part="lem"/>
                    <clip pos="1" side="tl" part="a_nom"/>
                    <clip pos="1" side="tl" part="gen"/>
                    <clip pos="1" side="tl" part="nbr"/>
                  </lu>
                  <b/>
                  <lu>
                    <clip pos="2" side="tl" part="lem"/>
                    <clip pos="2" side="tl" part="a_adj"/>
                    <clip pos="2" side="tl" part="gen"/>
                    <clip pos="2" side="tl" part="nbr"/>
                  </lu>
                </out>
              </when>
              <otherwise>
                <out>
                  <lu>
                    <lit v="el"/>
                    <lit-tag v="det.def"/>
                    <clip pos="1" side="tl" part="gen"/>
                    <clip pos="1" side="tl" part="nbr"/>
                  </lu>
                  <b/>
                  <lu>
                    <clip pos="1" side="tl" part="lem"/>
                    <clip pos="1" side="tl" part="a_nom"/>
                    <clip pos="1" side="tl" part="gen"/>
                    <clip pos="1" side="tl" part="nbr"/>
                  </lu>
                  <b/>
                  <lu>
                    <clip pos="2" side="tl" part="lem"/>
                    <clip pos="2" side="tl" part="a_adj"/>
                    <clip pos="2" side="tl" part="gen"/>
                    <clip pos="2" side="tl" part="nbr"/>
                  </lu>
                </out>
              </otherwise>
            </choose>
          </when>
          <when>
            <test>
              <and>
                <equal>
                  <clip pos="1" side="sl" part="a_def"/>
                  <lit-tag v="def"/>
                </equal>
                <equal>
                  <clip pos="1" side="sl" part="a_case"/>
                  <lit-tag v="dg"/>
                </equal>
              </and>
            </test>
            <call-macro n="f_modgen">
              <with-param pos="2"/>
            </call-macro>
            <call-macro n="f_concord2">
              <with-param pos="1"/>
              <with-param pos="2"/>
            </call-macro>
            <choose>
              <when>
                <test>
                  <equal>
                    <clip pos="1" side="tl" part="gen"/>
                    <lit-tag v="mf"/>
                  </equal>
                </test>
                <out>
                  <lu>
                    <lit v="de"/>
                    <lit-tag v="pr"/>
                  </lu>
                  <b/>
                  <lu>
                    <lit v="el"/>
                    <lit-tag v="det.def"/>
                    <clip pos="1" side="sl" part="gen"/>
                    <clip pos="1" side="tl" part="nbr"/>
                  </lu>
                  <b/>
                  <lu>
                    <clip pos="1" side="tl" part="lem"/>
                    <clip pos="1" side="tl" part="a_nom"/>
                    <clip pos="1" side="tl" part="gen"/>
                    <clip pos="1" side="tl" part="nbr"/>
                  </lu>
                  <b/>
                  <lu>
                    <clip pos="2" side="tl" part="lem"/>
                    <clip pos="2" side="tl" part="a_adj"/>
                    <clip pos="2" side="tl" part="gen"/>
                    <clip pos="2" side="tl" part="nbr"/>
                  </lu>
                </out>
              </when>
              <otherwise>
                <out>
                  <lu>
                    <lit v="de"/>
                    <lit-tag v="pr"/>
                  </lu>
                  <b/>
                  <lu>
                    <lit v="el"/>
                    <lit-tag v="det.def"/>
                    <clip pos="1" side="tl" part="gen"/>
                    <clip pos="1" side="tl" part="nbr"/>
                  </lu>
                  <b/>
                  <lu>
                    <clip pos="1" side="tl" part="lem"/>
                    <clip pos="1" side="tl" part="a_nom"/>
                    <clip pos="1" side="tl" part="gen"/>
                    <clip pos="1" side="tl" part="nbr"/>
                  </lu>
                  <b/>
                  <lu>
                    <clip pos="2" side="tl" part="lem"/>
                    <clip pos="2" side="tl" part="a_adj"/>
                    <clip pos="2" side="tl" part="gen"/>
                    <clip pos="2" side="tl" part="nbr"/>
                  </lu>
                </out>
              </otherwise>
            </choose>
          </when>
          <otherwise>
            <call-macro n="f_modgen">
              <with-param pos="2"/>
            </call-macro>
            <call-macro n="f_concord2">
              <with-param pos="1"/>
              <with-param pos="2"/>
            </call-macro>
            <out>
              <lu>
                <clip pos="1" side="tl" part="lem"/>
                <clip pos="1" side="tl" part="a_nom"/>
                <clip pos="1" side="tl" part="gen"/>
                <clip pos="1" side="tl" part="nbr"/>
              </lu>
              <b pos="1"/>
              <lu>
                <clip pos="2" side="tl" part="lem"/>
                <clip pos="2" side="tl" part="a_adj"/>
                <clip pos="2" side="tl" part="gen"/>
                <clip pos="2" side="tl" part="nbr"/>
              </lu>
            </out>
          </otherwise>
        </choose>
      </action>
    </rule>
    <rule>
<!-- REGLA: NOM ADVERBI ADJECTIU -->
      <pattern>
        <pattern-item n="nom"/>
        <pattern-item n="adv"/>
        <pattern-item n="adj"/>
      </pattern>
      <action>
        <choose>
          <when>
            <test>
              <and>
                <equal>
                  <clip pos="1" side="sl" part="a_def"/>
                  <lit-tag v="def"/>
                </equal>
                <equal>
                  <clip pos="1" side="sl" part="a_case"/>
                  <lit-tag v="nom"/>
                </equal>
              </and>
            </test>
            <call-macro n="f_modgen">
              <with-param pos="3"/>
            </call-macro>
            <call-macro n="f_concord2">
              <with-param pos="1"/>
              <with-param pos="3"/>
            </call-macro>
            <choose>
              <when>
                <test>
                  <equal>
                    <clip pos="1" side="tl" part="gen"/>
                    <lit-tag v="mf"/>
                  </equal>
                </test>
                <out>
                  <lu>
                    <lit v="el"/>
                    <lit-tag v="det.def"/>
                    <clip pos="1" side="sl" part="gen"/>
                    <clip pos="1" side="tl" part="nbr"/>
                  </lu>
                  <b/>
                  <lu>
                    <clip pos="1" side="tl" part="lem"/>
                    <clip pos="1" side="tl" part="a_nom"/>
                    <clip pos="1" side="tl" part="gen"/>
                    <clip pos="1" side="tl" part="nbr"/>
                  </lu>
                  <b/>
                  <lu>
                    <clip pos="2" side="tl" part="lem"/>
                    <clip pos="2" side="tl" part="a_adv"/>
                  </lu>
                  <b/>
                  <lu>
                    <clip pos="3" side="tl" part="lem"/>
                    <clip pos="3" side="tl" part="a_adj"/>
                    <clip pos="1" side="tl" part="gen"/>
                    <clip pos="1" side="tl" part="nbr"/>
                  </lu>
                </out>
              </when>
              <otherwise>
                <out>
                  <lu>
                    <lit v="el"/>
                    <lit-tag v="det.def"/>
                    <clip pos="1" side="tl" part="gen"/>
                    <clip pos="1" side="tl" part="nbr"/>
                  </lu>
                  <b/>
                  <lu>
                    <clip pos="1" side="tl" part="lem"/>
                    <clip pos="1" side="tl" part="a_nom"/>
                    <clip pos="1" side="tl" part="gen"/>
                    <clip pos="1" side="tl" part="nbr"/>
                  </lu>
                  <b/>
                  <lu>
                    <clip pos="2" side="tl" part="lem"/>
                    <clip pos="2" side="tl" part="a_adv"/>
                  </lu>
                  <b/>
                  <lu>
                    <clip pos="3" side="tl" part="lem"/>
                    <clip pos="3" side="tl" part="a_adj"/>
                    <clip pos="1" side="tl" part="gen"/>
                    <clip pos="1" side="tl" part="nbr"/>
                  </lu>
                </out>
              </otherwise>
            </choose>
          </when>
          <when>
            <test>
              <and>
                <equal>
                  <clip pos="1" side="sl" part="a_def"/>
                  <lit-tag v="def"/>
                </equal>
                <equal>
                  <clip pos="1" side="sl" part="a_case"/>
                  <lit-tag v="dg"/>
                </equal>
              </and>
            </test>
            <call-macro n="f_modgen">
              <with-param pos="3"/>
            </call-macro>
            <call-macro n="f_concord2">
              <with-param pos="1"/>
              <with-param pos="3"/>
            </call-macro>
            <choose>
              <when>
                <test>
                  <equal>
                    <clip pos="1" side="tl" part="gen"/>
                    <lit-tag v="mf"/>
                  </equal>
                </test>
                <out>
                  <lu>
                    <lit v="de"/>
                    <lit-tag v="pr"/>
                  </lu>
                  <b/>
                  <lu>
                    <lit v="el"/>
                    <lit-tag v="det.def"/>
                    <clip pos="1" side="sl" part="gen"/>
                    <clip pos="1" side="tl" part="nbr"/>
                  </lu>
                  <b/>
                  <lu>
                    <clip pos="1" side="tl" part="lem"/>
                    <clip pos="1" side="tl" part="a_nom"/>
                    <clip pos="1" side="tl" part="gen"/>
                    <clip pos="1" side="tl" part="nbr"/>
                  </lu>
                  <b/>
                  <lu>
                    <clip pos="2" side="tl" part="lem"/>
                    <clip pos="2" side="tl" part="a_adv"/>
                  </lu>
                  <b/>
                  <lu>
                    <clip pos="3" side="tl" part="lem"/>
                    <clip pos="3" side="tl" part="a_adj"/>
                    <clip pos="1" side="tl" part="gen"/>
                    <clip pos="1" side="tl" part="nbr"/>
                  </lu>
                </out>
              </when>
              <otherwise>
                <out>
                  <lu>
                    <lit v="de"/>
                    <lit-tag v="pr"/>
                  </lu>
                  <b/>
                  <lu>
                    <lit v="el"/>
                    <lit-tag v="det.def"/>
                    <clip pos="1" side="tl" part="gen"/>
                    <clip pos="1" side="tl" part="nbr"/>
                  </lu>
                  <b/>
                  <lu>
                    <clip pos="1" side="tl" part="lem"/>
                    <clip pos="1" side="tl" part="a_nom"/>
                    <clip pos="1" side="tl" part="gen"/>
                    <clip pos="1" side="tl" part="nbr"/>
                  </lu>
                  <b/>
                  <lu>
                    <clip pos="2" side="tl" part="lem"/>
                    <clip pos="2" side="tl" part="a_adv"/>
                  </lu>
                  <b/>
                  <lu>
                    <clip pos="3" side="tl" part="lem"/>
                    <clip pos="3" side="tl" part="a_adj"/>
                    <clip pos="1" side="tl" part="gen"/>
                    <clip pos="1" side="tl" part="nbr"/>
                  </lu>
                </out>
              </otherwise>
            </choose>
          </when>
          <otherwise>
            <call-macro n="f_modgen">
              <with-param pos="2"/>
            </call-macro>
            <call-macro n="f_concord2">
              <with-param pos="1"/>
              <with-param pos="3"/>
            </call-macro>
            <out>
              <lu>
                <clip pos="1" side="tl" part="lem"/>
                <clip pos="1" side="tl" part="a_nom"/>
                <clip pos="1" side="tl" part="gen"/>
                <clip pos="1" side="tl" part="nbr"/>
              </lu>
              <b pos="1"/>
              <lu>
                <clip pos="2" side="tl" part="lem"/>
                <clip pos="2" side="tl" part="a_adv"/>
              </lu>
              <b pos="2"/>
              <lu>
                <clip pos="3" side="tl" part="lem"/>
                <clip pos="3" side="tl" part="a_adj"/>
                <clip pos="3" side="tl" part="gen"/>
                <clip pos="3" side="tl" part="nbr"/>
              </lu>
            </out>
          </otherwise>
        </choose>
      </action>
    </rule>
<!-- cel mai frumos/cei mai frumoçi/cea mai frumoasä/cele mai frumoase - el más bello/los más bellos/la más bella/las más bellas-->
    <rule>
<!--REGLA: SUPERLATIU RELATIU-->
      <pattern>
        <pattern-item n="detcel"/>
        <pattern-item n="advmai"/>
        <pattern-item n="adj"/>
      </pattern>
      <action>
        <choose>
          <when>
            <test>
              <equal>
                <clip pos="1" side="sl" part="a_case"/>
                <lit-tag v="nom"/>
              </equal>
            </test>
            <call-macro n="f_modgen">
              <with-param pos="3"/>
            </call-macro>
            <call-macro n="f_modgen">
              <with-param pos="1"/>
            </call-macro>
            <call-macro n="f_concord2">
              <with-param pos="1"/>
              <with-param pos="3"/>
            </call-macro>
            <choose>
              <when>
                <test>
                  <equal>
                    <clip pos="3" side="tl" part="gen"/>
                    <lit-tag v="mf"/>
                  </equal>
                </test>
                <out>
                  <lu>
                    <lit v="el"/>
                    <lit-tag v="det.def"/>
                    <clip pos="3" side="sl" part="gen"/>
                    <clip pos="1" side="tl" part="nbr"/>
                  </lu>
                  <b/>
                  <lu>
                    <clip pos="2" side="tl" part="lem"/>
                    <clip pos="2" side="tl" part="a_adv"/>
                  </lu>
                  <b/>
                  <lu>
                    <clip pos="3" side="tl" part="lem"/>
                    <clip pos="3" side="tl" part="a_adj"/>
                    <clip pos="3" side="sl" part="gen"/>
                    <clip pos="3" side="tl" part="nbr"/>
                  </lu>
                </out>
              </when>
              <otherwise>
                <out>
                  <lu>
                    <lit v="el"/>
                    <lit-tag v="det.def"/>
                    <clip pos="1" side="tl" part="gen"/>
                    <clip pos="1" side="tl" part="nbr"/>
                  </lu>
                  <b/>
                  <lu>
                    <clip pos="2" side="tl" part="lem"/>
                    <clip pos="2" side="tl" part="a_adv"/>
                  </lu>
                  <b/>
                  <lu>
                    <clip pos="3" side="tl" part="lem"/>
                    <clip pos="3" side="tl" part="a_adj"/>
                    <clip pos="1" side="tl" part="gen"/>
                    <clip pos="1" side="tl" part="nbr"/>
                  </lu>
                </out>
              </otherwise>
            </choose>
          </when>
          <when>
            <test>
              <equal>
                <clip pos="1" side="sl" part="a_case"/>
                <lit-tag v="dg"/>
              </equal>
            </test>
            <call-macro n="f_modgen">
              <with-param pos="3"/>
            </call-macro>
            <call-macro n="f_modgen">
              <with-param pos="1"/>
            </call-macro>
            <call-macro n="f_concord2">
              <with-param pos="1"/>
              <with-param pos="3"/>
            </call-macro>
            <choose>
              <when>
                <test>
                  <and>
                    <equal>
                      <clip pos="1" side="sl" part="gen"/>
                      <lit-tag v="mf"/>
                    </equal>
                    <equal>
                      <clip pos="3" side="tl" part="gen"/>
                      <lit-tag v="mf"/>
                    </equal>
                  </and>
                </test>
                <out>
                  <lu>
                    <lit v="de"/>
                    <lit-tag v="pr"/>
                  </lu>
                  <b/>
                  <lu>
                    <lit v="el"/>
                    <lit-tag v="det.def"/>
                    <clip pos="3" side="sl" part="gen"/>
                    <clip pos="1" side="tl" part="nbr"/>
                  </lu>
                  <b/>
                  <lu>
                    <clip pos="2" side="tl" part="lem"/>
                    <clip pos="2" side="tl" part="a_adv"/>
                  </lu>
                  <b/>
                  <lu>
                    <clip pos="3" side="tl" part="lem"/>
                    <clip pos="3" side="tl" part="a_adj"/>
                    <clip pos="3" side="sl" part="gen"/>
                    <clip pos="3" side="tl" part="nbr"/>
                  </lu>
                </out>
              </when>
              <otherwise>
                <call-macro n="f_modgen">
                  <with-param pos="3"/>
                </call-macro>
                <call-macro n="f_modgen">
                  <with-param pos="1"/>
                </call-macro>
                <call-macro n="f_concord2">
                  <with-param pos="1"/>
                  <with-param pos="3"/>
                </call-macro>
                <choose>
                  <when>
                    <test>
                      <equal>
                        <clip pos="1" side="tl" part="gen"/>
                        <lit-tag v="mf"/>
                      </equal>
                    </test>
                    <out>
                      <lu>
                        <lit v="de"/>
                        <lit-tag v="pr"/>
                      </lu>
                      <b/>
                      <lu>
                        <lit v="el"/>
                        <lit-tag v="det.def"/>
                        <clip pos="3" side="sl" part="gen"/>
                        <clip pos="1" side="tl" part="nbr"/>
                      </lu>
                      <b/>
                      <lu>
                        <clip pos="2" side="tl" part="lem"/>
                        <clip pos="2" side="tl" part="a_adv"/>
                      </lu>
                      <b/>
                      <lu>
                        <clip pos="3" side="tl" part="lem"/>
                        <clip pos="3" side="tl" part="a_adj"/>
                        <clip pos="3" side="sl" part="gen"/>
                        <clip pos="3" side="tl" part="nbr"/>
                      </lu>
                    </out>
                  </when>
                  <otherwise>
                    <out>
                      <lu>
                        <lit v="de"/>
                        <lit-tag v="pr"/>
                      </lu>
                      <b/>
                      <lu>
                        <lit v="el"/>
                        <lit-tag v="det.def"/>
                        <clip pos="1" side="tl" part="gen"/>
                        <clip pos="1" side="tl" part="nbr"/>
                      </lu>
                      <b/>
                      <lu>
                        <clip pos="2" side="tl" part="lem"/>
                        <clip pos="2" side="tl" part="a_adv"/>
                      </lu>
                      <b/>
                      <lu>
                        <clip pos="3" side="tl" part="lem"/>
                        <clip pos="3" side="tl" part="a_adj"/>
                        <clip pos="1" side="tl" part="gen"/>
                        <clip pos="1" side="tl" part="nbr"/>
                      </lu>
                    </out>
                  </otherwise>
                </choose>
              </otherwise>
            </choose>
          </when>
<!--  <otherwise>
	   <call-macro n="f_modgen">
	     <with-param pos="3"/>
	   </call-macro> 
	   <call-macro n="f_modgen">
	      <with-param pos="1"/>
	    </call-macro>
           <call-macro n="f_concord2">
	     <with-param pos="1"/>
	     <with-param pos="3"/>
	   </call-macro>   
	   <out>
	      <lu>
              <lit v="a"/>
	      <lit-tag v="pr"/>
       	    </lu> 
	    <b/> 
	   <lu>
              <lit v="el"/>
	      <lit-tag v="det.def"/>
	      <clip pos="3" side="tl" part="gen"/>
	      <clip pos="3" side="tl" part="nbr"/>
       	    </lu> 
	      <b pos="1"/> 
	      <lu> 
              <clip pos="2" side="tl" part="lem"/>
	      <clip pos="2" side="tl" part="a_adv"/>
	    </lu>
	     <b pos="2"/> 
	    <lu> 
              <clip pos="3" side="tl" part="lem"/>
	      <clip pos="3" side="tl" part="a_adj"/>
	      <clip pos="3" side="tl" part="gen"/>
	      <clip pos="3" side="tl" part="nbr"/>
       	    </lu>   
	   </out>  
	 </otherwise> -->
        </choose>
      </action>
    </rule>
<!-- nespus de frumos/nespus de frumoçi/nespus de frumoasä/nespus de frumoase - bellíssimo/bellíssimos/bellíssima/bellíssimas-->
    <rule>
<!-- REGLA: SUPERLATIU ABSOLUT -->
      <pattern>
        <pattern-item n="advnespus"/>
        <pattern-item n="prepde"/>
        <pattern-item n="adj"/>
      </pattern>
      <action>
        <choose>
          <when>
            <test>
              <equal>
                <clip pos="3" side="sl" part="a_case"/>
                <lit-tag v="nom"/>
              </equal>
            </test>
            <call-macro n="f_modgen">
              <with-param pos="3"/>
            </call-macro>
            <choose>
              <when>
                <test>
                  <equal>
                    <clip pos="3" side="tl" part="gen"/>
                    <lit-tag v="mf"/>
                  </equal>
                </test>
                <out>
                  <lu>
                    <clip pos="3" side="sl" part="lem"/>
                    <clip pos="3" side="tl" part="a_adj"/>
                    <lit-tag v="sup"/>
                    <clip pos="3" side="tl" part="gen"/>
                    <clip pos="3" side="tl" part="nbr"/>
                  </lu>
                </out>
              </when>
              <otherwise>
                <call-macro n="f_modgen">
                  <with-param pos="3"/>
                </call-macro>
                <out>
                  <lu>
                    <clip pos="3" side="tl" part="lem"/>
                    <clip pos="3" side="tl" part="a_adj"/>
                    <lit-tag v="sup"/>
                    <clip pos="3" side="tl" part="gen"/>
                    <clip pos="3" side="tl" part="nbr"/>
                  </lu>
                </out>
              </otherwise>
            </choose>
          </when>
        </choose>
      </action>
    </rule>
    <rule>
<!--REGLA: NOM DETERMINANT ADJECTIU -->
      <pattern>
        <pattern-item n="nom"/>
        <pattern-item n="detcel"/>
        <pattern-item n="adj"/>
      </pattern>
      <action>
        <choose>
          <when>
            <test>
              <and>
                <equal>
                  <clip pos="1" side="sl" part="a_case"/>
                  <lit-tag v="nom"/>
                </equal>
                <equal>
                  <clip pos="1" side="sl" part="a_def"/>
                  <lit-tag v="def"/>
                </equal>
              </and>
            </test>
            <call-macro n="f_modgen">
              <with-param pos="3"/>
            </call-macro>
            <call-macro n="f_concord3">
              <with-param pos="1"/>
              <with-param pos="2"/>
              <with-param pos="3"/>
            </call-macro>
            <out>
              <lu>
                <lit v="el"/>
                <lit-tag v="det.def"/>
                <clip pos="1" side="tl" part="gen"/>
                <clip pos="1" side="tl" part="nbr"/>
              </lu>
              <b pos="1"/>
              <lu>
                <clip pos="1" side="tl" part="lem"/>
                <clip pos="1" side="tl" part="a_nom"/>
                <clip pos="1" side="tl" part="gen"/>
                <clip pos="1" side="tl" part="nbr"/>
              </lu>
              <b pos="2"/>
              <lu>
                <clip pos="3" side="tl" part="lem"/>
                <clip pos="3" side="tl" part="a_adj"/>
                <clip pos="3" side="tl" part="gen"/>
                <clip pos="3" side="tl" part="nbr"/>
              </lu>
            </out>
          </when>
          <when>
            <test>
              <and>
                <equal>
                  <clip pos="1" side="sl" part="a_def"/>
                  <lit-tag v="def"/>
                </equal>
                <equal>
                  <clip pos="1" side="sl" part="a_case"/>
                  <lit-tag v="dg"/>
                </equal>
              </and>
            </test>
            <call-macro n="f_modgen">
              <with-param pos="3"/>
            </call-macro>
            <call-macro n="f_concord3">
              <with-param pos="1"/>
              <with-param pos="2"/>
              <with-param pos="3"/>
            </call-macro>
            <out>
              <lu>
                <lit v="de"/>
                <lit-tag v="pr"/>
              </lu>
              <b/>
              <lu>
                <lit v="el"/>
                <lit-tag v="det.def"/>
                <clip pos="1" side="tl" part="gen"/>
                <clip pos="1" side="tl" part="nbr"/>
              </lu>
              <b pos="1"/>
              <lu>
                <clip pos="1" side="tl" part="lem"/>
                <clip pos="1" side="tl" part="a_nom"/>
                <clip pos="1" side="tl" part="gen"/>
                <clip pos="1" side="tl" part="nbr"/>
              </lu>
              <b/>
              <lu>
                <clip pos="2" side="tl" part="lem"/>
                <clip pos="2" side="tl" part="a_adj"/>
                <clip pos="1" side="tl" part="gen"/>
                <clip pos="1" side="tl" part="nbr"/>
              </lu>
            </out>
          </when>
          <otherwise>
            <call-macro n="f_modgen">
              <with-param pos="3"/>
            </call-macro>
            <call-macro n="f_concord2">
              <with-param pos="1"/>
              <with-param pos="2"/>
            </call-macro>
            <out>
              <lu>
                <clip pos="1" side="tl" part="lem"/>
                <clip pos="1" side="tl" part="a_nom"/>
                <clip pos="1" side="tl" part="gen"/>
                <clip pos="1" side="tl" part="nbr"/>
              </lu>
              <b pos="1"/>
              <lu>
                <clip pos="3" side="tl" part="lem"/>
                <clip pos="3" side="tl" part="a_adj"/>
                <clip pos="3" side="tl" part="gen"/>
                <clip pos="3" side="tl" part="nbr"/>
              </lu>
            </out>
          </otherwise>
        </choose>
      </action>
    </rule>
    <rule>
<!-- REGLA: DETERMINANT  NOM ADJECTIU -->
      <pattern>
        <pattern-item n="det"/>
        <pattern-item n="nom"/>
        <pattern-item n="adj"/>
      </pattern>
      <action>
        <choose>
          <when>
            <test>
              <equal>
                <clip pos="1" side="sl" part="a_case"/>
                <lit-tag v="nom"/>
              </equal>
            </test>
            <call-macro n="f_modgen">
              <with-param pos="1"/>
            </call-macro>
            <call-macro n="f_modgen">
              <with-param pos="3"/>
            </call-macro>
            <call-macro n="f_concord3">
              <with-param pos="2"/>
              <with-param pos="3"/>
              <with-param pos="1"/>
            </call-macro>
            <out>
              <lu>
                <clip pos="1" side="tl" part="lem"/>
                <lit-tag v="det.ind"/>
                <clip pos="1" side="tl" part="gen"/>
                <clip pos="1" side="tl" part="nbr"/>
              </lu>
              <b pos="1"/>
              <lu>
                <clip pos="2" side="tl" part="lem"/>
                <clip pos="2" side="tl" part="a_nom"/>
                <clip pos="2" side="tl" part="gen"/>
                <clip pos="2" side="tl" part="nbr"/>
              </lu>
              <b pos="2"/>
              <lu>
                <clip pos="3" side="tl" part="lem"/>
                <clip pos="3" side="tl" part="a_adj"/>
                <clip pos="3" side="tl" part="gen"/>
                <clip pos="3" side="tl" part="nbr"/>
              </lu>
            </out>
          </when>
          <when>
            <test>
              <equal>
                <clip pos="1" side="sl" part="a_case"/>
                <lit-tag v="dg"/>
              </equal>
            </test>
            <call-macro n="f_modgen">
              <with-param pos="1"/>
            </call-macro>
            <call-macro n="f_modgen">
              <with-param pos="3"/>
            </call-macro>
            <call-macro n="f_concord3">
              <with-param pos="2"/>
              <with-param pos="3"/>
              <with-param pos="1"/>
            </call-macro>
            <out>
              <lu>
                <lit v="de"/>
                <lit-tag v="pr"/>
              </lu>
              <b/>
              <lu>
                <clip pos="1" side="tl" part="lem"/>
                <lit-tag v="det.ind"/>
                <clip pos="1" side="tl" part="gen"/>
                <clip pos="1" side="tl" part="nbr"/>
              </lu>
              <b pos="1"/>
              <lu>
                <clip pos="2" side="tl" part="lem"/>
                <clip pos="2" side="tl" part="a_nom"/>
                <clip pos="2" side="tl" part="gen"/>
                <clip pos="2" side="tl" part="nbr"/>
              </lu>
              <b pos="2"/>
              <lu>
                <clip pos="3" side="tl" part="lem"/>
                <clip pos="3" side="tl" part="a_adj"/>
                <clip pos="3" side="tl" part="gen"/>
                <clip pos="3" side="tl" part="nbr"/>
              </lu>
            </out>
          </when>
        </choose>
      </action>
    </rule>
<!--  REGLA: NOM NOM per a traduir "cartea fetei" com a "el libro de la chica" o sigui el cas Genitiu  -->
    <rule>
      <pattern>
        <pattern-item n="nom"/>
        <pattern-item n="nom"/>
      </pattern>
      <action>
        <choose>
          <when>
            <test>
              <and>
                <equal>
                  <clip pos="1" side="sl" part="a_case"/>
                  <lit-tag v="nom"/>
                </equal>
                <equal>
                  <clip pos="1" side="sl" part="a_def"/>
                  <lit-tag v="def"/>
                </equal>
                <equal>
                  <clip pos="2" side="sl" part="a_case"/>
                  <lit-tag v="dg"/>
                </equal>
                <equal>
                  <clip pos="2" side="sl" part="a_def"/>
                  <lit-tag v="def"/>
                </equal>
              </and>
            </test>
            <out>
              <lu>
                <lit v="el"/>
                <lit-tag v="det.def"/>
                <clip pos="1" side="tl" part="gen"/>
                <clip pos="1" side="tl" part="nbr"/>
              </lu>
              <b/>
              <lu>
                <clip pos="1" side="tl" part="lem"/>
                <clip pos="1" side="tl" part="a_nom"/>
                <clip pos="1" side="tl" part="gen"/>
                <clip pos="1" side="tl" part="nbr"/>
              </lu>
              <b/>
              <lu>
                <lit v="de"/>
                <lit-tag v="pr"/>
              </lu>
              <b/>
              <lu>
                <lit v="el"/>
                <lit-tag v="det.def"/>
                <clip pos="2" side="tl" part="gen"/>
                <clip pos="2" side="tl" part="nbr"/>
              </lu>
              <b/>
              <lu>
                <clip pos="2" side="tl" part="lem"/>
                <clip pos="2" side="tl" part="a_nom"/>
                <clip pos="2" side="tl" part="gen"/>
                <clip pos="2" side="tl" part="nbr"/>
              </lu>
            </out>
          </when>
          <otherwise>
            <out>
              <lu>
                <clip pos="1" side="tl" part="lem"/>
                <clip pos="1" side="tl" part="a_nom"/>
                <clip pos="1" side="tl" part="gen"/>
                <clip pos="1" side="tl" part="nbr"/>
              </lu>
              <b pos="1"/>
              <lu>
                <clip pos="2" side="tl" part="lem"/>
                <clip pos="2" side="tl" part="a_nom"/>
                <clip pos="2" side="tl" part="gen"/>
                <clip pos="2" side="tl" part="nbr"/>
              </lu>
            </out>
          </otherwise>
        </choose>
      </action>
    </rule>
<!-- REGLA DATIU: VERB + NOM = VERB + A + NOM -->
    <rule>
      <pattern>
        <pattern-item n="verb"/>
        <pattern-item n="nom"/>
      </pattern>
      <action>
        <choose>
          <when>
            <test>
              <and>
                <equal>
                  <clip pos="2" side="sl" part="a_case"/>
                  <lit-tag v="dg"/>
                </equal>
                <equal>
                  <clip pos="2" side="sl" part="a_def"/>
                  <lit-tag v="def"/>
                </equal>
              </and>
            </test>
            <out>
              <lu>
                <clip pos="1" side="tl" part="lemh"/>
                <clip pos="1" side="tl" part="a_verb"/>
                <clip pos="1" side="tl" part="temps"/>
                <clip pos="1" side="tl" part="persona"/>
                <clip pos="1" side="tl" part="nbr"/>
              </lu>
              <b/>
              <lu>
                <lit v="a"/>
                <lit-tag v="pr"/>
              </lu>
              <b/>
              <lu>
                <lit v="el"/>
                <lit-tag v="det.def"/>
                <clip pos="2" side="tl" part="gen"/>
                <clip pos="2" side="tl" part="nbr"/>
              </lu>
              <b pos="1"/>
              <lu>
                <clip pos="2" side="tl" part="lem"/>
                <clip pos="2" side="tl" part="a_nom"/>
                <clip pos="2" side="tl" part="gen"/>
                <clip pos="2" side="tl" part="nbr"/>
              </lu>
            </out>
          </when>
          <otherwise>
            <out>
              <lu>
                <clip pos="1" side="tl" part="lemh"/>
                <clip pos="1" side="tl" part="a_verb"/>
                <clip pos="1" side="tl" part="temps"/>
                <clip pos="1" side="tl" part="persona"/>
                <clip pos="1" side="tl" part="nbr"/>
              </lu>
              <b pos="1"/>
              <lu>
                <clip pos="2" side="tl" part="lem"/>
                <clip pos="2" side="tl" part="a_nom"/>
                <clip pos="2" side="tl" part="gen"/>
                <clip pos="2" side="tl" part="nbr"/>
              </lu>
            </out>
          </otherwise>
        </choose>
      </action>
    </rule>
    <rule>
<!-- REGLA: DETERMINANT ADJECTIU NOM  -->
      <pattern>
        <pattern-item n="det"/>
        <pattern-item n="adj"/>
        <pattern-item n="nom"/>
      </pattern>
      <action>
        <choose>
          <when>
            <test>
              <equal>
                <clip pos="1" side="sl" part="a_case"/>
                <lit-tag v="nom"/>
              </equal>
            </test>
            <call-macro n="f_modgen">
              <with-param pos="1"/>
            </call-macro>
            <call-macro n="f_modgen">
              <with-param pos="2"/>
            </call-macro>
            <call-macro n="f_concord3">
              <with-param pos="3"/>
              <with-param pos="2"/>
              <with-param pos="1"/>
            </call-macro>
            <out>
              <lu>
                <clip pos="1" side="tl" part="lem"/>
                <lit-tag v="det.ind"/>
                <clip pos="1" side="tl" part="gen"/>
                <clip pos="1" side="tl" part="nbr"/>
              </lu>
              <b pos="1"/>
              <lu>
                <clip pos="2" side="tl" part="lem"/>
                <clip pos="2" side="tl" part="a_adj"/>
                <clip pos="2" side="tl" part="gen"/>
                <clip pos="2" side="tl" part="nbr"/>
              </lu>
              <b pos="2"/>
              <lu>
                <clip pos="3" side="tl" part="lem"/>
                <clip pos="3" side="tl" part="a_nom"/>
                <clip pos="3" side="tl" part="gen"/>
                <clip pos="3" side="tl" part="nbr"/>
              </lu>
            </out>
          </when>
        </choose>
      </action>
    </rule>
    <rule>
<!-- REGLA: ADVERBI ADJECTIU NOM -->
      <pattern>
        <pattern-item n="adv"/>
        <pattern-item n="adj"/>
        <pattern-item n="nom"/>
      </pattern>
      <action>
        <choose>
          <when>
            <test>
              <equal>
                <clip pos="2" side="sl" part="a_def"/>
                <lit-tag v="def"/>
              </equal>
            </test>
            <call-macro n="f_modgen">
              <with-param pos="2"/>
            </call-macro>
            <call-macro n="f_concord2">
              <with-param pos="3"/>
              <with-param pos="2"/>
            </call-macro>
            <out>
              <lu>
                <lit v="el"/>
                <lit-tag v="det.def"/>
                <clip pos="2" side="tl" part="gen"/>
                <clip pos="2" side="tl" part="nbr"/>
              </lu>
              <b pos="1"/>
              <lu>
                <clip pos="1" side="tl" part="lem"/>
                <clip pos="1" side="tl" part="a_adv"/>
              </lu>
              <b pos="2"/>
              <lu>
                <clip pos="2" side="tl" part="lem"/>
                <clip pos="2" side="tl" part="a_adj"/>
                <clip pos="2" side="tl" part="gen"/>
                <clip pos="2" side="tl" part="nbr"/>
              </lu>
              <b/>
              <lu>
                <clip pos="3" side="tl" part="lem"/>
                <clip pos="3" side="tl" part="a_nom"/>
                <clip pos="3" side="tl" part="gen"/>
                <clip pos="3" side="tl" part="nbr"/>
              </lu>
            </out>
          </when>
          <otherwise>
            <call-macro n="f_modgen">
              <with-param pos="2"/>
            </call-macro>
            <call-macro n="f_concord2">
              <with-param pos="3"/>
              <with-param pos="2"/>
            </call-macro>
            <out>
              <lu>
                <clip pos="1" side="tl" part="lem"/>
                <clip pos="1" side="tl" part="a_adv"/>
              </lu>
              <b pos="1"/>
              <lu>
                <clip pos="2" side="tl" part="lem"/>
                <clip pos="2" side="tl" part="a_adj"/>
                <clip pos="2" side="tl" part="gen"/>
                <clip pos="2" side="tl" part="nbr"/>
              </lu>
              <b pos="2"/>
              <lu>
                <clip pos="3" side="tl" part="lem"/>
                <clip pos="3" side="tl" part="a_nom"/>
                <clip pos="3" side="tl" part="gen"/>
                <clip pos="3" side="tl" part="nbr"/>
              </lu>
            </out>
          </otherwise>
        </choose>
      </action>
    </rule>
    <rule>
<!-- REGLA: NUMERAL ADJECTIU NOM -->
      <pattern>
        <pattern-item n="num"/>
        <pattern-item n="adj"/>
        <pattern-item n="nom"/>
      </pattern>
      <action>
        <choose>
          <when>
            <test>
              <equal>
                <clip pos="3" side="sl" part="a_def"/>
                <lit-tag v="def"/>
              </equal>
            </test>
            <call-macro n="f_modgen">
              <with-param pos="3"/>
            </call-macro>
            <call-macro n="f_concord3">
              <with-param pos="3"/>
              <with-param pos="2"/>
              <with-param pos="1"/>
            </call-macro>
            <out>
              <lu>
                <clip pos="1" side="tl" part="lem"/>
                <clip pos="1" side="tl" part="a_num"/>
                <clip pos="1" side="tl" part="gen"/>
                <clip pos="1" side="tl" part="nbr"/>
              </lu>
              <b pos="1"/>
              <lu>
                <clip pos="2" side="tl" part="lem"/>
                <clip pos="2" side="tl" part="a_adj"/>
                <clip pos="2" side="tl" part="gen"/>
                <clip pos="2" side="tl" part="nbr"/>
              </lu>
              <b pos="2"/>
              <lu>
                <clip pos="3" side="tl" part="lem"/>
                <clip pos="3" side="tl" part="a_nom"/>
                <clip pos="3" side="tl" part="gen"/>
                <clip pos="3" side="tl" part="nbr"/>
              </lu>
            </out>
          </when>
          <otherwise>
            <call-macro n="f_modgen">
              <with-param pos="3"/>
            </call-macro>
            <call-macro n="f_concord3">
              <with-param pos="3"/>
              <with-param pos="2"/>
              <with-param pos="1"/>
            </call-macro>
            <out>
              <lu>
                <clip pos="1" side="tl" part="lem"/>
                <clip pos="1" side="tl" part="a_num"/>
                <clip pos="1" side="tl" part="gen"/>
                <clip pos="1" side="tl" part="nbr"/>
              </lu>
              <b pos="1"/>
              <lu>
                <clip pos="2" side="tl" part="lem"/>
                <clip pos="2" side="tl" part="a_adj"/>
                <clip pos="2" side="tl" part="gen"/>
                <clip pos="2" side="tl" part="nbr"/>
              </lu>
              <b pos="2"/>
              <lu>
                <clip pos="3" side="tl" part="lem"/>
                <clip pos="3" side="tl" part="a_nom"/>
                <clip pos="3" side="tl" part="gen"/>
                <clip pos="3" side="tl" part="nbr"/>
              </lu>
            </out>
          </otherwise>
        </choose>
      </action>
    </rule>
    <rule>
<!-- REGLA: NUMERAL  NOM ADJECTIU-->
      <pattern>
        <pattern-item n="num"/>
        <pattern-item n="nom"/>
        <pattern-item n="adj"/>
      </pattern>
      <action>
        <choose>
          <when>
            <test>
              <equal>
                <clip pos="2" side="sl" part="a_def"/>
                <lit-tag v="def"/>
              </equal>
            </test>
            <call-macro n="f_modgen">
              <with-param pos="3"/>
            </call-macro>
            <call-macro n="f_concord3">
              <with-param pos="2"/>
              <with-param pos="1"/>
              <with-param pos="3"/>
            </call-macro>
            <out>
              <lu>
                <clip pos="1" side="tl" part="lem"/>
                <clip pos="1" side="tl" part="a_num"/>
                <clip pos="1" side="tl" part="gen"/>
                <clip pos="1" side="tl" part="nbr"/>
              </lu>
              <b pos="1"/>
              <lu>
                <clip pos="2" side="tl" part="lem"/>
                <clip pos="2" side="tl" part="a_nom"/>
                <clip pos="2" side="tl" part="gen"/>
                <clip pos="2" side="tl" part="nbr"/>
              </lu>
              <b pos="2"/>
              <lu>
                <clip pos="3" side="tl" part="lem"/>
                <clip pos="3" side="tl" part="a_adj"/>
                <clip pos="3" side="tl" part="gen"/>
                <clip pos="3" side="tl" part="nbr"/>
              </lu>
            </out>
          </when>
          <otherwise>
            <call-macro n="f_modgen">
              <with-param pos="3"/>
            </call-macro>
            <call-macro n="f_concord3">
              <with-param pos="2"/>
              <with-param pos="1"/>
              <with-param pos="3"/>
            </call-macro>
            <out>
              <lu>
                <clip pos="1" side="tl" part="lem"/>
                <clip pos="1" side="tl" part="a_num"/>
                <clip pos="1" side="tl" part="gen"/>
                <clip pos="1" side="tl" part="nbr"/>
              </lu>
              <b pos="1"/>
              <lu>
                <clip pos="2" side="tl" part="lem"/>
                <clip pos="2" side="tl" part="a_nom"/>
                <clip pos="2" side="tl" part="gen"/>
                <clip pos="2" side="tl" part="nbr"/>
              </lu>
              <b pos="2"/>
              <lu>
                <clip pos="3" side="tl" part="lem"/>
                <clip pos="3" side="tl" part="a_adj"/>
                <clip pos="3" side="tl" part="gen"/>
                <clip pos="3" side="tl" part="nbr"/>
              </lu>
            </out>
          </otherwise>
        </choose>
      </action>
    </rule>
    <rule>
<!--REGLA: DET NUMERAL NOM -->
      <pattern>
        <pattern-item n="detcel"/>
        <pattern-item n="num"/>
        <pattern-item n="nom"/>
      </pattern>
      <action>
        <choose>
          <when>
            <test>
              <equal>
                <clip pos="1" side="sl" part="a_case"/>
                <lit-tag v="nom"/>
              </equal>
            </test>
            <call-macro n="f_modgen">
              <with-param pos="1"/>
            </call-macro>
            <call-macro n="f_concord3">
              <with-param pos="3"/>
              <with-param pos="2"/>
              <with-param pos="1"/>
            </call-macro>
            <out>
              <lu>
                <lit v="el"/>
                <lit-tag v="det.def"/>
                <clip pos="3" side="tl" part="gen"/>
                <clip pos="1" side="tl" part="nbr"/>
              </lu>
              <b pos="1"/>
              <lu>
                <clip pos="2" side="tl" part="whole"/>
              </lu>
              <b pos="2"/>
              <lu>
                <clip pos="3" side="tl" part="lem"/>
                <clip pos="3" side="tl" part="a_nom"/>
                <clip pos="3" side="tl" part="gen"/>
                <clip pos="3" side="tl" part="nbr"/>
              </lu>
            </out>
          </when>
          <when>
            <test>
              <equal>
                <clip pos="1" side="sl" part="a_case"/>
                <lit-tag v="dg"/>
              </equal>
            </test>
            <call-macro n="f_modgen">
              <with-param pos="1"/>
            </call-macro>
            <call-macro n="f_concord3">
              <with-param pos="3"/>
              <with-param pos="2"/>
              <with-param pos="1"/>
            </call-macro>
            <out>
              <lu>
                <lit v="de"/>
                <lit-tag v="pr"/>
              </lu>
              <b/>
              <lu>
                <lit v="el"/>
                <lit-tag v="det.def"/>
                <clip pos="3" side="tl" part="gen"/>
                <clip pos="1" side="tl" part="nbr"/>
              </lu>
              <b pos="1"/>
              <lu>
                <clip pos="2" side="tl" part="whole"/>
              </lu>
              <b pos="2"/>
              <lu>
                <clip pos="3" side="tl" part="lem"/>
                <clip pos="3" side="tl" part="a_nom"/>
                <clip pos="3" side="tl" part="gen"/>
                <clip pos="3" side="tl" part="nbr"/>
              </lu>
            </out>
          </when>
          <otherwise>
            <call-macro n="f_modgen">
              <with-param pos="1"/>
            </call-macro>
            <call-macro n="f_concord3">
              <with-param pos="3"/>
              <with-param pos="2"/>
              <with-param pos="1"/>
            </call-macro>
            <out>
              <lu>
                <lit v="a"/>
                <lit-tag v="pr"/>
              </lu>
              <b/>
              <lu>
                <lit v="el"/>
                <lit-tag v="det.def"/>
                <clip pos="3" side="tl" part="gen"/>
                <clip pos="3" side="tl" part="nbr"/>
              </lu>
              <b pos="1"/>
              <lu>
                <clip pos="2" side="tl" part="whole"/>
              </lu>
              <b pos="2"/>
              <lu>
                <clip pos="3" side="tl" part="lem"/>
                <clip pos="3" side="tl" part="a_nom"/>
                <clip pos="3" side="tl" part="gen"/>
                <clip pos="3" side="tl" part="nbr"/>
              </lu>
            </out>
          </otherwise>
        </choose>
      </action>
    </rule>
<!--REGLA: PRONOM DETERMINANT NOM: "Nosaltres les dones : Nosotras las mujeres : Noi femeile" -->
    <rule>
      <pattern>
        <pattern-item n="prn"/>
        <pattern-item n="nom"/>
      </pattern>
      <action>
        <choose>
          <when>
            <test>
              <equal>
                <clip pos="2" side="sl" part="a_def"/>
                <lit-tag v="def"/>
              </equal>
            </test>
            <call-macro n="f_concord2">
              <with-param pos="2"/>
              <with-param pos="1"/>
            </call-macro>
            <out>
              <lu>
                <clip pos="1" side="tl" part="lem"/>
                <clip pos="1" side="tl" part="a_prn"/>
                <clip pos="1" side="tl" part="gen"/>
                <clip pos="1" side="tl" part="nbr"/>
              </lu>
              <b pos="1"/>
              <lu>
                <lit v="el"/>
                <lit-tag v="det.def"/>
                <clip pos="2" side="sl" part="gen"/>
                <clip pos="2" side="sl" part="nbr"/>
              </lu>
              <b pos="2"/>
              <lu>
                <clip pos="2" side="tl" part="lem"/>
                <clip pos="2" side="tl" part="a_nom"/>
                <clip pos="2" side="tl" part="gen"/>
                <clip pos="2" side="tl" part="nbr"/>
              </lu>
            </out>
          </when>
        </choose>
      </action>
    </rule>
    <rule>
<!-- REGLA: PRETÈRIT INDEFINIT -->
<!-- Para traducir "vaig fer"/"am fäcut" por "hice" -->
      <pattern>
        <pattern-item n="vbaveapri"/>
        <pattern-item n="pp"/>
      </pattern>
      <action>
        <out>
          <lu>
            <get-case-from pos="1">
              <clip pos="2" side="tl" part="lemh"/>
            </get-case-from>
            <clip pos="2" side="tl" part="a_verb"/>
            <lit-tag v="ifi"/>
            <clip pos="1" side="tl" part="persona"/>
            <clip pos="1" side="tl" part="nbr"/>
            <clip pos="2" side="tl" part="lemq"/>
          </lu>
        </out>
        <call-macro n="f_bcond">
          <with-param pos="1"/>
        </call-macro>
      </action>
    </rule>
    <rule>
<!-- REGLA: CONDICIONAL PRESENT -->
<!-- Per a traduir  "aç face" com a "faria" -->
      <pattern>
        <pattern-item n="vbaveacni"/>
<!--<pattern-item n="inf"/> el tagger tria malament, quan trie inf canviar verb per inf-->
        <pattern-item n="verb"/>
      </pattern>
      <action>
        <out>
          <lu>
            <get-case-from pos="1">
              <clip pos="2" side="tl" part="lemh"/>
            </get-case-from>
            <clip pos="2" side="tl" part="a_verb"/>
            <lit-tag v="cni"/>
            <clip pos="1" side="tl" part="persona"/>
            <clip pos="1" side="tl" part="nbr"/>
            <clip pos="2" side="tl" part="lemq"/>
          </lu>
        </out>
        <call-macro n="f_bcond">
          <with-param pos="1"/>
        </call-macro>
      </action>
    </rule>
    <rule>
<!-- REGLA: FUTUR -->
<!-- Per a traduir "voi face" com a  "faré" -->
      <pattern>
        <pattern-item n="vrea"/>
<!--<pattern-item n="inf"/>el tagger tria malament, quan trie inf canviar verb per inf-->
        <pattern-item n="verb"/>
      </pattern>
      <action>
        <out>
          <lu>
            <get-case-from pos="1">
              <clip pos="2" side="tl" part="lemh"/>
            </get-case-from>
            <clip pos="2" side="tl" part="a_verb"/>
            <lit-tag v="fti"/>
            <clip pos="1" side="tl" part="persona"/>
            <clip pos="1" side="tl" part="nbr"/>
            <clip pos="2" side="tl" part="lemq"/>
          </lu>
        </out>
        <call-macro n="f_bcond">
          <with-param pos="1"/>
        </call-macro>
      </action>
    </rule>
    <rule>
<!-- REGLA: PLUSQUAMPERFECTE -->
<!-- Para traducir "fäcusem" por "había hecho" -->
      <pattern>
        <pattern-item n="verbpper"/>
      </pattern>
      <action>
        <out>
          <lu>
            <get-case-from pos="1">
              <lit v="haber"/>
            </get-case-from>
            <lit-tag v="vbhaver"/>
            <lit-tag v="pii"/>
            <clip pos="1" side="sl" part="persona"/>
            <clip pos="1" side="sl" part="nbr"/>
          </lu>
          <b/>
          <lu>
            <clip pos="1" side="tl" part="lemh"/>
            <clip pos="1" side="sl" part="a_verb"/>
            <lit-tag v="pp.m.sg"/>
            <clip pos="1" side="tl" part="lemq"/>
          </lu>
        </out>
      </action>
    </rule>
    <rule>
<!-- REGLA: SUPIN  per a traduir "de fäcut" per "que hacer" /de + prep > que + inf -->
      <pattern>
        <pattern-item n="prepde"/>
        <pattern-item n="pp"/>
      </pattern>
      <action>
        <out>
          <lu>
            <lit v="que"/>
            <lit-tag v="cnjsub"/>
          </lu>
          <b/>
          <lu>
            <clip pos="2" side="tl" part="lem"/>
            <clip pos="2" side="sl" part="a_verb"/>
            <lit-tag v="inf"/>
          </lu>
        </out>
      </action>
    </rule>
    <rule>
<!--REGLA: VERB + ENCLÍTIC -->
      <pattern>
        <pattern-item n="verb"/>
        <pattern-item n="prnenc"/>
      </pattern>
      <action>
        <call-macro n="f_modgen">
          <with-param pos="2"/>
        </call-macro>
        <out>
          <mlu>
            <lu>
              <clip pos="1" side="tl" part="lemh"/>
              <clip pos="1" side="tl" part="a_verb"/>
              <clip pos="1" side="tl" part="temps"/>
              <clip pos="1" side="tl" part="persona"/>
              <clip pos="1" side="tl" part="nbr"/>
            </lu>
            <lu>
              <clip pos="2" side="tl" part="lem"/>
              <clip pos="2" side="tl" part="a_prnenc"/>
              <clip pos="2" side="tl" part="persona"/>
              <clip pos="2" side="tl" part="gen"/>
              <clip pos="2" side="tl" part="nbr"/>
              <clip pos="1" side="tl" part="lemq"/>
            </lu>
          </mlu>
        </out>
      </action>
    </rule>
    <rule>
<!--REGLA: VERB + ENCLÍTIC + ENCLÍTIC-->
      <pattern>
        <pattern-item n="verb"/>
        <pattern-item n="prnenc"/>
        <pattern-item n="prnenc"/>
      </pattern>
      <action>
        <call-macro n="f_modgen">
          <with-param pos="2"/>
        </call-macro>
        <call-macro n="f_modgen">
          <with-param pos="3"/>
        </call-macro>
        <out>
          <mlu>
            <lu>
              <clip pos="1" side="tl" part="lemh"/>
              <clip pos="1" side="tl" part="a_verb"/>
              <clip pos="1" side="tl" part="temps"/>
              <clip pos="1" side="tl" part="persona"/>
              <clip pos="1" side="tl" part="nbr"/>
            </lu>
            <lu>
              <clip pos="2" side="tl" part="lem"/>
              <clip pos="2" side="tl" part="a_prnenc"/>
              <clip pos="2" side="tl" part="persona"/>
              <clip pos="2" side="tl" part="gen"/>
              <clip pos="2" side="tl" part="nbr"/>
            </lu>
            <lu>
              <clip pos="3" side="tl" part="lem"/>
              <clip pos="3" side="tl" part="a_prnenc"/>
              <clip pos="3" side="tl" part="persona"/>
              <clip pos="3" side="tl" part="gen"/>
              <clip pos="3" side="tl" part="nbr"/>
              <clip pos="1" side="tl" part="lemq"/>
            </lu>
          </mlu>
        </out>
      </action>
    </rule>
    <rule>
<!--REGLA: VERB (per a multiparaules sense enclítics)-->
      <pattern>
        <pattern-item n="verb"/>
      </pattern>
      <action>
        <out>
          <lu>
            <clip pos="1" side="tl" part="lemh"/>
            <clip pos="1" side="tl" part="a_verb"/>
            <clip pos="1" side="tl" part="temps"/>
            <clip pos="1" side="tl" part="persona"/>
            <clip pos="1" side="tl" part="gen"/>
            <clip pos="1" side="tl" part="nbr"/>
            <clip pos="1" side="tl" part="lemq"/>
          </lu>
        </out>
      </action>
    </rule>
    <rule>
<!-- REGLA: DETERMINANT -->
      <pattern>
        <pattern-item n="det"/>
      </pattern>
      <action>
        <call-macro n="f_modgen">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_concord1">
          <with-param pos="1"/>
        </call-macro>
        <out>
          <lu>
            <clip pos="1" side="tl" part="lem"/>
            <clip pos="1" side="tl" part="a_det"/>
            <clip pos="1" side="tl" part="gen"/>
            <clip pos="1" side="tl" part="nbr"/>
          </lu>
        </out>
      </action>
    </rule>
    <rule>
<!-- REGLA: PRONOM -->
<!--Special case, macro f_concord1 
is not applicable because gender and number can not be taken from previous rules -->
      <pattern>
        <pattern-item n="prn"/>
      </pattern>
      <action>
        <call-macro n="f_modgen">
          <with-param pos="1"/>
        </call-macro>
        <out>
          <lu>
            <clip pos="1" side="tl" part="lem"/>
            <clip pos="1" side="tl" part="a_prn"/>
            <clip pos="1" side="tl" part="gen"/>
            <clip pos="1" side="tl" part="nbr"/>
          </lu>
        </out>
      </action>
    </rule>
    <rule>
<!-- REGLA: NUMERAL -->
      <pattern>
        <pattern-item n="num"/>
      </pattern>
      <action>
        <call-macro n="f_modgen">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_concord1">
          <with-param pos="1"/>
        </call-macro>
        <out>
          <lu>
            <clip pos="1" side="tl" part="lem"/>
            <clip pos="1" side="tl" part="a_num"/>
            <clip pos="1" side="tl" part="gen"/>
            <clip pos="1" side="tl" part="nbr"/>
          </lu>
        </out>
      </action>
    </rule>
    <rule>
<!-- REGLA: reset variables-->
      <pattern>
        <pattern-item n="sent"/>
      </pattern>
      <action>
        <let>
          <var n="numero"/>
          <lit-tag v="sg"/>
        </let>
        <let>
          <var n="genero"/>
          <lit-tag v="m"/>
        </let>
        <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
        </out>
      </action>
    </rule>
  </section-rules>
</transfer>
