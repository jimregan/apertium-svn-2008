<?xml version="1.0" encoding="UTF-8"?> <!-- -*- nxml -*- -->
<transfer default="chunk">
  <section-def-cats>

    <def-cat n="to"><!--BCN-->
      <cat-item lemma="to" tags="pr"/>
    </def-cat>

    <def-cat n="enough"><!--BCN-->
      <cat-item lemma="enough" tags="adv"/>
    </def-cat>

    <def-cat n="detquant"><!--BCN-->
      <cat-item tags="det.qnt.*"/>
    </def-cat>

    <def-cat n="all"><!--BCN-->
      <cat-item lemma="all" tags="predet.sp"/>
    </def-cat>

    <def-cat n="nomplural"><!--BCN-->
      <cat-item tags="n.pl"/>
    </def-cat>

    <def-cat n="nom">
      <cat-item tags="n.*"/>
      <cat-item tags="np.*"/>
    </def-cat>


    <def-cat n="nomcomu">
      <cat-item tags="n.*"/>
    </def-cat>
    
    <def-cat n="nompropi">
      <cat-item tags="np.*"/>
    </def-cat>
    <def-cat n="nploc">
      <cat-item tags="np.loc.*"/>
    </def-cat>

    <def-cat n="adj">
      <cat-item tags="adj"/>
      <cat-item tags="adj.comp"/> 
      <cat-item tags="adj.sup"/> 
      <cat-item tags="adj.pos"/>
      <cat-item tags="adj.sint"/>
      <cat-item tags="adj.sint.*"/>
      <cat-item tags="vblex.pp"/> <!-- BCN ok implica tocar les regles per la concordança-->
      <cat-item tags="vbmod.pp"/> <!-- BCN ok implica tocar les regles per la concordança-->
    </def-cat>

    <def-cat n="adj2"><!--revisar regles amb 'adj' i 'adj2' -->
      <cat-item tags="adj"/>
      <cat-item tags="adj.sint"/>
      <cat-item tags="adj.sint.*"/>
      <cat-item tags="adj.comp"/>
      <cat-item tags="adj.sup"/>
    </def-cat> 

    <def-cat n="num">
      <cat-item tags="num.*"/>
      <cat-item tags="num"/>
      
    </def-cat>

    <def-cat n="det"><!--Determinants i predeterminants, van anteposats en català -->
      <cat-item tags="det.dem.*"/>
      <cat-item tags="det.ind.*"/>
      <cat-item tags="det.def.*"/>
      <cat-item tags="det.pos.*"/>
      <cat-item tags="det.qnt.*"/>
      <cat-item tags="det.itg.*"/>
      <cat-item tags="det.ord.*"/>
      <cat-item tags="predet.*"/>
    </def-cat>

    <def-cat n="det2"><!--Poden anar precedits d'un altre determinant i anar després d'un genitiu saxó -->
      <cat-item tags="det.qnt.*"/>
      <cat-item tags="det.ord.*"/>
    </def-cat>

    
    <def-cat n="prep">
      <cat-item tags="pr"/>
    </def-cat>

    <def-cat n="prep_cnjadv">
      <cat-item tags="pr"/>
      <cat-item lemma="before" tags="cnjadv"/><!--MG: solució provisional, caldria que el tagger triés <pr> o que el t2x fes alguna cosa amb acnjadv + frase en gerundi o + frase conjugada. -->
      <cat-item lemma="after" tags="cnjadv"/>
    </def-cat>

    <def-cat n="probj">
      <cat-item tags="prn.obj.*"/>
    </def-cat>

    <def-cat n="prnsubj">
      <cat-item tags="prn.subj.*"/>
    </def-cat>

    <def-cat n="tn_itg_pos">
      <cat-item tags="prn.tn.*"/>
      <cat-item tags="prn.itg.*"/>
      <cat-item tags="prn.pos.*"/>
    </def-cat>

    <def-cat n="verbcj">
      <!--	  <cat-item tags="vblex.inf"/>-->
      <cat-item tags="vblex.pres"/>
      <cat-item tags="vblex.past"/>
      <cat-item tags="vblex.past.*"/><!--Per a la forma 'was' en el verb lèxic -->
      <cat-item tags="vblex.pri.*"/>

      <cat-item tags="vblex.sep.pres"/>
      <cat-item tags="vblex.sep.past"/>
      <cat-item tags="vblex.sep.past.*"/>
      <cat-item tags="vblex.sep.pri.*"/>

      <!--	  <cat-item tags="vbser.inf"/> -->
      <cat-item tags="vbser.pres"/>
      <cat-item tags="vbser.past"/>
      <cat-item tags="vbser.past.*"/>
      <cat-item tags="vbser.pri.*"/>
      <!--	  <cat-item tags="vbhaver.inf"/> -->
      <cat-item tags="vbhaver.pres"/><!--afegit 29/08, per quan es cola per aquesta regla un vbhaver mal desambiguat -->
      <cat-item tags="vbhaver.past"/>
      <cat-item tags="vbhaver.pri.*"/>
      <cat-item lemma="can" tags="vaux.*"/><!--perquè quan vagi sol entri per aquesta regla (I can, workers can) -->
      <!-- <cat-item tags="vbhaver.*"/> -->
      
    </def-cat>


    <def-cat n="verbcjnoser"> <!-- BCN -->
      <cat-item tags="vblex.inf"/>
      <cat-item tags="vblex.pres"/>
      <cat-item tags="vblex.past"/>
      <cat-item tags="vblex.pri.*"/>

      <cat-item tags="vblex.sep.pres"/>
      <cat-item tags="vblex.sep.past"/>
      <cat-item tags="vblex.sep.past.*"/>
      <cat-item tags="vblex.sep.pri.*"/>
    </def-cat>

    <def-cat n="controlverb">
      <cat-item lemma="desire" tags="vblex.inf"/>
      <cat-item lemma="need" tags="vblex.inf"/>
      <cat-item lemma="wish" tags="vblex.inf"/>
      <cat-item lemma="hope" tags="vblex.inf"/>
      <cat-item lemma="choose" tags="vblex.inf"/>
      <cat-item lemma="expect" tags="vblex.inf"/>
      <cat-item lemma="pretend" tags="vblex.inf"/>
      <cat-item lemma="prefer" tags="vblex.inf"/>
      <cat-item lemma="promise" tags="vblex.inf"/>
      <cat-item lemma="recommend" tags="vblex.inf"/>
      <cat-item lemma="decide" tags="vblex.inf"/>
      <cat-item lemma="manage" tags="vblex.inf"/>
      <cat-item lemma="refuse" tags="vblex.inf"/>
      <cat-item lemma="agree" tags="vblex.inf"/>
      <cat-item lemma="avoid" tags="vblex.inf"/>
      <cat-item lemma="enjoy" tags="vblex.inf"/>
      <cat-item lemma="hate" tags="vblex.inf"/>
      <cat-item lemma="intend" tags="vblex.inf"/>
      <cat-item lemma="plan" tags="vblex.inf"/>
      <cat-item lemma="continue" tags="vblex.inf"/>
      <cat-item lemma="resolve" tags="vblex.inf"/>
      <cat-item lemma="try" tags="vblex.inf"/>


      <cat-item lemma="desire" tags="vblex.pres"/>
      <cat-item lemma="need" tags="vblex.pres"/>
      <cat-item lemma="wish" tags="vblex.pres"/>
      <cat-item lemma="hope" tags="vblex.pres"/>
      <cat-item lemma="choose" tags="vblex.pres"/>
      <cat-item lemma="expect" tags="vblex.pres"/>
      <cat-item lemma="pretend" tags="vblex.pres"/>
      <cat-item lemma="prefer" tags="vblex.pres"/>
      <cat-item lemma="promise" tags="vblex.pres"/>
      <cat-item lemma="recommend" tags="vblex.pres"/>
      <cat-item lemma="decide" tags="vblex.pres"/>
      <cat-item lemma="manage" tags="vblex.pres"/>
      <cat-item lemma="refuse" tags="vblex.pres"/>
      <cat-item lemma="agree" tags="vblex.pres"/>
      <cat-item lemma="avoid" tags="vblex.pres"/>
      <cat-item lemma="enjoy" tags="vblex.pres"/>
      <cat-item lemma="hate" tags="vblex.pres"/>
      <cat-item lemma="intend" tags="vblex.pres"/>
      <cat-item lemma="plan" tags="vblex.pres"/>
      <cat-item lemma="continue" tags="vblex.pres"/>
      <cat-item lemma="resolve" tags="vblex.pres"/>
      <cat-item lemma="try" tags="vblex.pres"/>



      <cat-item lemma="desire" tags="vblex.past"/>
      <cat-item lemma="need" tags="vblex.past"/>
      <cat-item lemma="wish" tags="vblex.past"/>
      <cat-item lemma="hope" tags="vblex.past"/>
      <cat-item lemma="choose" tags="vblex.past"/>
      <cat-item lemma="expect" tags="vblex.past"/>
      <cat-item lemma="pretend" tags="vblex.past"/>
      <cat-item lemma="prefer" tags="vblex.past"/>
      <cat-item lemma="promise" tags="vblex.past"/>
      <cat-item lemma="recommend" tags="vblex.past"/>
      <cat-item lemma="decide" tags="vblex.past"/>
      <cat-item lemma="manage" tags="vblex.past"/>
      <cat-item lemma="refuse" tags="vblex.past"/>
      <cat-item lemma="agree" tags="vblex.past"/>
      <cat-item lemma="avoid" tags="vblex.past"/>
      <cat-item lemma="enjoy" tags="vblex.past"/>
      <cat-item lemma="hate" tags="vblex.past"/>
      <cat-item lemma="intend" tags="vblex.past"/>
      <cat-item lemma="plan" tags="vblex.past"/>
      <cat-item lemma="continue" tags="vblex.past"/>
      <cat-item lemma="resolve" tags="vblex.past"/>
      <cat-item lemma="try" tags="vblex.past"/>


      <cat-item lemma="desire" tags="vblex.pri.*"/>
      <cat-item lemma="need" tags="vblex.pri.*"/>
      <cat-item lemma="wish" tags="vblex.pri.*"/>
      <cat-item lemma="hope" tags="vblex.pri.*"/>
      <cat-item lemma="choose" tags="vblex.pri.*"/>
      <cat-item lemma="expect" tags="vblex.pri.*"/>
      <cat-item lemma="pretend" tags="vblex.pri.*"/>
      <cat-item lemma="prefer" tags="vblex.pri.*"/>
      <cat-item lemma="promise" tags="vblex.pri.*"/>
      <cat-item lemma="recommend" tags="vblex.pri.*"/>
      <cat-item lemma="decide" tags="vblex.pri.*"/>
      <cat-item lemma="manage" tags="vblex.pri.*"/>
      <cat-item lemma="refuse" tags="vblex.pri.*"/>
      <cat-item lemma="agree" tags="vblex.pri.*"/>
      <cat-item lemma="avoid" tags="vblex.pri.*"/>
      <cat-item lemma="enjoy" tags="vblex.pri.*"/>
      <cat-item lemma="hate" tags="vblex.pri.*"/>
      <cat-item lemma="intend" tags="vblex.pri.*"/>
      <cat-item lemma="plan" tags="vblex.pri.*"/>
      <cat-item lemma="continue" tags="vblex.pri.*"/>
      <cat-item lemma="resolve" tags="vblex.pri.*"/>
      <cat-item lemma="try" tags="vblex.pri.*"/>


      <cat-item lemma="desire" tags="vblex.ger"/>
      <cat-item lemma="need" tags="vblex.ger"/>
      <cat-item lemma="wish" tags="vblex.ger"/>
      <cat-item lemma="hope" tags="vblex.ger"/>
      <cat-item lemma="choose" tags="vblex.ger"/>
      <cat-item lemma="expect" tags="vblex.ger"/>
      <cat-item lemma="pretend" tags="vblex.ger"/>
      <cat-item lemma="prefer" tags="vblex.ger"/>
      <cat-item lemma="promise" tags="vblex.ger"/>
      <cat-item lemma="recommend" tags="vblex.ger"/>
      <cat-item lemma="decide" tags="vblex.ger"/>
      <cat-item lemma="manage" tags="vblex.ger"/>
      <cat-item lemma="refuse" tags="vblex.ger"/>
      <cat-item lemma="agree" tags="vblex.ger"/>
      <cat-item lemma="avoid" tags="vblex.ger"/>
      <cat-item lemma="enjoy" tags="vblex.ger"/>
      <cat-item lemma="hate" tags="vblex.ger"/>
      <cat-item lemma="intend" tags="vblex.ger"/>
      <cat-item lemma="plan" tags="vblex.ger"/>
      <cat-item lemma="continue" tags="vblex.ger"/>
      <cat-item lemma="resolve" tags="vblex.ger"/>
      <cat-item lemma="try" tags="vblex.ger"/>
    </def-cat>


    <def-cat n="controlverbger"> <!-- BCN -->
      <cat-item lemma="desire" tags="vblex.ger"/>
      <cat-item lemma="need" tags="vblex.ger"/>
      <cat-item lemma="wish" tags="vblex.ger"/>
      <cat-item lemma="hope" tags="vblex.ger"/>
      <cat-item lemma="choose" tags="vblex.ger"/>
      <cat-item lemma="expect" tags="vblex.ger"/>
      <cat-item lemma="pretend" tags="vblex.ger"/>
      <cat-item lemma="prefer" tags="vblex.ger"/>
      <cat-item lemma="promise" tags="vblex.ger"/>
      <cat-item lemma="recommend" tags="vblex.ger"/>
      <cat-item lemma="decide" tags="vblex.ger"/>
      <cat-item lemma="manage" tags="vblex.ger"/>
      <cat-item lemma="refuse" tags="vblex.ger"/>
      <cat-item lemma="agree" tags="vblex.ger"/>
      <cat-item lemma="avoid" tags="vblex.ger"/>
      <cat-item lemma="enjoy" tags="vblex.ger"/>
      <cat-item lemma="hate" tags="vblex.ger"/>
      <cat-item lemma="intend" tags="vblex.ger"/>
      <cat-item lemma="plan" tags="vblex.ger"/>
      <cat-item lemma="continue" tags="vblex.ger"/>
      <cat-item lemma="resolve" tags="vblex.ger"/>
      <cat-item lemma="try" tags="vblex.ger"/>
    </def-cat>


    <def-cat n="controlverbpp"> <!-- BCN -->
      <cat-item lemma="desire" tags="vblex.pp"/>
      <cat-item lemma="need" tags="vblex.pp"/>
      <cat-item lemma="wish" tags="vblex.pp"/>
      <cat-item lemma="hope" tags="vblex.pp"/>
      <cat-item lemma="choose" tags="vblex.pp"/>
      <cat-item lemma="expect" tags="vblex.pp"/>
      <cat-item lemma="pretend" tags="vblex.pp"/>
      <cat-item lemma="prefer" tags="vblex.pp"/>
      <cat-item lemma="promise" tags="vblex.pp"/>
      <cat-item lemma="recommend" tags="vblex.pp"/>
      <cat-item lemma="decide" tags="vblex.pp"/>
      <cat-item lemma="manage" tags="vblex.pp"/>
      <cat-item lemma="refuse" tags="vblex.pp"/>
      <cat-item lemma="agree" tags="vblex.pp"/>
      <cat-item lemma="avoid" tags="vblex.pp"/>
      <cat-item lemma="enjoy" tags="vblex.pp"/>
      <cat-item lemma="hate" tags="vblex.pp"/>
      <cat-item lemma="intend" tags="vblex.pp"/>
      <cat-item lemma="plan" tags="vblex.pp"/>
      <cat-item lemma="continue" tags="vblex.pp"/>
      <cat-item lemma="resolve" tags="vblex.pp"/>
      <cat-item lemma="try" tags="vblex.pp"/>
    </def-cat>

    <def-cat n="copulatiu">
      <cat-item tags="vbser.pres"/>
      <cat-item tags="vbser.past"/>
      <cat-item tags="vbser.past.*"/>
      <cat-item tags="vbser.pri.*"/>
      <cat-item lemma="look" tags="vblex.pres"/>
      <cat-item lemma="look" tags="vblex.past"/>
      <cat-item lemma="look" tags="vblex.pri.*"/>
      <cat-item lemma="seem" tags="vblex.pres"/>
      <cat-item lemma="seem" tags="vblex.past"/>
      <cat-item lemma="seem" tags="vblex.pri.*"/>
      <cat-item lemma="become" tags="vblex.pres"/>
      <cat-item lemma="become" tags="vblex.past"/>
      <cat-item lemma="become" tags="vblex.pri.*"/>
      <cat-item lemma="feel" tags="vblex.pres"/>
      <cat-item lemma="feel" tags="vblex.past"/>
      <cat-item lemma="feel" tags="vblex.pri.*"/>
      <cat-item lemma="get" tags="vblex.pres"/>
      <cat-item lemma="get" tags="vblex.past"/>
      <cat-item lemma="get" tags="vblex.pri.*"/>
    </def-cat>


    <def-cat n="inf">
      <cat-item tags="vblex.inf"/>
      <cat-item tags="vblex.sep.inf"/>
      <cat-item tags="vbser.inf"/>
      <cat-item tags="vbmod.inf"/>
      <cat-item tags="vaux.inf"/>
    </def-cat>

    <def-cat n="infpres">
      <cat-item tags="vblex.inf"/>
      <cat-item tags="vblex.pres"/><!--De moment detectem tb aquest a l'espera de veure si el tagger els distingeix. Canviar-ho més endavant si de cas. -->
      <cat-item tags="vblex.sep.inf"/>
      <cat-item tags="vblex.sep.pres"/>
      <cat-item tags="vbser.inf"/><!--afegit 4/08 -->
      <cat-item tags="vbser.pres"/><!--afegit 4/08 -->
    </def-cat>


    <def-cat n="modinf"><!--Verbs modals (have to, want to, be able to), que van seguits d'infinitiu (com els auxiliars) i es conjuguen (will have to, will be able to). A diferència, els auxiliars  no poden portar altres aux davant (*I will can, I do not can) : 'have to', 'want to'-->
      <cat-item tags="vbmod.inf"/>
      <cat-item tags="vbmod.pres"/><!--De moment detectem tb aquest a l'espera de veure si el tagger els distingeix -->
    </def-cat>

    <def-cat n="mod"><!--Verbs modals (have to, want to, be able to), que van seguits d'infinitiu (com els auxiliars) i es conjuguen (will have to, will be able to). A diferència, els auxiliars no poden portar altres aux davant (*I will can, I do not can). Per això els poso en categories diferents, perquè funcionen diferent amb negacions, adverbis intercalats, preguntes, etc. -->
      <cat-item tags="vbmod.*"/>
    </def-cat>

    <def-cat n="ger">
      <cat-item tags="vblex.ger"/>
      <cat-item tags="reporting.ger"/><!-- BCN-->
      <cat-item tags="vblex.sep.ger"/>
      <cat-item tags="vbser.ger"/>
    </def-cat>

    <def-cat n="haveger">
      <cat-item tags="vbhaver.ger"/>
    </def-cat>

    <def-cat n="auxtemps">
      <cat-item lemma="will" tags="vaux.*"/>
      <cat-item lemma="would" tags="vaux.*"/>
      <cat-item lemma="shall" tags="vaux.*"/>
    </def-cat>

    <def-cat n="auxmod"><!-- Falten: ought to, shall -->
      <cat-item lemma="can" tags="vaux.*"/>
      <cat-item lemma="must" tags="vaux.*"/>
      <cat-item lemma="should" tags="vaux.*"/>
      <cat-item lemma="may" tags="vaux.*"/>
      <cat-item lemma="might" tags="vaux.*"/>
    </def-cat>

    <def-cat n="auxnocan"><!-- Falten: (must?, should?, ought to, shall) -->
      <cat-item lemma="will" tags="vaux.*"/>
      <cat-item lemma="would" tags="vaux.*"/>
      <cat-item lemma="shall" tags="vaux.*"/>
      <cat-item lemma="may" tags="vaux.*"/>
      <cat-item lemma="might" tags="vaux.*"/>
      <cat-item lemma="do" tags="vbdo.*"/>
      <cat-item lemma="do" tags="vblex.*"/><!-- ATENCIÓ, només per ara perquè el tagger s'equivoca. -->
    </def-cat>


    <def-cat n="do">
      <cat-item lemma="do" tags="vbdo.*"/>
      <cat-item lemma="do" tags="vblex.pri.*"/><!--ATENCIÓ, només per ara perquè el tagger s'equivoca. -->
      <cat-item lemma="do" tags="vblex.pres"/>
      <cat-item lemma="do" tags="vblex.past"/>
      <cat-item lemma="do" tags="vblex.inf"/>
    </def-cat>

    <def-cat n="apos">
      <cat-item tags="apos"/>
    </def-cat>

    <def-cat n="coma">
      <cat-item tags="cm"/>
    </def-cat>

    <def-cat n="have_aux">
      <cat-item tags="vbhaver.*"/>
    </def-cat>

    <def-cat n="have_aux_inf">
      <cat-item tags="vbhaver.inf"/>
      <cat-item tags="vbhaver.pres"/>
    </def-cat>

    <def-cat n="ppadj"><!--Participis que poden actuar com a adjectius (el verb 'ser' va aquí?) -->
      <cat-item tags="vblex.pp"/>
      <cat-item tags="vblex.sep.pp"/>
      <cat-item tags="vbser.pp"/>
    </def-cat>

    <def-cat n="pp">
      <cat-item tags="vblex.pp"/>
      <cat-item tags="vblex.sep.pp"/>
      <cat-item tags="vbser.pp"/>
      <cat-item tags="vbmod.pp"/>
    </def-cat>

    <def-cat n="pprs">
      <cat-item tags="vblex.pprs"/>
      <cat-item tags="vblex.sep.pprs"/>
      <cat-item tags="vbhaver.pprs"/>
      <cat-item tags="vbser.pprs"/>
      <cat-item tags="vbmod.pprs"/>
    </def-cat>

    <def-cat n="vbsubs">
      <cat-item tags="vblex.subs"/>
      <cat-item tags="vblex.sep.subs"/>
      <cat-item tags="vbhaver.subs"/>
      <cat-item tags="vbser.subs"/>
      <cat-item tags="vbmod.subs"/>
    </def-cat>

    <def-cat n="adv_preadv">
      <cat-item tags="preadv"/>
      <cat-item tags="adv"/>
    </def-cat>

    <def-cat n="adv">
      <cat-item tags="adv"/>
    </def-cat>
    
    <def-cat n="adv_not"><!--BCN-->
      <cat-item lemma="not" tags="adv"/>
      <cat-item lemma="never" tags="adv"/>
    </def-cat>

    <def-cat n="preadv">
      <cat-item tags="preadv"/>
    </def-cat>

    <def-cat n="advitg">
      <cat-item tags="adv.itg"/>
    </def-cat>

    <def-cat n="cnj">
      <cat-item tags="cnjcoo"/>
      <cat-item tags="cnjsub"/>
      <cat-item tags="cnjadv"/>
    </def-cat>

    <def-cat n="cnjcoo">
      <cat-item lemma="and" tags="cnjcoo"/>
      <cat-item lemma="or" tags="cnjcoo"/>
    </def-cat>

    <def-cat n="such_a">
      <cat-item lemma="such a" tags="det.ind.sg"/>
    </def-cat>

    <def-cat n="yearmonth">
      <cat-item lemma="year" tags="n.sg"/>
      <cat-item lemma="year" tags="n.pl"/>
      <cat-item lemma="month" tags="n.sg"/>
      <cat-item lemma="month" tags="n.pl"/>
    </def-cat>

    <def-cat n="old">
      <cat-item lemma="old" tags="adj.sint"/>
    </def-cat>

    <def-cat n="there">
      <cat-item lemma="there" tags="adv"/>
    </def-cat>

    <def-cat n="genitiu">
      <cat-item tags="gen"/>
    </def-cat>

    <def-cat n="be">
      <cat-item lemma="be" tags="vbser.*"/>
    </def-cat>

    <def-cat n="relnom">
      <cat-item tags="rel.nn.*"/>	  
    </def-cat>

    <def-cat n="reladj">
      <cat-item tags="rel.an.*"/>	  
    </def-cat>

    <def-cat n="which">
      <cat-item lemma="which" tags="prn.itg.*"/><!-- BCN-->
      <cat-item lemma="which" tags="rel.an.*"/>
    </def-cat>


    <def-cat n="sent">
      <cat-item tags="sent"/>
    </def-cat>

    <def-cat n="guio">
      <cat-item tags="guio"/>
    </def-cat>

  </section-def-cats>
  <section-def-attrs>
    <def-attr n="a_nom">
      <attr-item tags="n"/>
      <attr-item tags="n.acr"/>
      <attr-item tags="np.loc"/>
      <attr-item tags="np.ant"/>
      <attr-item tags="np.cog"/>
      <attr-item tags="np.al"/>	
      <attr-item tags="adv"/>	  
    </def-attr>

    <def-attr n="a_np">
      <attr-item tags="np"/>
    </def-attr>

    <def-attr n="a_np_acr">
      <attr-item tags="np"/>
      <attr-item tags="acr"/>
    </def-attr>

    <def-attr n="a_adj">          
      <attr-item tags="adj"/>
      <attr-item tags="adj.pos"/>
      <attr-item tags="vblex.pp"/> <!-- BCN ok--> 
      <attr-item tags="vbmod.pp"/> <!-- BCN ok--> 
      <attr-item tags="vblex.pron.pp"/> <!-- BCN ok--> 
    </def-attr>  


    <def-attr n="grau_adj">          
      <attr-item tags="comp"/>
      <attr-item tags="sup"/>
    </def-attr>  

    <def-attr n="a_det">
      <attr-item tags="det.dem"/>
      <attr-item tags="det.ind"/>
      <attr-item tags="det.def"/>
      <attr-item tags="det.pos"/>
      <attr-item tags="det.qnt"/>
      <attr-item tags="det.itg"/>	  	 
      <attr-item tags="det.ord"/>
      <attr-item tags="adj.pos"/>
      <attr-item tags="num"/>
      <attr-item tags="predet"/>
    </def-attr>

    <def-attr n="a_prnpro">
      <attr-item tags="prn.pro"/>
    </def-attr>
    <def-attr n="a_prnenc">
      <attr-item tags="prn.enc"/>
    </def-attr>
    <def-attr n="a_num">
      <attr-item tags="num"/>
    </def-attr>

    <def-attr n="a_verb">
      <attr-item tags="vblex"/>	  
      <attr-item tags="vblex.pron"/>
      <attr-item tags="vbhaver"/>
      <attr-item tags="vbser"/>
      <attr-item tags="vbmod"/>
    </def-attr>

    <def-attr n="a_have_aux">
      <attr-item tags="vbhaver"/>
    </def-attr>

    <def-attr n="a_pp">
      <attr-item tags="vblex.pp"/>
      <attr-item tags="vblex.pron.pp"/>
      <attr-item tags="vbser.pp"/>
      <attr-item tags="vbmod.pp"/>
    </def-attr>


    <def-attr n="a_aux">
      <attr-item tags="vaux"/>
    </def-attr>

    <def-attr n="a_prn">
      <attr-item tags="prn"/>
    </def-attr>

    <def-attr n="a_adv">
      <attr-item tags="adv"/>
      <attr-item tags="preadv"/>
      <attr-item tags="adv.itg"/>
      <attr-item tags="cnjadv"/>
    </def-attr>

    <def-attr n="a_rel">
      <attr-item tags="rel.nn"/>
      <attr-item tags="rel.an"/>
      <attr-item tags="rel.adv"/>
    </def-attr>

    <def-attr n="tipus_rel">
      <attr-item tags="nn"/>
      <attr-item tags="an"/>
      <attr-item tags="adv"/>
    </def-attr>

    <def-attr n="tipus_prn">
      <attr-item tags="tn"/>
      <attr-item tags="obj"/>
      <attr-item tags="enc"/>
      <attr-item tags="itg"/>
      <attr-item tags="pos"/>
    </def-attr>

    <def-attr n="pers">
      <attr-item tags="p1"/>
      <attr-item tags="p2"/>
      <attr-item tags="p3"/>
      <attr-item tags="PD"/>
    </def-attr>

    <def-attr n="gen">
      <attr-item tags="m"/>
      <attr-item tags="f"/>
      <attr-item tags="mf"/>
      <attr-item tags="GD"/>
      <attr-item tags="nt"/>
    </def-attr>
    

    <def-attr n="nbr">
      <attr-item tags="sg"/>
      <attr-item tags="pl"/>
      <attr-item tags="sp"/>
      <attr-item tags="ND"/>
    </def-attr>

    <def-attr n="temps">
      <attr-item tags="cni"/>
      <attr-item tags="fti"/>  
      <attr-item tags="ifi"/>
      <attr-item tags="imp"/>
      <attr-item tags="pii"/>
      <attr-item tags="pis"/>
      <attr-item tags="inf"/>
      <attr-item tags="prs"/>
      <attr-item tags="pres"/>
      <attr-item tags="past"/>
      <attr-item tags="pri"/>
      <attr-item tags="pp"/>
      <attr-item tags="ger"/>
      <attr-item tags="pprs"/>
      <attr-item tags="subs"/>
    </def-attr>
    
    <def-attr n="neg">
      <attr-item tags="NEG"/>
    </def-attr>  

  </section-def-attrs>
  <section-def-vars>
    <def-var n="uno"/>
    <def-var n="genere" v="&amp;lt;m&amp;gt;"/>
    <def-var n="nombre" v="&amp;lt;sg&amp;gt;"/>
    <def-var n="interrogativa"/>
    <def-var n="exclamativa"/>
    <def-var n="adjectiu1"/>  
    <def-var n="adjectiu2"/>       
    <def-var n="auxiliar"/>
    <def-var n="caseFirstWord"/>
    <def-var n="EOS" v="true"/>
    <def-var n="lema"/>
    <def-var n="pronom"/>
    <def-var n="pronom2"/>
    <def-var n="pronomenc"/>
    <def-var n="paraula1"/>
    <def-var n="paraula2"/>
    <def-var n="tipus_verb"/>
    <def-var n="tipus_verb2"/>
    <def-var n="tipus_det"/> <!-- BCN-->
  </section-def-vars>

  <section-def-lists>

    <def-list n="reportingverb"> <!-- BCN verbs que poden no portar el THAT -->
      <list-item v="say"/>
      <list-item v="admit"/>
      <list-item v="agree"/>
      <list-item v="decide"/>
      <list-item v="deny"/>
      <list-item v="explain"/>
      <list-item v="insist"/>
      <list-item v="promise"/>
      <list-item v="recommend"/>
      <list-item v="suggest"/>
      <list-item v="point"/>
      <list-item v="think"/>
      <list-item v="believe"/>
      <list-item v="hope"/>
      <list-item v="fear"/>
      <list-item v="suppose"/>
    </def-list>

    <def-list n="controlnouns"> <!-- BCN -->
      <list-item v="desire"/>
      <list-item v="order"/>
      <list-item v="need"/>
      <list-item v="right"/>
      <list-item v="duty"/>
      <list-item v="failure"/>
      <list-item v="power"/>
      <list-item v="wish"/>
      <list-item v="capacity"/>
      <list-item v="ability"/>
      <list-item v="hope"/>
      <list-item v="chance"/>
      <list-item v="honour"/>
      <list-item v="compulsion"/>
      <list-item v="responsibility"/>
      <list-item v="opportunity"/>
      <list-item v="idea"/>
      <list-item v="record"/>
      <list-item v="way"/>
      <list-item v="attempt"/>
      <list-item v="obligation"/>
      <list-item v="impulse"/>
      <list-item v="surprise"/>
      <list-item v="will"/>
      <list-item v="mean"/>
    </def-list>



    <def-list n="adv_neg">
      <list-item v="not"/>
      <list-item v="never"/>
    </def-list>
  </section-def-lists>

  <section-def-macros>

    <def-macro n="genere_nombre" npar="1">
      <choose><!--To determine value of variables of gender and
		  number and propagate to other rules.  Variables are
		  not used again in this rule . 
		  MG: ara aquí no es fa sevir, sinó en t2x, eliminar i passar tot a 12x-->
	<when> 
	  <test>
	    <equal>
	      <clip pos="1" side="tl" part="gen"/>
	      <lit-tag v="m"/>
	    </equal>
	  </test>
	  <let><var n="genere"/><lit-tag v="m"/></let>
	</when>
	<when>
	  <test>
	    <equal>
	      <clip pos="1" side="tl" part="gen"/>
	      <lit-tag v="f"/>
	    </equal>
	  </test>
	  <let><var n="genere"/><lit-tag v="f"/></let>
	</when>
      </choose> 
      <choose>
	<when> 
	  <test>
	    <equal>
	      <clip pos="1" side="tl" part="nbr"/>
	      <lit-tag v="sg"/>
	    </equal>
	  </test>
	  <let><var n="nombre"/><lit-tag v="sg"/></let>
	</when>
	<when>
	  <test>
	    <equal>
	      <clip pos="1" side="tl" part="nbr"/>
	      <lit-tag v="pl"/>
	    </equal>
	  </test>
	  <let><var n="nombre"/><lit-tag v="pl"/></let>
	</when>
      </choose> 
    </def-macro>

    <def-macro n="pron" npar="1">
      <let>
	<var n="pronom"/>
	<lit v=""/>
      </let>
      <choose><!--envia el pronom en els verbs pronominals -->
	<when> 
	  <test>
	    <equal>
	      <var n="tipus_verb"/>
	      <lit-tag v="pron"/>
	    </equal>
	  </test>
	  <let>
	    <var n="pronom"/>
	    <lit v="prpers"/>
	  </let>
	  <append n="pronom">
	    <lit-tag v="prn.pro"/>
	    <lit-tag v="4"/>
	    <lit-tag v="mf"/>
	    <lit-tag v="5"/>
	    <lit v="$ ^"/>
	  </append>	
	</when>
      </choose> 
    </def-macro>

    <def-macro n="pronenc" npar="1"><!-- fa el mateix que la funció 'pron' però crea un enclític reflexiu (per a verbs en formes no personals). Funciona només si abans s'ha cridat la macro 'tipus_verbs2' per al verb que ha de portar l'enclític -->
      <let>
	<var n="pronomenc"/>
	<lit v=""/>
      </let>
      <choose><!--envia el pronom en els verbs pronominals -->
	<when> 
	  <test>
	    <equal>
	      <var n="tipus_verb2"/>
	      <lit-tag v="pron"/>
	    </equal>
	  </test>
	  <let>
	    <var n="pronomenc"/>
	    <lit v="+prpers"/>
	  </let>
	  <append n="pronomenc">
	    <lit-tag v="prn.enc"/>
	    <lit-tag v="4"/>
	    <lit-tag v="mf"/>
	    <lit-tag v="5"/>
	  </append>	
	</when>
      </choose> 
    </def-macro>


    <def-macro n="f_bcond" npar="1"><!--Per mirar si el blanc conté o no format. Cal posar aquesta funció en les regles en què desaparegui alguna paraula, per tal de decidir si el blanc de la paraula eliminada s'ha d'eliminar o conservar. Si conté format cal conservar-la, si no en conté cal eliminar-la perquè no apareguin dos espais seguits. -->
      <choose>
	<when>
	  <test>
	    <not>
	      <equal>
		<b pos="1"/>
		<lit v=" "/>
	      </equal>
	    </not>
	  </test>
	  <out>
	    <b pos="1"/>
	  </out>
	</when>     	    
      </choose>
    </def-macro>


    <def-macro n="million" npar="1">
      <choose>
	<when> 
	  <test>
	    <equal caseless="yes">
	      <clip pos="1" side="tl" part="lem"/>
	      <lit v="milió"/>
	    </equal>
	  </test>
	  <let>
	    <clip pos="1" side="tl" part="lem"/>
	    <lit v="milió de"/>
	  </let>
	</when>
	<when> 
	  <test>
	    <equal caseless="yes">
	      <clip pos="1" side="tl" part="lem"/>
	      <lit v="un milió"/>
	    </equal>
	  </test>
	  <let>
	    <clip pos="1" side="tl" part="lem"/>
	    <lit v="un milió de"/>
	  </let>
	</when>
      </choose>
      
    </def-macro>


    <def-macro n="flexio_numerals" npar="2">
      <choose>
	<when>
	  <test>
	    <equal>
	      <clip pos="1" side="tl" part="gen"/>
	      <lit-tag v="GD"/>
	    </equal>
	  </test>	
	  <let>
	    <clip pos="1" side="tl" part="gen"/>
	    <clip pos="2" side="tl" part="gen"/>
	  </let>
	</when>
      </choose>
      <choose>
	<when>
	  <test>
	    <equal>
	      <clip pos="2" side="sl" part="lem"/>
	      <lit v="percent"/>
	    </equal>
	  </test>
	  <let>
	    <clip pos="2" side="tl" part="lem"/>
	    <lit v="per cent"/>
	  </let>
	  <let>
	    <clip pos="2" side="tl" part="a_nom"/>
	    <lit-tag v="adv"/>
	  </let>
	  <let>
	    <clip pos="2" side="tl" part="gen"/>
	    <lit v=""/>
	  </let>
	  <let>
	    <clip pos="2" side="tl" part="nbr"/>
	    <lit v=""/>
	  </let>
	</when>
      </choose>

	  

    </def-macro>


    <def-macro n="det_no" npar="2"><!--No cars -> cap cotxe (canvia nombre del nom de pl a sg) -->
      
      <choose>
	<when> 
	  <test>
	    <and>
	      <equal caseless="yes">
		<clip pos="1" side="sl" part="lem"/>
		<lit v="no"/>
	      </equal>
	      <equal>
		<clip pos="2" side="sl" part="nbr"/>
		<lit-tag v="pl"/>
	      </equal>
	    </and>
	  </test>
	  <let>
	    <clip pos="2" side="tl" part="nbr"/>
	    <lit-tag v="sg"/>
	  </let>
	  <let> <!-- BCN -->
	    <var n="tipus_det"/>
	    <lit-tag v="negacio"/>
	  </let>
	</when>


	<when> 
	  <test>
	    <and>
	      <equal caseless="yes">
		<clip pos="1" side="sl" part="lem"/>
		<lit v="no"/>
	      </equal>
	      <equal>
		<clip pos="2" side="sl" part="nbr"/>
		<lit-tag v="sg"/>
	      </equal>
	    </and>
	  </test>
	  <let> <!-- BCN -->
	    <var n="tipus_det"/>
	    <lit-tag v="negacio"/>
	  </let>
	</when>
	<otherwise>
	  <let>
	    <var n="tipus_det"/>
	    <lit v=""/>
	  </let>
	</otherwise>
      </choose>

    </def-macro>



    <def-macro n="comparatiu_adj1" npar="1"><!--per a afegir adverbi 'més' en adjs comparatius. -->
      <let>
	<var n="adjectiu1"/>
	<lit v=""/>
      </let>
      <choose>
	<when>
	  <test>
	    <or>
	      <equal>
		<clip pos="1" side="sl" part="grau_adj"/>
		<lit-tag v="comp"/>
	      </equal>
	      <equal>
		<clip pos="1" side="sl" part="grau_adj"/>
		<lit-tag v="sup"/>
	      </equal>
	    </or>	  
	  </test>
	  <choose>
	    <when>
	      <test>
		<not>
		  <or>
		    <equal caseless="yes">
		      <clip pos="1" side="sl" part="lem"/>
		      <lit v="good"/>
		    </equal>
		    <equal caseless="yes">
		      <clip pos="1" side="sl" part="lem"/>
		      <lit v="bad"/>
		    </equal>
		  </or>
		</not>
	      </test>
	      <append n="adjectiu1">
		<lit v="més"/>
		<lit-tag v="preadv"/>
		<lit v="$ ^"/>
	      </append>	  
	    </when>
	  </choose>
	</when>
	<otherwise>
	  <append n="adjectiu1">
	    <lit v=""/>
	  </append>
	</otherwise>
      </choose>
    </def-macro>


    <def-macro n="comparatiu_adj2" npar="1"><!--per a afegir adverbi 'més' en adjs comparatius. Per a regles amb 2 adjectius. -->
      <let>
	<var n="adjectiu2"/>
	<lit v=""/>
      </let>
      <choose>
	<when>
	  <test>
	    <or>
	      <equal>
		<clip pos="1" side="sl" part="grau_adj"/>
		<lit-tag v="comp"/>
	      </equal>
	      <equal>
		<clip pos="1" side="sl" part="grau_adj"/>
		<lit-tag v="sup"/>
	      </equal>
	    </or>	  
	  </test>
	  <choose>
	    <when>
	      <test>
		<not>
		  <or>
		    <equal caseless="yes">
		      <clip pos="1" side="sl" part="lem"/>
		      <lit v="good"/>
		    </equal>
		    <equal caseless="yes">
		      <clip pos="1" side="sl" part="lem"/>
		      <lit v="bad"/>
		    </equal>
		  </or>
		</not>
	      </test>
	      <append n="adjectiu2">
		<lit v="més"/>
		<lit-tag v="preadv"/>
		<lit v="$ ^"/>
	      </append>	  
	    </when>
	  </choose>
	</when>
	<otherwise>
	  <append n="adjectiu2">
	    <lit v=""/>
	  </append>
	</otherwise>
      </choose>
    </def-macro>


    <def-macro n="firstWord" npar="1">
      <choose>
	<when>
	  <test>
	    <equal>
	      <clip pos="1" side="sl" part="a_np_acr"/>
	      <lit v=""/>
	    </equal>
	  </test>
	  <choose>
	    <when>
	      <test>
		<equal> 
		  <var n="EOS"/>
		  <lit v="true"/>
		</equal> 
	      </test>
	      <modify-case>
		<clip pos="1" side="tl" part="lem"/>
		<lit v="aa"/>
	      </modify-case>
	      <let>
		<var n="caseFirstWord"/>
		<lit v="Aa"/>
	      </let>
	    </when>
	  </choose>
	</when>
	<otherwise>
	  <let>
	    <var n="caseFirstWord"/>
	    <lit v="aa"/>
	  </let>
	</otherwise>
      </choose>
      <let>
	<var n="EOS"/>
	<lit v="false"/>
      </let>
    </def-macro>



    <def-macro n="tipus_verbs" npar="1">
      <choose>
	<when>
	  <test>
	    <equal>
	      <clip pos="1" side="tl" part="a_verb"/>
	      <lit-tag v="vblex.pron"/>
	    </equal>
	  </test>
	  <let>
	    <var n="tipus_verb"/>
	    <lit-tag v="pron"/>
	  </let>
	</when>
	<when>
	  <test>
	    <or>
	      <equal caseless="yes">
		<clip pos="1" side="sl" part="lemh"/>
		<lit v="like"/>
	      </equal>
	      <equal caseless="yes">
		<clip pos="1" side="tl" part="lemh"/>
		<lit v="encantar"/>
	      </equal>
	    </or>
	  </test>
	  <let>
	    <var n="tipus_verb"/>
	    <lit-tag v="like"/>
	  </let>
	</when>
	<when><!-- (BCN)-->
	  <test>
	    <in caseless="yes">
	      <clip pos="1" side="sl" part="lemh"/>
	      <list n="reportingverb"/>
	    </in>
	  </test>
	  <let>
	    <var n="tipus_verb"/>
	    <lit-tag v="reporting"/>
	  </let>
	</when>
	<otherwise>
	  <let>
	    <var n="tipus_verb"/>
	    <clip pos="1" side="tl" part="a_verb"/>
	  </let>
	</otherwise>
      </choose>
    </def-macro>


<def-macro n="tipus_verbs2" npar="1"><!--per quan hi ha dos verbs en una regla, cal utilitzar dues variables diferents -->
      <choose>
	<when>
	  <test>
	    <equal>
	      <clip pos="1" side="tl" part="a_verb"/>
	      <lit-tag v="vblex.pron"/>
	    </equal>
	  </test>
	  <let>
	    <var n="tipus_verb2"/>
	    <lit-tag v="pron"/>
	  </let>
	</when>
	<when>
	  <test>
	    <or>
	      <equal caseless="yes">
		<clip pos="1" side="sl" part="lemh"/>
		<lit v="like"/>
	      </equal>
	      <equal caseless="yes">
		<clip pos="1" side="tl" part="lemh"/>
		<lit v="encantar"/>
	      </equal>
	    </or>
	  </test>
	  <let>
	    <var n="tipus_verb2"/>
	    <lit-tag v="like"/>
	  </let>
	</when>
	<when><!-- (BCN)-->
	  <test>
	    <in caseless="yes">
	      <clip pos="1" side="sl" part="lemh"/>
	      <list n="reportingverb"/>
	    </in>
	  </test>
	  <let>
	    <var n="tipus_verb2"/>
	    <lit-tag v="reporting"/>
	  </let>
	</when>
	<otherwise>
	  <let>
	    <var n="tipus_verb2"/>
	    <clip pos="1" side="tl" part="a_verb"/>
	  </let>
	</otherwise>
      </choose>
    </def-macro>

  </section-def-macros>

  <section-rules>

    <!--********************************* REGLES DE SN ***************************************************** -->


    <rule comment="REGLA: ALL NOUNplural (BCN: per afegir l'article definit en català 'all students' :: 'tots els estudiants'.Chunk de sortida: det_nom_plural"> 

      <pattern>
	<pattern-item n="all"/>
	<pattern-item n="nomplural"/>
      </pattern>
      <action>
	<call-macro n="genere_nombre">
	  <with-param pos="2"/>
	</call-macro>
	<call-macro n="det_no">
	  <with-param pos="1"/>
	  <with-param pos="2"/>
	</call-macro>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<choose>
	  <when>
	    <test>
	      <equal>
		<clip pos="2" side="tl" part="gen"/>
		<lit-tag v="m"/>
	      </equal>
	    </test>
	    <out>
	      <chunk name="all_noun_plural" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="SN.DET"/></tag>
		  <tag><clip pos="2" side="tl" part="gen"/></tag>
		  <tag><clip pos="2" side="tl" part="nbr"/></tag>
		</tags>
		<lu>
		  <clip pos="1" side="tl" part="lem"/>
		  <clip pos="1" side="tl" part="a_det"/>
		  <clip pos="2" side="tl" part="gen" link-to="3"/>
		  <clip pos="2" side="tl" part="nbr" link-to="4"/>
		</lu>
		<b/>
		<lu>
		  <lit v="el"/>
		  <lit-tag v="det.def.m.pl"/>
		</lu>
		<b/>
		<b pos="2"/>
		<lu>
		  <clip pos="2" side="tl" part="lemh"/>
		  <clip pos="2" side="tl" part="a_nom"/>
		  <clip pos="2" side="tl" part="gen" link-to="3"/>
		  <clip pos="2" side="tl" part="nbr" link-to="4"/>
		</lu>
	      </chunk>
	    </out>
	    <let>
	      <var n="caseFirstWord"/>
	      <lit v="aa"/>
	    </let>
	  </when> <!-- femenins -->

	  <when>
	    <test>
	      <equal>
		<clip pos="2" side="tl" part="gen"/>
		<lit-tag v="f"/>
	      </equal>
	    </test>
	    <out>
	      <chunk name="all_noun_plural" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="SN.DET"/></tag>
		  <tag><clip pos="2" side="tl" part="gen"/></tag>
		  <tag><clip pos="2" side="tl" part="nbr"/></tag>
		</tags>
		<lu>
		  <clip pos="1" side="tl" part="lem"/>
		  <clip pos="1" side="tl" part="a_det"/>
		  <clip pos="2" side="tl" part="gen" link-to="3"/>
		  <clip pos="2" side="tl" part="nbr" link-to="4"/>
		</lu>
		<b/>
		<lu>
		  <lit v="el"/>
		  <lit-tag v="det.def.f.pl"/>
		</lu>
		<b/>
		<b pos="2"/>
		<lu>
		  <clip pos="2" side="tl" part="lemh"/>
		  <clip pos="2" side="tl" part="a_nom"/>
		  <clip pos="2" side="tl" part="gen" link-to="3"/>
		  <clip pos="2" side="tl" part="nbr" link-to="4"/>
		</lu>
	      </chunk>
	    </out>
	    <let>
	      <var n="caseFirstWord"/>
	      <lit v="aa"/>
	    </let>
	  </when> 
	</choose>
      </action>
    </rule>

    <rule comment="REGLA: ALL ADJ NOUNplural (BCN: per afegir l'article definit en català 'all legal states' :: 'tots els estats legals'. Chunk de sortida: det_nom_plural">

      <pattern>
	<pattern-item n="all"/>
	<pattern-item n="adj"/>
	<pattern-item n="nomplural"/>
      </pattern>
      <action>
	<call-macro n="genere_nombre">
	  <with-param pos="3"/>
	</call-macro>
	<call-macro n="det_no">
	  <with-param pos="1"/>
	  <with-param pos="3"/>
	</call-macro>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="comparatiu_adj1">
	  <with-param pos="2"/>
	</call-macro>

	<choose>
	  <when>
	    <test>
	      <equal>
		<clip pos="3" side="tl" part="gen"/>
		<lit-tag v="m"/>
	      </equal>
	    </test>
	    <out>
	      <chunk name="all_noun_plural" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="SN.DET"/></tag>
		  <tag><clip pos="3" side="tl" part="gen"/></tag>
		  <tag><clip pos="3" side="tl" part="nbr"/></tag>
		</tags>
		<lu>
		  <clip pos="1" side="tl" part="lem"/>
		  <clip pos="1" side="tl" part="a_det"/>
		  <clip pos="3" side="tl" part="gen" link-to="3"/>
		  <clip pos="3" side="tl" part="nbr" link-to="4"/>
		</lu>
		<b/>
		<lu>
		  <lit v="el"/>
		  <lit-tag v="det.def.m.pl"/>
		</lu>
		<b pos="2"/>
		<lu>
		  <clip pos="3" side="tl" part="lemh"/>
		  <clip pos="3" side="tl" part="a_nom"/>
		  <clip pos="3" side="tl" part="gen" link-to="3"/>
		  <clip pos="3" side="tl" part="nbr" link-to="4"/>
		</lu>
		<b/>
		<b pos="3"/>
		<lu>
		  <var n="adjectiu1"/>
		  <clip pos="2" side="tl" part="lemh"/>
		  <clip pos="2" side="tl" part="a_adj"/>
		  <clip pos="3" side="tl" part="gen" link-to="3"/>
		  <clip pos="3" side="tl" part="nbr" link-to="4"/>
		</lu>

	      </chunk>
	    </out>
	    <let>
	      <var n="caseFirstWord"/>
	      <lit v="aa"/>
	    </let>
	  </when> <!-- femenins -->

	  <when>
	    <test>
	      <equal>
		<clip pos="3" side="tl" part="gen"/>
		<lit-tag v="f"/>
	      </equal>
	    </test>
	    <out>
	      <chunk name="all_noun_plural" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="SN.DET"/></tag>
		  <tag><clip pos="3" side="tl" part="gen"/></tag>
		  <tag><clip pos="3" side="tl" part="nbr"/></tag>
		</tags>
		<lu>
		  <clip pos="1" side="tl" part="lem"/>
		  <clip pos="1" side="tl" part="a_det"/>
		  <clip pos="3" side="tl" part="gen" link-to="3"/>
		  <clip pos="3" side="tl" part="nbr" link-to="4"/>
		</lu>
		<b/>
		<lu>
		  <lit v="el"/>
		  <lit-tag v="det.def.f.pl"/>
		</lu>
		<b pos="2"/>
		<lu>
		  <clip pos="3" side="tl" part="lemh"/>
		  <clip pos="3" side="tl" part="a_nom"/>
		  <clip pos="3" side="tl" part="gen" link-to="3"/>
		  <clip pos="3" side="tl" part="nbr" link-to="4"/>
		  <clip pos="3" side="tl" part="lemq"/>
		</lu>
		<b/>
		<b pos="3"/>
		<lu>
		  <var n="adjectiu1"/>
		  <clip pos="2" side="tl" part="lemh"/> <!-- per a les possibles cues dels PPs --> 
		  <clip pos="2" side="tl" part="a_adj"/>
		  <clip pos="3" side="tl" part="gen" link-to="3"/>
		  <clip pos="3" side="tl" part="nbr" link-to="4"/>
		  <clip pos="2" side="tl" part="lemq"/> <!-- per a les possibles cues dels PPs --> 
		</lu>

	      </chunk>
	    </out>
	    <let>
	      <var n="caseFirstWord"/>
	      <lit v="aa"/>
	    </let>
	  </when>
	</choose>
      </action>
    </rule>



    <rule comment="REGLA: DET NOM TO INF (BCN:  Regla que canvia la preposició TO de l'anglès per DE del català per A noms de control i per PER per als altres ('the need to work' - 'la necessitat de treballr' vs. 'a book to read' - 'un llibre per llegir'. Com que és d'aplicació general es codifica via regla i no al lèxic. Els noms de control (o equi nouns) es llisten sota la marca equinouns. Amb això evitem duplicar entrades. Les excepcions que hi pugui haver s'han de codificar al lèxic). 
		   EN principi la regla es justifica per evitar que la prep TO es tradueixi per A.">

      <pattern>
	<pattern-item n="det"/>
	<pattern-item n="nom"/>
	<pattern-item n="to"/>
	<pattern-item n="inf"/>
      </pattern>
      <action>
	<choose>
	  <when>
	    <test>
	      <in caseless="yes">
		<clip pos="2" side="sl" part="lem"/>
		<list n="controlnouns"/>
	      </in>
	    </test>
	    <let>
	      <clip pos="3" side="tl" part="lem"/>
	      <lit v ="de"/>
	    </let>
	  </when> 
	  <otherwise>
	    <let>
	      <clip pos="3" side="tl" part="lem"/>
	      <lit v ="per"/>
	    </let>
	  </otherwise>
	</choose>
	<call-macro n="genere_nombre">
	  <with-param pos="2"/>
	</call-macro>
	<call-macro n="det_no">
	  <with-param pos="1"/>
	  <with-param pos="2"/>
	</call-macro>
	<call-macro n="tipus_verbs"> <!-- per tractar la cua en verbs multiparaula -->
	  <with-param pos="4"/>
	</call-macro>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>

	<choose>		<!-- la part del INF per a tractar la cua si enté-->
	  <when>
	    <test>
	      <not>
		<or>
		  <equal caseless="yes">
		    <clip pos="4" side="sl" part="lem"/>
		    <lit v="will"/>
		  </equal>
		  <equal caseless="yes">
		    <clip pos="4" side="sl" part="lem"/>
		    <lit v="shall"/>
		  </equal>
		  <equal caseless="yes">
		    <clip pos="4" side="sl" part="lem"/>
		    <lit v="would"/>
		  </equal>
		</or>
	      </not>
	    </test>
	    <choose>
	      <when>
		<test>
		  <equal>
		    <var n="tipus_verb"/>
		    <lit-tag v="pron"/>
		  </equal>
		</test>
		<out>

		  <chunk name="det_nom_to_inf" case="caseFirstWord">
		    <tags>
		      <tag><lit-tag v="SN.DET"/></tag>
		      <tag><clip pos="2" side="tl" part="gen"/></tag>
		      <tag><clip pos="2" side="tl" part="nbr"/></tag>
		      <tag><lit-tag v="inf"/></tag> <!-- posat a mà-->
		    </tags>
		    <lu>
		      <clip pos="1" side="tl" part="lem"/>
		      <clip pos="1" side="tl" part="a_det"/>
		      <clip pos="2" side="tl" part="gen" link-to="3"/>
		      <clip pos="2" side="tl" part="nbr" link-to="4"/>
		    </lu>
		    <b pos="1"/>
		    <lu>
		      <clip pos="2" side="tl" part="lemh"/>
		      <clip pos="2" side="tl" part="a_nom"/>
		      <clip pos="2" side="tl" part="gen" link-to="3"/>
		      <clip pos="2" side="tl" part="nbr" link-to="4"/>
		      <clip pos="2" side="tl" part="lemq"/>
		    </lu>
		    <b pos="2"/>
		    <lu>
		      <clip pos="3" side="tl" part="whole"/>
		    </lu>
		    <b pos="3"/>
		    <mlu>
		      <lu>
			<clip pos="4" side="tl" part="lemh"/>
			<clip pos="4" side="tl" part="a_verb"/>
			<clip pos="4" side="tl" part="temps" link-to="5"/>

		      </lu>
		      <lu>
			<lit v="es"/>
			<lit-tag v="prn.enc.ref.p3.mf.sp"/>
			<clip pos="4" side="tl" part="lemq"/>
		      </lu>
		    </mlu>
		  </chunk>
		</out>
	      </when>
	      <otherwise>
		<out>
		  <chunk name="det_nom_to_inf" case="caseFirstWord">
		    <tags>
		      <tag><lit-tag v="SN.DET"/></tag>
		      <tag><clip pos="2" side="tl" part="gen"/></tag>
		      <tag><clip pos="2" side="tl" part="nbr"/></tag>
		      <tag><lit-tag v="inf"/></tag> <!-- posat a mà-->
		    </tags>
		    <lu>
		      <clip pos="1" side="tl" part="lem"/>
		      <clip pos="1" side="tl" part="a_det"/>
		      <clip pos="2" side="tl" part="gen" link-to="3"/>
		      <clip pos="2" side="tl" part="nbr" link-to="4"/>
		    </lu>
		    <b pos="1"/>
		    <lu>
		      <clip pos="2" side="tl" part="lemh"/>
		      <clip pos="2" side="tl" part="a_nom"/>
		      <clip pos="2" side="tl" part="gen" link-to="3"/>
		      <clip pos="2" side="tl" part="nbr" link-to="4"/>
		      <clip pos="2" side="tl" part="lemq"/>
		    </lu>
		    <b pos="2"/>
		    <lu>
		      <clip pos="3" side="tl" part="whole"/>
		    </lu>
		    <b pos="3"/>
		    <lu>
		      <clip pos="4" side="tl" part="lemh"/>
		      <clip pos="4" side="tl" part="a_verb"/>
		      <clip pos="4" side="tl" part="temps" link-to="5"/>
		      <clip pos="4" side="tl" part="lemq"/>
		    </lu>
		  </chunk>
		</out>
	      </otherwise>
	    </choose>
	  </when>
	</choose>

	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>

 <rule comment="REGLA: DET NOM TO INF+clitic (igual que l'anterior, amb inf + pronom obj= inf+clític)">

      <pattern>
	<pattern-item n="det"/>
	<pattern-item n="nom"/>
	<pattern-item n="to"/>
	<pattern-item n="inf"/>
	<pattern-item n="probj"/>
      </pattern>
      <action>
	<choose>
	  <when>
	    <test>
	      <in caseless="yes">
		<clip pos="2" side="sl" part="lem"/>
		<list n="controlnouns"/>
	      </in>
	    </test>
	    <let>
	      <clip pos="3" side="tl" part="lem"/>
	      <lit v ="de"/>
	    </let>
	  </when> 
	  <otherwise>
	    <let>
	      <clip pos="3" side="tl" part="lem"/>
	      <lit v ="per"/>
	    </let>
	  </otherwise>
	</choose>
	<call-macro n="genere_nombre">
	  <with-param pos="2"/>
	</call-macro>
	<call-macro n="det_no">
	  <with-param pos="1"/>
	  <with-param pos="2"/>
	</call-macro>
	<call-macro n="tipus_verbs"> <!-- per tractar la cua en verbs multiparaula -->
	  <with-param pos="4"/>
	</call-macro>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>

	<choose>		<!-- la part del INF per a tractar la cua si enté-->
	  <when>
	    <test>
	      <not>
		<or>
		  <equal caseless="yes">
		    <clip pos="4" side="sl" part="lem"/>
		    <lit v="will"/>
		  </equal>
		  <equal caseless="yes">
		    <clip pos="4" side="sl" part="lem"/>
		    <lit v="shall"/>
		  </equal>
		  <equal caseless="yes">
		    <clip pos="4" side="sl" part="lem"/>
		    <lit v="would"/>
		  </equal>
		</or>
	      </not>
	    </test>
	    <choose>
	      <when>
		<test>
		  <equal>
		    <var n="tipus_verb"/>
		    <lit-tag v="pron"/>
		  </equal>
		</test>
		<out>

		  <chunk name="det_nom_to_inf" case="caseFirstWord">
		    <tags>
		      <tag><lit-tag v="SN.DET"/></tag>
		      <tag><clip pos="2" side="tl" part="gen"/></tag>
		      <tag><clip pos="2" side="tl" part="nbr"/></tag>
		      <tag><lit-tag v="inf"/></tag> <!-- posat a mà-->
		    </tags>
		    <lu>
		      <clip pos="1" side="tl" part="lem"/>
		      <clip pos="1" side="tl" part="a_det"/>
		      <clip pos="2" side="tl" part="gen" link-to="3"/>
		      <clip pos="2" side="tl" part="nbr" link-to="4"/>
		    </lu>
		    <b pos="1"/>
		    <lu>
		      <clip pos="2" side="tl" part="lemh"/>
		      <clip pos="2" side="tl" part="a_nom"/>
		      <clip pos="2" side="tl" part="gen" link-to="3"/>
		      <clip pos="2" side="tl" part="nbr" link-to="4"/>
		      <clip pos="2" side="tl" part="lemq"/>
		    </lu>
		    <b pos="2"/>
		    <lu>
		      <clip pos="3" side="tl" part="whole"/>
		    </lu>
		    <b pos="3"/>
		    <mlu>
		      <lu>
			<clip pos="4" side="tl" part="lemh"/>
			<clip pos="4" side="tl" part="a_verb"/>
			<clip pos="4" side="tl" part="temps" link-to="5"/>
		      </lu>
		      <lu>
			<lit v="es"/>
			<lit-tag v="prn.enc.ref.p3.mf.sp"/>
		      </lu>
		      <lu>
			<clip pos="5" side="tl" part="lem"/>
			<lit-tag v="prn.enc"/>
			<clip pos="5" side="tl" part="pers"/>
			<clip pos="5" side="tl" part="gen"/>
			<clip pos="5" side="tl" part="nbr"/>
			<clip pos="4" side="tl" part="lemq"/>
		      </lu>
		    </mlu>
		  </chunk>
		</out>
	      </when>
	      <otherwise>
		<out>
		  <chunk name="det_nom_to_inf" case="caseFirstWord">
		    <tags>
		      <tag><lit-tag v="SN.DET"/></tag>
		      <tag><clip pos="2" side="tl" part="gen"/></tag>
		      <tag><clip pos="2" side="tl" part="nbr"/></tag>
		      <tag><lit-tag v="inf"/></tag> <!-- posat a mà-->
		    </tags>
		    <lu>
		      <clip pos="1" side="tl" part="lem"/>
		      <clip pos="1" side="tl" part="a_det"/>
		      <clip pos="2" side="tl" part="gen" link-to="3"/>
		      <clip pos="2" side="tl" part="nbr" link-to="4"/>
		    </lu>
		    <b pos="1"/>
		    <lu>
		      <clip pos="2" side="tl" part="lemh"/>
		      <clip pos="2" side="tl" part="a_nom"/>
		      <clip pos="2" side="tl" part="gen" link-to="3"/>
		      <clip pos="2" side="tl" part="nbr" link-to="4"/>
		      <clip pos="2" side="tl" part="lemq"/>
		    </lu>
		    <b pos="2"/>
		    <lu>
		      <clip pos="3" side="tl" part="whole"/>
		    </lu>
		    <b pos="3"/>
		    <mlu>
		      <lu>
			<clip pos="4" side="tl" part="lemh"/>
			<clip pos="4" side="tl" part="a_verb"/>
			<clip pos="4" side="tl" part="temps" link-to="5"/>
		      </lu>
		      <lu>
			<clip pos="5" side="tl" part="lem"/>
			<lit-tag v="prn.enc"/>
			<clip pos="5" side="tl" part="pers"/>
			<clip pos="5" side="tl" part="gen"/>
			<clip pos="5" side="tl" part="nbr"/>
			<clip pos="4" side="tl" part="lemq"/>
		      </lu>
		    </mlu>
		  </chunk>
		</out>
	      </otherwise>
	    </choose>
	  </when>
	</choose>
	<call-macro n="f_bcond">
	  <with-param pos="4"/>
	</call-macro>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>


    <rule comment="REGLA: NOM TO INF (BCN:  Regla que canvia la preposició TO de l'anglès per DE del català per A noms de control i per PER per als altres ('the need to work' - 'la necessitat de treballr' vs. 'a book to read' - 'un llibre per llegir'. Com que és d'aplicació general es codifica via regla i no al lèxic. Els noms de control (o equi nouns) es llisten sota la marca equinouns. Amb això evitem duplicar entrades. Les exepcions que hi pugui haver s'han de codificar al lèxic). 
		   EN principi la regla es justifica per evitar que la prep TO es tradueixi per A.">

      <pattern>
	<pattern-item n="nom"/>
	<pattern-item n="to"/>
	<pattern-item n="inf"/>
      </pattern>
      <action>
	<choose>
	  <when>
	    <test>
	      <in caseless="yes">
		<clip pos="1" side="sl" part="lem"/>
		<list n="controlnouns"/>
	      </in>
	    </test>
	    <let>
	      <clip pos="2" side="tl" part="lem"/>
	      <lit v ="de"/>
	    </let>
	  </when> 
	  <otherwise>
	    <let>
	      <clip pos="2" side="tl" part="lem"/>
	      <lit v ="per"/>
	    </let>
	  </otherwise>
	</choose>
	<call-macro n="genere_nombre">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="tipus_verbs"> <!-- per tractar la cua en verbs multiparaula -->
	  <with-param pos="3"/>
	</call-macro>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>

	<choose>		<!-- la part del INF per a tractar la cua si enté-->
	  <when>
	    <test>
	      <not>
		<or>
		  <equal caseless="yes">
		    <clip pos="3" side="sl" part="lem"/>
		    <lit v="will"/>
		  </equal>
		  <equal caseless="yes">
		    <clip pos="3" side="sl" part="lem"/>
		    <lit v="shall"/>
		  </equal>
		  <equal caseless="yes">
		    <clip pos="3" side="sl" part="lem"/>
		    <lit v="would"/>
		  </equal>
		</or>
	      </not>
	    </test>
	    <choose>
	      <when>
		<test>
		  <equal>
		    <var n="tipus_verb"/>
		    <lit-tag v="pron"/>
		  </equal>
		</test>
		<out>

		  <chunk name="nom_to_inf" case="caseFirstWord">
		    <tags>
		      <tag><lit-tag v="SN.UNDET"/></tag>
		      <tag><clip pos="1" side="tl" part="gen"/></tag>
		      <tag><clip pos="1" side="tl" part="nbr"/></tag>
		      <tag><lit-tag v="inf"/></tag> <!-- posat a mà-->
		    </tags>
		    <lu>
		      <clip pos="1" side="tl" part="lemh"/>
		      <clip pos="1" side="tl" part="a_nom"/>
		      <clip pos="1" side="tl" part="gen" link-to="3"/>
		      <clip pos="1" side="tl" part="nbr" link-to="4"/>
		      <clip pos="1" side="tl" part="lemq"/>
		    </lu>
		    <b pos="1"/>
		    <lu>
		      <clip pos="2" side="tl" part="whole"/>
		    </lu>
		    <b pos="2"/>
		    <mlu>
		      <lu>
			<clip pos="3" side="tl" part="lemh"/>
			<clip pos="3" side="tl" part="a_verb"/>
			<clip pos="3" side="tl" part="temps" link-to="5"/>

		      </lu>
		      <lu>
			<lit v="es"/>
			<lit-tag v="prn.enc.ref.p3.mf.sp"/>
			<clip pos="3" side="tl" part="lemq"/>
		      </lu>
		    </mlu>
		  </chunk>
		</out>
	      </when>
	      <otherwise>
		<out>
		  <chunk name="nom_to_inf" case="caseFirstWord">
		    <tags>
		      <tag><lit-tag v="SN.UNDET"/></tag>
		      <tag><clip pos="1" side="tl" part="gen"/></tag>
		      <tag><clip pos="1" side="tl" part="nbr"/></tag>
		      <tag><lit-tag v="inf"/></tag> <!-- posat a mà-->
		    </tags>
		    <lu>
		      <clip pos="1" side="tl" part="lemh"/>
		      <clip pos="1" side="tl" part="a_nom"/>
		      <clip pos="1" side="tl" part="gen" link-to="3"/>
		      <clip pos="1" side="tl" part="nbr" link-to="4"/>
		      <clip pos="1" side="tl" part="lemq"/>
		    </lu>
		    <b pos="1"/>
		    <lu>
		      <clip pos="2" side="tl" part="whole"/>
		    </lu>
		    <b pos="2"/>
		    <lu>
		      <clip pos="3" side="tl" part="lemh"/>
		      <clip pos="3" side="tl" part="a_verb"/>
		      <clip pos="3" side="tl" part="temps" link-to="5"/>
		      <clip pos="3" side="tl" part="lemq"/>
		    </lu>
		  </chunk>
		</out>
	      </otherwise>
	    </choose>
	  </when>
	</choose>

	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>

   <rule comment="REGLA: NOM TO INF + PRNobj">

      <pattern>
	<pattern-item n="nom"/>
	<pattern-item n="to"/>
	<pattern-item n="inf"/>
	<pattern-item n="probj"/>
      </pattern>
      <action>
	<choose>
	  <when>
	    <test>
	      <in caseless="yes">
		<clip pos="1" side="sl" part="lem"/>
		<list n="controlnouns"/>
	      </in>
	    </test>
	    <let>
	      <clip pos="2" side="tl" part="lem"/>
	      <lit v ="de"/>
	    </let>
	  </when> 
	  <otherwise>
	    <let>
	      <clip pos="2" side="tl" part="lem"/>
	      <lit v ="per"/>
	    </let>
	  </otherwise>
	</choose>
	<call-macro n="genere_nombre">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="tipus_verbs"> <!-- per tractar la cua en verbs multiparaula -->
	  <with-param pos="3"/>
	</call-macro>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>

	<choose>		<!-- la part del INF per a tractar la cua si enté-->
	  <when>
	    <test>
	      <not>
		<or>
		  <equal caseless="yes">
		    <clip pos="3" side="sl" part="lem"/>
		    <lit v="will"/>
		  </equal>
		  <equal caseless="yes">
		    <clip pos="3" side="sl" part="lem"/>
		    <lit v="shall"/>
		  </equal>
		  <equal caseless="yes">
		    <clip pos="3" side="sl" part="lem"/>
		    <lit v="would"/>
		  </equal>
		</or>
	      </not>
	    </test>
	    <choose>
	      <when>
		<test>
		  <equal>
		    <var n="tipus_verb"/>
		    <lit-tag v="pron"/>
		  </equal>
		</test>
		<out>

		  <chunk name="nom_to_inf" case="caseFirstWord">
		    <tags>
		      <tag><lit-tag v="SN.UNDET"/></tag>
		      <tag><clip pos="1" side="tl" part="gen"/></tag>
		      <tag><clip pos="1" side="tl" part="nbr"/></tag>
		      <tag><lit-tag v="inf"/></tag> <!-- posat a mà-->
		    </tags>
		    <lu>
		      <clip pos="1" side="tl" part="lemh"/>
		      <clip pos="1" side="tl" part="a_nom"/>
		      <clip pos="1" side="tl" part="gen" link-to="3"/>
		      <clip pos="1" side="tl" part="nbr" link-to="4"/>
		      <clip pos="1" side="tl" part="lemq"/>
		    </lu>
		    <b pos="1"/>
		    <lu>
		      <clip pos="2" side="tl" part="whole"/>
		    </lu>
		    <b pos="2"/>
		    <mlu>
		      <lu>
			<clip pos="3" side="tl" part="lemh"/>
			<clip pos="3" side="tl" part="a_verb"/>
			<clip pos="3" side="tl" part="temps" link-to="5"/>
		      </lu>
		      <lu>
			<lit v="es"/>
			<lit-tag v="prn.enc.ref.p3.mf.sp"/>
		      </lu>
		      <lu>
			<clip pos="4" side="tl" part="lem"/>
			<lit-tag v="prn.enc"/>
			<clip pos="4" side="tl" part="pers"/>
			<clip pos="4" side="tl" part="gen"/>
			<clip pos="4" side="tl" part="nbr"/>
			<clip pos="3" side="tl" part="lemq"/>
		      </lu>
		    </mlu>
		  </chunk>
		</out>
	      </when>
	      <otherwise>
		<out>
		  <chunk name="nom_to_inf" case="caseFirstWord">
		    <tags>
		      <tag><lit-tag v="SN.UNDET"/></tag>
		      <tag><clip pos="1" side="tl" part="gen"/></tag>
		      <tag><clip pos="1" side="tl" part="nbr"/></tag>
		      <tag><lit-tag v="inf"/></tag> <!-- posat a mà-->
		    </tags>
		    <lu>
		      <clip pos="1" side="tl" part="lemh"/>
		      <clip pos="1" side="tl" part="a_nom"/>
		      <clip pos="1" side="tl" part="gen" link-to="3"/>
		      <clip pos="1" side="tl" part="nbr" link-to="4"/>
		      <clip pos="1" side="tl" part="lemq"/>
		    </lu>
		    <b pos="1"/>
		    <lu>
		      <clip pos="2" side="tl" part="whole"/>
		    </lu>
		    <b pos="2"/>
		    <mlu>
		      <lu>
			<clip pos="3" side="tl" part="lemh"/>
			<clip pos="3" side="tl" part="a_verb"/>
			<clip pos="3" side="tl" part="temps" link-to="5"/>
		      </lu>
		      <lu>
			<clip pos="4" side="tl" part="lem"/>
			<lit-tag v="prn.enc"/>
			<clip pos="4" side="tl" part="pers"/>
			<clip pos="4" side="tl" part="gen"/>
			<clip pos="4" side="tl" part="nbr"/>
			<clip pos="3" side="tl" part="lemq"/>
		      </lu>
		    </mlu>
		  </chunk>
		</out>
	      </otherwise>
	    </choose>
	  </when>
	</choose>
	<call-macro n="f_bcond">
	  <with-param pos="3"/>
	</call-macro>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>

    <rule comment="REGLA: DET ADJ NOM TO INF (BCN:  Regla que canvia la preposició TO de l'anglès per DE del català per A noms de control i per PER per als altres ('the need to work' - 'la necessitat de treballr' vs. 'a book to read' - 'un llibre per llegir'. Com que és d'aplicació general es codifica via regla i no al lèxic. Els noms de control (o equi nouns) es llisten sota la marca equinouns. Amb això evitem duplicar entrades. Les exepcions que hi pugui haver s'han de codificar al lèxic). 
		   EN principi la regla es justifica per evitar que la prep TO es tradueixi per A.">

      <pattern>
	<pattern-item n="det"/>
	<pattern-item n="adj"/>
	<pattern-item n="nom"/>
	<pattern-item n="to"/>
	<pattern-item n="inf"/>
      </pattern>
      <action>
	<choose>
	  <when>
	    <test>
	      <in caseless="yes">
		<clip pos="3" side="sl" part="lem"/>
		<list n="controlnouns"/>
	      </in>
	    </test>
	    <let>
	      <clip pos="4" side="tl" part="lem"/>
	      <lit v ="de"/>
	    </let>
	  </when> 
	  <otherwise>
	    <let>
	      <clip pos="4" side="tl" part="lem"/>
	      <lit v ="per"/>
	    </let>
	  </otherwise>
	</choose>
	<call-macro n="genere_nombre">
	  <with-param pos="3"/>
	</call-macro>
	<call-macro n="det_no">
	  <with-param pos="1"/>
	  <with-param pos="3"/>
	</call-macro>
	<call-macro n="comparatiu_adj1">
	  <with-param pos="2"/>
	</call-macro>
	<call-macro n="tipus_verbs"> <!-- per tractar la cua en verbs multiparaula -->
	  <with-param pos="5"/>
	</call-macro>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<choose>
	  <when>
	    <test>
	      <not>
		<or>
		  <equal caseless="yes">
		    <clip pos="5" side="sl" part="lem"/>
		    <lit v="will"/>
		  </equal>
		  <equal caseless="yes">
		    <clip pos="5" side="sl" part="lem"/>
		    <lit v="shall"/>
		  </equal>
		  <equal caseless="yes">
		    <clip pos="5" side="sl" part="lem"/>
		    <lit v="would"/>
		  </equal>
		</or>
	      </not>
	    </test>
	    <choose>
	      <when>
		<test>
		  <equal>
		    <var n="tipus_verb"/>
		    <lit-tag v="pron"/>
		  </equal>
		</test>
		<out>

		  <chunk name="det_adj_nom_to_inf" case="caseFirstWord">
		    <tags>
		      <tag><lit-tag v="SN.DET"/></tag>
		      <tag><clip pos="3" side="tl" part="gen"/></tag>
		      <tag><clip pos="3" side="tl" part="nbr"/></tag>
		      <tag><lit-tag v="inf"/></tag> <!-- posat a mà-->
		    </tags>
		    <lu>
		      <clip pos="1" side="tl" part="lem"/>
		      <clip pos="1" side="tl" part="a_det"/>
		      <clip pos="3" side="tl" part="gen" link-to="3"/>
		      <clip pos="3" side="tl" part="nbr" link-to="4"/>
		    </lu>
		    <b pos="1"/>
		    <lu>
		      <clip pos="3" side="tl" part="lemh"/>
		      <clip pos="3" side="tl" part="a_nom"/>
		      <clip pos="3" side="tl" part="gen" link-to="3"/>
		      <clip pos="3" side="tl" part="nbr" link-to="4"/>
		      <clip pos="3" side="tl" part="lemq"/>
		    </lu>
		    <b pos="2"/>
		    <lu>
		      <var n="adjectiu1"/>
		      <clip pos="2" side="tl" part="lemh"/> <!-- BCN només el head per evitar la cua dels PP adj-->
		      <clip pos="2" side="tl" part="a_adj"/>
		      <clip pos="3" side="tl" part="gen" link-to="3"/>
		      <clip pos="3" side="tl" part="nbr" link-to="4"/>
		      <clip pos="2" side="tl" part="lemq"/> <!-- la cua--> 
		    </lu>
		    <b pos="3"/>
		    <lu>
		      <clip pos="4" side="tl" part="whole"/>
		    </lu>
		    <b pos="4"/>
		    <mlu>
		      <lu>
			<clip pos="5" side="tl" part="lemh"/>
			<clip pos="5" side="tl" part="a_verb"/>
			<clip pos="5" side="tl" part="temps" link-to="5"/>

		      </lu>
		      <lu>
			<lit v="es"/>
			<lit-tag v="prn.enc.ref.p3.mf.sp"/>
			<clip pos="5" side="tl" part="lemq"/>
		      </lu>
		    </mlu>
		  </chunk>
		</out>
	      </when>
	      <otherwise>
		<out>
		  <chunk name="det_adj_nom_to_inf" case="caseFirstWord">
		    <tags>
		      <tag><lit-tag v="SN.DET"/></tag>
		      <tag><clip pos="3" side="tl" part="gen"/></tag>
		      <tag><clip pos="3" side="tl" part="nbr"/></tag>
		      <tag><lit-tag v="inf"/></tag> <!-- posat a mà-->
		    </tags>
		    <lu>
		      <clip pos="1" side="tl" part="lem"/>
		      <clip pos="1" side="tl" part="a_det"/>
		      <clip pos="3" side="tl" part="gen" link-to="3"/>
		      <clip pos="3" side="tl" part="nbr" link-to="4"/>
		    </lu>
		    <b pos="1"/>
		    <lu>
		      <clip pos="3" side="tl" part="lemh"/>
		      <clip pos="3" side="tl" part="a_nom"/>
		      <clip pos="3" side="tl" part="gen" link-to="3"/>
		      <clip pos="3" side="tl" part="nbr" link-to="4"/>
		      <clip pos="3" side="tl" part="lemq"/>
		    </lu>
		    <b pos="2"/>
		    <lu>
		      <var n="adjectiu1"/>
		      <clip pos="2" side="tl" part="lemh"/> <!-- BCN només el head per evitar la cua dels PPs adj-->
		      <clip pos="2" side="tl" part="a_adj"/>
		      <clip pos="3" side="tl" part="gen" link-to="3"/>
		      <clip pos="3" side="tl" part="nbr" link-to="4"/>
		      <clip pos="2" side="tl" part="lemq"/> <!-- --> 
		    </lu>
		    <b pos="3"/>
		    <lu>
		      <clip pos="4" side="tl" part="whole"/>
		    </lu>
		    <b pos="4"/>
		    <lu>
		      <clip pos="5" side="tl" part="lemh"/>
		      <clip pos="5" side="tl" part="a_verb"/>
		      <clip pos="5" side="tl" part="temps" link-to="5"/>
		      <clip pos="5" side="tl" part="lemq"/>
		    </lu>
		  </chunk>
		</out>
	      </otherwise>
	    </choose>
	  </when>
	</choose>

	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>


   <rule comment="REGLA: DET ADJ NOM TO INF PRNobj (igual que l'anterior però amb inf + clític).">

      <pattern>
	<pattern-item n="det"/>
	<pattern-item n="adj"/>
	<pattern-item n="nom"/>
	<pattern-item n="to"/>
	<pattern-item n="inf"/>
	<pattern-item n="probj"/>
      </pattern>
      <action>
	<choose>
	  <when>
	    <test>
	      <in caseless="yes">
		<clip pos="3" side="sl" part="lem"/>
		<list n="controlnouns"/>
	      </in>
	    </test>
	    <let>
	      <clip pos="4" side="tl" part="lem"/>
	      <lit v ="de"/>
	    </let>
	  </when> 
	  <otherwise>
	    <let>
	      <clip pos="4" side="tl" part="lem"/>
	      <lit v ="per"/>
	    </let>
	  </otherwise>
	</choose>
	<call-macro n="genere_nombre">
	  <with-param pos="3"/>
	</call-macro>
	<call-macro n="det_no">
	  <with-param pos="1"/>
	  <with-param pos="3"/>
	</call-macro>
	<call-macro n="comparatiu_adj1">
	  <with-param pos="2"/>
	</call-macro>
	<call-macro n="tipus_verbs"> <!-- per tractar la cua en verbs multiparaula -->
	  <with-param pos="5"/>
	</call-macro>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<choose>
	  <when>
	    <test>
	      <not>
		<or>
		  <equal caseless="yes">
		    <clip pos="5" side="sl" part="lem"/>
		    <lit v="will"/>
		  </equal>
		  <equal caseless="yes">
		    <clip pos="5" side="sl" part="lem"/>
		    <lit v="shall"/>
		  </equal>
		  <equal caseless="yes">
		    <clip pos="5" side="sl" part="lem"/>
		    <lit v="would"/>
		  </equal>
		</or>
	      </not>
	    </test>
	    <choose>
	      <when>
		<test>
		  <equal>
		    <var n="tipus_verb"/>
		    <lit-tag v="pron"/>
		  </equal>
		</test>
		<out>

		  <chunk name="det_adj_nom_to_inf" case="caseFirstWord">
		    <tags>
		      <tag><lit-tag v="SN.DET"/></tag>
		      <tag><clip pos="3" side="tl" part="gen"/></tag>
		      <tag><clip pos="3" side="tl" part="nbr"/></tag>
		      <tag><lit-tag v="inf"/></tag> <!-- posat a mà-->
		    </tags>
		    <lu>
		      <clip pos="1" side="tl" part="lem"/>
		      <clip pos="1" side="tl" part="a_det"/>
		      <clip pos="3" side="tl" part="gen" link-to="3"/>
		      <clip pos="3" side="tl" part="nbr" link-to="4"/>
		    </lu>
		    <b pos="1"/>
		    <lu>
		      <clip pos="3" side="tl" part="lemh"/>
		      <clip pos="3" side="tl" part="a_nom"/>
		      <clip pos="3" side="tl" part="gen" link-to="3"/>
		      <clip pos="3" side="tl" part="nbr" link-to="4"/>
		      <clip pos="3" side="tl" part="lemq"/>
		    </lu>
		    <b pos="2"/>
		    <lu>
		      <var n="adjectiu1"/>
		      <clip pos="2" side="tl" part="lemh"/> <!-- BCN només el head per evitar la cua dels PP adj-->
		      <clip pos="2" side="tl" part="a_adj"/>
		      <clip pos="3" side="tl" part="gen" link-to="3"/>
		      <clip pos="3" side="tl" part="nbr" link-to="4"/>
		      <clip pos="2" side="tl" part="lemq"/> <!-- la cua--> 
		    </lu>
		    <b pos="3"/>
		    <lu>
		      <clip pos="4" side="tl" part="whole"/>
		    </lu>
		    <b pos="4"/>
		    <mlu>
		      <lu>
			<clip pos="5" side="tl" part="lemh"/>
			<clip pos="5" side="tl" part="a_verb"/>
			<clip pos="5" side="tl" part="temps" link-to="5"/>

		      </lu>
		      <lu>
			<lit v="es"/>
			<lit-tag v="prn.enc.ref.p3.mf.sp"/>
		      </lu>
		      <lu>
			<clip pos="6" side="tl" part="lem"/>
			<lit-tag v="prn.enc"/>
			<clip pos="6" side="tl" part="pers"/>
			<clip pos="6" side="tl" part="gen"/>
			<clip pos="6" side="tl" part="nbr"/>
			<clip pos="5" side="tl" part="lemq"/>
		      </lu>
		    </mlu>
		  </chunk>
		</out>
	      </when>
	      <otherwise>
		<out>
		  <chunk name="det_adj_nom_to_inf" case="caseFirstWord">
		    <tags>
		      <tag><lit-tag v="SN.DET"/></tag>
		      <tag><clip pos="3" side="tl" part="gen"/></tag>
		      <tag><clip pos="3" side="tl" part="nbr"/></tag>
		      <tag><lit-tag v="inf"/></tag> <!-- posat a mà-->
		    </tags>
		    <lu>
		      <clip pos="1" side="tl" part="lem"/>
		      <clip pos="1" side="tl" part="a_det"/>
		      <clip pos="3" side="tl" part="gen" link-to="3"/>
		      <clip pos="3" side="tl" part="nbr" link-to="4"/>
		    </lu>
		    <b pos="1"/>
		    <lu>
		      <clip pos="3" side="tl" part="lemh"/>
		      <clip pos="3" side="tl" part="a_nom"/>
		      <clip pos="3" side="tl" part="gen" link-to="3"/>
		      <clip pos="3" side="tl" part="nbr" link-to="4"/>
		      <clip pos="3" side="tl" part="lemq"/>
		    </lu>
		    <b pos="2"/>
		    <lu>
		      <var n="adjectiu1"/>
		      <clip pos="2" side="tl" part="lemh"/> <!-- BCN només el head per evitar la cua dels PPs adj-->
		      <clip pos="2" side="tl" part="a_adj"/>
		      <clip pos="3" side="tl" part="gen" link-to="3"/>
		      <clip pos="3" side="tl" part="nbr" link-to="4"/>
		      <clip pos="2" side="tl" part="lemq"/> <!-- --> 
		    </lu>
		    <b pos="3"/>
		    <lu>
		      <clip pos="4" side="tl" part="whole"/>
		    </lu>
		    <b pos="4"/>
		    <mlu>
		      <lu>
			<clip pos="5" side="tl" part="lemh"/>
			<clip pos="5" side="tl" part="a_verb"/>
			<clip pos="5" side="tl" part="temps" link-to="5"/>
		      </lu>
		      <lu>
			<clip pos="6" side="tl" part="lem"/>
			<lit-tag v="prn.enc"/>
			<clip pos="6" side="tl" part="pers"/>
			<clip pos="6" side="tl" part="gen"/>
			<clip pos="6" side="tl" part="nbr"/>
			<clip pos="5" side="tl" part="lemq"/>
		      </lu>
		    </mlu>
		  </chunk>
		</out>
	      </otherwise>
	    </choose>
	  </when>
	</choose>
	<call-macro n="f_bcond">
	  <with-param pos="5"/>
	</call-macro>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>

    <!-- SINTAGNES NOMINALS SENSE ADJS-->

    <rule comment="REGLA: DET NOM"> 
      <pattern>
	<pattern-item n="det"/>
	<pattern-item n="nom"/>
      </pattern>
      <action>
	<call-macro n="genere_nombre">
	  <with-param pos="2"/>
	</call-macro>
	<call-macro n="det_no">
	  <with-param pos="1"/>
	  <with-param pos="2"/>
	</call-macro>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<out>
	  <chunk name="det_nom" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN.DET"/></tag>
	      <tag><clip pos="2" side="tl" part="gen"/></tag>
	      <tag><clip pos="2" side="tl" part="nbr"/></tag>
	      <tag><var n="tipus_det"/></tag> <!-- BCN per recollir si es negacio-->
	    </tags>
	    <lu>
	      <clip pos="1" side="tl" part="lem"/> 
	      <clip pos="1" side="tl" part="a_det"/>
	      <clip pos="2" side="tl" part="gen" link-to="3"/>
	      <clip pos="2" side="tl" part="nbr" link-to="4"/>
	    </lu> 
	    <b pos="1"/>
	    <lu> 
	      <clip pos="2" side="tl" part="lemh"/> 
	      <clip pos="2" side="tl" part="a_nom"/>
	      <clip pos="2" side="tl" part="gen" link-to="3"/>
	      <clip pos="2" side="tl" part="nbr" link-to="4"/>
	      <clip pos="2" side="tl" part="lemq"/> 
	    </lu> 
	  </chunk>
	</out>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule> 

    <rule comment="REGLA: NUM NOM">
      <pattern>
	<pattern-item n="num"/>
	<pattern-item n="nom"/>
      </pattern>
      <action>
	<call-macro n="genere_nombre">
	  <with-param pos="2"/>
	</call-macro>
	<call-macro n="million">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="flexio_numerals">
	  <with-param pos="1"/>
	  <with-param pos="2"/>
	</call-macro> <!-- Pensar tema 'teacher' -->
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<out> 
	  <chunk name="num_nom" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN.NUM"/></tag>
	      <tag><clip pos="2" side="tl" part="gen"/></tag>
	      <tag><clip pos="2" side="tl" part="nbr"/></tag>
	    </tags>
	    <lu>   
	      <clip pos="1" side="tl" part="lem"/> 
	      <clip pos="1" side="tl" part="a_num"/> 
	      <clip pos="1" side="tl" part="gen"/> 
	      <clip pos="1" side="tl" part="nbr"/>
	    </lu> 
	    <b pos="1"/>
	    <lu> 
	      <clip pos="2" side="tl" part="lemh"/> 
	      <clip pos="2" side="tl" part="a_nom"/> 
	      <clip pos="2" side="tl" part="gen" link-to="3"/> 
	      <clip pos="2" side="tl" part="nbr" link-to="4"/>
	      <clip pos="2" side="tl" part="lemq"/> 
	    </lu> 
	  </chunk>
	</out>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>

    <rule comment="REGLA: DET DET NOM"> 
      <pattern>
	<pattern-item n="det"/>
	<pattern-item n="det"/>
	<pattern-item n="nom"/>
      </pattern>
      <action>
	<call-macro n="genere_nombre">
	  <with-param pos="3"/>
	</call-macro>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<out> 
	  <chunk name="det_det_nom" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN.DET"/></tag>
	      <tag><clip pos="3" side="tl" part="gen"/></tag>
	      <tag><clip pos="3" side="tl" part="nbr"/></tag>
	    </tags>
	    <lu>   
	      <clip pos="1" side="tl" part="lem"/> 
	      <clip pos="1" side="tl" part="a_det"/>
	      <clip pos="3" side="tl" part="gen" link-to="3"/>
	      <clip pos="3" side="tl" part="nbr" link-to="4"/>
	    </lu> 
	    <b pos="1"/>
	    <lu>   
	      <clip pos="2" side="tl" part="lem"/> 
	      <clip pos="2" side="tl" part="a_det"/>
	      <clip pos="3" side="tl" part="gen" link-to="3"/>
	      <clip pos="3" side="tl" part="nbr" link-to="4"/>
	    </lu> 
	    <b pos="2"/>
	    <lu> 
	      <clip pos="3" side="tl" part="lemh"/> 
	      <clip pos="3" side="tl" part="a_nom"/>
	      <clip pos="3" side="tl" part="gen" link-to="3"/>
	      <clip pos="3" side="tl" part="nbr" link-to="4"/>
	      <clip pos="3" side="tl" part="lemq"/> 
	    </lu> 
	  </chunk>
	</out>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>

    <rule comment="REGLA: DET NUM NOM"> 
      <pattern>
	<pattern-item n="det"/>
	<pattern-item n="num"/>
	<pattern-item n="nom"/>
      </pattern>
      <action>
	<call-macro n="genere_nombre">
	  <with-param pos="3"/>
	</call-macro>
	<call-macro n="million">
	  <with-param pos="2"/>
	</call-macro>
	<call-macro n="flexio_numerals">
	  <with-param pos="2"/>
	  <with-param pos="3"/>
	</call-macro> 
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<out> 
	  <chunk name="det_num_nom" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN.DET"/></tag>
	      <tag><clip pos="3" side="tl" part="gen"/></tag>
	      <tag><clip pos="3" side="tl" part="nbr"/></tag>
	    </tags>
	    <lu>
	      <clip pos="1" side="tl" part="lem"/>
	      <clip pos="1" side="tl" part="a_det"/>
	      <clip pos="3" side="tl" part="gen" link-to="3"/>
	      <clip pos="3" side="tl" part="nbr" link-to="4"/> 
	    </lu> 
	    <b pos="1"/>
	    <lu>   
	      <clip pos="2" side="tl" part="lem"/> 
	      <clip pos="2" side="tl" part="a_num"/> 
	      <clip pos="2" side="tl" part="gen"/>
	      <clip pos="2" side="tl" part="nbr"/>
	    </lu> 
	    <b pos="2"/>
	    <lu> 
	      <clip pos="3" side="tl" part="lemh"/>
	      <clip pos="3" side="tl" part="a_nom"/> 
	      <clip pos="3" side="tl" part="gen" link-to="3"/> 
	      <clip pos="3" side="tl" part="nbr" link-to="4"/>
	      <clip pos="3" side="tl" part="lemq"/> 
	    </lu> 
	  </chunk>
	</out>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>


    <rule comment="REGLA: NUM NUM NOM"> 
      <pattern>
	<pattern-item n="num"/>
	<pattern-item n="num"/>
	<pattern-item n="nom"/>
      </pattern>
      <action>
	<call-macro n="genere_nombre">
	  <with-param pos="3"/>
	</call-macro>
	<call-macro n="million">
	  <with-param pos="2"/>
	</call-macro>
	<choose>
	  <when>
	    <test>
	      <and>
		<or>
		  <equal caseless="yes">
		    <clip pos="2" side="tl" part="lem"/>
		    <lit v="milió de"/>
		  </equal>
		  <equal caseless="yes">
		    <clip pos="2" side="tl" part="lem"/>
		    <lit v="un milió de"/>
		  </equal>
		</or>
		<equal>
		  <clip pos="1" side="tl" part="gen"/>
		  <lit-tag v="GD"/>
		</equal>
	      </and>
	    </test>
	    <let>
	      <clip pos="1" side="tl" part="gen"/>
	      <lit-tag v="m"/>
	    </let>
	  </when>
	  <otherwise>
	    <call-macro n="flexio_numerals">
	      <with-param pos="1"/>
	      <with-param pos="3"/>
	    </call-macro> 
	  </otherwise>
	</choose>
	<call-macro n="flexio_numerals">
	  <with-param pos="2"/>
	  <with-param pos="3"/>
	</call-macro> 
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<out> 
	  <chunk name="num_num_nom" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN.NUM"/></tag>
	      <tag><clip pos="3" side="tl" part="gen"/></tag>
	      <tag><clip pos="3" side="tl" part="nbr"/></tag>
	    </tags>
	    <lu>   
	      <clip pos="1" side="tl" part="lem"/> 
	      <clip pos="1" side="tl" part="a_num"/> 
	      <clip pos="1" side="tl" part="gen"/>
	      <clip pos="1" side="tl" part="nbr"/>
	    </lu> 
	    <b pos="1"/>
	    <lu>   
	      <clip pos="2" side="tl" part="lem"/>
	      <clip pos="2" side="tl" part="a_num"/> 
	      <clip pos="2" side="tl" part="gen"/>
	      <clip pos="2" side="tl" part="nbr"/>
	    </lu> 
	    <b pos="2"/>
	    <lu> 
	      <clip pos="3" side="tl" part="lemh"/> 
	      <clip pos="3" side="tl" part="a_nom"/>
	      <clip pos="3" side="tl" part="gen" link-to="3"/>
	      <clip pos="3" side="tl" part="nbr" link-to="4"/>
	      <clip pos="3" side="tl" part="lemq"/> 
	    </lu> 
	  </chunk>
	</out>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>


    <rule comment="REGLA: DET DET NUM NOM"> 
      <pattern>
	<pattern-item n="det"/>
	<pattern-item n="det"/>
	<pattern-item n="num"/>
	<pattern-item n="nom"/>
      </pattern>
      <action>
	<call-macro n="genere_nombre">
	  <with-param pos="4"/>
	</call-macro>
	<call-macro n="million">
	  <with-param pos="3"/>
	</call-macro>
	<call-macro n="flexio_numerals">
	  <with-param pos="3"/>
	  <with-param pos="4"/>
	</call-macro>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<out> 
	  <chunk name="det_det_num_nom" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN.DET"/></tag>
	      <tag><clip pos="4" side="tl" part="gen"/></tag>
	      <tag><clip pos="4" side="tl" part="nbr"/></tag>
	    </tags>
	    <lu>   
	      <clip pos="1" side="tl" part="lem"/> 
	      <clip pos="1" side="tl" part="a_det"/>
	      <clip pos="4" side="tl" part="gen" link-to="3"/>
	      <clip pos="4" side="tl" part="nbr" link-to="4"/>
	    </lu> 
	    <b pos="1"/>
	    <lu>   
	      <clip pos="2" side="tl" part="lem"/> 
	      <clip pos="2" side="tl" part="a_det"/>
	      <clip pos="4" side="tl" part="gen" link-to="3"/>
	      <clip pos="4" side="tl" part="nbr" link-to="4"/>
	    </lu> 
	    <b pos="2"/>
	    <lu>   
	      <clip pos="3" side="tl" part="lem"/> 
	      <clip pos="3" side="tl" part="a_num"/>
	      <clip pos="3" side="tl" part="gen"/>
	      <clip pos="3" side="tl" part="nbr"/>
	    </lu> 
	    <b pos="3"/>
	    <lu>  
	      <clip pos="4" side="tl" part="lemh"/> 
	      <clip pos="4" side="tl" part="a_nom"/>
	      <clip pos="4" side="tl" part="gen" link-to="3"/>
	      <clip pos="4" side="tl" part="nbr" link-to="4"/>
	      <clip pos="4" side="tl" part="lemq"/>  
	    </lu>
	  </chunk>
	</out>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>

    <rule comment="REGLA: DET NUM NUM NOM">
      <pattern>
	<pattern-item n="det"/>
	<pattern-item n="num"/>
	<pattern-item n="num"/>
	<pattern-item n="nom"/>
      </pattern>
      <action>
	<call-macro n="genere_nombre">
	  <with-param pos="4"/>
	</call-macro>
	<call-macro n="million">
	  <with-param pos="3"/>
	</call-macro>
	<choose>
	  <when>
	    <test>
	      <and>
		<or>
		  <equal caseless="yes">
		    <clip pos="3" side="tl" part="lem"/>
		    <lit v="milió de"/>
		  </equal>
		  <equal caseless="yes">
		    <clip pos="3" side="tl" part="lem"/>
		    <lit v="un milió de"/>
		  </equal>
		</or>
		<equal>
		  <clip pos="2" side="tl" part="gen"/>
		  <lit-tag v="GD"/>
		</equal>
	      </and>
	    </test>
	    <let>
	      <clip pos="2" side="tl" part="gen"/>
	      <lit-tag v="m"/>
	    </let>
	  </when>
	  <otherwise>
	    <call-macro n="flexio_numerals">
	      <with-param pos="2"/>
	      <with-param pos="4"/>
	    </call-macro> 
	  </otherwise>
	</choose>
	<call-macro n="flexio_numerals">
	  <with-param pos="3"/>
	  <with-param pos="4"/>
	</call-macro>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<out> 
	  <chunk name="det_num_num_nom" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN.DET"/></tag>
	      <tag><clip pos="4" side="tl" part="gen"/></tag>
	      <tag><clip pos="4" side="tl" part="nbr"/></tag>
	    </tags>
	    <lu>   
	      <clip pos="1" side="tl" part="lem"/> 
	      <clip pos="1" side="tl" part="a_det"/>
	      <clip pos="4" side="tl" part="gen" link-to="3"/>
	      <clip pos="4" side="tl" part="nbr" link-to="4"/>
	    </lu> 
	    <b pos="1"/>
	    <lu>   
	      <clip pos="2" side="tl" part="lem"/> 
	      <clip pos="2" side="tl" part="a_num"/> 
	      <clip pos="2" side="tl" part="gen"/>
	      <clip pos="2" side="tl" part="nbr"/>
	    </lu> 
	    <b pos="2"/>
	    <lu>   
	      <clip pos="3" side="tl" part="lem"/> 
	      <clip pos="3" side="tl" part="a_num"/>  
	      <clip pos="3" side="tl" part="gen"/>
	      <clip pos="3" side="tl" part="nbr"/>
	    </lu> 
	    <b pos="3"/>
	    <lu>  
	      <clip pos="4" side="tl" part="lemh"/> 
	      <clip pos="4" side="tl" part="a_nom"/>
	      <clip pos="4" side="tl" part="gen" link-to="3"/>
	      <clip pos="4" side="tl" part="nbr" link-to="4"/>
	      <clip pos="4" side="tl" part="lemq"/>  
	    </lu>
	  </chunk>
	</out>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>
    <!-- FI SINTAGNES NOMINALS SENSE ADJS-->


    <!-- SINTAGNES NOMINALS AMB UN ADJ -->

    <rule comment="REGLA: such a ADJ NOM (afegir tb una regla such a ADJ ADJ NOM?. Aquí no he posat funció 'envia_adj' i per tant desapareix el comparatiu/superlatiu: such a bigger field = un camp tan gran. Pensar-hi">  
      <pattern>
	<pattern-item n="such_a"/>
	<pattern-item n="adj"/>
	<pattern-item n="nom"/>
      </pattern>
      <action>
	<call-macro n="genere_nombre">
	  <with-param pos="3"/>
	</call-macro>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<out> 
	  <chunk name="such_a_adj_nom" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN.DET"/></tag>
	      <tag><clip pos="3" side="tl" part="gen"/></tag>
	      <tag><clip pos="3" side="tl" part="nbr"/></tag>
	    </tags>
	    <lu>   
	      <lit v="un"/>
	      <lit-tag v="det.ind"/>
	      <clip pos="3" side="tl" part="gen" link-to="3"/>
	      <clip pos="3" side="tl" part="nbr" link-to="4"/>
	    </lu> 
	    <b pos="1"/>
	    <lu>   
	      <clip pos="3" side="tl" part="lemh"/> 
	      <clip pos="3" side="tl" part="a_nom"/>
	      <clip pos="3" side="tl" part="gen" link-to="3"/>
	      <clip pos="3" side="tl" part="nbr" link-to="4"/>
	      <clip pos="3" side="tl" part="lemq"/>
	    </lu> 
	    <b pos="2"/>
	    <lu>
	      <lit v="tan"/>
	      <lit-tag v="preadv"/>
	    </lu>
	    <b/>
	    <lu>   
	      <clip pos="2" side="tl" part="lemh"/> <!-- BCN-->
	      <clip pos="2" side="tl" part="a_adj"/>
	      <clip pos="3" side="tl" part="gen" link-to="3"/>
	      <clip pos="3" side="tl" part="nbr" link-to="4"/>
	    </lu> 
	  </chunk>
	</out>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>
    


    <rule comment="REGLA: DET DET ADJ NOM (your many beautiful cats)">
      <pattern>
	<pattern-item n="det"/>
	<pattern-item n="det"/>
	<pattern-item n="adj"/>
	<pattern-item n="nom"/>
      </pattern>
      <action>
	<call-macro n="genere_nombre">
	  <with-param pos="4"/>
	</call-macro>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="comparatiu_adj1">
	  <with-param pos="3"/>
	</call-macro>
	<out> 
	  <chunk name="det_det_adj_nom" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN.DET"/></tag>
	      <tag><clip pos="4" side="tl" part="gen"/></tag>
	      <tag><clip pos="4" side="tl" part="nbr"/></tag>
	    </tags>
	    <lu>   
	      <clip pos="1" side="tl" part="lem"/> 
	      <clip pos="1" side="tl" part="a_det"/>
	      <clip pos="4" side="tl" part="gen" link-to="3"/>
	      <clip pos="4" side="tl" part="nbr" link-to="4"/>
	    </lu> 
	    <b pos="1"/>
	    <lu> 
	      <clip pos="2" side="tl" part="lemh"/> 
	      <clip pos="2" side="tl" part="a_det"/>
	      <clip pos="4" side="tl" part="gen" link-to="3"/>
	      <clip pos="4" side="tl" part="nbr" link-to="4"/>
	    </lu> 
	    <b pos="2"/>
	    <lu>   
	      <clip pos="4" side="tl" part="lemh"/> 
	      <clip pos="4" side="tl" part="a_nom"/>
	      <clip pos="4" side="tl" part="gen" link-to="3"/>
	      <clip pos="4" side="tl" part="nbr" link-to="4"/>
	      <clip pos="4" side="tl" part="lemq"/> 
	    </lu>
	    <b pos="3"/>
	    <lu> 
	      <var n="adjectiu1"/>   
	      <clip pos="3" side="tl" part="lemh"/> 
	      <clip pos="3" side="tl" part="a_adj"/>
	      <clip pos="4" side="tl" part="gen" link-to="3"/>
	      <clip pos="4" side="tl" part="nbr" link-to="4"/>
	    </lu> 
	  </chunk>
	</out>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>

    <rule comment="REGLA: DET NUM ADJ NOM (your three beautiful cats)">
      <pattern>
	<pattern-item n="det"/>
	<pattern-item n="num"/>
	<pattern-item n="adj"/>
	<pattern-item n="nom"/>
      </pattern>
      <action>
	<call-macro n="genere_nombre">
	  <with-param pos="4"/>
	</call-macro>
	<call-macro n="million">
	  <with-param pos="2"/>
	</call-macro>
	<call-macro n="flexio_numerals">
	  <with-param pos="2"/>
	  <with-param pos="4"/>
	</call-macro>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="comparatiu_adj1">
	  <with-param pos="3"/>
	</call-macro>
	<out> 
	  <chunk name="det_num_adj_nom" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN.DET"/></tag>
	      <tag><clip pos="4" side="tl" part="gen"/></tag>
	      <tag><clip pos="4" side="tl" part="nbr"/></tag>
	    </tags>
	    <lu>   
	      <clip pos="1" side="tl" part="lem"/> 
	      <clip pos="1" side="tl" part="a_det"/>
	      <clip pos="4" side="tl" part="gen" link-to="3"/>
	      <clip pos="4" side="tl" part="nbr" link-to="4"/>
	    </lu> 
	    <b pos="1"/>
	    <lu> 
	      <clip pos="2" side="tl" part="lemh"/> 
	      <clip pos="2" side="tl" part="a_num"/>
	      <clip pos="2" side="tl" part="gen"/>
	      <clip pos="2" side="tl" part="nbr"/>
	    </lu> 
	    <b pos="2"/>
	    <lu>   
	      <clip pos="4" side="tl" part="lemh"/> 
	      <clip pos="4" side="tl" part="a_nom"/>
	      <clip pos="4" side="tl" part="gen" link-to="3"/>
	      <clip pos="4" side="tl" part="nbr" link-to="4"/>
	      <clip pos="4" side="tl" part="lemq"/> 
	    </lu>
	    <b pos="3"/>
	    <lu> 
	      <var n="adjectiu1"/>   
	      <clip pos="3" side="tl" part="lemh"/> 
	      <clip pos="3" side="tl" part="a_adj"/>
	      <clip pos="4" side="tl" part="gen" link-to="3"/>
	      <clip pos="4" side="tl" part="nbr" link-to="4"/>
	    </lu> 
	  </chunk>
	</out>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>

    <rule comment="REGLA: DET DET ADV (incl preadv) ADJ NOM (BCN)">
      <pattern>
	<pattern-item n="det"/>
	<pattern-item n="detquant"/>
	<pattern-item n="adv_preadv"/>
	<pattern-item n="adj"/>
	<pattern-item n="nom"/>
      </pattern>
      <action>
	<call-macro n="genere_nombre">
	  <with-param pos="5"/>
	</call-macro>
	<call-macro n="det_no">
	  <with-param pos="1"/>
	  <with-param pos="5"/>
	</call-macro>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="comparatiu_adj1">
	  <with-param pos="4"/>
	</call-macro>  
	<out> 
	  <chunk name="det_detquant_adv_adj_nom" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN.DET"/></tag>
	      <tag><clip pos="5" side="tl" part="gen"/></tag>
	      <tag><clip pos="5" side="tl" part="nbr"/></tag>
	    </tags>
	    <lu>   
	      <clip pos="1" side="tl" part="lem"/> 
	      <clip pos="1" side="tl" part="a_det"/>
	      <clip pos="5" side="tl" part="gen" link-to="3"/>
	      <clip pos="5" side="tl" part="nbr" link-to="4"/>
	    </lu> 
	    <b pos="1"/>	    
	    <lu>   
	      <clip pos="5" side="tl" part="lemh"/> 
	      <clip pos="5" side="tl" part="a_nom"/>
	      <clip pos="5" side="tl" part="gen" link-to="3"/>
	      <clip pos="5" side="tl" part="nbr" link-to="4"/>
	      <clip pos="5" side="tl" part="lemq"/> 
	    </lu> 
	    <b pos="2"/>	    
	    <lu>   
	      <clip pos="2" side="tl" part="lem"/> 
	      <clip pos="2" side="tl" part="a_det"/>
	      <clip pos="5" side="tl" part="gen" link-to="3"/>
	      <clip pos="5" side="tl" part="nbr" link-to="4"/>
	    </lu> 
	    <b pos="3"/>
	    <lu>   
	      <clip pos="3" side="tl" part="whole"/> 
	    </lu> 
	    <b pos="4"/>
	    <lu> 
	      <var n="adjectiu1"/>   
	      <clip pos="4" side="tl" part="lemh"/> 
	      <clip pos="4" side="tl" part="a_adj"/>
	      <clip pos="5" side="tl" part="gen" link-to="3"/>
	      <clip pos="5" side="tl" part="nbr" link-to="4"/>
	      <clip pos="4" side="tl" part="lemq"/> 
	    </lu> 
	  </chunk>
	</out>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>

    <rule comment="REGLA: DET NUM ADV (incl preadv) ADJ NOM (BCN)">
      <pattern>
	<pattern-item n="det"/>
	<pattern-item n="num"/>
	<pattern-item n="adv_preadv"/>
	<pattern-item n="adj"/>
	<pattern-item n="nom"/>
      </pattern>
      <action>
	<call-macro n="genere_nombre">
	  <with-param pos="5"/>
	</call-macro>
	<call-macro n="million">
	  <with-param pos="2"/>
	</call-macro>
	<call-macro n="flexio_numerals">
	  <with-param pos="2"/>
	  <with-param pos="5"/>
	</call-macro>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="comparatiu_adj1">
	  <with-param pos="4"/>
	</call-macro>  
	<out> 
	  <chunk name="det_num_adv_adj_nom" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN.NUM"/></tag>
	      <tag><clip pos="5" side="tl" part="gen"/></tag>
	      <tag><clip pos="5" side="tl" part="nbr"/></tag>
	    </tags>
	    <lu>   
	      <clip pos="1" side="tl" part="lem"/> 
	      <clip pos="1" side="tl" part="a_det"/>
	      <clip pos="5" side="tl" part="gen" link-to="3"/>
	      <clip pos="5" side="tl" part="nbr" link-to="4"/>
	    </lu> 
	    <b pos="1"/>	    
	    <lu>   
	      <clip pos="2" side="tl" part="lem"/> 
	      <clip pos="2" side="tl" part="a_num"/>
	      <clip pos="2" side="tl" part="gen"/> 
	      <clip pos="2" side="tl" part="nbr"/>
	    </lu> 
	    <b pos="2"/>	    
	    <lu>   
	      <clip pos="5" side="tl" part="lemh"/> 
	      <clip pos="5" side="tl" part="a_nom"/>
	      <clip pos="5" side="tl" part="gen" link-to="3"/>
	      <clip pos="5" side="tl" part="nbr" link-to="4"/>
	      <clip pos="5" side="tl" part="lemq"/> 
	    </lu> 
	    <b pos="3"/>
	    <lu>   
	      <clip pos="3" side="tl" part="whole"/> 
	    </lu> 
	    <b pos="4"/>
	    <lu> 
	      <var n="adjectiu1"/>   
	      <clip pos="4" side="tl" part="lemh"/> 
	      <clip pos="4" side="tl" part="a_adj"/>
	      <clip pos="5" side="tl" part="gen" link-to="3"/>
	      <clip pos="5" side="tl" part="nbr" link-to="4"/>
	      <clip pos="4" side="tl" part="lemq"/> 
	    </lu> 
	  </chunk>
	</out>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>

    <rule comment="REGLA: DET ADV (incl preadv) ADJ NOM">
      <pattern>
	<pattern-item n="det"/>
	<pattern-item n="adv_preadv"/>
	<pattern-item n="adj"/>
	<pattern-item n="nom"/>
      </pattern>
      <action>
	<call-macro n="genere_nombre">
	  <with-param pos="4"/>
	</call-macro>
	<call-macro n="det_no">
	  <with-param pos="1"/>
	  <with-param pos="4"/>
	</call-macro>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="comparatiu_adj1">
	  <with-param pos="3"/>
	</call-macro>  
	<out> 
	  <chunk name="det_adv_adj_nom" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN.DET"/></tag>
	      <tag><clip pos="4" side="tl" part="gen"/></tag>
	      <tag><clip pos="4" side="tl" part="nbr"/></tag>
	    </tags>
	    <lu>   
	      <clip pos="1" side="tl" part="lem"/> 
	      <clip pos="1" side="tl" part="a_det"/>
	      <clip pos="4" side="tl" part="gen" link-to="3"/>
	      <clip pos="4" side="tl" part="nbr" link-to="4"/>
	    </lu> 
	    <b pos="1"/>	    
	    <lu>   
	      <clip pos="4" side="tl" part="lemh"/> 
	      <clip pos="4" side="tl" part="a_nom"/>
	      <clip pos="4" side="tl" part="gen" link-to="3"/>
	      <clip pos="4" side="tl" part="nbr" link-to="4"/>
	      <clip pos="4" side="tl" part="lemq"/> 
	    </lu> 
	    <b pos="2"/>
	    <lu>   
	      <clip pos="2" side="tl" part="whole"/> 
	    </lu> 
	    <b pos="3"/>
	    <lu> 
	      <var n="adjectiu1"/>   
	      <clip pos="3" side="tl" part="lemh"/> 
	      <clip pos="3" side="tl" part="a_adj"/>
	      <clip pos="4" side="tl" part="gen" link-to="3"/>
	      <clip pos="4" side="tl" part="nbr" link-to="4"/>
	      <clip pos="3" side="tl" part="lemq"/> 
	    </lu> 
	  </chunk>
	</out>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>

    <rule comment="REGLA: NUM ADV (incl preadv) ADJ NOM">
      <pattern>
	<pattern-item n="num"/>
	<pattern-item n="adv_preadv"/>
	<pattern-item n="adj"/>
	<pattern-item n="nom"/>
      </pattern>
      <action>
	<call-macro n="genere_nombre">
	  <with-param pos="4"/>
	</call-macro>
	<call-macro n="million">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="flexio_numerals">
	  <with-param pos="1"/>
	  <with-param pos="4"/>
	</call-macro>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="comparatiu_adj1">
	  <with-param pos="3"/>
	</call-macro> 
	<out> 
	  <chunk name="num_adv_adj_nom" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN.NUM"/></tag>
	      <tag><clip pos="4" side="tl" part="gen"/></tag>
	      <tag><clip pos="4" side="tl" part="nbr"/></tag>
	    </tags>
	    <lu>   
	      <clip pos="1" side="tl" part="lem"/> 
	      <clip pos="1" side="tl" part="a_num"/>
	      <clip pos="1" side="tl" part="gen"/> 
	      <clip pos="1" side="tl" part="nbr"/>
	    </lu> 
	    <b pos="1"/>	    
	    <lu>   
	      <clip pos="4" side="tl" part="lemh"/> 
	      <clip pos="4" side="tl" part="a_nom"/>
	      <clip pos="4" side="tl" part="gen" link-to="3"/>
	      <clip pos="4" side="tl" part="nbr" link-to="4"/>
	      <clip pos="4" side="tl" part="lemq"/> 
	    </lu> 
	    <b pos="2"/>
	    <lu>   
	      <clip pos="2" side="tl" part="whole"/> 
	    </lu> 
	    <b pos="3"/>
	    <lu> 
	      <var n="adjectiu1"/>   
	      <clip pos="3" side="tl" part="lemh"/> 
	      <clip pos="3" side="tl" part="a_adj"/>
	      <clip pos="4" side="tl" part="gen" link-to="3"/>
	      <clip pos="4" side="tl" part="nbr" link-to="4"/>
	      <clip pos="3" side="tl" part="lemq"/> 
	    </lu> 
	  </chunk>
	</out>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>


    <rule comment="REGLA: PREADV ADJ NOM">
      <pattern>
	<pattern-item n="preadv"/>
	<pattern-item n="adj"/>
	<pattern-item n="nom"/>
      </pattern>
      <action>
	<call-macro n="genere_nombre">
	  <with-param pos="3"/>
	</call-macro>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="comparatiu_adj1">
	  <with-param pos="2"/>
	</call-macro>  
	<out> 
	  <chunk name="adv_adj_nom" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN.UNDET"/></tag>
	      <tag><clip pos="3" side="tl" part="gen"/></tag>
	      <tag><clip pos="3" side="tl" part="nbr"/></tag>
	    </tags>
	    <lu> 
	      <clip pos="3" side="tl" part="lemh"/> 
	      <clip pos="3" side="tl" part="a_nom"/>
	      <clip pos="3" side="tl" part="gen" link-to="3"/>
	      <clip pos="3" side="tl" part="nbr" link-to="4"/>
	      <clip pos="3" side="tl" part="lemq"/>  
	    </lu> 
	    <b pos="1"/>
	    <lu>   
	      <clip pos="1" side="tl" part="whole"/> 
	    </lu> 
	    <b pos="2"/>
	    <lu> 
	      <var n="adjectiu1"/>   
	      <clip pos="2" side="tl" part="lemh"/> 
	      <clip pos="2" side="tl" part="a_adj"/>
	      <clip pos="3" side="tl" part="gen" link-to="3"/>
	      <clip pos="3" side="tl" part="nbr" link-to="4"/>
	    </lu> 
	  </chunk>
	</out>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>


    <rule comment="REGLA: PREADV ADJ NOM (és com la regla anterior, però inclou tb adverbis junt amb pp: 'locally produced materials'. No hi ha cap regla per ADV ADJ(pp) NOM perquè l'adverbi no sempre modifica l'adjectiu o pp (....'always green articles'). He pensat que quan és 'pp' és més probable que l'adverbi modifiqui el pp, tot i que tampoc sempre és així.">
      <pattern>
	<pattern-item n="adv_preadv"/>
	<pattern-item n="pp"/>
	<pattern-item n="nom"/>
      </pattern>
      <action>
	<call-macro n="genere_nombre">
	  <with-param pos="3"/>
	</call-macro>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<out> 
	  <chunk name="adv_adj_nom" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN.UNDET"/></tag>
	      <tag><clip pos="3" side="tl" part="gen"/></tag>
	      <tag><clip pos="3" side="tl" part="nbr"/></tag>
	    </tags>
	    <lu> 
	      <clip pos="3" side="tl" part="lemh"/> 
	      <clip pos="3" side="tl" part="a_nom"/>
	      <clip pos="3" side="tl" part="gen" link-to="3"/>
	      <clip pos="3" side="tl" part="nbr" link-to="4"/>
	      <clip pos="3" side="tl" part="lemq"/>  
	    </lu> 
	    <b pos="1"/>
	    <lu> 
	      <clip pos="2" side="tl" part="lemh"/> 
	      <clip pos="2" side="tl" part="a_adj"/>
	      <clip pos="3" side="tl" part="gen" link-to="3"/>
	      <clip pos="3" side="tl" part="nbr" link-to="4"/>
	    </lu> 
	    <b pos="2"/>
	    <lu>   
	      <clip pos="1" side="tl" part="whole"/> 
	    </lu> 
	  </chunk>
	</out>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>


    <rule comment="REGLA: DET ADJ NOM">
      <pattern>
	<pattern-item n="det"/>
	<pattern-item n="adj"/>
	<pattern-item n="nom"/>
      </pattern>
      <action>
	<call-macro n="genere_nombre">
	  <with-param pos="3"/>
	</call-macro>
	<call-macro n="det_no">
	  <with-param pos="1"/>
	  <with-param pos="3"/>
	</call-macro>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="comparatiu_adj1">
	  <with-param pos="2"/>
	</call-macro>  
	<out> 
	  <chunk name="det_adj_nom" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN.DET"/></tag>
	      <tag><clip pos="3" side="tl" part="gen"/></tag>
	      <tag><clip pos="3" side="tl" part="nbr"/></tag>
	    </tags>
	    <lu>   
	      <clip pos="1" side="tl" part="lem"/> 
	      <clip pos="1" side="tl" part="a_det"/>
	      <clip pos="3" side="tl" part="gen" link-to="3"/>
	      <clip pos="3" side="tl" part="nbr" link-to="4"/>
	    </lu> 
	    <b pos="1"/>
	    <lu> 
	      <clip pos="3" side="tl" part="lemh"/> 
	      <clip pos="3" side="tl" part="a_nom"/>
	      <clip pos="3" side="tl" part="gen" link-to="3"/>
	      <clip pos="3" side="tl" part="nbr" link-to="4"/>
	      <clip pos="3" side="tl" part="lemq"/>  
	    </lu> 
	    <b pos="2"/>
	    <lu> 
	      <var n="adjectiu1"/>   
	      <clip pos="2" side="tl" part="lemh"/> 
	      <clip pos="2" side="tl" part="a_adj"/>
	      <clip pos="3" side="tl" part="gen" link-to="3"/>
	      <clip pos="3" side="tl" part="nbr" link-to="4"/>
	    </lu> 
	  </chunk>
	</out>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>


    <rule comment="REGLA: NUM ADJ NOM">
      <pattern>
	<pattern-item n="num"/>
	<pattern-item n="adj"/>
	<pattern-item n="nom"/>
      </pattern>
      <action>
	<call-macro n="genere_nombre">
	  <with-param pos="3"/>
	</call-macro>
	<call-macro n="det_no">
	  <with-param pos="1"/>
	  <with-param pos="3"/>
	</call-macro>
	<call-macro n="million">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="flexio_numerals">
	  <with-param pos="1"/>
	  <with-param pos="3"/>
	</call-macro>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="comparatiu_adj1">
	  <with-param pos="2"/>
	</call-macro>  
	<out> 
	  <chunk name="num_adj_nom" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN.NUM"/></tag>
	      <tag><clip pos="3" side="tl" part="gen"/></tag>
	      <tag><clip pos="3" side="tl" part="nbr"/></tag>
	    </tags>
	    <lu>   
	      <clip pos="1" side="tl" part="lem"/> 
	      <clip pos="1" side="tl" part="a_num"/>
	      <clip pos="1" side="tl" part="gen"/>
	      <clip pos="1" side="tl" part="nbr"/>
	    </lu> 
	    <b pos="1"/>
	    <lu> 
	      <clip pos="3" side="tl" part="lemh"/> 
	      <clip pos="3" side="tl" part="a_nom"/>
	      <clip pos="3" side="tl" part="gen" link-to="3"/>
	      <clip pos="3" side="tl" part="nbr" link-to="4"/>
	      <clip pos="3" side="tl" part="lemq"/>  
	    </lu> 
	    <b pos="2"/>
	    <lu> 
	      <var n="adjectiu1"/>   
	      <clip pos="2" side="tl" part="lem"/> 
	      <clip pos="2" side="tl" part="a_adj"/>
	      <clip pos="3" side="tl" part="gen" link-to="3"/>
	      <clip pos="3" side="tl" part="nbr" link-to="4"/>
	    </lu> 
	  </chunk>
	</out>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>

    <rule comment="REGLA: ADJ NOM">
      <pattern>
	<pattern-item n="adj"/>
	<pattern-item n="nom"/>
      </pattern>
      <action>
	<call-macro n="genere_nombre">
	  <with-param pos="2"/>
	</call-macro>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="comparatiu_adj1">
	  <with-param pos="1"/>
	</call-macro>
	<out>
	  <chunk name="adj_nom" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN.UNDET"/></tag>
	      <tag><clip pos="2" side="tl" part="gen"/></tag>
	      <tag><clip pos="2" side="tl" part="nbr"/></tag>
	    </tags>
	    <lu>
	      <clip pos="2" side="tl" part="lemh"/>
	      <clip pos="2" side="tl" part="a_nom"/>
	      <clip pos="2" side="tl" part="gen" link-to="3"/>
	      <clip pos="2" side="tl" part="nbr" link-to="4"/>
	      <clip pos="2" side="tl" part="lemq"/>
	    </lu>
	    <b pos="1"/>	  
	    <lu>  
	      <var n="adjectiu1"/> 
	      <clip pos="1" side="tl" part="lemh"/> 
	      <clip pos="1" side="tl" part="a_adj"/>
	      <clip pos="2" side="tl" part="gen" link-to="3"/>
	      <clip pos="2" side="tl" part="nbr" link-to="4"/>
	      <clip pos="1" side="tl" part="lemq"/>
	    </lu> 
	  </chunk>
	</out>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>

    <!-- FI SINTAGMES NOMINALS AMB UN ADJ -->


    <!-- SINTAGMES NOMINALS AMB DOS ADJS (ADJ ADJ)--> 

    <rule comment="REGLA: DET ADJ ADJ NOM">
      <pattern>
	<pattern-item n="det"/>
	<pattern-item n="adj"/>
	<pattern-item n="adj"/>
	<pattern-item n="nom"/>
      </pattern>
      <action>
	<call-macro n="genere_nombre">
	  <with-param pos="4"/>
	</call-macro>
	<call-macro n="det_no">
	  <with-param pos="1"/>
	  <with-param pos="4"/>
	</call-macro>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="comparatiu_adj1">
	  <with-param pos="2"/>
	</call-macro>
	<call-macro n="comparatiu_adj2">
	  <with-param pos="3"/>
	</call-macro>
	<out> 
	  <chunk name="det_adj_adj_nom" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN.DET"/></tag>
	      <tag><clip pos="4" side="tl" part="gen"/></tag>
	      <tag><clip pos="4" side="tl" part="nbr"/></tag>
	    </tags>
	    <lu>   
	      <clip pos="1" side="tl" part="lem"/> 
	      <clip pos="1" side="tl" part="a_det"/>
	      <clip pos="4" side="tl" part="gen" link-to="3"/>
	      <clip pos="4" side="tl" part="nbr" link-to="4"/>
	    </lu> 
	    <b pos="1"/>
	    <lu> 
	      <clip pos="4" side="tl" part="lemh"/> 
	      <clip pos="4" side="tl" part="a_nom"/>
	      <clip pos="4" side="tl" part="gen" link-to="3"/>
	      <clip pos="4" side="tl" part="nbr" link-to="4"/>
	      <clip pos="4" side="tl" part="lemq"/>  
	    </lu> 
	    <b pos="2"/>
	    <lu> 
	      <var n="adjectiu2"/>
	      <clip pos="3" side="tl" part="lem"/> 
	      <clip pos="3" side="tl" part="a_adj"/>
	      <clip pos="4" side="tl" part="gen" link-to="3"/>
	      <clip pos="4" side="tl" part="nbr" link-to="4"/>
	    </lu> 
	    <b pos="3"/>
	    <lu> 
	      <var n="adjectiu1"/>   
	      <clip pos="2" side="tl" part="lem"/> 
	      <clip pos="2" side="tl" part="a_adj"/>
	      <clip pos="4" side="tl" part="gen" link-to="3"/>
	      <clip pos="4" side="tl" part="nbr" link-to="4"/>
	    </lu> 
	  </chunk>
	</out>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>


    <rule comment="REGLA: DET DET ADJ ADJ NOM (BCN)">
      <pattern>
	<pattern-item n="det"/>
	<pattern-item n="det"/>
	<pattern-item n="adj"/>
	<pattern-item n="adj"/>
	<pattern-item n="nom"/>
      </pattern>
      <action>
	<call-macro n="genere_nombre">
	  <with-param pos="5"/>
	</call-macro>
	<call-macro n="det_no">
	  <with-param pos="1"/>
	  <with-param pos="5"/>
	</call-macro>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="comparatiu_adj1">
	  <with-param pos="3"/>
	</call-macro>
	<call-macro n="comparatiu_adj2">
	  <with-param pos="4"/>
	</call-macro>
	<out> 
	  <chunk name="det_det_adj_adj_nom" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN.DET"/></tag>
	      <tag><clip pos="5" side="tl" part="gen"/></tag>
	      <tag><clip pos="5" side="tl" part="nbr"/></tag>
	    </tags>
	    <lu>   
	      <clip pos="1" side="tl" part="lem"/> 
	      <clip pos="1" side="tl" part="a_det"/>
	      <clip pos="5" side="tl" part="gen" link-to="3"/>
	      <clip pos="5" side="tl" part="nbr" link-to="4"/>
	    </lu> 
	    <b pos="1"/>
	    <lu>   
	      <clip pos="2" side="tl" part="lem"/> 
	      <clip pos="2" side="tl" part="a_det"/>
	      <clip pos="5" side="tl" part="gen" link-to="3"/>
	      <clip pos="5" side="tl" part="nbr" link-to="4"/>
	    </lu> 
	    <b pos="2"/>
	    <lu> 
	      <clip pos="5" side="tl" part="lemh"/> 
	      <clip pos="5" side="tl" part="a_nom"/>
	      <clip pos="5" side="tl" part="gen" link-to="3"/>
	      <clip pos="5" side="tl" part="nbr" link-to="4"/>
	      <clip pos="5" side="tl" part="lemq"/>  
	    </lu> 
	    <b pos="3"/>
	    <lu> 
	      <var n="adjectiu2"/>
	      <clip pos="4" side="tl" part="lem"/> 
	      <clip pos="4" side="tl" part="a_adj"/>
	      <clip pos="5" side="tl" part="gen" link-to="3"/>
	      <clip pos="5" side="tl" part="nbr" link-to="4"/>
	    </lu> 
	    <b pos="4"/>
	    <lu> 
	      <var n="adjectiu1"/>   
	      <clip pos="3" side="tl" part="lem"/> 
	      <clip pos="3" side="tl" part="a_adj"/>
	      <clip pos="5" side="tl" part="gen" link-to="3"/>
	      <clip pos="5" side="tl" part="nbr" link-to="4"/>
	    </lu> 
	  </chunk>
	</out>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>


    <rule comment="REGLA: DET ADV ADJ ADJ NOM (BCN a currently valid legislative delegationi ->  una delegació legislativa actualment vàlida)">
      <pattern>
	<pattern-item n="det"/>
	<pattern-item n="adv_preadv"/>
	<pattern-item n="adj"/>
	<pattern-item n="adj"/>
	<pattern-item n="nom"/>
      </pattern>
      <action>
	<call-macro n="genere_nombre">
	  <with-param pos="5"/>
	</call-macro>
	<call-macro n="det_no">
	  <with-param pos="1"/>
	  <with-param pos="5"/>
	</call-macro>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="comparatiu_adj1">
	  <with-param pos="3"/>
	</call-macro>
	<call-macro n="comparatiu_adj2">
	  <with-param pos="4"/>
	</call-macro>
	<out> 
	  <chunk name="det_adv_adj_adj_nom" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN.DET"/></tag>
	      <tag><clip pos="5" side="tl" part="gen"/></tag>
	      <tag><clip pos="5" side="tl" part="nbr"/></tag>
	    </tags>
	    <lu>   
	      <clip pos="1" side="tl" part="lem"/> 
	      <clip pos="1" side="tl" part="a_det"/>
	      <clip pos="5" side="tl" part="gen" link-to="3"/>
	      <clip pos="5" side="tl" part="nbr" link-to="4"/>
	    </lu> 
	    <b pos="1"/>
	    <lu> 
	      <clip pos="5" side="tl" part="lemh"/> 
	      <clip pos="5" side="tl" part="a_nom"/>
	      <clip pos="5" side="tl" part="gen" link-to="3"/>
	      <clip pos="5" side="tl" part="nbr" link-to="4"/>
	      <clip pos="5" side="tl" part="lemq"/>  
	    </lu> 
	    <b pos="2"/>
	    <lu> 
	      <var n="adjectiu2"/>
	      <clip pos="4" side="tl" part="lem"/> 
	      <clip pos="4" side="tl" part="a_adj"/>
	      <clip pos="5" side="tl" part="gen" link-to="3"/>
	      <clip pos="5" side="tl" part="nbr" link-to="4"/>
	    </lu> 
	    <b pos="3"/>
	    <lu>
	      <clip pos="2" side="tl" part="whole"/>
	    </lu>
	    <b pos="4"/>
	    <lu> 
	      <var n="adjectiu1"/>   
	      <clip pos="3" side="tl" part="lem"/> 
	      <clip pos="3" side="tl" part="a_adj"/>
	      <clip pos="5" side="tl" part="gen" link-to="3"/>
	      <clip pos="5" side="tl" part="nbr" link-to="4"/>
	    </lu> 
	  </chunk>
	</out>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>


    <rule comment="REGLA: NUM ADV ADJ ADJ NOM (BCN two currently valid legislative delegations)">
      <pattern>
	<pattern-item n="num"/>
	<pattern-item n="adv_preadv"/>
	<pattern-item n="adj"/>
	<pattern-item n="adj"/>
	<pattern-item n="nom"/>
      </pattern>
      <action>
	<call-macro n="genere_nombre">
	  <with-param pos="5"/>
	</call-macro>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="comparatiu_adj1">
	  <with-param pos="3"/>
	</call-macro>
	<call-macro n="comparatiu_adj2">
	  <with-param pos="4"/>
	</call-macro>
	<out> 
	  <chunk name="det_adj_adj_nom" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN.DET"/></tag>
	      <tag><clip pos="5" side="tl" part="gen"/></tag>
	      <tag><clip pos="5" side="tl" part="nbr"/></tag>
	    </tags>
	    <lu>   
	      <clip pos="1" side="tl" part="lem"/> 
	      <clip pos="1" side="tl" part="a_det"/>
	      <clip pos="5" side="tl" part="gen" link-to="3"/>
	      <clip pos="5" side="tl" part="nbr" link-to="4"/>
	    </lu> 
	    <b pos="1"/>
	    <lu> 
	      <clip pos="5" side="tl" part="lemh"/> 
	      <clip pos="5" side="tl" part="a_nom"/>
	      <clip pos="5" side="tl" part="gen" link-to="3"/>
	      <clip pos="5" side="tl" part="nbr" link-to="4"/>
	      <clip pos="5" side="tl" part="lemq"/>  
	    </lu> 
	    <b pos="2"/>
	    <lu> 
	      <var n="adjectiu2"/>
	      <clip pos="4" side="tl" part="lem"/> 
	      <clip pos="4" side="tl" part="a_adj"/>
	      <clip pos="5" side="tl" part="gen" link-to="3"/>
	      <clip pos="5" side="tl" part="nbr" link-to="4"/>
	    </lu> 
	    <b pos="3"/>
	    <lu>
	      <clip pos="2" side="tl" part="whole"/>
	    </lu>
	    <b pos="4"/>
	    <lu> 
	      <var n="adjectiu1"/>   
	      <clip pos="3" side="tl" part="lem"/> 
	      <clip pos="3" side="tl" part="a_adj"/>
	      <clip pos="5" side="tl" part="gen" link-to="3"/>
	      <clip pos="5" side="tl" part="nbr" link-to="4"/>
	    </lu> 
	  </chunk>
	</out>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>

    <rule comment="REGLA: NUM ADJ ADJ NOM">
      <pattern>
	<pattern-item n="num"/>
	<pattern-item n="adj"/>
	<pattern-item n="adj"/>
	<pattern-item n="nom"/>
      </pattern>
      <action>
	<call-macro n="genere_nombre">
	  <with-param pos="4"/>
	</call-macro>
	<call-macro n="million">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="flexio_numerals">
	  <with-param pos="1"/>
	  <with-param pos="4"/>
	</call-macro>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="comparatiu_adj1">
	  <with-param pos="2"/>
	</call-macro>
	<call-macro n="comparatiu_adj2">
	  <with-param pos="3"/>
	</call-macro>
	<out> 
	  <chunk name="num_adj_adj_nom" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN.NUM"/></tag>
	      <tag><clip pos="4" side="tl" part="gen"/></tag>
	      <tag><clip pos="4" side="tl" part="nbr"/></tag>
	    </tags>
	    <lu>   
	      <clip pos="1" side="tl" part="lem"/> 
	      <clip pos="1" side="tl" part="a_num"/>
	      <clip pos="1" side="tl" part="gen"/>
	      <clip pos="1" side="tl" part="nbr"/>
	    </lu> 
	    <b pos="1"/>
	    <lu> 
	      <clip pos="4" side="tl" part="lemh"/> 
	      <clip pos="4" side="tl" part="a_nom"/>
	      <clip pos="4" side="tl" part="gen" link-to="3"/>
	      <clip pos="4" side="tl" part="nbr" link-to="4"/>
	      <clip pos="4" side="tl" part="lemq"/>  
	    </lu> 
	    <b pos="2"/>
	    <lu> 
	      <var n="adjectiu2"/>   
	      <clip pos="3" side="tl" part="lemh"/> 
	      <clip pos="3" side="tl" part="a_adj"/>
	      <clip pos="4" side="tl" part="gen" link-to="3"/>
	      <clip pos="4" side="tl" part="nbr" link-to="4"/>
	    </lu> 
	    <b pos="3"/>
	    <lu> 
	      <var n="adjectiu1"/>   
	      <clip pos="2" side="tl" part="lemh"/> 
	      <clip pos="2" side="tl" part="a_adj"/>
	      <clip pos="4" side="tl" part="gen" link-to="3"/>
	      <clip pos="4" side="tl" part="nbr" link-to="4"/>
	    </lu> 
	  </chunk>
	</out>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>


    <rule comment="REGLA: DET NUM ADJ ADJ NOM (BCN)">
      <pattern>
	<pattern-item n="det"/>
	<pattern-item n="num"/>
	<pattern-item n="adj"/>
	<pattern-item n="adj"/>
	<pattern-item n="nom"/>
      </pattern>
      <action>
	<call-macro n="genere_nombre">
	  <with-param pos="5"/>
	</call-macro>
	<call-macro n="million">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="flexio_numerals">
	  <with-param pos="1"/>
	  <with-param pos="5"/>
	</call-macro>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="comparatiu_adj1">
	  <with-param pos="3"/>
	</call-macro>
	<call-macro n="comparatiu_adj2">
	  <with-param pos="4"/>
	</call-macro>
	<out> 
	  <chunk name="det_num_adj_adj_nom" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN.NUM"/></tag>
	      <tag><clip pos="5" side="tl" part="gen"/></tag>
	      <tag><clip pos="5" side="tl" part="nbr"/></tag>
	    </tags>
	    <lu>   
	      <clip pos="1" side="tl" part="lem"/> 
	      <clip pos="1" side="tl" part="a_det"/>
	      <clip pos="5" side="tl" part="gen" link-to="3"/>
	      <clip pos="5" side="tl" part="nbr" link-to="4"/>
	    </lu> 
	    <b pos="1"/>
	    <lu>   
	      <clip pos="2" side="tl" part="lem"/> 
	      <clip pos="2" side="tl" part="a_num"/>
	      <clip pos="2" side="tl" part="gen"/>
	      <clip pos="2" side="tl" part="nbr"/>
	    </lu> 
	    <b pos="2"/>
	    <lu> 
	      <clip pos="5" side="tl" part="lemh"/> 
	      <clip pos="5" side="tl" part="a_nom"/>
	      <clip pos="5" side="tl" part="gen" link-to="3"/>
	      <clip pos="5" side="tl" part="nbr" link-to="4"/>
	      <clip pos="5" side="tl" part="lemq"/>  
	    </lu> 
	    <b pos="3"/>
	    <lu> 
	      <var n="adjectiu2"/>   
	      <clip pos="4" side="tl" part="lemh"/> 
	      <clip pos="4" side="tl" part="a_adj"/>
	      <clip pos="5" side="tl" part="gen" link-to="3"/>
	      <clip pos="5" side="tl" part="nbr" link-to="4"/>
	    </lu> 
	    <b pos="4"/>
	    <lu> 
	      <var n="adjectiu1"/>   
	      <clip pos="3" side="tl" part="lemh"/> 
	      <clip pos="3" side="tl" part="a_adj"/>
	      <clip pos="5" side="tl" part="gen" link-to="3"/>
	      <clip pos="5" side="tl" part="nbr" link-to="4"/>
	    </lu> 
	  </chunk>
	</out>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>

    <rule comment="REGLA: ADJ ADJ NOM">
      <pattern>
	<pattern-item n="adj"/>
	<pattern-item n="adj"/>
	<pattern-item n="nom"/>
      </pattern>
      <action>
	<call-macro n="genere_nombre">
	  <with-param pos="3"/>
	</call-macro>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="comparatiu_adj1">
	  <with-param pos="1"/>
	</call-macro>  
	<call-macro n="comparatiu_adj2">
	  <with-param pos="2"/>
	</call-macro>  
	<out> 
	  <chunk name="adj_adj_nom" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN.UNDET"/></tag>
	      <tag><clip pos="3" side="tl" part="gen"/></tag>
	      <tag><clip pos="3" side="tl" part="nbr"/></tag>
	    </tags>
	    <lu> 
	      <clip pos="3" side="tl" part="lemh"/> 
	      <clip pos="3" side="tl" part="a_nom"/>
	      <clip pos="3" side="tl" part="gen" link-to="3"/>
	      <clip pos="3" side="tl" part="nbr" link-to="4"/>
	      <clip pos="3" side="tl" part="lemq"/>  
	    </lu> 
	    <b pos="1"/>
	    <lu> 
	      <var n="adjectiu2"/>   
	      <clip pos="2" side="tl" part="lemh"/> 
	      <clip pos="2" side="tl" part="a_adj"/>
	      <clip pos="3" side="tl" part="gen" link-to="3"/>
	      <clip pos="3" side="tl" part="nbr" link-to="4"/>
	      <clip pos="2" side="tl" part="lemq"/> 
	    </lu> 
	    <b pos="2"/>
	    <lu> 
	      <var n="adjectiu1"/>   
	      <clip pos="1" side="tl" part="lemh"/> 
	      <clip pos="1" side="tl" part="a_adj"/>
	      <clip pos="3" side="tl" part="gen" link-to="3"/>
	      <clip pos="3" side="tl" part="nbr" link-to="4"/>
	      <clip pos="1" side="tl" part="lemq"/> 
	    </lu> 
	  </chunk>
	</out>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>


    <rule comment="REGLA: DET NUM PREADV ADJ ADJ NOM (BCN)">
      <pattern>
	<pattern-item n="det"/>
	<pattern-item n="num"/>
	<pattern-item n="adv_preadv"/>
	<pattern-item n="adj"/>
	<pattern-item n="adj"/>
	<pattern-item n="nom"/>
      </pattern>
      <action>
	<call-macro n="genere_nombre">
	  <with-param pos="6"/>
	</call-macro>
	<call-macro n="million">
	  <with-param pos="2"/>
	</call-macro>
	<call-macro n="flexio_numerals">
	  <with-param pos="2"/>
	  <with-param pos="6"/>
	</call-macro>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="comparatiu_adj1">
	  <with-param pos="4"/>
	</call-macro>
	<call-macro n="comparatiu_adj2">
	  <with-param pos="5"/>
	</call-macro>
	<out> 
	  <chunk name="det_num_adv_adj_adj_nom" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN.NUM"/></tag>
	      <tag><clip pos="6" side="tl" part="gen"/></tag>
	      <tag><clip pos="6" side="tl" part="nbr"/></tag>
	    </tags>
	    <lu>   
	      <clip pos="1" side="tl" part="lem"/> 
	      <clip pos="1" side="tl" part="a_det"/>
	      <clip pos="6" side="tl" part="gen" link-to="3"/>
	      <clip pos="6" side="tl" part="nbr" link-to="4"/>
	    </lu> 
	    <b pos="1"/>
	    <lu>   
	      <clip pos="2" side="tl" part="lem"/> 
	      <clip pos="2" side="tl" part="a_num"/>
	      <clip pos="2" side="tl" part="gen"/>
	      <clip pos="2" side="tl" part="nbr"/>
	    </lu> 
	    <b pos="2"/>
	    <lu> 
	      <clip pos="6" side="tl" part="lemh"/> 
	      <clip pos="6" side="tl" part="a_nom"/>
	      <clip pos="6" side="tl" part="gen" link-to="3"/>
	      <clip pos="6" side="tl" part="nbr" link-to="4"/>
	      <clip pos="6" side="tl" part="lemq"/>  
	    </lu> 
	    <b pos="3"/>
	    <lu> 
	      <var n="adjectiu2"/>   
	      <clip pos="5" side="tl" part="lemh"/> 
	      <clip pos="5" side="tl" part="a_adj"/>
	      <clip pos="6" side="tl" part="gen" link-to="3"/>
	      <clip pos="6" side="tl" part="nbr" link-to="4"/>
	      <clip pos="5" side="tl" part="lemq"/> 
	    </lu> 
	    <b pos="4"/>
	    <lu> 
	      <clip pos="3" side="tl" part="whole"/>
	    </lu> 
	    <b pos="5"/>
	    <lu> 
	      <var n="adjectiu1"/>   
	      <clip pos="4" side="tl" part="lemh"/> 
	      <clip pos="4" side="tl" part="a_adj"/>
	      <clip pos="6" side="tl" part="gen" link-to="3"/>
	      <clip pos="6" side="tl" part="nbr" link-to="4"/>
	      <clip pos="4" side="tl" part="lemq"/> 
	    </lu> 
	  </chunk>
	</out>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>


    <rule comment="REGLA: DET DETquant PREADV ADJ ADJ NOM (BCN)">
      <pattern>
	<pattern-item n="det"/>
	<pattern-item n="detquant"/>
	<pattern-item n="adv_preadv"/>
	<pattern-item n="adj"/>
	<pattern-item n="adj"/>
	<pattern-item n="nom"/>
      </pattern>
      <action>
	<call-macro n="genere_nombre">
	  <with-param pos="6"/>
	</call-macro>
	<call-macro n="million">
	  <with-param pos="2"/>
	</call-macro>
	<call-macro n="flexio_numerals">
	  <with-param pos="2"/>
	  <with-param pos="6"/>
	</call-macro>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="comparatiu_adj1">
	  <with-param pos="4"/>
	</call-macro>
	<call-macro n="comparatiu_adj2">
	  <with-param pos="5"/>
	</call-macro>
	<out> 
	  <chunk name="det_num_adv_adj_adj_nom" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN.NUM"/></tag>
	      <tag><clip pos="6" side="tl" part="gen"/></tag>
	      <tag><clip pos="6" side="tl" part="nbr"/></tag>
	    </tags>
	    <lu>   
	      <clip pos="1" side="tl" part="lem"/> 
	      <clip pos="1" side="tl" part="a_det"/>
	      <clip pos="6" side="tl" part="gen" link-to="3"/>
	      <clip pos="6" side="tl" part="nbr" link-to="4"/>
	    </lu> 
	    <b pos="1"/>
	    <lu>   
	      <clip pos="2" side="tl" part="lem"/> 
	      <clip pos="2" side="tl" part="a_num"/>
	      <clip pos="2" side="tl" part="gen"/>
	      <clip pos="2" side="tl" part="nbr"/>
	    </lu> 
	    <b pos="2"/>
	    <lu> 
	      <clip pos="6" side="tl" part="lemh"/> 
	      <clip pos="6" side="tl" part="a_nom"/>
	      <clip pos="6" side="tl" part="gen" link-to="3"/>
	      <clip pos="6" side="tl" part="nbr" link-to="4"/>
	      <clip pos="6" side="tl" part="lemq"/>  
	    </lu> 
	    <b pos="3"/>
	    <lu> 
	      <var n="adjectiu2"/>   
	      <clip pos="5" side="tl" part="lemh"/> 
	      <clip pos="5" side="tl" part="a_adj"/>
	      <clip pos="6" side="tl" part="gen" link-to="3"/>
	      <clip pos="6" side="tl" part="nbr" link-to="4"/>
	      <clip pos="5" side="tl" part="lemq"/> 
	    </lu> 
	    <b pos="4"/>
	    <lu> 
	      <clip pos="3" side="tl" part="whole"/>
	    </lu> 
	    <b pos="5"/>
	    <lu> 
	      <var n="adjectiu1"/>   
	      <clip pos="4" side="tl" part="lemh"/> 
	      <clip pos="4" side="tl" part="a_adj"/>
	      <clip pos="6" side="tl" part="gen" link-to="3"/>
	      <clip pos="6" side="tl" part="nbr" link-to="4"/>
	      <clip pos="4" side="tl" part="lem4"/> 
	    </lu> 
	  </chunk>
	</out>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>

    <!-- FI SINTAGMES NOMINALS AMB DOS ADJS (ADJ ADJ)-->


    <!-- SINTAGMES NOMINALS AMB DOS ADJS COORDINATS-->

    <rule comment="REGLA: DET ADJ AND ADJ NOM (BCN)">
      <pattern>
	<pattern-item n="det"/>
	<pattern-item n="adj"/>
	<pattern-item n="cnjcoo"/>
	<pattern-item n="adj"/>
	<pattern-item n="nom"/>
      </pattern>
      <action>
	<call-macro n="genere_nombre">
	  <with-param pos="5"/>
	</call-macro>
	<call-macro n="det_no">
	  <with-param pos="1"/>
	  <with-param pos="5"/>
	</call-macro>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="comparatiu_adj1">
	  <with-param pos="2"/>
	</call-macro>
	<call-macro n="comparatiu_adj2">
	  <with-param pos="4"/>
	</call-macro>

	<out>
	  <chunk name="det_adj_conj_adj_nom" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN.DET"/></tag>
	      <tag><clip pos="5" side="tl" part="gen"/></tag>
	      <tag><clip pos="5" side="tl" part="nbr"/></tag>
	    </tags>
	    <lu>
	      <clip pos="1" side="tl" part="lem"/>
	      <clip pos="1" side="tl" part="a_det"/>
	      <clip pos="5" side="tl" part="gen" link-to="3"/>
	      <clip pos="5" side="tl" part="nbr" link-to="4"/>
	    </lu>
	    <b pos="1"/>
	    <lu>
	      <clip pos="5" side="tl" part="lemh"/>
	      <clip pos="5" side="tl" part="a_nom"/>
	      <clip pos="5" side="tl" part="gen" link-to="3"/>
	      <clip pos="5" side="tl" part="nbr" link-to="4"/>
	      <clip pos="5" side="tl" part="lemq"/>
	    </lu>
	    <b pos="2"/>
	    <lu>
	      <var n="adjectiu1"/>
	      <clip pos="2" side="tl" part="lemh"/> <!-- BCN cua PPs asj -->
	      <clip pos="2" side="tl" part="a_adj"/>
	      <clip pos="5" side="tl" part="gen" link-to="3"/>
	      <clip pos="5" side="tl" part="nbr" link-to="4"/>
	      <clip pos="2" side="tl" part="lemq"/> <!-- per a les possibles cues dels PPs --> 
	    </lu>
	    <b pos="3"/>
	    <lu>
	      <clip pos="3" side="tl" part="whole"/>
	    </lu>
	    <b pos="4"/>
	    <lu>
	      <var n="adjectiu2"/>
	      <clip pos="4" side="tl" part="lemh"/> <!-- BCN cua PPs asj-->
	      <clip pos="4" side="tl" part="a_adj"/>
	      <clip pos="5" side="tl" part="gen" link-to="3"/>
	      <clip pos="5" side="tl" part="nbr" link-to="4"/>
	      <clip pos="4" side="tl" part="lemq"/> <!-- per a les possibles cues dels PPs --> 
	    </lu>
	  </chunk>
	</out>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>


    <rule comment="REGLA: DET ADJ AND ADV ADJ NOM (BCN)">
      <pattern>
	<pattern-item n="det"/>
	<pattern-item n="adj"/>
	<pattern-item n="cnjcoo"/>
	<pattern-item n="adv_preadv"/>
	<pattern-item n="adj"/>
	<pattern-item n="nom"/>
      </pattern>
      <action>
	<call-macro n="genere_nombre">
	  <with-param pos="6"/>
	</call-macro>
	<call-macro n="det_no">
	  <with-param pos="1"/>
	  <with-param pos="6"/>
	</call-macro>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="comparatiu_adj1">
	  <with-param pos="2"/>
	</call-macro>
	<call-macro n="comparatiu_adj2">
	  <with-param pos="5"/>
	</call-macro>

	<out>
	  <chunk name="det_adj_conj_adj_nom" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN.DET"/></tag>
	      <tag><clip pos="6" side="tl" part="gen"/></tag>
	      <tag><clip pos="6" side="tl" part="nbr"/></tag>
	    </tags>
	    <lu>
	      <clip pos="1" side="tl" part="lem"/>
	      <clip pos="1" side="tl" part="a_det"/>
	      <clip pos="6" side="tl" part="gen" link-to="3"/>
	      <clip pos="6" side="tl" part="nbr" link-to="4"/>
	    </lu>
	    <b pos="1"/>
	    <lu>
	      <clip pos="6" side="tl" part="lemh"/>
	      <clip pos="6" side="tl" part="a_nom"/>
	      <clip pos="6" side="tl" part="gen" link-to="3"/>
	      <clip pos="6" side="tl" part="nbr" link-to="4"/>
	      <clip pos="6" side="tl" part="lemq"/>
	    </lu>
	    <b pos="2"/>
	    <lu>
	      <var n="adjectiu1"/>
	      <clip pos="2" side="tl" part="lemh"/> <!-- BCN cua PPs asj -->
	      <clip pos="2" side="tl" part="a_adj"/>
	      <clip pos="6" side="tl" part="gen" link-to="3"/>
	      <clip pos="6" side="tl" part="nbr" link-to="4"/>
	      <clip pos="2" side="tl" part="lemq"/> <!-- per a les possibles cues dels PPs --> 
	    </lu>
	    <b pos="3"/>
	    <lu>
	      <clip pos="3" side="tl" part="whole"/>
	    </lu>
	    <b pos="4"/>
	    <lu>
	      <clip pos="4" side="tl" part="whole"/>
	    </lu>
	    <b pos="5"/>
	    <lu>
	      <var n="adjectiu2"/>
	      <clip pos="5" side="tl" part="lemh"/> <!-- BCN cua PPs asj-->
	      <clip pos="5" side="tl" part="a_adj"/>
	      <clip pos="6" side="tl" part="gen" link-to="3"/>
	      <clip pos="6" side="tl" part="nbr" link-to="4"/>
	      <clip pos="5" side="tl" part="lemq"/> <!-- per a les possibles cues dels PPs --> 
	    </lu>
	  </chunk>
	</out>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>

    <rule comment="REGLA: DET ADV ADJ AND ADJ NOM (BCN: the most popular and largest city)">
      <pattern>
	<pattern-item n="det"/>
	<pattern-item n="adv_preadv"/>
	<pattern-item n="adj"/>
	<pattern-item n="cnjcoo"/>
	<pattern-item n="adj"/>
	<pattern-item n="nom"/>
      </pattern>
      <action>
	<call-macro n="genere_nombre">
	  <with-param pos="6"/>
	</call-macro>
	<call-macro n="det_no">
	  <with-param pos="1"/>
	  <with-param pos="6"/>
	</call-macro>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="comparatiu_adj1">
	  <with-param pos="3"/>
	</call-macro>
	<call-macro n="comparatiu_adj2">
	  <with-param pos="5"/>
	</call-macro>

	<out>
	  <chunk name="det_adv_adj_conj_adj_nom" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN.DET"/></tag>
	      <tag><clip pos="6" side="tl" part="gen"/></tag>
	      <tag><clip pos="6" side="tl" part="nbr"/></tag>
	    </tags>
	    <lu>
	      <clip pos="1" side="tl" part="lem"/>
	      <clip pos="1" side="tl" part="a_det"/>
	      <clip pos="6" side="tl" part="gen" link-to="3"/>
	      <clip pos="6" side="tl" part="nbr" link-to="4"/>
	    </lu>
	    <b pos="1"/>
	    <lu>
	      <clip pos="6" side="tl" part="lemh"/>
	      <clip pos="6" side="tl" part="a_nom"/>
	      <clip pos="6" side="tl" part="gen" link-to="3"/>
	      <clip pos="6" side="tl" part="nbr" link-to="4"/>
	      <clip pos="6" side="tl" part="lemq"/>
	    </lu>
	    <b pos="2"/>
	    <lu>
	      <clip pos="2" side="tl" part="whole"/>
	    </lu>
	    <b pos="3"/>
	    <lu>
	      <var n="adjectiu1"/>
	      <clip pos="3" side="tl" part="lemh"/> <!-- BCN cua PPs asj -->
	      <clip pos="3" side="tl" part="a_adj"/>
	      <clip pos="6" side="tl" part="gen" link-to="3"/>
	      <clip pos="6" side="tl" part="nbr" link-to="4"/>
	      <clip pos="3" side="tl" part="lemq"/> <!-- per a les possibles cues dels PPs --> 
	    </lu>
	    <b pos="4"/>
	    <lu>
	      <clip pos="4" side="tl" part="whole"/>
	    </lu>
	    <b pos="5"/>
	    <lu>
	      <var n="adjectiu2"/>
	      <clip pos="5" side="tl" part="lemh"/> <!-- BCN cua PPs asj-->
	      <clip pos="5" side="tl" part="a_adj"/>
	      <clip pos="6" side="tl" part="gen" link-to="3"/>
	      <clip pos="6" side="tl" part="nbr" link-to="4"/>
	      <clip pos="5" side="tl" part="lemq"/> <!-- per a les possibles cues dels PPs --> 
	    </lu>
	  </chunk>
	</out>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>

    <rule comment="REGLA: ADJ AND ADJ NOM (BCN)">
      <pattern>
	<pattern-item n="adj"/>
	<pattern-item n="cnjcoo"/>
	<pattern-item n="adj"/>
	<pattern-item n="nom"/>
      </pattern>
      <action>
	<call-macro n="genere_nombre">
	  <with-param pos="4"/>
	</call-macro>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="comparatiu_adj1">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="comparatiu_adj2">
	  <with-param pos="3"/>
	</call-macro>

	<out>
	  <chunk name="adj_conj_adj_nom" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN.DET"/></tag>
	      <tag><clip pos="4" side="tl" part="gen"/></tag>
	      <tag><clip pos="4" side="tl" part="nbr"/></tag>
	    </tags>
	    <lu>
	      <clip pos="4" side="tl" part="lemh"/>
	      <clip pos="4" side="tl" part="a_nom"/>
	      <clip pos="4" side="tl" part="gen" link-to="3"/>
	      <clip pos="4" side="tl" part="nbr" link-to="4"/>
	      <clip pos="4" side="tl" part="lemq"/>
	    </lu>
	    <b pos="1"/>
	    <lu>
	      <var n="adjectiu1"/>
	      <clip pos="1" side="tl" part="lemh"/> <!-- BCN cua PPs asj -->
	      <clip pos="1" side="tl" part="a_adj"/>
	      <clip pos="4" side="tl" part="gen" link-to="3"/>
	      <clip pos="4" side="tl" part="nbr" link-to="4"/>
	      <clip pos="1" side="tl" part="lemq"/> <!-- per a les possibles cues dels PPs --> 
	    </lu>
	    <b pos="2"/>
	    <lu>
	      <clip pos="2" side="tl" part="whole"/>
	    </lu>
	    <b pos="3"/>
	    <lu>
	      <var n="adjectiu2"/>
	      <clip pos="3" side="tl" part="lemh"/> <!-- BCN cua PPs asj -->
	      <clip pos="3" side="tl" part="a_adj"/>
	      <clip pos="4" side="tl" part="gen" link-to="3"/>
	      <clip pos="4" side="tl" part="nbr" link-to="4"/>
	      <clip pos="3" side="tl" part="lemq"/> <!-- per a les possibles cues dels PPs --> 
	    </lu>
	  </chunk>
	</out>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>

 <rule comment="REGLA: ADJ AND ADJ NOM">
      <pattern>
	<pattern-item n="adj"/>
	<pattern-item n="cnjcoo"/>
	<pattern-item n="adv"/>
	<pattern-item n="adj"/>
	<pattern-item n="nom"/>
      </pattern>
      <action>
	<call-macro n="genere_nombre">
	  <with-param pos="5"/>
	</call-macro>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="comparatiu_adj1">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="comparatiu_adj2">
	  <with-param pos="4"/>
	</call-macro>

	<out>
	  <chunk name="adj_conj_adj_adv_nom" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN.DET"/></tag>
	      <tag><clip pos="5" side="tl" part="gen"/></tag>
	      <tag><clip pos="5" side="tl" part="nbr"/></tag>
	    </tags>
	    <lu>
	      <clip pos="5" side="tl" part="lemh"/>
	      <clip pos="5" side="tl" part="a_nom"/>
	      <clip pos="5" side="tl" part="gen" link-to="3"/>
	      <clip pos="5" side="tl" part="nbr" link-to="4"/>
	      <clip pos="5" side="tl" part="lemq"/>
	    </lu>
	    <b pos="1"/>
	    <lu>
	      <var n="adjectiu1"/>
	      <clip pos="1" side="tl" part="lemh"/> 
	      <clip pos="1" side="tl" part="a_adj"/>
	      <clip pos="5" side="tl" part="gen" link-to="3"/>
	      <clip pos="5" side="tl" part="nbr" link-to="4"/>
	      <clip pos="1" side="tl" part="lemq"/>
	    </lu>
	    <b pos="2"/>
	    <lu>
	      <clip pos="2" side="tl" part="whole"/>
	    </lu>
	    <b pos="3"/>
	    <lu>
	      <var n="adjectiu2"/>
	      <clip pos="4" side="tl" part="lemh"/> 
	      <clip pos="4" side="tl" part="a_adj"/>
	      <clip pos="5" side="tl" part="gen" link-to="3"/>
	      <clip pos="5" side="tl" part="nbr" link-to="4"/>
	      <clip pos="4" side="tl" part="lemq"/>  
	    </lu>
	    <b pos="4"/>
	    <lu>
	      <clip pos="3" side="tl" part="whole"/>
	    </lu>
	  </chunk>
	</out>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>

    <!-- FI SINTAGMES NOMINALS AMB DOS ADJS COORDINATS-->


    <!-- SINTAGMES NOMINALS AMB DOS ADJS AMB COMA-->

    <rule comment="REGLA: DET ADJ, ADJ NOM (Those wild, wonderful places)">
      <pattern>
	<pattern-item n="det"/>
	<pattern-item n="adj"/>
	<pattern-item n="coma"/>
	<pattern-item n="adj"/>
	<pattern-item n="nom"/>
      </pattern>
      <action>
	<call-macro n="genere_nombre">
	  <with-param pos="5"/>
	</call-macro>
	<call-macro n="det_no">
	  <with-param pos="1"/>
	  <with-param pos="5"/>
	</call-macro>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="comparatiu_adj1">
	  <with-param pos="2"/>
	</call-macro>
	<call-macro n="comparatiu_adj2">
	  <with-param pos="4"/>
	</call-macro>
	<out> 
	  <chunk name="det_adj_cm_adj_nom" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN.DET"/></tag>
	      <tag><clip pos="5" side="tl" part="gen"/></tag>
	      <tag><clip pos="5" side="tl" part="nbr"/></tag>
	    </tags>
	    <lu>   
	      <clip pos="1" side="tl" part="lem"/> 
	      <clip pos="1" side="tl" part="a_det"/>
	      <clip pos="5" side="tl" part="gen" link-to="3"/>
	      <clip pos="5" side="tl" part="nbr" link-to="4"/>
	    </lu> 
	    <b pos="1"/>
	    <lu> 
	      <clip pos="5" side="tl" part="lemh"/> 
	      <clip pos="5" side="tl" part="a_nom"/>
	      <clip pos="5" side="tl" part="gen" link-to="3"/>
	      <clip pos="5" side="tl" part="nbr" link-to="4"/>
	      <clip pos="5" side="tl" part="lemq"/>  
	    </lu> 
	    <b pos="3"/>
	    <lu> 
	      <var n="adjectiu1"/>
	      <clip pos="2" side="tl" part="lemh"/> <!-- BCN cua PPs adj-->
	      <clip pos="2" side="tl" part="a_adj"/>
	      <clip pos="5" side="tl" part="gen" link-to="3"/>
	      <clip pos="5" side="tl" part="nbr" link-to="4"/>
	      <clip pos="2" side="tl" part="lemq"/> <!-- per a les possibles cues dels PPs --> 
	    </lu> 
	    <lu>
	      <clip pos="3" side="tl" part="whole"/> 
	    </lu>
	    <b pos="4"/>
	    <lu> 
	      <var n="adjectiu2"/>   
	      <clip pos="4" side="tl" part="lemh"/> 
	      <clip pos="4" side="tl" part="a_adj"/>
	      <clip pos="5" side="tl" part="gen" link-to="3"/>
	      <clip pos="5" side="tl" part="nbr" link-to="4"/>
	      <clip pos="4" side="tl" part="lemq"/> 
	    </lu> 
	  </chunk>
	</out>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>
    

    <rule comment="REGLA: ADJ, ADJ NOM (wild, wonderful places)">
      <pattern>
	<pattern-item n="adj"/>
	<pattern-item n="coma"/>
	<pattern-item n="adj"/>
	<pattern-item n="nom"/>
      </pattern>
      <action>
	<call-macro n="genere_nombre">
	  <with-param pos="4"/>
	</call-macro>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="comparatiu_adj1">
	  <with-param pos="1"/>
	</call-macro>  
	<call-macro n="comparatiu_adj2">
	  <with-param pos="3"/>
	</call-macro>  
	<out> 
	  <chunk name="adj_cm_adj_nom" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN.UNDET"/></tag>
	      <tag><clip pos="4" side="tl" part="gen"/></tag>
	      <tag><clip pos="4" side="tl" part="nbr"/></tag>
	    </tags>
	    <lu> 
	      <clip pos="4" side="tl" part="lemh"/> 
	      <clip pos="4" side="tl" part="a_nom"/>
	      <clip pos="4" side="tl" part="gen" link-to="3"/>
	      <clip pos="4" side="tl" part="nbr" link-to="4"/>
	      <clip pos="4" side="tl" part="lemq"/>  
	    </lu> 
	    <b pos="2"/>
	    <lu> 
	      <var n="adjectiu1"/>   
	      <clip pos="1" side="tl" part="lemh"/> 
	      <clip pos="1" side="tl" part="a_adj"/>
	      <clip pos="4" side="tl" part="gen" link-to="3"/>
	      <clip pos="4" side="tl" part="nbr" link-to="4"/>
	      <clip pos="1" side="tl" part="lemq"/> 
	    </lu> 
	    <lu>
	      <clip pos="2" side="tl" part="whole"/> 
	    </lu>
	    <b pos="3"/>
	    <lu> 
	      <var n="adjectiu2"/>   
	      <clip pos="3" side="tl" part="lemh"/> 
	      <clip pos="3" side="tl" part="a_adj"/>
	      <clip pos="4" side="tl" part="gen" link-to="3"/>
	      <clip pos="4" side="tl" part="nbr" link-to="4"/>
	      <clip pos="3" side="tl" part="lemq"/> 
	    </lu> 
	  </chunk>
	</out>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>

    <!-- FI SINTAGMES NOMINALS AMB DOS ADJS AMB COMA-->



    <!-- SINTAGMES NOMINALS AMB APOS-->

    <rule comment="REGLA:  APOS ADJ APOS NOM">
      <pattern>
	<pattern-item n="apos"/>
	<pattern-item n="adj"/>
	<pattern-item n="apos"/>
	<pattern-item n="nom"/>
      </pattern>
      <action>
	<call-macro n="genere_nombre">
	  <with-param pos="4"/>
	</call-macro>
	<call-macro n="firstWord">
	  <with-param pos="2"/>
	</call-macro>
	<call-macro n="comparatiu_adj1">
	  <with-param pos="2"/>
	</call-macro>
	<out>
	  <chunk name="adj_nom" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN.UNDET"/></tag>
	      <tag><clip pos="4" side="tl" part="gen"/></tag>
	      <tag><clip pos="4" side="tl" part="nbr"/></tag>
	    </tags>
	    <lu>
	      <clip pos="4" side="tl" part="lemh"/>
	      <clip pos="4" side="tl" part="a_nom"/>
	      <clip pos="4" side="tl" part="gen" link-to="3"/>
	      <clip pos="4" side="tl" part="nbr" link-to="4"/>
	      <clip pos="4" side="tl" part="lemq"/>
	    </lu>
	    <b pos="3"/>
	    <lu>
	      <clip pos="1" side="tl" part="whole"/> 
	    </lu>
	    <lu>  
	      <var n="adjectiu1"/> 
	      <clip pos="2" side="tl" part="lemh"/> <!--BCN no la cua dels PP adj-->
	      <clip pos="2" side="tl" part="a_adj"/>
	      <clip pos="4" side="tl" part="gen" link-to="3"/>
	      <clip pos="4" side="tl" part="nbr" link-to="4"/>
	      <clip pos="2" side="tl" part="lemq"/> <!-- per a les possibles cues dels PPs --> 
	    </lu> 
	    <lu>
	      <clip pos="3" side="tl" part="whole"/> 
	    </lu>
	    
	  </chunk>
	</out>
      </action>
    </rule>
    
    <rule comment="REGLA: ADJ APOS NOM APOS">
      <pattern>
	<pattern-item n="adj"/>
	<pattern-item n="apos"/>
	<pattern-item n="nom"/>
	<pattern-item n="apos"/>
	
      </pattern>
      <action>
	<call-macro n="genere_nombre">
	  <with-param pos="3"/>
	</call-macro>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="comparatiu_adj1">
	  <with-param pos="1"/>
	</call-macro>
	<out>
	  <chunk name="adj_nom" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN.UNDET"/></tag>
	      <tag><clip pos="3" side="tl" part="gen"/></tag>
	      <tag><clip pos="3" side="tl" part="nbr"/></tag>
	    </tags>
	    <lu>
	      <clip pos="2" side="tl" part="whole"/>
	    </lu>
	    <lu>
	      <clip pos="3" side="tl" part="lemh"/>
	      <clip pos="3" side="tl" part="a_nom"/>
	      <clip pos="3" side="tl" part="gen" link-to="3"/>
	      <clip pos="3" side="tl" part="nbr" link-to="4"/>
	      <clip pos="3" side="tl" part="lemq"/> <!--BCN faltava-->
	    </lu>
	    <lu>
	      <clip pos="4" side="tl" part="whole"/>
	    </lu>
	    <b pos="1"/>	  
	    <lu>  
	      <var n="adjectiu1"/> 
	      <clip pos="1" side="tl" part="lemh"/><!-- BCN-->
	      <clip pos="1" side="tl" part="a_adj"/>
	      <clip pos="2" side="tl" part="gen" link-to="3"/>
	      <clip pos="2" side="tl" part="nbr" link-to="4"/>
	      <clip pos="1" side="tl" part="lemq"/><!-- BCN-->
	    </lu> 
	  </chunk>
	</out>
      </action>
    </rule>


    <rule comment="REGLA: DET ADJ APOS 'NOM' APOS">
      <pattern>
	<pattern-item n="det"/>
	<pattern-item n="adj"/>
	<pattern-item n="apos"/>
	<pattern-item n="nom"/>
	<pattern-item n="apos"/>
      </pattern>
      <action>
	<call-macro n="genere_nombre">
	  <with-param pos="3"/>
	</call-macro>
	<call-macro n="det_no">
	  <with-param pos="1"/>
	  <with-param pos="3"/>
	</call-macro>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="comparatiu_adj1">
	  <with-param pos="2"/>
	</call-macro>  
	<out> 
	  <chunk name="det_adj_nom" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN.DET"/></tag>
	      <tag><clip pos="4" side="tl" part="gen"/></tag>
	      <tag><clip pos="4" side="tl" part="nbr"/></tag>
	    </tags>
	    <lu>   
	      <clip pos="1" side="tl" part="lem"/> 
	      <clip pos="1" side="tl" part="a_det"/>
	      <clip pos="4" side="tl" part="gen" link-to="3"/>
	      <clip pos="4" side="tl" part="nbr" link-to="4"/>
	    </lu> 
	    <b pos="1"/>
	    <lu>
	      <clip pos="3" side="tl" part="whole"/> 
	    </lu>
	    
	    <lu> 
	      <clip pos="4" side="tl" part="lemh"/> 
	      <clip pos="4" side="tl" part="a_nom"/>
	      <clip pos="4" side="tl" part="gen" link-to="3"/>
	      <clip pos="4" side="tl" part="nbr" link-to="4"/>
	      <clip pos="4" side="tl" part="lemq"/>  
	    </lu> 
	    <lu>
	      <clip pos="5" side="tl" part="whole"/> 
	    </lu>
	    
	    <b pos="2"/>
	    <lu> 
	      <var n="adjectiu1"/>   
	      <clip pos="2" side="tl" part="lemh"/> 
	      <clip pos="2" side="tl" part="a_adj"/>
	      <clip pos="4" side="tl" part="gen" link-to="3"/>
	      <clip pos="4" side="tl" part="nbr" link-to="4"/>
	      <clip pos="2" side="tl" part="lemq"/> 
	    </lu> 
	  </chunk>
	</out>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>
    
    <rule comment="REGLA: DET APOS 'ADJ' APOS NOM">
      <pattern>
	<pattern-item n="det"/>
	<pattern-item n="apos"/>
	<pattern-item n="adj"/>
	<pattern-item n="apos"/>
	<pattern-item n="nom"/>
      </pattern>
      <action>
	<call-macro n="genere_nombre">
	  <with-param pos="5"/>
	</call-macro>
	<call-macro n="det_no">
	  <with-param pos="1"/>
	  <with-param pos="5"/>
	</call-macro>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="comparatiu_adj1">
	  <with-param pos="3"/>
	</call-macro>  
	<out> 
	  <chunk name="det_adj_nom" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN.DET"/></tag>
	      <tag><clip pos="5" side="tl" part="gen"/></tag>
	      <tag><clip pos="5" side="tl" part="nbr"/></tag>
	    </tags>
	    <lu>   
	      <clip pos="1" side="tl" part="lem"/> 
	      <clip pos="1" side="tl" part="a_det"/>
	      <clip pos="5" side="tl" part="gen" link-to="3"/>
	      <clip pos="5" side="tl" part="nbr" link-to="4"/>
	    </lu> 
	    <b pos="1"/>
	    <lu> 
	      <clip pos="5" side="tl" part="lemh"/> 
	      <clip pos="5" side="tl" part="a_nom"/>
	      <clip pos="5" side="tl" part="gen" link-to="3"/>
	      <clip pos="5" side="tl" part="nbr" link-to="4"/>
	      <clip pos="5" side="tl" part="lemq"/>  
	    </lu> 
	    <b pos="4"/>
	    <lu>
	      <clip pos="2" side="tl" part="whole"/> 
	    </lu>
	    <lu> 
	      <var n="adjectiu1"/>   
	      <clip pos="3" side="tl" part="lemh"/> 
	      <clip pos="3" side="tl" part="a_adj"/>
	      <clip pos="5" side="tl" part="gen" link-to="3"/>
	      <clip pos="5" side="tl" part="nbr" link-to="4"/>
	      <clip pos="3" side="tl" part="lemq"/> 
	    </lu> 
	    <lu>
	      <clip pos="4" side="tl" part="whole"/> 
	    </lu>
	  </chunk>
	</out>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
	
      </action>
    </rule>

    <!-- FI SINTAGMES NOMINALS AMB APOS-->


    <!-- SINTAGMES NOMINALS AMB MES D'UN NOM-->


    <rule comment="REGLA: NOM1 NOM2 -> NOM2 de NOM1">
      <pattern>
	<pattern-item n="nom"/>
	<pattern-item n="nom"/>
      </pattern>
      <action>
	<call-macro n="genere_nombre">
	  <with-param pos="2"/>
	</call-macro>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<choose>
	  <when>
	    <test>
	      <not>
		<or>
		  <equal>
		    <clip pos="2" side="tl" part="a_nom"/>
		    <lit-tag v="np.ant"/>
		  </equal>
		  <equal>
		    <clip pos="2" side="tl" part="a_nom"/>
		    <lit-tag v="np.cog"/>
		  </equal>
		</or>
	      </not>
	    </test>
	    <out> 
	      <chunk name="nom_nom" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="SN.UNDET"/></tag>
		  <tag><clip pos="2" side="tl" part="gen"/></tag>
		  <tag><clip pos="2" side="tl" part="nbr"/></tag>
		</tags>
		<lu> 
		  <clip pos="2" side="tl" part="lemh"/> 
		  <clip pos="2" side="tl" part="a_nom"/>
		  <clip pos="2" side="tl" part="gen" link-to="3"/>
		  <clip pos="2" side="tl" part="nbr" link-to="4"/>
		  <clip pos="2" side="tl" part="lemq"/>  
		</lu> 
		<b pos="1"/>
		<lu>
		  <lit v="de"/>
		  <lit-tag v="pr"/>
		</lu>
		<b/>
		<lu> 
		  <clip pos="1" side="tl" part="lemh"/> 
		  <clip pos="1" side="tl" part="a_nom"/>
		  <clip pos="1" side="tl" part="gen"/>
		  <clip pos="1" side="tl" part="nbr"/>
		  <clip pos="1" side="tl" part="lemq"/>  
		</lu> 
	      </chunk>
	    </out>
	  </when>
	  <otherwise>
	    <out>
	      <chunk name="nom_nom" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="SN.UNDET"/></tag>
		  <tag><clip pos="1" side="tl" part="gen"/></tag>
		  <tag><clip pos="1" side="tl" part="nbr"/></tag>
		</tags>
		<lu> 
		  <clip pos="1" side="tl" part="lemh"/> 
		  <clip pos="1" side="tl" part="a_nom"/>
		  <clip pos="1" side="tl" part="gen" link-to="3"/>
		  <clip pos="1" side="tl" part="nbr" link-to="4"/>
		  <clip pos="1" side="tl" part="lemq"/>  
		</lu> 
		<b pos="1"/>
		<lu> 
		  <clip pos="2" side="tl" part="lemh"/> 
		  <clip pos="2" side="tl" part="a_nom"/>
		  <clip pos="2" side="tl" part="gen"/>
		  <clip pos="2" side="tl" part="nbr"/>
		  <clip pos="2" side="tl" part="lemq"/>  
		</lu> 
	      </chunk>
	    </out>
	  </otherwise>
	</choose>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>

    <rule comment="REGLA: DET NOM1 NOM2 -> DET NOM2 de NOM1">
      <pattern>
	<pattern-item n="det"/>
	<pattern-item n="nom"/>
	<pattern-item n="nom"/>
      </pattern>
      <action>
	<call-macro n="genere_nombre">
	  <with-param pos="3"/>
	</call-macro>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<choose>
	  <when>
	    <test>
	      <not>
		<or>
		  <equal>
		    <clip pos="3" side="tl" part="a_nom"/>
		    <lit-tag v="np.ant"/>
		  </equal>
		  <equal>
		    <clip pos="3" side="tl" part="a_nom"/>
		    <lit-tag v="np.cog"/>
		  </equal>
		</or>
	      </not>
	    </test>
	    <out> 
	      <chunk name="det_nom_nom" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="SN.DET"/></tag>
		  <tag><clip pos="3" side="tl" part="gen"/></tag>
		  <tag><clip pos="3" side="tl" part="nbr"/></tag>
		</tags>
		<lu>   
		  <clip pos="1" side="tl" part="lem"/> 
		  <clip pos="1" side="tl" part="a_det"/>
		  <clip pos="3" side="tl" part="gen" link-to="3"/>
		  <clip pos="3" side="tl" part="nbr" link-to="4"/>
		</lu> 
		<b pos="1"/>
		<lu> 
		  <clip pos="3" side="tl" part="lemh"/> 
		  <clip pos="3" side="tl" part="a_nom"/>
		  <clip pos="3" side="tl" part="gen" link-to="3"/>
		  <clip pos="3" side="tl" part="nbr" link-to="4"/>
		  <clip pos="3" side="tl" part="lemq"/>  
		</lu> 
		<b pos="2"/>
		<lu>
		  <lit v="de"/>
		  <lit-tag v="pr"/>
		</lu>
		<b/>
		<lu>   
		  <clip pos="2" side="tl" part="lemh"/> 
		  <clip pos="2" side="tl" part="a_nom"/>
		  <clip pos="2" side="tl" part="gen"/>
		  <clip pos="2" side="tl" part="nbr"/>
		  <clip pos="2" side="tl" part="lemq"/>
		</lu> 
	      </chunk>
	    </out>
	  </when>
	  <otherwise><!--'his son James' no fa canvi d'ordre del nom -->
	    <out> 
	      <chunk name="det_nom_nom" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="SN.DET"/></tag>
		  <tag><clip pos="2" side="tl" part="gen"/></tag>
		  <tag><clip pos="2" side="tl" part="nbr"/></tag>
		</tags>
		<lu>   
		  <clip pos="1" side="tl" part="lem"/> 
		  <clip pos="1" side="tl" part="a_det"/>
		  <clip pos="2" side="tl" part="gen" link-to="3"/>
		  <clip pos="2" side="tl" part="nbr" link-to="4"/>
		</lu> 
		<b pos="1"/>
		<lu> 
		  <clip pos="2" side="tl" part="lemh"/> 
		  <clip pos="2" side="tl" part="a_nom"/>
		  <clip pos="2" side="tl" part="gen" link-to="3"/>
		  <clip pos="2" side="tl" part="nbr" link-to="4"/>
		  <clip pos="2" side="tl" part="lemq"/>  
		</lu> 
		<b pos="2"/>
		<lu>   
		  <clip pos="3" side="tl" part="lemh"/> 
		  <clip pos="3" side="tl" part="a_nom"/>
		  <clip pos="3" side="tl" part="gen"/>
		  <clip pos="3" side="tl" part="nbr"/>
		  <clip pos="3" side="tl" part="lemq"/>
		</lu> 
	      </chunk>
	    </out>
	  </otherwise>
	</choose>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>

    <rule comment="REGLA: NUM NOM1 NOM2 -> NUM NOM2 de NOM1 (Three street chairs)">
      <pattern>
	<pattern-item n="num"/>
	<pattern-item n="nom"/>
	<pattern-item n="nom"/>
      </pattern>
      <action>
	<call-macro n="genere_nombre">
	  <with-param pos="3"/>
	</call-macro>
	<call-macro n="million">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="flexio_numerals">
	  <with-param pos="1"/>
	  <with-param pos="3"/>
	</call-macro>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<out> 
	  <chunk name="num_nom_nom" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN.NUM"/></tag>
	      <tag><clip pos="3" side="tl" part="gen"/></tag>
	      <tag><clip pos="3" side="tl" part="nbr"/></tag>
	    </tags>
	    <lu>   
	      <clip pos="1" side="tl" part="lem"/> 
	      <clip pos="1" side="tl" part="a_num"/>
	      <clip pos="1" side="tl" part="gen"/>
	      <clip pos="1" side="tl" part="nbr"/>
	    </lu> 
	    <b pos="1"/>
	    <lu> 
	      <clip pos="3" side="tl" part="lemh"/> 
	      <clip pos="3" side="tl" part="a_nom"/>
	      <clip pos="3" side="tl" part="gen" link-to="3"/>
	      <clip pos="3" side="tl" part="nbr" link-to="4"/>
	      <clip pos="3" side="tl" part="lemq"/>  
	    </lu> 
	    <b pos="2"/>
	    <lu>
	      <lit v="de"/>
	      <lit-tag v="pr"/>
	    </lu>
	    <b/>
	    <lu>   
	      <clip pos="2" side="tl" part="lemh"/> 
	      <clip pos="2" side="tl" part="a_nom"/>
	      <clip pos="2" side="tl" part="gen"/>
	      <clip pos="2" side="tl" part="nbr"/>
	      <clip pos="2" side="tl" part="lemq"/>
	    </lu> 
	  </chunk>
	</out>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>

    <rule comment="REGLA: NUM-NOM1 NOM2 -> NOM2 de NUM NOM1(pl) (Three-month extension - extensió de tres mesos)">
      <pattern>
	<pattern-item n="num"/>
	<pattern-item n="guio"/>
	<pattern-item n="nom"/>
	<pattern-item n="nom"/>
      </pattern>
      <action>
	<call-macro n="genere_nombre">
	  <with-param pos="4"/>
	</call-macro>
	<call-macro n="million">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="flexio_numerals">
	  <with-param pos="1"/>
	  <with-param pos="3"/>
	</call-macro>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<out> 
	  <chunk name="num_nom_nom" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN.NUM"/></tag>
	      <tag><clip pos="4" side="tl" part="gen"/></tag>
	      <tag><clip pos="4" side="tl" part="nbr"/></tag>
	    </tags>	
	    <lu> 
	      <clip pos="4" side="tl" part="lemh"/> 
	      <clip pos="4" side="tl" part="a_nom"/>
	      <clip pos="4" side="tl" part="gen" link-to="3"/>
	      <clip pos="4" side="tl" part="nbr" link-to="4"/>
	      <clip pos="4" side="tl" part="lemq"/>  
	    </lu> 
	    <b pos="3"/>
	    <lu>
	      <lit v="de"/>
	      <lit-tag v="pr"/>
	    </lu>
	    <b/>
	    <lu>   
	      <clip pos="1" side="tl" part="lem"/> 
	      <clip pos="1" side="tl" part="a_num"/>
	      <clip pos="1" side="tl" part="gen"/>
	      <clip pos="1" side="tl" part="nbr"/>
	    </lu> 
	    <b/> 
	    <lu>   
	      <clip pos="3" side="tl" part="lemh"/> 
	      <clip pos="3" side="tl" part="a_nom"/>
	      <clip pos="3" side="tl" part="gen"/>
	      <lit-tag v="pl"/><!--MG: atenció! i quan és 'one-month'? - arreglar -->
	      <clip pos="3" side="tl" part="lemq"/>
	    </lu> 
	  </chunk>
	</out>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>


    <rule comment="REGLA: ADJ-NOM1 NOM2 -> NOM2 de NOM1 ADJ (BCN open-source software)">
      <pattern>
	<pattern-item n="adj"/>
	<pattern-item n="guio"/>
	<pattern-item n="nom"/>
	<pattern-item n="nom"/>
      </pattern>
      <action>
	<call-macro n="genere_nombre">
	  <with-param pos="4"/>
	</call-macro>
	<call-macro n="comparatiu_adj1">
	  <with-param pos="2"/>
	</call-macro>

	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<out> 
	  <chunk name="adj_nom_nom" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN.UNDET"/></tag>
	      <tag><clip pos="4" side="tl" part="gen"/></tag>
	      <tag><clip pos="4" side="tl" part="nbr"/></tag>
	    </tags>	
	    <lu> 
	      <clip pos="4" side="tl" part="lemh"/> 
	      <clip pos="4" side="tl" part="a_nom"/>
	      <clip pos="4" side="tl" part="gen" link-to="3"/>
	      <clip pos="4" side="tl" part="nbr" link-to="4"/>
	      <clip pos="4" side="tl" part="lemq"/>  
	    </lu> 
	    <b pos="3"/>
	    <lu>
	      <lit v="de"/>
	      <lit-tag v="pr"/>
	    </lu>
	    <b/>
	    <lu>   
	      <clip pos="3" side="tl" part="lemh"/> 
	      <clip pos="3" side="tl" part="a_nom"/>
	      <clip pos="3" side="tl" part="gen"/>
	      <clip pos="3" side="tl" part="nbr"/>
	      <clip pos="3" side="tl" part="lemq"/>
	    </lu> 
	    <b/> 
	    <lu>   
	      <clip pos="1" side="tl" part="lem"/> 
	      <clip pos="1" side="tl" part="a_adj"/>
	      <clip pos="3" side="tl" part="gen" />
	      <clip pos="3" side="tl" part="nbr" />
	    </lu> 
	    <b/> 

	  </chunk>
	</out>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>


    <rule comment="REGLA: DET ADJ-NOM1 NOM2 -> DET NOM2 de NOM1 ADJ (BCN open-source software)">
      <pattern>
	<pattern-item n="det"/>
	<pattern-item n="adj"/>
	<pattern-item n="guio"/>
	<pattern-item n="nom"/>
	<pattern-item n="nom"/>
      </pattern>
      <action>
	<call-macro n="genere_nombre">
	  <with-param pos="5"/>
	</call-macro>
	<call-macro n="det_no">
	  <with-param pos="1"/>
	  <with-param pos="4"/>
	</call-macro>
	<call-macro n="comparatiu_adj1">
	  <with-param pos="2"/>
	</call-macro>

	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<out> 
	  <chunk name="det_adj_nom_nom" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN.UNDET"/></tag>
	      <tag><clip pos="5" side="tl" part="gen"/></tag>
	      <tag><clip pos="5" side="tl" part="nbr"/></tag>
	    </tags>	
	    <lu>
	      <clip pos="1" side="tl" part="lem"/>
	      <clip pos="1" side="tl" part="a_det"/>
	      <clip pos="5" side="tl" part="gen" link-to="3"/>
	      <clip pos="5" side="tl" part="nbr" link-to="4"/>
	    </lu>
	    <b/> 
	    <lu> 
	      <clip pos="5" side="tl" part="lemh"/> 
	      <clip pos="5" side="tl" part="a_nom"/>
	      <clip pos="5" side="tl" part="gen" link-to="3"/>
	      <clip pos="5" side="tl" part="nbr" link-to="4"/>
	      <clip pos="5" side="tl" part="lemq"/>  
	    </lu> 
	    <b/>
	    <b pos="3"/>
	    <lu>
	      <lit v="de"/>
	      <lit-tag v="pr"/>
	    </lu>
	    <b/>
	    <lu>   
	      <clip pos="4" side="tl" part="lemh"/> 
	      <clip pos="4" side="tl" part="a_nom"/>
	      <clip pos="4" side="tl" part="gen"/>
	      <clip pos="4" side="tl" part="nbr"/>
	      <clip pos="4" side="tl" part="lemq"/>
	    </lu> 
	    <b/> 
	    <lu>   
	      <clip pos="2" side="tl" part="lem"/> 
	      <clip pos="2" side="tl" part="a_adj"/>
	      <clip pos="4" side="tl" part="gen" />
	      <clip pos="4" side="tl" part="nbr" />
	    </lu> 
	    <b/> 

	  </chunk>
	</out>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>



    <rule comment="REGLA: NUM ADJ-NOM1 NOM2 -> NOM NOM2 de NOM1 ADJ (BCN open-source software)">
      <pattern>
	<pattern-item n="num"/>
	<pattern-item n="adj"/>
	<pattern-item n="guio"/>
	<pattern-item n="nom"/>
	<pattern-item n="nom"/>
      </pattern>
      <action>
	<call-macro n="genere_nombre">
	  <with-param pos="5"/>
	</call-macro>
	<call-macro n="million">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="flexio_numerals">
	  <with-param pos="1"/>
	  <with-param pos="5"/>
	</call-macro>

	<call-macro n="comparatiu_adj1">
	  <with-param pos="2"/>
	</call-macro>

	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<out> 
	  <chunk name="num_adj_nom_nom" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN.DET"/></tag>
	      <tag><clip pos="5" side="tl" part="gen"/></tag>
	      <tag><clip pos="5" side="tl" part="nbr"/></tag>
	    </tags>	
	    <lu>
	      <clip pos="1" side="tl" part="lem"/>
	      <clip pos="1" side="tl" part="a_num"/>
	      <clip pos="1" side="tl" part="gen" />
	      <clip pos="1" side="tl" part="nbr" />
	    </lu>
	    <b/> 
	    <lu> 
	      <clip pos="5" side="tl" part="lemh"/> 
	      <clip pos="5" side="tl" part="a_nom"/>
	      <clip pos="5" side="tl" part="gen" link-to="3"/>
	      <clip pos="5" side="tl" part="nbr" link-to="4"/>
	      <clip pos="5" side="tl" part="lemq"/>  
	    </lu> 
	    <b/>
	    <b pos="3"/>
	    <lu>
	      <lit v="de"/>
	      <lit-tag v="pr"/>
	    </lu>
	    <b/>
	    <lu>   
	      <clip pos="4" side="tl" part="lemh"/> 
	      <clip pos="4" side="tl" part="a_nom"/>
	      <clip pos="4" side="tl" part="gen"/>
	      <clip pos="4" side="tl" part="nbr"/>
	      <clip pos="4" side="tl" part="lemq"/>
	    </lu> 
	    <b/> 
	    <lu>   
	      <clip pos="2" side="tl" part="lem"/> 
	      <clip pos="2" side="tl" part="a_adj"/>
	      <clip pos="4" side="tl" part="gen" />
	      <clip pos="4" side="tl" part="nbr" />
	    </lu> 
	    <b/> 

	  </chunk>
	</out>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>


    <rule comment="REGLA: ADJ-NOM1 NOM2 NOM3-> NOM3 de NOM1 NOM ADJ (BCN open-source software systems)">
      <pattern>
	<pattern-item n="adj"/>
	<pattern-item n="guio"/>
	<pattern-item n="nom"/>
	<pattern-item n="nom"/>
	<pattern-item n="nom"/>
      </pattern>
      <action>
	<call-macro n="genere_nombre">
	  <with-param pos="5"/>
	</call-macro>
	<call-macro n="comparatiu_adj1">
	  <with-param pos="2"/>
	</call-macro>

	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<out> 
	  <chunk name="adj_nom_nom" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN.UNDET"/></tag>
	      <tag><clip pos="5" side="tl" part="gen"/></tag>
	      <tag><clip pos="5" side="tl" part="nbr"/></tag>
	    </tags>	
	    <lu> 
	      <clip pos="5" side="tl" part="lemh"/> 
	      <clip pos="5" side="tl" part="a_nom"/>
	      <clip pos="5" side="tl" part="gen" link-to="3"/>
	      <clip pos="5" side="tl" part="nbr" link-to="4"/>
	      <clip pos="5" side="tl" part="lemq"/>  
	    </lu> 
	    <b pos="1"/>
	    <b/>
	    <lu>
	      <lit v="de"/>
	      <lit-tag v="pr"/>
	    </lu>
	    <b/>
	    <lu> 
	      <clip pos="4" side="tl" part="lemh"/> 
	      <clip pos="4" side="tl" part="a_nom"/>
	      <clip pos="4" side="tl" part="gen" />
	      <clip pos="4" side="tl" part="nbr" />
	      <clip pos="4" side="tl" part="lemq"/>  
	    </lu> 
	    <b pos="2"/>
	    <b/>
	    <lu>
	      <lit v="de"/>
	      <lit-tag v="pr"/>
	    </lu>
	    <b/>
	    <lu>   
	      <clip pos="3" side="tl" part="lemh"/> 
	      <clip pos="3" side="tl" part="a_nom"/>
	      <clip pos="3" side="tl" part="gen"/>
	      <clip pos="3" side="tl" part="nbr"/>
	      <clip pos="3" side="tl" part="lemq"/>
	    </lu> 
	    <b/> 
	    <lu>   
	      <clip pos="1" side="tl" part="lem"/> 
	      <clip pos="1" side="tl" part="a_adj"/>
	      <clip pos="3" side="tl" part="gen" />
	      <clip pos="3" side="tl" part="nbr" />
	    </lu> 
	    <b/> 

	  </chunk>
	</out>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>


    <rule comment="REGLA: DET ADJ-NOM1 NOM2 NOM3-> NOM3 de NOM1 NOM ADJ (BCN open-source software systems)">
      <pattern>
	<pattern-item n="det"/>
	<pattern-item n="adj"/>
	<pattern-item n="guio"/>
	<pattern-item n="nom"/>
	<pattern-item n="nom"/>
	<pattern-item n="nom"/>
      </pattern>
      <action>
	<call-macro n="genere_nombre">
	  <with-param pos="6"/>
	</call-macro>
	<call-macro n="comparatiu_adj1">
	  <with-param pos="3"/>
	</call-macro>
	<call-macro n="det_no">
	  <with-param pos="1"/>
	  <with-param pos="6"/>
	</call-macro>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<out> 
	  <chunk name="adj_nom_nom" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN.UNDET"/></tag>
	      <tag><clip pos="6" side="tl" part="gen"/></tag>
	      <tag><clip pos="6" side="tl" part="nbr"/></tag>
	    </tags>	

	    <lu>
	      <clip pos="1" side="tl" part="lem"/>
	      <clip pos="1" side="tl" part="a_det"/>
	      <clip pos="6" side="tl" part="gen" link-to="3"/>
	      <clip pos="6" side="tl" part="nbr" link-to="4"/>
	    </lu>
	    <b pos="1"/>
	    <lu> 
	      <clip pos="6" side="tl" part="lemh"/> 
	      <clip pos="6" side="tl" part="a_nom"/>
	      <clip pos="6" side="tl" part="gen" link-to="3"/>
	      <clip pos="6" side="tl" part="nbr" link-to="4"/>
	      <clip pos="6" side="tl" part="lemq"/>  
	    </lu> 
	    <b pos="2"/>
	    <b/>
	    <lu>
	      <lit v="de"/>
	      <lit-tag v="pr"/>
	    </lu>
	    <b/>
	    <lu> 
	      <clip pos="5" side="tl" part="lemh"/> 
	      <clip pos="5" side="tl" part="a_nom"/>
	      <clip pos="5" side="tl" part="gen" />
	      <clip pos="5" side="tl" part="nbr" />
	      <clip pos="5" side="tl" part="lemq"/>  
	    </lu> 
	    <b pos="3"/>
	    <b/>
	    <lu>
	      <lit v="de"/>
	      <lit-tag v="pr"/>
	    </lu>
	    <b/>
	    <lu>   
	      <clip pos="4" side="tl" part="lemh"/> 
	      <clip pos="4" side="tl" part="a_nom"/>
	      <clip pos="4" side="tl" part="gen"/>
	      <clip pos="4" side="tl" part="nbr"/>
	      <clip pos="4" side="tl" part="lemq"/>
	    </lu> 
	    <b/> 
	    <lu>   
	      <clip pos="2" side="tl" part="lem"/> 
	      <clip pos="2" side="tl" part="a_adj"/>
	      <clip pos="4" side="tl" part="gen" />
	      <clip pos="4" side="tl" part="nbr" />
	    </lu> 
	    <b/> 

	  </chunk>
	</out>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>


    <rule comment="REGLA: NUM ADJ-NOM1 NOM2 NOM3-> NOM3 de NOM1 NOM ADJ (BCN open-source software systems)">
      <pattern>
	<pattern-item n="num"/>
	<pattern-item n="adj"/>
	<pattern-item n="guio"/>
	<pattern-item n="nom"/>
	<pattern-item n="nom"/>
	<pattern-item n="nom"/>
      </pattern>
      <action>
	<call-macro n="genere_nombre">
	  <with-param pos="6"/>
	</call-macro>

	<call-macro n="million">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="flexio_numerals">
	  <with-param pos="1"/>
	  <with-param pos="6"/>
	</call-macro>
	<call-macro n="comparatiu_adj1">
	  <with-param pos="3"/>
	</call-macro>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<out> 
	  <chunk name="adj_nom_nom" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN.UNDET"/></tag>
	      <tag><clip pos="6" side="tl" part="gen"/></tag>
	      <tag><clip pos="6" side="tl" part="nbr"/></tag>
	    </tags>	

	    <lu>
	      <clip pos="1" side="tl" part="lem"/>
	      <clip pos="1" side="tl" part="a_num"/>
	      <clip pos="1" side="tl" part="gen" />
	      <clip pos="1" side="tl" part="nbr" />
	    </lu>
	    <b pos="1"/>
	    <lu> 
	      <clip pos="6" side="tl" part="lemh"/> 
	      <clip pos="6" side="tl" part="a_nom"/>
	      <clip pos="6" side="tl" part="gen" link-to="3"/>
	      <clip pos="6" side="tl" part="nbr" link-to="4"/>
	      <clip pos="6" side="tl" part="lemq"/>  
	    </lu> 
	    <b pos="2"/>
	    <b/>
	    <lu>
	      <lit v="de"/>
	      <lit-tag v="pr"/>
	    </lu>
	    <b/>
	    <lu> 
	      <clip pos="5" side="tl" part="lemh"/> 
	      <clip pos="5" side="tl" part="a_nom"/>
	      <clip pos="5" side="tl" part="gen" />
	      <clip pos="5" side="tl" part="nbr" />
	      <clip pos="5" side="tl" part="lemq"/>  
	    </lu> 
	    <b pos="3"/>
	    <b/>
	    <lu>
	      <lit v="de"/>
	      <lit-tag v="pr"/>
	    </lu>
	    <b/>
	    <lu>   
	      <clip pos="4" side="tl" part="lemh"/> 
	      <clip pos="4" side="tl" part="a_nom"/>
	      <clip pos="4" side="tl" part="gen"/>
	      <clip pos="4" side="tl" part="nbr"/>
	      <clip pos="4" side="tl" part="lemq"/>
	    </lu> 
	    <b/> 
	    <lu>   
	      <clip pos="2" side="tl" part="lem"/> 
	      <clip pos="2" side="tl" part="a_adj"/>
	      <clip pos="4" side="tl" part="gen" />
	      <clip pos="4" side="tl" part="nbr" />
	    </lu> 
	    <b/> 

	  </chunk>
	</out>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>

    <rule comment="REGLA: NUM ADV-ADJ NOM2 (BCN non-free software)">
      <pattern>
	<pattern-item n="num"/>
	<pattern-item n="adv"/>
	<pattern-item n="guio"/>
	<pattern-item n="adj"/>
	<pattern-item n="nom"/>
      </pattern>
      <action>
	<call-macro n="genere_nombre">
	  <with-param pos="5"/>
	</call-macro>
	<call-macro n="million">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="flexio_numerals">
	  <with-param pos="1"/>
	  <with-param pos="5"/>
	</call-macro>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<out> 
	  <chunk name="num_adv_adj_nom" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN.DET"/></tag>
	      <tag><clip pos="5" side="tl" part="gen"/></tag>
	      <tag><clip pos="5" side="tl" part="nbr"/></tag>
	    </tags>	
	    <lu>
	      <clip pos="1" side="tl" part="lem"/>
	      <clip pos="1" side="tl" part="a_num"/>
	      <clip pos="1" side="tl" part="gen" />
	      <clip pos="1" side="tl" part="nbr" />
	    </lu>
	    <b/> 
	    <lu> 
	      <clip pos="5" side="tl" part="lemh"/> 
	      <clip pos="5" side="tl" part="a_nom"/>
	      <clip pos="5" side="tl" part="gen" link-to="3"/>
	      <clip pos="5" side="tl" part="nbr" link-to="4"/>
	      <clip pos="5" side="tl" part="lemq"/>  
	    </lu> 
	    <b/>
	    <lu>   
	      <clip pos="2" side="tl" part="whole"/>
	    </lu> 
	    <b/> 
	    <lu>   
	      <clip pos="4" side="tl" part="lemh"/> 
	      <clip pos="4" side="tl" part="a_adj"/>
	      <clip pos="5" side="tl" part="gen" />
	      <clip pos="5" side="tl" part="nbr" />
	      <clip pos="4" side="tl" part="lemq"/> 
	    </lu> 
	    <b/> 

	  </chunk>
	</out>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>


    <rule comment="REGLA: DET ADV-ADJ NOM2 (BCN non-free software)">
      <pattern>
	<pattern-item n="det"/>
	<pattern-item n="adv"/>
	<pattern-item n="guio"/>
	<pattern-item n="adj"/>
	<pattern-item n="nom"/>
      </pattern>
      <action>
	<call-macro n="genere_nombre">
	  <with-param pos="5"/>
	</call-macro>
	<call-macro n="det_no">
	  <with-param pos="1"/>
	  <with-param pos="5"/>
	</call-macro>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<out> 
	  <chunk name="det_adv_adj_nom" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN.DET"/></tag>
	      <tag><clip pos="5" side="tl" part="gen"/></tag>
	      <tag><clip pos="5" side="tl" part="nbr"/></tag>
	    </tags>	
	    <lu>
	      <clip pos="1" side="tl" part="lem"/>
	      <clip pos="1" side="tl" part="a_det"/>
	      <clip pos="5" side="tl" part="gen" link-to="3"/>
	      <clip pos="5" side="tl" part="nbr" link-to="4"/>
	    </lu>
	    <b/> 
	    <lu> 
	      <clip pos="5" side="tl" part="lemh"/> 
	      <clip pos="5" side="tl" part="a_nom"/>
	      <clip pos="5" side="tl" part="gen" link-to="3"/>
	      <clip pos="5" side="tl" part="nbr" link-to="4"/>
	      <clip pos="5" side="tl" part="lemq"/>  
	    </lu> 
	    <b/>
	    <lu>   
	      <clip pos="2" side="tl" part="whole"/>
	    </lu> 
	    <b/> 
	    <lu>   
	      <clip pos="4" side="tl" part="lemh"/> 
	      <clip pos="4" side="tl" part="a_adj"/>
	      <clip pos="5" side="tl" part="gen" link-to="3" />
	      <clip pos="5" side="tl" part="nbr" link-to="4"/>
	      <clip pos="4" side="tl" part="lemq"/> 
	    </lu> 
	    <b/> 

	  </chunk>
	</out>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>


    <rule comment="REGLA: ADV-ADJ NOM2 -> NOM NOM2 de ADV NOM1 (BCN non-free software)">
      <pattern>
	<pattern-item n="adv"/>
	<pattern-item n="guio"/>
	<pattern-item n="adj"/>
	<pattern-item n="nom"/>
      </pattern>
      <action>
	<call-macro n="genere_nombre">
	  <with-param pos="4"/>
	</call-macro>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<out> 
	  <chunk name="adv_adj_nom" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN.UNDET"/></tag>
	      <tag><clip pos="4" side="tl" part="gen"/></tag>
	      <tag><clip pos="4" side="tl" part="nbr"/></tag>
	    </tags>	
	    <lu> 
	      <clip pos="4" side="tl" part="lemh"/> 
	      <clip pos="4" side="tl" part="a_nom"/>
	      <clip pos="4" side="tl" part="gen" link-to="3"/>
	      <clip pos="4" side="tl" part="nbr" link-to="4"/>
	      <clip pos="4" side="tl" part="lemq"/>  
	    </lu> 
	    <b/>
	    <lu>   
	      <clip pos="1" side="tl" part="whole"/>
	    </lu> 
	    <b/> 
	    <lu>   
	      <clip pos="3" side="tl" part="lemh"/> 
	      <clip pos="3" side="tl" part="a_adj"/>
	      <clip pos="4" side="tl" part="gen" />
	      <clip pos="4" side="tl" part="nbr" />
	      <clip pos="3" side="tl" part="lemq"/> 
	    </lu> 
	    <b/> 

	  </chunk>
	</out>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>

    <rule comment="REGLA: DET DET NOM1 NOM2 -> DET DET NOM2 de NOM1">
      <pattern>
	<pattern-item n="det"/>
	<pattern-item n="det"/>
	<pattern-item n="nom"/>
	<pattern-item n="nom"/>
      </pattern>
      <action>
	<call-macro n="genere_nombre">
	  <with-param pos="4"/>
	</call-macro>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<choose>
	  <when>
	    <test>
	      <not>
		<or>
		  <equal>
		    <clip pos="4" side="tl" part="a_nom"/>
		    <lit-tag v="np.ant"/>
		  </equal>
		  <equal>
		    <clip pos="4" side="tl" part="a_nom"/>
		    <lit-tag v="np.cog"/>
		  </equal>
		</or>
	      </not>
	    </test>
	    <out> 
	      <chunk name="det_det_nom_nom" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="SN.DET"/></tag>
		  <tag><clip pos="4" side="tl" part="gen"/></tag>
		  <tag><clip pos="4" side="tl" part="nbr"/></tag>
		</tags>
		<lu>   
		  <clip pos="1" side="tl" part="lem"/> 
		  <clip pos="1" side="tl" part="a_det"/>
		  <clip pos="4" side="tl" part="gen" link-to="3"/>
		  <clip pos="4" side="tl" part="nbr" link-to="4"/>
		</lu> 
		<b pos="1"/>
		<lu>   
		  <clip pos="2" side="tl" part="lem"/> 
		  <clip pos="2" side="tl" part="a_det"/>
		  <clip pos="4" side="tl" part="gen" link-to="3"/>
		  <clip pos="4" side="tl" part="nbr" link-to="4"/>
		</lu> 
		<b pos="2"/>
		<lu> 
		  <clip pos="4" side="tl" part="lemh"/> 
		  <clip pos="4" side="tl" part="a_nom"/>
		  <clip pos="4" side="tl" part="gen" link-to="3"/>
		  <clip pos="4" side="tl" part="nbr" link-to="4"/>
		  <clip pos="4" side="tl" part="lemq"/>  
		</lu> 
		<b pos="3"/>
		<lu>
		  <lit v="de"/>
		  <lit-tag v="pr"/>
		</lu>
		<b/>
		<lu>   
		  <clip pos="3" side="tl" part="lemh"/> 
		  <clip pos="3" side="tl" part="a_nom"/>
		  <clip pos="3" side="tl" part="gen"/>
		  <clip pos="3" side="tl" part="nbr"/>
		  <clip pos="3" side="tl" part="lemq"/>
		</lu> 
	      </chunk>
	    </out>
	  </when>
	  <otherwise><!--'his first son John' -->
	    <out> 
	      <chunk name="det_det_nom_nom" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="SN.DET"/></tag>
		  <tag><clip pos="3" side="tl" part="gen"/></tag>
		  <tag><clip pos="3" side="tl" part="nbr"/></tag>
		</tags>
		<lu>   
		  <clip pos="1" side="tl" part="lem"/> 
		  <clip pos="1" side="tl" part="a_det"/>
		  <clip pos="3" side="tl" part="gen" link-to="3"/>
		  <clip pos="3" side="tl" part="nbr" link-to="4"/>
		</lu> 
		<b pos="1"/>
		<lu>   
		  <clip pos="2" side="tl" part="lem"/> 
		  <clip pos="2" side="tl" part="a_det"/>
		  <clip pos="3" side="tl" part="gen" link-to="3"/>
		  <clip pos="3" side="tl" part="nbr" link-to="4"/>
		</lu> 
		<b pos="2"/>
		<lu> 
		  <clip pos="3" side="tl" part="lemh"/> 
		  <clip pos="3" side="tl" part="a_nom"/>
		  <clip pos="3" side="tl" part="gen" link-to="3"/>
		  <clip pos="3" side="tl" part="nbr" link-to="4"/>
		  <clip pos="3" side="tl" part="lemq"/>  
		</lu> 
		<b pos="3"/>
		<lu>   
		  <clip pos="4" side="tl" part="lemh"/> 
		  <clip pos="4" side="tl" part="a_nom"/>
		  <clip pos="4" side="tl" part="gen"/>
		  <clip pos="4" side="tl" part="nbr"/>
		  <clip pos="4" side="tl" part="lemq"/>
		</lu> 
	      </chunk>
	    </out>
	  </otherwise>
	</choose>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>

    <rule comment="REGLA: DET NUM NOM1 NOM2 -> DET NUM NOM2 de NOM1">
      <pattern>
	<pattern-item n="det"/>
	<pattern-item n="num"/>
	<pattern-item n="nom"/>
	<pattern-item n="nom"/>
      </pattern>
      <action>
	<call-macro n="genere_nombre">
	  <with-param pos="4"/>
	</call-macro>
	<call-macro n="million">
	  <with-param pos="2"/>
	</call-macro>
	<call-macro n="flexio_numerals">
	  <with-param pos="2"/>
	  <with-param pos="4"/>
	</call-macro>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<choose>
	  <when>
	    <test>
	      <not>
		<or>
		  <equal>
		    <clip pos="4" side="tl" part="a_nom"/>
		    <lit-tag v="np.ant"/>
		  </equal>
		  <equal>
		    <clip pos="4" side="tl" part="a_nom"/>
		    <lit-tag v="np.cog"/>
		  </equal>
		</or>
	      </not>
	    </test>
	    <out> 
	      <chunk name="det_num_nom_nom" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="SN.DET"/></tag>
		  <tag><clip pos="4" side="tl" part="gen"/></tag>
		  <tag><clip pos="4" side="tl" part="nbr"/></tag>
		</tags>
		<lu>   
		  <clip pos="1" side="tl" part="lem"/> 
		  <clip pos="1" side="tl" part="a_det"/>
		  <clip pos="4" side="tl" part="gen" link-to="3"/>
		  <clip pos="4" side="tl" part="nbr" link-to="4"/>
		</lu> 
		<b pos="1"/>
		<lu>   
		  <clip pos="2" side="tl" part="lem"/> 
		  <clip pos="2" side="tl" part="a_num"/>
		  <clip pos="2" side="tl" part="gen"/>
		  <clip pos="2" side="tl" part="nbr"/>
		</lu> 
		<b pos="2"/>
		<lu> 
		  <clip pos="4" side="tl" part="lemh"/> 
		  <clip pos="4" side="tl" part="a_nom"/>
		  <clip pos="4" side="tl" part="gen" link-to="3"/>
		  <clip pos="4" side="tl" part="nbr" link-to="4"/>
		  <clip pos="4" side="tl" part="lemq"/>  
		</lu> 
		<b pos="3"/>
		<lu>
		  <lit v="de"/>
		  <lit-tag v="pr"/>
		</lu>
		<b/>
		<lu>   
		  <clip pos="3" side="tl" part="lemh"/> 
		  <clip pos="3" side="tl" part="a_nom"/>
		  <clip pos="3" side="tl" part="gen"/>
		  <clip pos="3" side="tl" part="nbr"/>
		  <clip pos="3" side="tl" part="lemq"/>
		</lu> 
	      </chunk>
	    </out>
	  </when>
	  <otherwise><!--His three cats Tom... -->
	    <out> 
	      <chunk name="det_num_nom_nom" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="SN.DET"/></tag>
		  <tag><clip pos="3" side="tl" part="gen"/></tag>
		  <tag><clip pos="3" side="tl" part="nbr"/></tag>
		</tags>
		<lu>   
		  <clip pos="1" side="tl" part="lem"/> 
		  <clip pos="1" side="tl" part="a_det"/>
		  <clip pos="3" side="tl" part="gen" link-to="3"/>
		  <clip pos="3" side="tl" part="nbr" link-to="4"/>
		</lu> 
		<b pos="1"/>
		<lu>   
		  <clip pos="2" side="tl" part="lem"/> 
		  <clip pos="2" side="tl" part="a_num"/>
		  <clip pos="2" side="tl" part="gen"/>
		  <clip pos="2" side="tl" part="nbr"/>
		</lu> 
		<b pos="2"/>
		<lu> 
		  <clip pos="3" side="tl" part="lemh"/> 
		  <clip pos="3" side="tl" part="a_nom"/>
		  <clip pos="3" side="tl" part="gen" link-to="3"/>
		  <clip pos="3" side="tl" part="nbr" link-to="4"/>
		  <clip pos="3" side="tl" part="lemq"/>  
		</lu> 
		<b pos="3"/>
		<lu>   
		  <clip pos="4" side="tl" part="lemh"/> 
		  <clip pos="4" side="tl" part="a_nom"/>
		  <clip pos="4" side="tl" part="gen"/>
		  <clip pos="4" side="tl" part="nbr"/>
		  <clip pos="4" side="tl" part="lemq"/>
		</lu> 
	      </chunk>
	    </out>
	  </otherwise>
	</choose>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>

    <rule comment="REGLA: DET NUM-NOM1 NOM2 ->DET NOM2 de NUM NOM1(pl) (A three-month extension - una extensió de tres mesos">
      <pattern>
	<pattern-item n="det"/>
	<pattern-item n="num"/>
	<pattern-item n="guio"/>
	<pattern-item n="nom"/>
	<pattern-item n="nom"/>
      </pattern>
      <action>
	<call-macro n="genere_nombre">
	  <with-param pos="5"/>
	</call-macro>
	<call-macro n="million">
	  <with-param pos="2"/>
	</call-macro>
	<call-macro n="flexio_numerals">
	  <with-param pos="2"/>
	  <with-param pos="4"/>
	</call-macro>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<out> 
	  <chunk name="det_num_guio_nom_nom" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN.DET"/></tag>
	      <tag><clip pos="5" side="tl" part="gen"/></tag>
	      <tag><clip pos="5" side="tl" part="nbr"/></tag>
	    </tags>
	    <lu>   
	      <clip pos="1" side="tl" part="lem"/> 
	      <clip pos="1" side="tl" part="a_det"/>
	      <clip pos="5" side="tl" part="gen" link-to="3"/>
	      <clip pos="5" side="tl" part="nbr" link-to="4"/>
	    </lu> 
	    <b pos="1"/>
	    <lu> 
	      <clip pos="5" side="tl" part="lemh"/> 
	      <clip pos="5" side="tl" part="a_nom"/>
	      <clip pos="5" side="tl" part="gen" link-to="3"/>
	      <clip pos="5" side="tl" part="nbr" link-to="4"/>
	      <clip pos="5" side="tl" part="lemq"/>  
	    </lu> 
	    <b/>
	    <lu>
	      <lit v="de"/>
	      <lit-tag v="pr"/>
	    </lu>
	    <b/>
	    <lu> 
	      <clip pos="2" side="tl" part="lem"/> 
	      <clip pos="2" side="tl" part="a_num"/>
	      <clip pos="2" side="tl" part="gen"/>
	      <clip pos="2" side="tl" part="nbr"/>
	    </lu> 
	    <b pos="4"/>
	    <lu>   
	      <clip pos="4" side="tl" part="lemh"/> 
	      <clip pos="4" side="tl" part="a_nom"/>
	      <clip pos="4" side="tl" part="gen"/>
	      <lit-tag v="pl"/>
	      <clip pos="4" side="tl" part="lemq"/>
	    </lu> 
	  </chunk>
	</out>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>

    <rule comment="REGLA: ADJ NOM1 NOM2 -> NOM2 de NOM1 ADJ">
      <pattern>
	<pattern-item n="adj"/>
	<pattern-item n="nom"/>
	<pattern-item n="nom"/>
      </pattern>
      <action>
	<call-macro n="genere_nombre">
	  <with-param pos="3"/>
	</call-macro>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="comparatiu_adj1">
	  <with-param pos="1"/>
	</call-macro>  
	<choose>
	  <when>
	    <test>
	      <not>
		<or>
		  <equal>
		    <clip pos="3" side="tl" part="a_nom"/>
		    <lit-tag v="np.ant"/>
		  </equal>
		  <equal>
		    <clip pos="3" side="tl" part="a_nom"/>
		    <lit-tag v="np.cog"/>
		  </equal>
		</or>
	      </not>
	    </test>
	    <out> 
	      <chunk name="adj_nom_nom" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="SN.UNDET"/></tag>
		  <tag><clip pos="3" side="tl" part="gen"/></tag>
		  <tag><clip pos="3" side="tl" part="nbr"/></tag>
		</tags>
		<lu> 
		  <clip pos="3" side="tl" part="lemh"/> 
		  <clip pos="3" side="tl" part="a_nom"/>
		  <clip pos="3" side="tl" part="gen" link-to="3"/>
		  <clip pos="3" side="tl" part="nbr" link-to="4"/>
		  <clip pos="3" side="tl" part="lemq"/>  
		</lu> 
		<b pos="1"/>
		<lu>
		  <lit v="de"/>
		  <lit-tag v="pr"/>
		</lu>
		<b/>
		<lu>   
		  <clip pos="2" side="tl" part="lemh"/> 
		  <clip pos="2" side="tl" part="a_nom"/>
		  <clip pos="2" side="tl" part="gen"/>
		  <clip pos="2" side="tl" part="nbr"/>
		  <clip pos="2" side="tl" part="lemq"/>
		</lu> 
		<b pos="2"/>
		<lu> 
		  <var n="adjectiu1"/>   
		  <clip pos="1" side="tl" part="lemh"/> 
		  <clip pos="1" side="tl" part="a_adj"/>
		  <clip pos="2" side="tl" part="gen"/>
		  <clip pos="2" side="tl" part="nbr"/>
		  <clip pos="1" side="tl" part="lemq"/> 
		</lu> 
	      </chunk>
	    </out>
	  </when>
	  <otherwise>
	    <out> <!--'beautiful son James' -->
	      <chunk name="adj_nom_nom" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="SN.UNDET"/></tag>
		  <tag><clip pos="2" side="tl" part="gen"/></tag>
		  <tag><clip pos="2" side="tl" part="nbr"/></tag>
		</tags>
		<lu> 
		  <clip pos="2" side="tl" part="lemh"/> 
		  <clip pos="2" side="tl" part="a_nom"/>
		  <clip pos="2" side="tl" part="gen" link-to="3"/>
		  <clip pos="2" side="tl" part="nbr" link-to="4"/>
		  <clip pos="2" side="tl" part="lemq"/>  
		</lu> 
		<b pos="1"/>
		<lu> 
		  <var n="adjectiu1"/>   
		  <clip pos="1" side="tl" part="lemh"/> 
		  <clip pos="1" side="tl" part="a_adj"/>
		  <clip pos="2" side="tl" part="gen"/>
		  <clip pos="2" side="tl" part="nbr"/>
		  <clip pos="1" side="tl" part="lemq"/> 
		</lu>
		<b pos="2"/> 
		<lu>   
		  <clip pos="3" side="tl" part="lemh"/> 
		  <clip pos="3" side="tl" part="a_nom"/>
		  <clip pos="3" side="tl" part="gen"/>
		  <clip pos="3" side="tl" part="nbr"/>
		  <clip pos="3" side="tl" part="lemq"/>
		</lu> 	    
	      </chunk>
	    </out>
	  </otherwise>
	</choose>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>

    <rule comment="REGLA: DET ADJ NOM1 NOM2 -> DET NOM2 de NOM1 ADJ">
      <pattern>
	<pattern-item n="det"/>
	<pattern-item n="adj"/>
	<pattern-item n="nom"/>
	<pattern-item n="nom"/>
      </pattern>
      <action>
	<call-macro n="genere_nombre">
	  <with-param pos="4"/>
	</call-macro>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="comparatiu_adj1">
	  <with-param pos="2"/>
	</call-macro>  
	<choose>
	  <when>
	    <test>
	      <not>
		<or>
		  <equal>
		    <clip pos="4" side="tl" part="a_nom"/>
		    <lit-tag v="np.ant"/>
		  </equal>
		  <equal>
		    <clip pos="4" side="tl" part="a_nom"/>
		    <lit-tag v="np.cog"/>
		  </equal>
		</or>
	      </not>
	    </test>
	    <out> 
	      <chunk name="det_adj_nom_nom" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="SN.DET"/></tag>
		  <tag><clip pos="4" side="tl" part="gen"/></tag>
		  <tag><clip pos="4" side="tl" part="nbr"/></tag>
		</tags>
		<lu>   
		  <clip pos="1" side="tl" part="lem"/> 
		  <clip pos="1" side="tl" part="a_det"/>
		  <clip pos="4" side="tl" part="gen" link-to="3"/>
		  <clip pos="4" side="tl" part="nbr" link-to="4"/>
		</lu> 
		<b pos="1"/>
		<lu> 
		  <clip pos="4" side="tl" part="lemh"/> 
		  <clip pos="4" side="tl" part="a_nom"/>
		  <clip pos="4" side="tl" part="gen" link-to="3"/>
		  <clip pos="4" side="tl" part="nbr" link-to="4"/>
		  <clip pos="4" side="tl" part="lemq"/>  
		</lu> 
		<b pos="2"/>
		<lu>
		  <lit v="de"/>
		  <lit-tag v="pr"/>
		</lu>
		<b/>
		<lu>   
		  <clip pos="3" side="tl" part="lemh"/> 
		  <clip pos="3" side="tl" part="a_nom"/>
		  <clip pos="3" side="tl" part="gen"/>
		  <clip pos="3" side="tl" part="nbr"/>
		  <clip pos="3" side="tl" part="lemq"/>
		</lu> 
		<b pos="3"/>
		<lu> 
		  <var n="adjectiu1"/>   
		  <clip pos="2" side="tl" part="lemh"/> 
		  <clip pos="2" side="tl" part="a_adj"/>
		  <clip pos="4" side="tl" part="gen" link-to="3"/>
		  <clip pos="4" side="tl" part="nbr" link-to="4"/>
		  <clip pos="2" side="tl" part="lemq"/> 
		</lu> 
	      </chunk>
	    </out>
	  </when>
	  <otherwise><!--'his beautiful son James' -->
	    <out> 
	      <chunk name="det_adj_nom_nom" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="SN.DET"/></tag>
		  <tag><clip pos="3" side="tl" part="gen"/></tag>
		  <tag><clip pos="3" side="tl" part="nbr"/></tag>
		</tags>
		<lu>   
		  <clip pos="1" side="tl" part="lem"/> 
		  <clip pos="1" side="tl" part="a_det"/>
		  <clip pos="3" side="tl" part="gen" link-to="3"/>
		  <clip pos="3" side="tl" part="nbr" link-to="4"/>
		</lu> 
		<b pos="1"/>
		<lu> 
		  <clip pos="3" side="tl" part="lemh"/> 
		  <clip pos="3" side="tl" part="a_nom"/>
		  <clip pos="3" side="tl" part="gen" link-to="3"/>
		  <clip pos="3" side="tl" part="nbr" link-to="4"/>
		  <clip pos="3" side="tl" part="lemq"/>  
		</lu> 
		<b pos="2"/>
		<lu> 
		  <var n="adjectiu1"/>   
		  <clip pos="2" side="tl" part="lemh"/> 
		  <clip pos="2" side="tl" part="a_adj"/>
		  <clip pos="3" side="tl" part="gen" link-to="3"/>
		  <clip pos="3" side="tl" part="nbr" link-to="4"/>
		  <clip pos="2" side="tl" part="lemq"/> 
		</lu> 
		<b pos="3"/>
		<lu>   
		  <clip pos="4" side="tl" part="lemh"/> 
		  <clip pos="4" side="tl" part="a_nom"/>
		  <clip pos="4" side="tl" part="gen"/>
		  <clip pos="4" side="tl" part="nbr"/>
		  <clip pos="4" side="tl" part="lemq"/>
		</lu>     
	      </chunk>
	    </out>
	  </otherwise>
	</choose>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>

    <rule comment="REGLA: NOM1 NOM2 NOM3 -> NOM3 de NOM2 del NOM1 (noms comuns: una altra manera de solucionar reordenaments no volguts de noms propis, que en les regles anteriors es fa mitjançant operacions dins la regla">
      <pattern>
	<pattern-item n="nomcomu"/>
	<pattern-item n="nomcomu"/>
	<pattern-item n="nomcomu"/>
      </pattern>
      <action>
	<call-macro n="genere_nombre">
	  <with-param pos="3"/>
	</call-macro>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<out> 
	  <chunk name="nom_nom_nom" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN.UNDET"/></tag>
	      <tag><clip pos="3" side="tl" part="gen"/></tag>
	      <tag><clip pos="3" side="tl" part="nbr"/></tag>
	    </tags>
	    <lu> 
	      <clip pos="3" side="tl" part="lemh"/> 
	      <clip pos="3" side="tl" part="a_nom"/>
	      <clip pos="3" side="tl" part="gen" link-to="3"/>
	      <clip pos="3" side="tl" part="nbr" link-to="4"/>
	      <clip pos="3" side="tl" part="lemq"/>  
	    </lu> 
	    <b pos="1"/>
	    <lu>
	      <lit v="de"/>
	      <lit-tag v="pr"/>
	    </lu>
	    <b/>
	    <lu>   
	      <clip pos="2" side="tl" part="lemh"/> 
	      <clip pos="2" side="tl" part="a_nom"/>
	      <clip pos="2" side="tl" part="gen"/>
	      <clip pos="2" side="tl" part="nbr"/>
	      <clip pos="2" side="tl" part="lemq"/>
	    </lu> 
	    <b pos="2"/>
	    <lu>
	      <lit v="de"/>
	      <lit-tag v="pr"/>
	    </lu>
	    <b/>
	    <lu>
	      <lit v="el"/><!--De moment hi posarem article, potser no sempre és correcte, estudiar-ho. -->
	      <lit-tag v="det.def"/>
	      <clip pos="1" side="tl" part="gen"/>
	      <clip pos="1" side="tl" part="nbr"/>
	    </lu>
	    <b/> 
	    <lu> 
	      <clip pos="1" side="tl" part="lemh"/> 
	      <clip pos="1" side="tl" part="a_nom"/>
	      <clip pos="1" side="tl" part="gen"/>
	      <clip pos="1" side="tl" part="nbr"/>
	      <clip pos="1" side="tl" part="lemq"/>
	    </lu> 
	  </chunk>
	</out>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>

  <rule comment="REGLA: NOM1 NOM2 NOM3 -> NOM3 de NOM2 del NOM1 (noms comuns: una altra manera de solucionar reordenaments no volguts de noms propis, que en les regles anteriors es fa mitjançant operacions dins la regla">
      <pattern>
	<pattern-item n="nompropi"/>
	<pattern-item n="nompropi"/>
	<pattern-item n="nompropi"/>
      </pattern>
      <action>
	<call-macro n="genere_nombre">
	  <with-param pos="3"/>
	</call-macro>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<out> 
	  <chunk name="nom_nom_nom" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN.UNDET"/></tag>
	      <tag><clip pos="1" side="tl" part="gen"/></tag>
	      <tag><clip pos="1" side="tl" part="nbr"/></tag>
	    </tags>
	    <lu> 
	      <clip pos="1" side="tl" part="lemh"/> 
	      <clip pos="1" side="tl" part="a_nom"/>
	      <clip pos="1" side="tl" part="gen" link-to="3"/>
	      <clip pos="1" side="tl" part="nbr" link-to="4"/>
	      <clip pos="1" side="tl" part="lemq"/>  
	    </lu> 
	    <b pos="1"/>
	    <lu>   
	      <clip pos="2" side="tl" part="lemh"/> 
	      <clip pos="2" side="tl" part="a_nom"/>
	      <clip pos="2" side="tl" part="gen"/>
	      <clip pos="2" side="tl" part="nbr"/>
	      <clip pos="2" side="tl" part="lemq"/>
	    </lu> 
	    <b pos="2"/>
	    <lu> 
	      <clip pos="3" side="tl" part="lemh"/> 
	      <clip pos="3" side="tl" part="a_nom"/>
	      <clip pos="3" side="tl" part="gen"/>
	      <clip pos="3" side="tl" part="nbr"/>
	      <clip pos="3" side="tl" part="lemq"/>
	    </lu> 
	  </chunk>
	</out>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>

    <rule comment="REGLA: DET NOM1 NOM2 NOM3 -> DET NOM3 de NOM2 del NOM1">
      <pattern>
	<pattern-item n="det"/>
	<pattern-item n="nomcomu"/>
	<pattern-item n="nomcomu"/>
	<pattern-item n="nomcomu"/>
      </pattern>
      <action>
	<call-macro n="genere_nombre">
	  <with-param pos="4"/>
	</call-macro>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<out> 
	  <chunk name="det_nom_nom_nom" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN.DET"/></tag>
	      <tag><clip pos="4" side="tl" part="gen"/></tag>
	      <tag><clip pos="4" side="tl" part="nbr"/></tag>
	    </tags>
	    <lu>   
	      <clip pos="1" side="tl" part="lem"/> 
	      <clip pos="1" side="tl" part="a_det"/>
	      <clip pos="4" side="tl" part="gen" link-to="3"/>
	      <clip pos="4" side="tl" part="nbr" link-to="4"/>
	    </lu> 
	    <b pos="1"/>
	    <lu> 
	      <clip pos="4" side="tl" part="lemh"/> 
	      <clip pos="4" side="tl" part="a_nom"/>
	      <clip pos="4" side="tl" part="gen" link-to="3"/>
	      <clip pos="4" side="tl" part="nbr" link-to="4"/>
	      <clip pos="4" side="tl" part="lemq"/>  
	    </lu> 
	    <b pos="2"/>
	    <lu>
	      <lit v="de"/>
	      <lit-tag v="pr"/>
	    </lu>
	    <b/>
	    <lu>   
	      <clip pos="3" side="tl" part="lemh"/> 
	      <clip pos="3" side="tl" part="a_nom"/>
	      <clip pos="3" side="tl" part="gen"/>
	      <clip pos="3" side="tl" part="nbr"/>
	      <clip pos="3" side="tl" part="lemq"/>
	    </lu> 
	    <b pos="3"/>
	    <lu>
	      <lit v="de"/>
	      <lit-tag v="pr"/>
	    </lu>
	    <b/>
	    <lu>
	      <lit v="el"/><!--De moment hi posarem article, potser no sempre és correcte, estudiar-ho. -->
	      <lit-tag v="det.def"/>
	      <clip pos="2" side="tl" part="gen"/>
	      <clip pos="2" side="tl" part="nbr"/>
	    </lu>
	    <b/> 
	    <lu> 
	      <clip pos="2" side="tl" part="lemh"/> 
	      <clip pos="2" side="tl" part="a_nom"/>
	      <clip pos="2" side="tl" part="gen"/>
	      <clip pos="2" side="tl" part="nbr"/>
	      <clip pos="2" side="tl" part="lemq"/>
	    </lu> 
	  </chunk>
	</out>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>

    <rule comment="REGLA: ADJ NOM1 NOM2 NOM3 -> NOM3 de NOM2 de NOM1 ADJ (professional video game design -> disseny de joc de vídeo professional (?)">
      <pattern>
	<pattern-item n="adj"/>
	<pattern-item n="nomcomu"/>
	<pattern-item n="nomcomu"/>
	<pattern-item n="nomcomu"/>
      </pattern>
      <action>
	<call-macro n="genere_nombre">
	  <with-param pos="4"/>
	</call-macro>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="comparatiu_adj1">
	  <with-param pos="1"/>
	</call-macro>  
	
	<out> 
	  <chunk name="adj_nom_nom_nom" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN.UNDET"/></tag>
	      <tag><clip pos="4" side="tl" part="gen"/></tag>
	      <tag><clip pos="4" side="tl" part="nbr"/></tag>
	    </tags>
	    <lu> 
	      <clip pos="4" side="tl" part="lemh"/> 
	      <clip pos="4" side="tl" part="a_nom"/>
	      <clip pos="4" side="tl" part="gen" link-to="3"/>
	      <clip pos="4" side="tl" part="nbr" link-to="4"/>
	      <clip pos="4" side="tl" part="lemq"/>  
	    </lu> 
	    <b pos="1"/>
	    <lu>
	      <lit v="de"/>
	      <lit-tag v="pr"/>
	    </lu>
	    <b/>
	    <lu>   
	      <clip pos="3" side="tl" part="lemh"/> 
	      <clip pos="3" side="tl" part="a_nom"/>
	      <clip pos="3" side="tl" part="gen"/>
	      <clip pos="3" side="tl" part="nbr"/>
	      <clip pos="3" side="tl" part="lemq"/>
	    </lu> 
	    <b pos="2"/>
	    <lu>
	      <lit v="de"/>
	      <lit-tag v="pr"/>
	    </lu>
	    <b/> 
	    <lu> 
	      <clip pos="2" side="tl" part="lemh"/> 
	      <clip pos="2" side="tl" part="a_nom"/>
	      <clip pos="2" side="tl" part="gen"/>
	      <clip pos="2" side="tl" part="nbr"/>
	      <clip pos="2" side="tl" part="lemq"/>
	    </lu> 
	    <b pos="3"/>
	    <lu> 
	      <var n="adjectiu1"/>   
	      <clip pos="1" side="tl" part="lemh"/> 
	      <clip pos="1" side="tl" part="a_adj"/>
	      <clip pos="4" side="tl" part="gen" link-to="3"/>
	      <clip pos="4" side="tl" part="nbr" link-to="4"/>
	      <clip pos="1" side="tl" part="lemq"/> 
	    </lu> 
	  </chunk>
	</out>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>

    <rule comment="REGLA: DET ADJ NOM1 NOM2 NOM3 -> DET NOM3 de NOM2 de NOM1 ADJ">
      <pattern>
	<pattern-item n="det"/>
	<pattern-item n="adj"/>
	<pattern-item n="nomcomu"/>
	<pattern-item n="nomcomu"/>
	<pattern-item n="nomcomu"/>
      </pattern>
      <action>
	<call-macro n="genere_nombre">
	  <with-param pos="5"/>
	</call-macro>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="comparatiu_adj1">
	  <with-param pos="2"/>
	</call-macro>  
	<out> 
	  <chunk name="det_adj_nom_nom_nom" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN.DET"/></tag>
	      <tag><clip pos="5" side="tl" part="gen"/></tag>
	      <tag><clip pos="5" side="tl" part="nbr"/></tag>
	    </tags>
	    <lu>   
	      <clip pos="1" side="tl" part="lem"/> 
	      <clip pos="1" side="tl" part="a_det"/>
	      <clip pos="5" side="tl" part="gen" link-to="3"/>
	      <clip pos="5" side="tl" part="nbr" link-to="4"/>
	    </lu> 
	    <b pos="1"/>
	    <lu> 
	      <clip pos="5" side="tl" part="lemh"/> 
	      <clip pos="5" side="tl" part="a_nom"/>
	      <clip pos="5" side="tl" part="gen" link-to="3"/>
	      <clip pos="5" side="tl" part="nbr" link-to="4"/>
	      <clip pos="5" side="tl" part="lemq"/>  
	    </lu> 
	    <b pos="2"/>
	    <lu>
	      <lit v="de"/>
	      <lit-tag v="pr"/>
	    </lu>
	    <b/>
	    <lu>   
	      <clip pos="4" side="tl" part="lemh"/> 
	      <clip pos="4" side="tl" part="a_nom"/>
	      <clip pos="4" side="tl" part="gen"/>
	      <clip pos="4" side="tl" part="nbr"/>
	      <clip pos="4" side="tl" part="lemq"/>
	    </lu> 
	    <b pos="3"/>
	    <lu>
	      <lit v="de"/>
	      <lit-tag v="pr"/>
	    </lu>
	    <b pos="4"/> 
	    <lu> 
	      <clip pos="3" side="tl" part="lemh"/> 
	      <clip pos="3" side="tl" part="a_nom"/>
	      <clip pos="3" side="tl" part="gen"/>
	      <clip pos="3" side="tl" part="nbr"/>
	      <clip pos="3" side="tl" part="lemq"/>
	    </lu> 
	    <b/>
	    <lu> 
	      <var n="adjectiu1"/>   
	      <clip pos="2" side="tl" part="lemh"/> 
	      <clip pos="2" side="tl" part="a_adj"/>
	      <clip pos="5" side="tl" part="gen" link-to="3"/>
	      <clip pos="5" side="tl" part="nbr" link-to="4"/>
	      <clip pos="2" side="tl" part="lemq"/> 
	    </lu> 
	  </chunk>
	</out>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>

    <rule comment="REGLA: NOM1 NOM2 NOM3 NOM4-> NOM4 de NOM3 de NOM2 de NOM1 (video game design industry -> indústria de disseny de joc de vídeo (?)">
      <pattern>
	<pattern-item n="nomcomu"/>
	<pattern-item n="nomcomu"/>
	<pattern-item n="nomcomu"/>
	<pattern-item n="nomcomu"/>
      </pattern>
      <action>
	<call-macro n="genere_nombre">
	  <with-param pos="4"/>
	</call-macro>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<out> 
	  <chunk name="nom_nom_nom_nom" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN.UNDET"/></tag>
	      <tag><clip pos="4" side="tl" part="gen"/></tag>
	      <tag><clip pos="4" side="tl" part="nbr"/></tag>
	    </tags>
	    <lu> 
	      <clip pos="4" side="tl" part="lemh"/> 
	      <clip pos="4" side="tl" part="a_nom"/>
	      <clip pos="4" side="tl" part="gen" link-to="3"/>
	      <clip pos="4" side="tl" part="nbr" link-to="4"/>
	      <clip pos="4" side="tl" part="lemq"/>  
	    </lu> 
	    <b pos="1"/>
	    <lu>
	      <lit v="de"/>
	      <lit-tag v="pr"/>
	    </lu>
	    <b/>
	    <lu>   
	      <clip pos="3" side="tl" part="lemh"/> 
	      <clip pos="3" side="tl" part="a_nom"/>
	      <clip pos="3" side="tl" part="gen"/>
	      <clip pos="3" side="tl" part="nbr"/>
	      <clip pos="3" side="tl" part="lemq"/>
	    </lu> 
	    <b pos="2"/>
	    <lu>
	      <lit v="de"/>
	      <lit-tag v="pr"/>
	    </lu>
	    <b/> 
	    <lu> 
	      <clip pos="2" side="tl" part="lemh"/> 
	      <clip pos="2" side="tl" part="a_nom"/>
	      <clip pos="2" side="tl" part="gen"/>
	      <clip pos="2" side="tl" part="nbr"/>
	      <clip pos="2" side="tl" part="lemq"/>
	    </lu> 
	    <b pos="3"/>
	    <lu>
	      <lit v="de"/>
	      <lit-tag v="pr"/>
	    </lu>
	    <b/>
	    <lu> 
	      <clip pos="1" side="tl" part="lemh"/> 
	      <clip pos="1" side="tl" part="a_nom"/>
	      <clip pos="1" side="tl" part="gen"/>
	      <clip pos="1" side="tl" part="nbr"/>
	      <clip pos="1" side="tl" part="lemq"/>
	    </lu> 
	  </chunk>
	</out>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>

    <rule comment="REGLA: DET NOM1 NOM2 NOM3 NOM4-> DET NOM4 de NOM3 de NOM2 de NOM1 (the video game design industry -> la indústria de disseny de joc de vídeo (?)">
      <pattern>
	<pattern-item n="det"/>
	<pattern-item n="nomcomu"/>
	<pattern-item n="nomcomu"/>
	<pattern-item n="nomcomu"/>
	<pattern-item n="nomcomu"/>
      </pattern>
      <action>
	<call-macro n="genere_nombre">
	  <with-param pos="5"/>
	</call-macro>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<out> 
	  <chunk name="det_nom_nom_nom_nom" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN.DET"/></tag>
	      <tag><clip pos="5" side="tl" part="gen"/></tag>
	      <tag><clip pos="5" side="tl" part="nbr"/></tag>
	    </tags>
	    <lu>   
	      <clip pos="1" side="tl" part="lem"/> 
	      <clip pos="1" side="tl" part="a_det"/>
	      <clip pos="5" side="tl" part="gen" link-to="3"/>
	      <clip pos="5" side="tl" part="nbr" link-to="4"/>
	    </lu> 
	    <b pos="1"/>
	    <lu> 
	      <clip pos="5" side="tl" part="lemh"/> 
	      <clip pos="5" side="tl" part="a_nom"/>
	      <clip pos="5" side="tl" part="gen" link-to="3"/>
	      <clip pos="5" side="tl" part="nbr" link-to="4"/>
	      <clip pos="5" side="tl" part="lemq"/>  
	    </lu> 
	    <b pos="2"/>
	    <lu>
	      <lit v="de"/>
	      <lit-tag v="pr"/>
	    </lu>
	    <b/>
	    <lu> 
	      <clip pos="4" side="tl" part="lemh"/> 
	      <clip pos="4" side="tl" part="a_nom"/>
	      <clip pos="4" side="tl" part="gen"/>
	      <clip pos="4" side="tl" part="nbr"/>
	      <clip pos="4" side="tl" part="lemq"/>  
	    </lu> 
	    <b pos="3"/>
	    <lu>
	      <lit v="de"/>
	      <lit-tag v="pr"/>
	    </lu>
	    <b/>
	    <lu>   
	      <clip pos="3" side="tl" part="lemh"/> 
	      <clip pos="3" side="tl" part="a_nom"/>
	      <clip pos="3" side="tl" part="gen"/>
	      <clip pos="3" side="tl" part="nbr"/>
	      <clip pos="3" side="tl" part="lemq"/>
	    </lu> 
	    <b pos="4"/>
	    <lu>
	      <lit v="de"/>
	      <lit-tag v="pr"/>
	    </lu>
	    <b/> 
	    <lu> 
	      <clip pos="2" side="tl" part="lemh"/> 
	      <clip pos="2" side="tl" part="a_nom"/>
	      <clip pos="2" side="tl" part="gen"/>
	      <clip pos="2" side="tl" part="nbr"/>
	      <clip pos="2" side="tl" part="lemq"/>
	    </lu> 
	  </chunk>
	</out>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>

    <rule comment="REGLA: NOM1 and NOM2 -> NOM1 i NOM2">
      <pattern>
	<pattern-item n="nom"/>
	<pattern-item n="cnjcoo"/>
	<pattern-item n="nom"/>
      </pattern>
      <action>
	<choose><!--To determine value of variables of gender-->
	  <when> 
	    <test>
	      <and>
		<equal>
		  <clip pos="1" side="tl" part="gen"/>
		  <lit-tag v="f"/>
		</equal>
		<equal>
		  <clip pos="3" side="tl" part="gen"/>
		  <lit-tag v="f"/>
		</equal>
	      </and>	    
	    </test>
	    <let><var n="genere"/><lit-tag v="f"/></let>
	  </when>
	  <otherwise>
	    <let><var n="genere"/><lit-tag v="m"/></let>
	  </otherwise>
	</choose>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<out> 
	  <chunk name="nom_conj_nom" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN.UNDET"/></tag>
	      <tag><var n="genere"/></tag>
	      <tag><lit-tag v="pl"/></tag>
	    </tags>
	    <lu>  
	      <clip pos="1" side="tl" part="lemh"/> 
	      <clip pos="1" side="tl" part="a_nom"/>
	      <clip pos="1" side="tl" part="gen"/>
	      <clip pos="1" side="tl" part="nbr"/>
	      <clip pos="1" side="tl" part="lemq"/>  
	    </lu> 
	    <b pos="1"/>
	    <lu>
	      <clip pos="2" side="tl" part="whole"/>
	    </lu>
	    <b pos="2"/>
	    <lu>  
	      <clip pos="3" side="tl" part="lemh"/> 
	      <clip pos="3" side="tl" part="a_nom"/>
	      <clip pos="3" side="tl" part="gen"/>
	      <clip pos="3" side="tl" part="nbr"/>
	      <clip pos="3" side="tl" part="lemq"/>  
	    </lu> 
	  </chunk>
	</out>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>


    <rule comment="REGLA: NOM1 and NOM2 NOM3 (BCN  safety and security issues)">
      <pattern>
	<pattern-item n="nom"/>
	<pattern-item n="cnjcoo"/>
	<pattern-item n="nomcomu"/>
	<pattern-item n="nomcomu"/>
      </pattern>
      <action>
	<choose><!--To determine value of variables of gender-->
	  <when> 
	    <test>
	      <and>
		<equal>
		  <clip pos="1" side="tl" part="gen"/>
		  <lit-tag v="f"/>
		</equal>
		<equal>
		  <clip pos="3" side="tl" part="gen"/>
		  <lit-tag v="f"/>
		</equal>
	      </and>	    
	    </test>
	    <let><var n="genere"/><lit-tag v="f"/></let>
	  </when>
	  <otherwise>
	    <let><var n="genere"/><lit-tag v="m"/></let>
	  </otherwise>
	</choose>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<out> 
	  <chunk name="nom_conj_nom_nom" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN.UNDET"/></tag>
	      <tag><var n="genere"/></tag>
	      <tag><lit-tag v="pl"/></tag>
	    </tags>
	    <lu>  
	      <clip pos="1" side="tl" part="lemh"/> 
	      <clip pos="1" side="tl" part="a_nom"/>
	      <clip pos="1" side="tl" part="gen"/>
	      <clip pos="1" side="tl" part="nbr"/>
	      <clip pos="1" side="tl" part="lemq"/>  
	    </lu> 
	    <b pos="1"/>
	    <lu>
	      <clip pos="2" side="tl" part="whole"/>
	    </lu>
	    <b pos="2"/>
	    <lu>  
	      <clip pos="4" side="tl" part="lemh"/> 
	      <clip pos="4" side="tl" part="a_nom"/>
	      <clip pos="4" side="tl" part="gen"/>
	      <clip pos="4" side="tl" part="nbr"/>
	      <clip pos="4" side="tl" part="lemq"/>  
	    </lu> 
	    <b pos="3"/>
	    <lu>
	      <lit v="de"/>
	      <lit-tag v="pr"/>
	    </lu>
	    <b/>
	    <lu>
	      <clip pos="3" side="tl" part="lemh"/>
	      <clip pos="3" side="tl" part="a_nom"/>
	      <clip pos="3" side="tl" part="gen"/>
	      <clip pos="3" side="tl" part="nbr"/>
	      <clip pos="3" side="tl" part="lemq"/>
	    </lu>

	  </chunk>
	</out>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>

    <rule comment="REGLA: ADJ NOM1 and NOM2 -> NOM1 i NOM2 ADJ ('native plants and animals')">
      <pattern>
	<pattern-item n="adj"/>
	<pattern-item n="nom"/>
	<pattern-item n="cnjcoo"/>
	<pattern-item n="nom"/>
      </pattern>
      <action>
	<call-macro n="comparatiu_adj1">
	  <with-param pos="1"/>
	</call-macro>  
	<choose><!--To determine value of variables of gender and
		    number-->
	  <when> 
	    <test>
	      <and>
		<equal>
		  <clip pos="2" side="tl" part="gen"/>
		  <lit-tag v="f"/>
		</equal>
		<equal>
		  <clip pos="4" side="tl" part="gen"/>
		  <lit-tag v="f"/>
		</equal>
	      </and>	    
	    </test>
	    <let><var n="genere"/><lit-tag v="f"/></let>
	  </when>
	  <otherwise>
	    <let><var n="genere"/><lit-tag v="m"/></let>
	  </otherwise>
	</choose>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<out> 
	  <chunk name="adj_nom_conj_nom" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN.UNDET"/></tag>
	      <tag><var n="genere"/></tag>
	      <tag><lit-tag v="pl"/></tag>
	    </tags>
	    <lu>
	      <clip pos="4" side="tl" part="lemh"/> 
	      <clip pos="4" side="tl" part="a_nom"/>
	      <clip pos="4" side="tl" part="gen"/>
	      <clip pos="4" side="tl" part="nbr"/>
	      <clip pos="4" side="tl" part="lemq"/>  
	    </lu>
	    <b pos="1"/>
	    <lu>
	      <clip pos="3" side="tl" part="whole"/>
	    </lu>
	    <b pos="2"/>
	    <lu>
	      <clip pos="2" side="tl" part="lemh"/> 
	      <clip pos="2" side="tl" part="a_nom"/>
	      <clip pos="2" side="tl" part="gen"/>
	      <clip pos="2" side="tl" part="nbr"/>
	      <clip pos="2" side="tl" part="lemq"/>  
	    </lu>
	    <b pos="3"/>
	    <lu> 
	      <var n="adjectiu1"/>   
	      <clip pos="1" side="tl" part="lemh"/> 
	      <clip pos="1" side="tl" part="a_adj"/>
	      <clip pos="2" side="tl" part="gen"/>
	      <clip pos="2" side="tl" part="nbr"/>
	      <clip pos="1" side="tl" part="lemq"/> 
	    </lu> 
	  </chunk>
	</out>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>




    <!-- FI SINTAGMES NOMINALS AMB MES D'UN NOM-->

    <!-- SINTAGMES NOMINALS AMB GENITIU-->

    <rule comment="REGLA: NOM1 GENITIU NOM2 (Mexico's history)">
      <pattern>
	<pattern-item n="nom"/>
	<pattern-item n="genitiu"/>
	<pattern-item n="nom"/>
      </pattern>
      <action>
	<call-macro n="genere_nombre">
	  <with-param pos="3"/>
	</call-macro>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<out> 
	  <chunk name="nom_genitiu_nom" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN.DET"/></tag>
	      <tag><clip pos="3" side="tl" part="gen"/></tag>
	      <tag><clip pos="3" side="tl" part="nbr"/></tag>
	    </tags>
	    <lu>
	      <lit v="el"/>
	      <lit-tag v="det.def"/>
	      <clip pos="3" side="tl" part="gen" link-to="3"/>
	      <clip pos="3" side="tl" part="nbr" link-to="4"/>
	    </lu>
	    <b pos="2"/>
	    <lu> 
	      <clip pos="3" side="tl" part="lemh"/> 
	      <clip pos="3" side="tl" part="a_nom"/>
	      <clip pos="3" side="tl" part="gen" link-to="3"/>
	      <clip pos="3" side="tl" part="nbr" link-to="4"/>
	      <clip pos="3" side="tl" part="lemq"/>  
	    </lu> 
	    <b/>
	    <lu>
	      <lit v="de"/>
	      <lit-tag v="pr"/>
	    </lu>
	    <b/>
	    <lu> 
	      <clip pos="1" side="tl" part="lemh"/> 
	      <clip pos="1" side="tl" part="a_nom"/>
	      <clip pos="1" side="tl" part="gen"/>
	      <clip pos="1" side="tl" part="nbr"/>
	      <clip pos="1" side="tl" part="lemq"/>  
	    </lu> 
	  </chunk>
	</out>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>

    <rule comment="REGLA: DET NOM1 GENITIU NOM2 (my mother's house)">
      <pattern>
	<pattern-item n="det"/>
	<pattern-item n="nom"/>
	<pattern-item n="genitiu"/>
	<pattern-item n="nom"/>
      </pattern>
      <action>
	<call-macro n="genere_nombre">
	  <with-param pos="4"/>
	</call-macro>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<out> 
	  <chunk name="det_nom_genitiu_nom" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN.DET"/></tag>
	      <tag><clip pos="4" side="tl" part="gen"/></tag>
	      <tag><clip pos="4" side="tl" part="nbr"/></tag>
	    </tags>
	    <lu>
	      <lit v="el"/>
	      <lit-tag v="det.def"/>
	      <clip pos="4" side="tl" part="gen" link-to="3"/>
	      <clip pos="4" side="tl" part="nbr" link-to="4"/>
	    </lu>
	    <b pos="1"/>
	    <lu> 
	      <clip pos="4" side="tl" part="lemh"/> 
	      <clip pos="4" side="tl" part="a_nom"/>
	      <clip pos="4" side="tl" part="gen" link-to="3"/>
	      <clip pos="4" side="tl" part="nbr" link-to="4"/>
	      <clip pos="4" side="tl" part="lemq"/>  
	    </lu> 
	    <b pos="3"/>
	    <lu>
	      <lit v="de"/>
	      <lit-tag v="pr"/>
	    </lu>
	    <b/>
	    <lu>   
	      <clip pos="1" side="tl" part="lem"/> 
	      <clip pos="1" side="tl" part="a_det"/>
	      <clip pos="2" side="tl" part="gen"/>
	      <clip pos="2" side="tl" part="nbr"/>
	    </lu> 
	    <b/>
	    <lu> 
	      <clip pos="2" side="tl" part="lemh"/> 
	      <clip pos="2" side="tl" part="a_nom"/>
	      <clip pos="2" side="tl" part="gen"/>
	      <clip pos="2" side="tl" part="nbr"/>
	      <clip pos="2" side="tl" part="lemq"/>  
	    </lu> 
	  </chunk>
	</out>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>

    <rule comment="REGLA: NOM1 GENITIU ADJ NOM2 (Mexico's long history)">
      <pattern>
	<pattern-item n="nom"/>
	<pattern-item n="genitiu"/>
	<pattern-item n="adj2"/>
	<pattern-item n="nom"/>
      </pattern>
      <action>
	<call-macro n="genere_nombre">
	  <with-param pos="4"/>
	</call-macro>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="comparatiu_adj1">
	  <with-param pos="3"/>
	</call-macro>  
	<out> 
	  <chunk name="nom_genitiu_adj_nom" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN.DET"/></tag>
	      <tag><clip pos="4" side="tl" part="gen"/></tag>
	      <tag><clip pos="4" side="tl" part="nbr"/></tag>
	    </tags>
	    <lu>
	      <lit v="el"/>
	      <lit-tag v="det.def"/>
	      <clip pos="4" side="tl" part="gen" link-to="3"/>
	      <clip pos="4" side="tl" part="nbr" link-to="4"/>
	    </lu>
	    <b pos="2"/>
	    <lu> 
	      <clip pos="4" side="tl" part="lemh"/> 
	      <clip pos="4" side="tl" part="a_nom"/>
	      <clip pos="4" side="tl" part="gen" link-to="3"/>
	      <clip pos="4" side="tl" part="nbr" link-to="4"/>
	      <clip pos="4" side="tl" part="lemq"/>  
	    </lu> 
	    <b pos="3"/>
	    <lu> 
	      <var n="adjectiu1"/>   
	      <clip pos="3" side="tl" part="lem"/> 
	      <clip pos="3" side="tl" part="a_adj"/>
	      <clip pos="4" side="tl" part="gen" link-to="3"/>
	      <clip pos="4" side="tl" part="nbr" link-to="4"/>
	    </lu> 
	    <b/>
	    <lu>
	      <lit v="de"/>
	      <lit-tag v="pr"/>
	    </lu>
	    <b/>
	    <lu> 
	      <clip pos="1" side="tl" part="lemh"/> 
	      <clip pos="1" side="tl" part="a_nom"/>
	      <clip pos="1" side="tl" part="gen"/>
	      <clip pos="1" side="tl" part="nbr"/>
	      <clip pos="1" side="tl" part="lemq"/>  
	    </lu> 
	  </chunk>
	</out>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>

    <rule comment="REGLA: DET NOM GENITIU DET NOM (my mother's first house)">
      <pattern>
	<pattern-item n="det"/>
	<pattern-item n="nom"/>
	<pattern-item n="genitiu"/>
	<pattern-item n="det2"/>
	<pattern-item n="nom"/>
      </pattern>
      <action>
	<call-macro n="genere_nombre">
	  <with-param pos="5"/>
	</call-macro>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<out> 
	  <chunk name="det_nom_genitiu_det_nom" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN.DET"/></tag>
	      <tag><clip pos="5" side="tl" part="gen"/></tag>
	      <tag><clip pos="5" side="tl" part="nbr"/></tag>
	    </tags>
	    <lu>
	      <lit v="el"/>
	      <lit-tag v="det.def"/>
	      <clip pos="5" side="tl" part="gen" link-to="3"/>
	      <clip pos="5" side="tl" part="nbr" link-to="4"/>
	    </lu>
	    <b pos="1"/>
	    <lu>
	      <clip pos="4" side="tl" part="lem"/> 
	      <clip pos="4" side="tl" part="a_det"/>
	      <clip pos="5" side="tl" part="gen" link-to="3"/>
	      <clip pos="5" side="tl" part="nbr" link-to="4"/>
	    </lu> 
	    <b pos="3"/>
	    <lu> 
	      <clip pos="5" side="tl" part="lemh"/> 
	      <clip pos="5" side="tl" part="a_nom"/>
	      <clip pos="5" side="tl" part="gen" link-to="3"/>
	      <clip pos="5" side="tl" part="nbr" link-to="4"/>
	      <clip pos="5" side="tl" part="lemq"/>  
	    </lu> 
	    <b pos="4"/>
	    <lu>
	      <lit v="de"/>
	      <lit-tag v="pr"/>
	    </lu>
	    <b/>
	    <lu>   
	      <clip pos="1" side="tl" part="lem"/> 
	      <clip pos="1" side="tl" part="a_det"/>
	      <clip pos="2" side="tl" part="gen"/>
	      <clip pos="2" side="tl" part="nbr"/>
	    </lu> 
	    <b/>
	    <lu> 
	      <clip pos="2" side="tl" part="lemh"/> 
	      <clip pos="2" side="tl" part="a_nom"/>
	      <clip pos="2" side="tl" part="gen"/>
	      <clip pos="2" side="tl" part="nbr"/>
	      <clip pos="2" side="tl" part="lemq"/>  
	    </lu> 
	  </chunk>
	</out>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>

    <rule comment="REGLA: DET NOM1 GENITIU ADJ NOM2 (my mother's big house)">
      <pattern>
	<pattern-item n="det"/>
	<pattern-item n="nom"/>
	<pattern-item n="genitiu"/>
	<pattern-item n="adj2"/>
	<pattern-item n="nom"/>
      </pattern>
      <action>
	<call-macro n="genere_nombre">
	  <with-param pos="5"/>
	</call-macro>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="comparatiu_adj1">
	  <with-param pos="4"/>
	</call-macro>  
	<out> 
	  <chunk name="det_nom_genitiu_adj_nom" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN.DET"/></tag>
	      <tag><clip pos="5" side="tl" part="gen"/></tag>
	      <tag><clip pos="5" side="tl" part="nbr"/></tag>
	    </tags>
	    <lu>
	      <lit v="el"/>
	      <lit-tag v="det.def"/>
	      <clip pos="5" side="tl" part="gen" link-to="3"/>
	      <clip pos="5" side="tl" part="nbr" link-to="4"/>
	    </lu>
	    <b pos="1"/>
	    <lu> 
	      <clip pos="5" side="tl" part="lemh"/> 
	      <clip pos="5" side="tl" part="a_nom"/>
	      <clip pos="5" side="tl" part="gen" link-to="3"/>
	      <clip pos="5" side="tl" part="nbr" link-to="4"/>
	      <clip pos="5" side="tl" part="lemq"/>  
	    </lu> 
	    <b pos="3"/>
	    <lu> 
	      <var n="adjectiu1"/>   
	      <clip pos="4" side="tl" part="lem"/> 
	      <clip pos="4" side="tl" part="a_adj"/>
	      <clip pos="5" side="tl" part="gen" link-to="3"/>
	      <clip pos="5" side="tl" part="nbr" link-to="4"/>
	    </lu> 
	    <b pos="4"/>
	    <lu>
	      <lit v="de"/>
	      <lit-tag v="pr"/>
	    </lu>
	    <b/>
	    <lu>   
	      <clip pos="1" side="tl" part="lem"/> 
	      <clip pos="1" side="tl" part="a_det"/>
	      <clip pos="2" side="tl" part="gen"/>
	      <clip pos="2" side="tl" part="nbr"/>
	    </lu> 
	    <b/>
	    <lu> 
	      <clip pos="2" side="tl" part="lemh"/> 
	      <clip pos="2" side="tl" part="a_nom"/>
	      <clip pos="2" side="tl" part="gen"/>
	      <clip pos="2" side="tl" part="nbr"/>
	      <clip pos="2" side="tl" part="lemq"/>  
	    </lu> 
	  </chunk>
	</out>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>

    <rule comment="REGLA: DET NOM1 GENITIU NUM NOM2 (my mother's two houses)">
      <pattern>
	<pattern-item n="det"/>
	<pattern-item n="nom"/>
	<pattern-item n="genitiu"/>
	<pattern-item n="num"/>
	<pattern-item n="nom"/>
      </pattern>
      <action>
	<call-macro n="genere_nombre">
	  <with-param pos="5"/>
	</call-macro>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="million">
	  <with-param pos="4"/>
	</call-macro>
	<call-macro n="flexio_numerals">
	  <with-param pos="4"/>
	  <with-param pos="5"/>
	</call-macro>
	<out> 
	  <chunk name="det_nom_genitiu_num_nom" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN.DET"/></tag>
	      <tag><clip pos="5" side="tl" part="gen"/></tag>
	      <tag><clip pos="5" side="tl" part="nbr"/></tag>
	    </tags>
	    <lu>
	      <lit v="el"/>
	      <lit-tag v="det.def"/>
	      <clip pos="5" side="tl" part="gen" link-to="3"/>
	      <clip pos="5" side="tl" part="nbr" link-to="4"/>
	    </lu>
	    <b pos="1"/>
	    <lu>
	      <clip pos="4" side="tl" part="lem"/>  
	      <clip pos="4" side="tl" part="a_num"/> 
	      <clip pos="4" side="tl" part="gen"/>
	      <clip pos="4" side="tl" part="nbr"/>
	    </lu> 
	    <b pos="3"/>
	    <lu> 
	      <clip pos="5" side="tl" part="lemh"/> 
	      <clip pos="5" side="tl" part="a_nom"/>
	      <clip pos="5" side="tl" part="gen" link-to="3"/>
	      <clip pos="5" side="tl" part="nbr" link-to="4"/>
	      <clip pos="5" side="tl" part="lemq"/>  
	    </lu> 
	    <b pos="4"/>
	    <lu> 
	      <lit v="de"/>
	      <lit-tag v="pr"/>
	    </lu>
	    <b/>
	    <lu>   
	      <clip pos="1" side="tl" part="lem"/> 
	      <clip pos="1" side="tl" part="a_det"/>
	      <clip pos="2" side="tl" part="gen"/>
	      <clip pos="2" side="tl" part="nbr"/>
	    </lu> 
	    <b/>
	    <lu> 
	      <clip pos="2" side="tl" part="lemh"/> 
	      <clip pos="2" side="tl" part="a_nom"/>
	      <clip pos="2" side="tl" part="gen"/>
	      <clip pos="2" side="tl" part="nbr"/>
	      <clip pos="2" side="tl" part="lemq"/>  
	    </lu> 
	  </chunk>
	</out>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>

    <rule comment="REGLA: ADJ NOM GENITIU NOM">
      <pattern>
	<pattern-item n="adj2"/>
	<pattern-item n="nom"/>
	<pattern-item n="genitiu"/>
	<pattern-item n="nom"/>
      </pattern>
      <action>
	<call-macro n="genere_nombre">
	  <with-param pos="4"/>
	</call-macro>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="comparatiu_adj1">
	  <with-param pos="1"/>
	</call-macro>  
	<out> 
	  <chunk name="adj_nom_genitiu_nom" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN.DET"/></tag>
	      <tag><clip pos="4" side="tl" part="gen"/></tag>
	      <tag><clip pos="4" side="tl" part="nbr"/></tag>
	    </tags>
	    <lu>
	      <lit v="el"/>
	      <lit-tag v="det.def"/>
	      <clip pos="4" side="tl" part="gen" link-to="3"/>
	      <clip pos="4" side="tl" part="nbr" link-to="4"/>
	    </lu>
	    <b pos="1"/>
	    <lu> 
	      <clip pos="4" side="tl" part="lemh"/> 
	      <clip pos="4" side="tl" part="a_nom"/>
	      <clip pos="4" side="tl" part="gen" link-to="3"/>
	      <clip pos="4" side="tl" part="nbr" link-to="4"/>
	      <clip pos="4" side="tl" part="lemq"/>  
	    </lu> 
	    <b pos="3"/>
	    <lu>   
	      <lit v="de"/>
	      <lit-tag v="pr"/>
	    </lu>
	    <b/>
	    <lu>
	      <lit v="el"/><!--Està bé posar l'article davant el primer nom? -->
	      <lit-tag v="det.def"/>
	      <clip pos="2" side="tl" part="gen"/>
	      <clip pos="2" side="tl" part="nbr"/>
	    </lu>
	    <b/>
	    <lu> 
	      <clip pos="2" side="tl" part="lemh"/> 
	      <clip pos="2" side="tl" part="a_nom"/>
	      <clip pos="2" side="tl" part="gen"/>
	      <clip pos="2" side="tl" part="nbr"/>
	      <clip pos="2" side="tl" part="lemq"/> 
	    </lu>
	    <b/>
	    <lu> 
	      <var n="adjectiu1"/>   
	      <clip pos="1" side="tl" part="lem"/> 
	      <clip pos="1" side="tl" part="a_adj"/>
	      <clip pos="2" side="tl" part="gen" link-to="3"/>
	      <clip pos="2" side="tl" part="nbr" link-to="4"/>
	    </lu> 
	  </chunk>
	</out>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>

    <rule comment="REGLA: NOM GENITIU NOM NOM (Mexico's emergencies ministry)">
      <pattern>
	<pattern-item n="nom"/>
	<pattern-item n="genitiu"/>
	<pattern-item n="nom"/>
	<pattern-item n="nom"/>
      </pattern>
      <action>
	<call-macro n="genere_nombre">
	  <with-param pos="4"/>
	</call-macro>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<out> 
	  <chunk name="nom_genitiu_nom" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN.DET"/></tag>
	      <tag><clip pos="4" side="tl" part="gen"/></tag>
	      <tag><clip pos="4" side="tl" part="nbr"/></tag>
	    </tags>
	    <lu>
	      <lit v="el"/>
	      <lit-tag v="det.def"/>
	      <clip pos="4" side="tl" part="gen" link-to="3"/>
	      <clip pos="4" side="tl" part="nbr" link-to="4"/>
	    </lu>
	    <b pos="2"/>
	    <lu> 
	      <clip pos="4" side="tl" part="lemh"/> 
	      <clip pos="4" side="tl" part="a_nom"/>
	      <clip pos="4" side="tl" part="gen" link-to="3"/>
	      <clip pos="4" side="tl" part="nbr" link-to="4"/>
	      <clip pos="4" side="tl" part="lemq"/>  
	    </lu> 
	    <b/>
	    <lu>
	      <lit v="de"/>
	      <lit-tag v="pr"/>
	    </lu>
	    <b pos="3"/>
	    <lu> 
	      <clip pos="3" side="tl" part="lemh"/> 
	      <clip pos="3" side="tl" part="a_nom"/>
	      <clip pos="3" side="tl" part="gen"/>
	      <clip pos="3" side="tl" part="nbr"/>
	      <clip pos="3" side="tl" part="lemq"/> 
	    </lu>
	    <b/>
	    <lu>   
	      <lit v="de"/>
	      <lit-tag v="pr"/>
	    </lu>
	    <b/>
	    <lu> 
	      <clip pos="1" side="tl" part="lemh"/> 
	      <clip pos="1" side="tl" part="a_nom"/>
	      <clip pos="1" side="tl" part="gen"/>
	      <clip pos="1" side="tl" part="nbr"/>
	      <clip pos="1" side="tl" part="lemq"/>  
	    </lu> 
	  </chunk>
	</out>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>

    <rule comment="REGLA: DET ADJ NOM GENITIU NOM (the American public's imagination)">
      <pattern>
	<pattern-item n="det"/>
	<pattern-item n="adj2"/>
	<pattern-item n="nom"/>
	<pattern-item n="genitiu"/>
	<pattern-item n="nom"/>
      </pattern>
      <action>
	<call-macro n="genere_nombre">
	  <with-param pos="5"/>
	</call-macro>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="comparatiu_adj1">
	  <with-param pos="2"/>
	</call-macro>  
	<out> 
	  <chunk name="det_adj_nom_genitiu_nom" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN.DET"/></tag>
	      <tag><clip pos="5" side="tl" part="gen"/></tag>
	      <tag><clip pos="5" side="tl" part="nbr"/></tag>
	    </tags>
	    <lu>
	      <lit v="el"/>
	      <lit-tag v="det.def"/>
	      <clip pos="5" side="tl" part="gen" link-to="3"/>
	      <clip pos="5" side="tl" part="nbr" link-to="4"/>
	    </lu>
	    <b pos="1"/>
	    <lu> 
	      <clip pos="5" side="tl" part="lemh"/> 
	      <clip pos="5" side="tl" part="a_nom"/>
	      <clip pos="5" side="tl" part="gen" link-to="3"/>
	      <clip pos="5" side="tl" part="nbr" link-to="4"/>
	      <clip pos="5" side="tl" part="lemq"/>  
	    </lu> 
	    <b pos="2"/>
	    <lu>   
	      <lit v="de"/>
	      <lit-tag v="pr"/>
	    </lu>
	    <b pos="4"/>
	    <lu>
	      <clip pos="1" side="tl" part="lem"/> 
	      <clip pos="1" side="tl" part="a_det"/>
	      <clip pos="3" side="tl" part="gen"/>
	      <clip pos="3" side="tl" part="nbr"/>
	    </lu>
	    <b/>
	    <lu> 
	      <clip pos="3" side="tl" part="lemh"/> 
	      <clip pos="3" side="tl" part="a_nom"/>
	      <clip pos="3" side="tl" part="gen"/>
	      <clip pos="3" side="tl" part="nbr"/>
	      <clip pos="3" side="tl" part="lemq"/> 
	    </lu>
	    <b/>
	    <lu> 
	      <var n="adjectiu1"/>   
	      <clip pos="2" side="tl" part="lem"/> 
	      <clip pos="2" side="tl" part="a_adj"/>
	      <clip pos="3" side="tl" part="gen"/>
	      <clip pos="3" side="tl" part="nbr"/>
	    </lu> 
	  </chunk>
	</out>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>
    <!-- FI SINTAGMES NOMINALS AMB GENITIU-->


    <!-- SINTAGMES NOMINALS ALTRES-->

    <rule comment="REGLA: NUM-NOM1-OLD NOM3 -> NOM3 de NUM NOM1(pl) (48-year-old man - home de 48 anys)">
      <pattern>
	<pattern-item n="num"/>
	<pattern-item n="guio"/>
	<pattern-item n="yearmonth"/>
	<pattern-item n="guio"/>
	<pattern-item n="old"/>
	<pattern-item n="nom"/>
      </pattern>
      <action>
	<call-macro n="genere_nombre">
	  <with-param pos="6"/>
	</call-macro>
	<call-macro n="million">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="flexio_numerals">
	  <with-param pos="1"/>
	  <with-param pos="3"/>
	</call-macro>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<out> 
	  <chunk name="num_yearold_nom" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN.UNDET"/></tag>
	      <tag><clip pos="6" side="tl" part="gen"/></tag>
	      <tag><clip pos="6" side="tl" part="nbr"/></tag>
	    </tags>	
	    <lu> 
	      <clip pos="6" side="tl" part="lemh"/> 
	      <clip pos="6" side="tl" part="a_nom"/>
	      <clip pos="6" side="tl" part="gen" link-to="3"/>
	      <clip pos="6" side="tl" part="nbr" link-to="4"/>
	      <clip pos="6" side="tl" part="lemq"/>  
	    </lu> 
	    <b pos="5"/>
	    <lu>
	      <lit v="de"/>
	      <lit-tag v="pr"/>
	    </lu>
	    <b/>
	    <lu>   
	      <clip pos="1" side="tl" part="whole"/> 
	    </lu> 
	    <b/> 
	    <lu>   
	      <clip pos="3" side="tl" part="lemh"/> 
	      <clip pos="3" side="tl" part="a_nom"/>
	      <clip pos="3" side="tl" part="gen"/>
	      <lit-tag v="pl"/><!--MG: atenció! i quan és 'one-month'? - arreglar -->
	      <clip pos="3" side="tl" part="lemq"/>
	    </lu> 
	  </chunk>
	</out>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>

    <rule comment="REGLA: DET NUM-NOM1-OLD NOM3 -> DET NOM3 de NUM NOM1(pl) (the 48-year-old man - l'home de 48 anys)">
      <pattern>
	<pattern-item n="det"/>
	<pattern-item n="num"/>
	<pattern-item n="guio"/>
	<pattern-item n="yearmonth"/>
	<pattern-item n="guio"/>
	<pattern-item n="old"/>
	<pattern-item n="nom"/>
      </pattern>
      <action>
	<call-macro n="genere_nombre">
	  <with-param pos="7"/>
	</call-macro>
	<call-macro n="million">
	  <with-param pos="2"/>
	</call-macro>
	<call-macro n="flexio_numerals">
	  <with-param pos="2"/>
	  <with-param pos="4"/>
	</call-macro>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<out> 
	  <chunk name="det_num_yearold_nom" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN.DET"/></tag>
	      <tag><clip pos="7" side="tl" part="gen"/></tag>
	      <tag><clip pos="7" side="tl" part="nbr"/></tag>
	    </tags>
	    <lu>   
	      <clip pos="1" side="tl" part="lem"/> 
	      <clip pos="1" side="tl" part="a_det"/>
	      <clip pos="7" side="tl" part="gen" link-to="3"/>
	      <clip pos="7" side="tl" part="nbr" link-to="4"/>
	    </lu> 
	    <b pos="1"/>
	    <lu> 
	      <clip pos="7" side="tl" part="lemh"/> 
	      <clip pos="7" side="tl" part="a_nom"/>
	      <clip pos="7" side="tl" part="gen" link-to="3"/>
	      <clip pos="7" side="tl" part="nbr" link-to="4"/>
	      <clip pos="7" side="tl" part="lemq"/>  
	    </lu> 
	    <b pos="6"/>
	    <lu>
	      <lit v="de"/>
	      <lit-tag v="pr"/>
	    </lu>
	    <b/>
	    <lu>   
	      <clip pos="2" side="tl" part="whole"/> 
	    </lu> 
	    <b/> 
	    <lu>   
	      <clip pos="4" side="tl" part="lemh"/> 
	      <clip pos="4" side="tl" part="a_nom"/>
	      <clip pos="4" side="tl" part="gen"/>
	      <lit-tag v="pl"/><!--MG: atenció! i quan és 'one-month'? - arreglar -->
	      <clip pos="4" side="tl" part="lemq"/>
	    </lu> 
	  </chunk>
	</out>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>
    <!-- FI SINTAGMES NOMINALS ALTRES-->



    <!--    <rule comment="REGLA: DET PP NOM  (The preferred model - el model preferit. An increased risk - un risc augmentat (major)">   BCN OJO OJO sobra
	 <pattern>
	 <pattern-item n="det"/>
	 <pattern-item n="ppadj"/>
	 <pattern-item n="nom"/>
	 </pattern>
	 <action>
	 <call-macro n="genere_nombre">
	 <with-param pos="3"/>
	 </call-macro>
	 <call-macro n="firstWord">
	 <with-param pos="1"/>
	 </call-macro>
	 <out> 
	 <chunk name="det_adj_nom" case="caseFirstWord">
	 <tags>
	 <tag><lit-tag v="SN.DET"/></tag>
	 <tag><clip pos="3" side="tl" part="gen"/></tag>
	 <tag><clip pos="3" side="tl" part="nbr"/></tag>
	 </tags>
	 <lu>   
	 <clip pos="1" side="tl" part="lem"/> 
	 <clip pos="1" side="tl" part="a_det"/>
	 <clip pos="3" side="tl" part="gen" link-to="3"/>
	 <clip pos="3" side="tl" part="nbr" link-to="4"/>
	 </lu> 
	 <b pos="1"/>
	 <lu> 
	 <clip pos="3" side="tl" part="lemh"/> 
	 <clip pos="3" side="tl" part="a_nom"/>
	 <clip pos="3" side="tl" part="gen" link-to="3"/>
	 <clip pos="3" side="tl" part="nbr" link-to="4"/>
	 <clip pos="3" side="tl" part="lemq"/>  
	 </lu> 
	 <b pos="2"/>
	 <lu> 
	 <clip pos="2" side="tl" part="lemh"/> 
	 <clip pos="2" side="tl" part="a_pp"/>
	 <clip pos="3" side="tl" part="gen" link-to="3"/>
	 <clip pos="3" side="tl" part="nbr" link-to="4"/>
	 <clip pos="2" side="tl" part="lemq"/> 
	 </lu> 
	 </chunk>
	 </out>
	 <let>
	 <var n="caseFirstWord"/>
	 <lit v="aa"/>
	 </let>
	 </action>
	 </rule>-->






    <rule comment="REGLA: COMA WHICH (BCN noun, which noun -> el qual)"> 
      <pattern>
	<pattern-item n="coma"/>
	<pattern-item n="which"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<out>
	  <chunk name="coma">
	    <tags>
	      <tag><clip pos="1" side="tl" part="tags"/></tag>
	    </tags>
	    <lu>
	      <clip pos="1" side="tl" part="whole"/> 
	    </lu>
	  </chunk>
	  <b pos="1"/>
	  <chunk name="relnom" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="REL"/></tag>
	      <tag><lit-tag v="nn"/></tag>
	      <tag><lit-tag v="GD"/></tag>
	      <tag><lit-tag v="ND"/></tag>
	    </tags>
	    <lu>
	      <lit v="el qual"/> 
	      <lit-tag v="rel"/>
	      <lit-tag v="nn"/>
	      <lit-tag v="3"/>
	      <lit-tag v="4"/>
	    </lu> 
	  </chunk>
	</out>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule> 


    <rule comment="REGLA: PREP WHICH (to which all belong -> 'al qual(rel.nn)' i no 'a que(rel.an.)')"> 
      <pattern>
	<pattern-item n="prep"/>
	<pattern-item n="which"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<out>
	  <chunk name="pr" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="PREP"/></tag>
	    </tags>
	    <lu>
	      <clip pos="1" side="tl" part="whole"/>
	    </lu>
	  </chunk>
	  <b pos="1"/>
	  <chunk name="relnom">
	    <tags>
	      <tag><lit-tag v="REL"/></tag>
	      <tag><lit-tag v="nn"/></tag>
	      <tag><lit-tag v="GD"/></tag>
	      <tag><lit-tag v="ND"/></tag>
	    </tags>
	    <lu>
	      <lit v="el qual"/> 
	      <lit-tag v="rel"/>
	      <lit-tag v="nn"/>
	      <lit-tag v="3"/>
	      <lit-tag v="4"/>
	    </lu> 
	  </chunk>
	</out>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule> 


    <rule comment="REGLA: NUMERAL. Si pot ser 'm' o 'f', sortirà com a GD. Caldrà tractar-ho en interchunk o postchunk.">
      <pattern>
	<pattern-item n="num"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<out>
	  <chunk name="num" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="NUM"/></tag>
	      <tag><clip pos="1" side="tl" part="gen"/></tag>
	      <tag><clip pos="1" side="tl" part="nbr"/></tag>
	    </tags>
	    <lu>   
	      <clip pos="1" side="tl" part="lem"/>
	      <clip pos="1" side="tl" part="a_num"/> 
	      <clip pos="1" side="tl" part="gen" link-to="2"/>
	      <clip pos="1" side="tl" part="nbr"/>
	    </lu> 
	  </chunk>
	</out>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>


    <rule comment="REGLA: DETERMINANT">          
      <pattern>
	<pattern-item n="det"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<choose>
	  <when>
	    <test>
	      <not>
		<or>
		  <equal>
		    <clip pos="1" side="tl" part="nbr"/>
		    <lit-tag v="sg"/>
		  </equal>
		  <equal>
		    <clip pos="1" side="tl" part="nbr"/>
		    <lit-tag v="pl"/>
		  </equal>
		</or>
	      </not>
	    </test>
	    <let>
	      <clip pos="1" side="tl" part="nbr"/>
	      <lit-tag v="ND"/>
	    </let>
	  </when>
	</choose>
	
	<out>
	  <chunk name="det" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="DET"/></tag>
	      <tag><lit-tag v="GD"/></tag>
	      <tag><clip pos="1" side="tl" part="nbr"/></tag>
	    </tags>
	    <lu>
	      <clip pos="1" side="tl" part="lem"/> 
	      <clip pos="1" side="tl" part="a_det"/>
	      <lit-tag v="2"/>
	      <lit-tag v="3"/>
	    </lu>	
	  </chunk>
	</out>

	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule> 


    <rule comment="REGLA: NOM (per a donar valor a la variable de gènere, i per a col·locar la cua en les multiparaules amb g">
      <pattern>
	<pattern-item n="nom"/>
      </pattern>
      <action>
	<call-macro n="genere_nombre">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<out> 
	  <chunk name="nom" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN.UNDET"/></tag>
	      <tag><clip pos="1" side="tl" part="gen"/></tag>
	      <tag><clip pos="1" side="tl" part="nbr"/></tag>
	    </tags>
	    <lu> 
	      <clip pos="1" side="tl" part="lemh"/> 
	      <clip pos="1" side="tl" part="a_nom"/>
	      <clip pos="1" side="tl" part="gen" link-to="3"/>
	      <clip pos="1" side="tl" part="nbr" link-to="4"/>
	      <clip pos="1" side="tl" part="lemq"/> 
	    </lu>
	  </chunk>
	</out>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>



    <rule comment="REGLA: ADJECTIU + enough (BCN strong enough :: prou fort)">
      <pattern>
	<pattern-item n="adj"/>
	<pattern-item n="enough"/>
      </pattern>
      <action>    
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="comparatiu_adj1">
	  <with-param pos="1"/>
	</call-macro>    
	<out>   
	  <chunk name="adj" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SA"/></tag>
	      <tag><lit-tag v="GD"/></tag>
	      <tag><lit-tag v="ND"/></tag>
	    </tags>    	
	    <lu>
	      <clip pos="2" side="tl" part="whole"/>
	    </lu>
	    <b/>
	    <lu> 
	      <var n="adjectiu1"/>   
	      <clip pos="1" side="tl" part="lemh"/> <!-- BCN cua PPs-->
	      <clip pos="1" side="tl" part="a_adj"/>
	      <lit-tag v="2"/>
	      <lit-tag v="3"/>
	      <clip pos="1" side="tl" part="lemq"/> <!-- per a les possibles cues dels PPs --> 
	    </lu> 
	  </chunk>
	</out>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule> 

    <rule comment="REGLA: ADJECTIU (queda com a GD i ND fins al interchunk)">
      <pattern>
	<pattern-item n="adj"/>
      </pattern>
      <action>    
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="comparatiu_adj1">
	  <with-param pos="1"/>
	</call-macro>    
	<out>   
	  <chunk name="adj" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SA"/></tag>
	      <tag><lit-tag v="GD"/></tag>
	      <tag><lit-tag v="ND"/></tag>
	    </tags>    	
	    <lu> 
	      <var n="adjectiu1"/>   
	      <clip pos="1" side="tl" part="lemh"/> <!-- BCN cua PPs-->
	      <clip pos="1" side="tl" part="a_adj"/>
	      <lit-tag v="2"/>
	      <lit-tag v="3"/>
	      <clip pos="1" side="tl" part="lemq"/> <!-- per a les possibles cues dels PPs --> 
	    </lu> 
	  </chunk>
	</out>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule> 
    
    <rule comment="REGLA: ADJ TO INF (BCN: canviem la prep TO per DE; els adjectius que no compleixin la regla s'han de codificar al lèxic. Queda com a GD i ND fins al interchunk)">
      <pattern>
	<pattern-item n="adj2"/> <!-- BCN només volesm adjs 'reals' no PPs-->
	<pattern-item n="to"/>
	<pattern-item n="inf"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="comparatiu_adj1">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="tipus_verbs"> <!-- per tractar la cua en verbs multiparaula -->
	  <with-param pos="3"/>
	</call-macro>

	<choose>                <!-- la part del INF per a tractar la cua si enté-->
	  <when>
	    <test>
	      <not>
		<or>
		  <equal caseless="yes">
		    <clip pos="3" side="sl" part="lem"/>
		    <lit v="will"/>
		  </equal>
		  <equal caseless="yes">
		    <clip pos="3" side="sl" part="lem"/>
		    <lit v="shall"/>
		  </equal>
		  <equal caseless="yes">
		    <clip pos="3" side="sl" part="lem"/>
		    <lit v="would"/>
		  </equal>
		</or>
	      </not>
	    </test>
	    <choose>
	      <when>
		<test>
		  <equal>
		    <var n="tipus_verb"/>
		    <lit-tag v="pron"/>
		  </equal>
		</test>
		<out>

		  <chunk name="adj" case="caseFirstWord">
		    <tags>
		      <tag><lit-tag v="SA"/></tag>
		      <tag><lit-tag v="GD"/></tag>
		      <tag><lit-tag v="ND"/></tag>
		      <tag><lit-tag v="inf"/></tag> <!-- posat a mà-->
		    </tags>
		    <lu>
		      <var n="adjectiu1"/>
		      <clip pos="1" side="tl" part="lem"/>
		      <clip pos="1" side="tl" part="a_adj"/>
		      <lit-tag v="2"/>
		      <lit-tag v="3"/>
		    </lu>
		    <b pos="1"/>
		    <lu>
		      <lit v="de"/>
		      <lit-tag v="pr"/>
		    </lu>
		    <b pos="2"/>
		    <mlu>
		      <lu>
			<clip pos="3" side="tl" part="lemh"/>
			<clip pos="3" side="tl" part="a_verb"/>
			<clip pos="3" side="tl" part="temps" link-to="4"/>
		      </lu>
		      <lu>
			<lit v="es"/>
			<lit-tag v="prn.enc.ref.p3.mf.sp"/>
			<clip pos="3" side="tl" part="lemq"/>
		      </lu>
		    </mlu>
		  </chunk>
		</out>
	      </when>
	      <otherwise>
		<out>
		  <chunk name="adj" case="caseFirstWord">
		    <tags>
		      <tag><lit-tag v="SA"/></tag>
		      <tag><lit-tag v="GD"/></tag>
		      <tag><lit-tag v="ND"/></tag>
		      <tag><lit-tag v="inf"/></tag> <!-- posat a mà-->
		    </tags>
		    <lu>
		      <var n="adjectiu1"/>
		      <clip pos="1" side="tl" part="lem"/>
		      <clip pos="1" side="tl" part="a_adj"/>
		      <lit-tag v="2"/>
		      <lit-tag v="3"/>
		    </lu>
		    <b pos="1"/>
		    <lu>
		      <lit v="de"/>
		      <lit-tag v="pr"/>
		    </lu>
		    <b pos="2"/>
		    <lu>
		      <clip pos="3" side="tl" part="lemh"/>
		      <clip pos="3" side="tl" part="a_verb"/>
		      <clip pos="3" side="tl" part="temps" link-to="4"/>
		      <clip pos="3" side="tl" part="lemq"/>
		    </lu>
		  </chunk>
		</out>
	      </otherwise>
	    </choose>
	  </when>
	</choose>

	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>


 <rule comment="REGLA: ADJ TO INF PRNobj (BCN: canviem la prep TO per DE; els adjectius que no compleixin la regla s'han de codificar al lèxic. Queda com a GD i ND fins al interchunk)">
      <pattern>
	<pattern-item n="adj2"/> <!-- BCN només volesm adjs 'reals' no PPs-->
	<pattern-item n="to"/>
	<pattern-item n="inf"/>
	<pattern-item n="probj"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="comparatiu_adj1">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="tipus_verbs"> <!-- per tractar la cua en verbs multiparaula -->
	  <with-param pos="3"/>
	</call-macro>

	<choose>                <!-- la part del INF per a tractar la cua si enté-->
	  <when>
	    <test>
	      <not>
		<or>
		  <equal caseless="yes">
		    <clip pos="3" side="sl" part="lem"/>
		    <lit v="will"/>
		  </equal>
		  <equal caseless="yes">
		    <clip pos="3" side="sl" part="lem"/>
		    <lit v="shall"/>
		  </equal>
		  <equal caseless="yes">
		    <clip pos="3" side="sl" part="lem"/>
		    <lit v="would"/>
		  </equal>
		</or>
	      </not>
	    </test>
	    <choose>
	      <when>
		<test>
		  <equal>
		    <var n="tipus_verb"/>
		    <lit-tag v="pron"/>
		  </equal>
		</test>
		<out>

		  <chunk name="adj" case="caseFirstWord">
		    <tags>
		      <tag><lit-tag v="SA"/></tag>
		      <tag><lit-tag v="GD"/></tag>
		      <tag><lit-tag v="ND"/></tag>
		      <tag><lit-tag v="inf"/></tag> <!-- posat a mà-->
		    </tags>
		    <lu>
		      <var n="adjectiu1"/>
		      <clip pos="1" side="tl" part="lem"/>
		      <clip pos="1" side="tl" part="a_adj"/>
		      <lit-tag v="2"/>
		      <lit-tag v="3"/>
		    </lu>
		    <b pos="1"/>
		    <lu>
		      <lit v="de"/>
		      <lit-tag v="pr"/>
		    </lu>
		    <b pos="2"/>
		    <mlu>
		      <lu>
			<clip pos="3" side="tl" part="lemh"/>
			<clip pos="3" side="tl" part="a_verb"/>
			<clip pos="3" side="tl" part="temps" link-to="4"/>
		      </lu>
		      <lu>
			<lit v="es"/>
			<lit-tag v="prn.enc.ref.p3.mf.sp"/>
		      </lu>
		      <lu>
			<clip pos="4" side="tl" part="lem"/>
			<lit-tag v="prn.enc"/>
			<clip pos="4" side="tl" part="pers"/>
			<clip pos="4" side="tl" part="gen"/>
			<clip pos="4" side="tl" part="nbr"/>
			<clip pos="3" side="tl" part="lemq"/>
		      </lu>
		    </mlu>
		  </chunk>
		</out>
	      </when>
	      <otherwise>
		<out>
		  <chunk name="adj" case="caseFirstWord">
		    <tags>
		      <tag><lit-tag v="SA"/></tag>
		      <tag><lit-tag v="GD"/></tag>
		      <tag><lit-tag v="ND"/></tag>
		      <tag><lit-tag v="inf"/></tag> <!-- posat a mà-->
		    </tags>
		    <lu>
		      <var n="adjectiu1"/>
		      <clip pos="1" side="tl" part="lem"/>
		      <clip pos="1" side="tl" part="a_adj"/>
		      <lit-tag v="2"/>
		      <lit-tag v="3"/>
		    </lu>
		    <b pos="1"/>
		    <lu>
		      <lit v="de"/>
		      <lit-tag v="pr"/>
		    </lu>
		    <b pos="2"/>
		    <mlu>
		      <lu>
			<clip pos="3" side="tl" part="lemh"/>
			<clip pos="3" side="tl" part="a_verb"/>
			<clip pos="3" side="tl" part="temps" link-to="4"/>
		      </lu>
		      <lu>
			<clip pos="4" side="tl" part="lem"/>
			<lit-tag v="prn.enc"/>
			<clip pos="4" side="tl" part="pers"/>
			<clip pos="4" side="tl" part="gen"/>
			<clip pos="4" side="tl" part="nbr"/>
			<clip pos="3" side="tl" part="lemq"/>
		      </lu>
		    </mlu>
		  </chunk>
		</out>
	      </otherwise>
	    </choose>
	  </when>
	</choose>
	<call-macro n="f_bcond">
	  <with-param pos="3"/>
	</call-macro>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>


    <rule comment="REGLA: ADV ADJ TO INF (BCN: canviem la prep TO per DE; els adjectius que no compleixin la regla s'han de codificar al lèxic. Queda com a GD i ND fins al interchunk)">
      <pattern>
	<pattern-item n="preadv"/> 
	<pattern-item n="adj2"/> <!-- BCN només volem adjs 'reals' no PPs-->
	<pattern-item n="to"/>
	<pattern-item n="inf"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="comparatiu_adj1">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="tipus_verbs"> <!-- per tractar la cua en verbs multiparaula -->
	  <with-param pos="4"/>
	</call-macro>

	<choose>                <!-- la part del INF per a tractar la cua si enté-->
	  <when>
	    <test>
	      <not>
		<or>
		  <equal caseless="yes">
		    <clip pos="4" side="sl" part="lem"/>
		    <lit v="will"/>
		  </equal>
		  <equal caseless="yes">
		    <clip pos="4" side="sl" part="lem"/>
		    <lit v="shall"/>
		  </equal>
		  <equal caseless="yes">
		    <clip pos="4" side="sl" part="lem"/>
		    <lit v="would"/>
		  </equal>
		</or>
	      </not>
	    </test>
	    <choose>
	      <when>
		<test>
		  <equal>
		    <var n="tipus_verb"/>
		    <lit-tag v="pron"/>
		  </equal>
		</test>
		<out>

		  <chunk name="adj" case="caseFirstWord">
		    <tags>
		      <tag><lit-tag v="SA"/></tag>
		      <tag><lit-tag v="GD"/></tag>
		      <tag><lit-tag v="ND"/></tag>
		      <tag><lit-tag v="inf"/></tag> <!-- posat a mà-->
		    </tags>
		    <lu>
		      <clip pos="1" side="tl" part="whole"/>
		    </lu>
		    <b pos="1"/>
		    <lu>
		      <var n="adjectiu1"/>
		      <clip pos="2" side="tl" part="lem"/>
		      <clip pos="2" side="tl" part="a_adj"/>
		      <lit-tag v="2"/>
		      <lit-tag v="3"/>
		    </lu>
		    <b pos="2"/>
		    <lu>
		      <lit v="de"/>
		      <lit-tag v="pr"/>
		    </lu>
		    <b pos="3"/>

		    <mlu>
		      <lu>
			<clip pos="4" side="tl" part="lemh"/>
			<clip pos="4" side="tl" part="a_verb"/>
			<clip pos="4" side="tl" part="temps" link-to="4"/>

		      </lu>
		      <lu>
			<lit v="es"/>
			<lit-tag v="prn.enc.ref.p3.mf.sp"/>
			<clip pos="4" side="tl" part="lemq"/>
		      </lu>
		    </mlu>
		  </chunk>
		</out>
	      </when>
	      <otherwise>
		<out>
		  <chunk name="adj" case="caseFirstWord">
		    <tags>
		      <tag><lit-tag v="SA"/></tag>
		      <tag><lit-tag v="GD"/></tag>
		      <tag><lit-tag v="ND"/></tag>
		      <tag><lit-tag v="inf"/></tag> <!-- posat a mà-->
		    </tags>
		    <lu>
		      <clip pos="1" side="tl" part="whole"/>
		    </lu>
		    <b pos="1"/>
		    <lu>
		      <var n="adjectiu1"/>
		      <clip pos="2" side="tl" part="lem"/>
		      <clip pos="2" side="tl" part="a_adj"/>
		      <lit-tag v="2"/>
		      <lit-tag v="3"/>
		    </lu>
		    <b pos="2"/>
		    <lu>
		      <lit v="de"/>
		      <lit-tag v="pr"/>
		    </lu>
		    <b pos="3"/>
		    <lu>
		      <clip pos="4" side="tl" part="lemh"/>
		      <clip pos="4" side="tl" part="a_verb"/>
		      <clip pos="4" side="tl" part="temps" link-to="4"/>
		      <clip pos="4" side="tl" part="lemq"/>
		    </lu>
		  </chunk>
		</out>
	      </otherwise>
	    </choose>
	  </when>
	</choose>

	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>


   <rule comment="REGLA: ADV ADJ TO INF (BCN: canviem la prep TO per DE; els adjectius que no compleixin la regla s'han de codificar al lèxic. Queda com a GD i ND fins al interchunk)">
      <pattern>
	<pattern-item n="preadv"/> 
	<pattern-item n="adj2"/> <!-- BCN només volem adjs 'reals' no PPs-->
	<pattern-item n="to"/>
	<pattern-item n="inf"/>
	<pattern-item n="probj"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="comparatiu_adj1">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="tipus_verbs"> <!-- per tractar la cua en verbs multiparaula -->
	  <with-param pos="4"/>
	</call-macro>

	<choose>                <!-- la part del INF per a tractar la cua si enté-->
	  <when>
	    <test>
	      <not>
		<or>
		  <equal caseless="yes">
		    <clip pos="4" side="sl" part="lem"/>
		    <lit v="will"/>
		  </equal>
		  <equal caseless="yes">
		    <clip pos="4" side="sl" part="lem"/>
		    <lit v="shall"/>
		  </equal>
		  <equal caseless="yes">
		    <clip pos="4" side="sl" part="lem"/>
		    <lit v="would"/>
		  </equal>
		</or>
	      </not>
	    </test>
	    <choose>
	      <when>
		<test>
		  <equal>
		    <var n="tipus_verb"/>
		    <lit-tag v="pron"/>
		  </equal>
		</test>
		<out>

		  <chunk name="adj" case="caseFirstWord">
		    <tags>
		      <tag><lit-tag v="SA"/></tag>
		      <tag><lit-tag v="GD"/></tag>
		      <tag><lit-tag v="ND"/></tag>
		      <tag><lit-tag v="inf"/></tag> <!-- posat a mà-->
		    </tags>
		    <lu>
		      <clip pos="1" side="tl" part="whole"/>
		    </lu>
		    <b pos="1"/>
		    <lu>
		      <var n="adjectiu1"/>
		      <clip pos="2" side="tl" part="lem"/>
		      <clip pos="2" side="tl" part="a_adj"/>
		      <lit-tag v="2"/>
		      <lit-tag v="3"/>
		    </lu>
		    <b pos="2"/>
		    <lu>
		      <lit v="de"/>
		      <lit-tag v="pr"/>
		    </lu>
		    <b pos="3"/>
		    <mlu>
		      <lu>
			<clip pos="4" side="tl" part="lemh"/>
			<clip pos="4" side="tl" part="a_verb"/>
			<clip pos="4" side="tl" part="temps" link-to="4"/>
		      </lu>
		      <lu>
			<lit v="es"/>
			<lit-tag v="prn.enc.ref.p3.mf.sp"/>
		      </lu>
		      <lu>
			<clip pos="5" side="tl" part="lem"/>
			<lit-tag v="prn.enc"/>
			<clip pos="5" side="tl" part="pers"/>
			<clip pos="5" side="tl" part="gen"/>
			<clip pos="5" side="tl" part="nbr"/>
			<clip pos="4" side="tl" part="lemq"/>
		      </lu>
		    </mlu>
		  </chunk>
		</out>
	      </when>
	      <otherwise>
		<out>
		  <chunk name="adj" case="caseFirstWord">
		    <tags>
		      <tag><lit-tag v="SA"/></tag>
		      <tag><lit-tag v="GD"/></tag>
		      <tag><lit-tag v="ND"/></tag>
		      <tag><lit-tag v="inf"/></tag> <!-- posat a mà-->
		    </tags>
		    <lu>
		      <clip pos="1" side="tl" part="whole"/>
		    </lu>
		    <b pos="1"/>
		    <lu>
		      <var n="adjectiu1"/>
		      <clip pos="2" side="tl" part="lem"/>
		      <clip pos="2" side="tl" part="a_adj"/>
		      <lit-tag v="2"/>
		      <lit-tag v="3"/>
		    </lu>
		    <b pos="2"/>
		    <lu>
		      <lit v="de"/>
		      <lit-tag v="pr"/>
		    </lu>
		    <b pos="3"/>
		    <mlu>
		      <lu>
			<clip pos="4" side="tl" part="lemh"/>
			<clip pos="4" side="tl" part="a_verb"/>
			<clip pos="4" side="tl" part="temps" link-to="4"/>
		      </lu>
		      <lu>
			<clip pos="5" side="tl" part="lem"/>
			<lit-tag v="prn.enc"/>
			<clip pos="5" side="tl" part="pers"/>
			<clip pos="5" side="tl" part="gen"/>
			<clip pos="5" side="tl" part="nbr"/>
			<clip pos="4" side="tl" part="lemq"/>
		      </lu>
		    </mlu>
		  </chunk>
		</out>
	      </otherwise>
	    </choose>
	  </when>
	</choose>
	<call-macro n="f_bcond">
	  <with-param pos="4"/>
	</call-macro>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>


    <rule comment="REGLA: PREADV ADJECTIU ('very difficult'; queda com a GD i ND fins al interchunk)">
      <pattern>
	<pattern-item n="preadv"/>
	<pattern-item n="adj"/>
      </pattern>
      <action>    
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="comparatiu_adj1">
	  <with-param pos="2"/>
	</call-macro>    
	<out>   
	  <chunk name="adj" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SA"/></tag>
	      <tag><lit-tag v="GD"/></tag>
	      <tag><lit-tag v="ND"/></tag>
	    </tags>
	    <lu>
	      <clip pos="1" side="tl" part="whole"/> 
	    </lu>
	    <b pos="1"/> 
	    <lu> 
	      <var n="adjectiu1"/>   
	      <clip pos="2" side="tl" part="lemh"/> 
	      <clip pos="2" side="tl" part="a_adj"/>
	      <lit-tag v="2"/>
	      <lit-tag v="3"/>
	      <clip pos="2" side="tl" part="lemq"/> 
	    </lu> 
	  </chunk>
	</out>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule> 


 <rule comment="REGLA: NPLOC-PP (London-based)">
      <pattern>
	<pattern-item n="nploc"/>
	<pattern-item n="guio"/>
	<pattern-item n="pp"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>	
	<out>
	  <chunk name="np_pp" case="caseFirstWord">
	    <tags>	
	      <tag><lit-tag v="SA"/></tag>
	      <tag><lit-tag v="GD"/></tag>
	      <tag><lit-tag v="ND"/></tag>
	    </tags>
	    <lu> 
	      <clip pos="3" side="tl" part="lemh"/> 
	      <clip pos="3" side="tl" part="a_adj"/>
	      <lit-tag v="2"/>
	      <lit-tag v="3"/>
	    </lu> 
	    <b/>
	    <lu>
	      <lit v="a"/>
	      <lit-tag v="pr"/>
	    </lu> 
	    <b/>
	    <lu> 
	      <clip pos="1" side="tl" part="whole"/> 
	    </lu> 
	  </chunk>
	</out>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
</rule>


 <rule comment="REGLA: NPLOC-PP (London-based)">
      <pattern>
	<pattern-item n="det"/>
	<pattern-item n="nploc"/>
	<pattern-item n="guio"/>
	<pattern-item n="pp"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<choose>
	  <when>
	    <test>
	      <not>
		<or>
		  <equal>
		    <clip pos="1" side="tl" part="nbr"/>
		    <lit-tag v="sg"/>
		  </equal>
		  <equal>
		    <clip pos="1" side="tl" part="nbr"/>
		    <lit-tag v="pl"/>
		  </equal>
		</or>
	      </not>
	    </test>
	    <let>
	      <clip pos="1" side="tl" part="nbr"/>
	      <lit-tag v="ND"/>
	    </let>
	  </when>
	</choose>	
	<out>
	  <chunk name="det" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="DET"/></tag>
	      <tag><lit-tag v="GD"/></tag>
	      <tag><clip pos="1" side="tl" part="nbr"/></tag>
	    </tags>
	    <lu>
	      <clip pos="1" side="tl" part="lem"/> 
	      <clip pos="1" side="tl" part="a_det"/>
	      <lit-tag v="2"/>
	      <lit-tag v="3"/>
	    </lu>	
	  </chunk>
	  <b pos="1"/>
	  <chunk name="np_pp">
	    <tags>	
	      <tag><lit-tag v="SA"/></tag>
	      <tag><lit-tag v="GD"/></tag>
	      <tag><lit-tag v="ND"/></tag>
	    </tags>
	    <lu> 
	      <clip pos="4" side="tl" part="lemh"/> 
	      <clip pos="4" side="tl" part="a_adj"/>
	      <lit-tag v="2"/>
	      <lit-tag v="3"/>
	    </lu> 
	    <b/>
	    <lu>
	      <lit v="a"/>
	      <lit-tag v="pr"/>
	    </lu> 
	    <b/>
	    <lu> 
	      <clip pos="2" side="tl" part="whole"/> 
	    </lu> 
	  </chunk>
	</out>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
</rule>





    <rule comment="REGLA: PRONOM">
      <pattern>
	<pattern-item n="prnsubj"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>	
	<choose>
	  <when>
	    <test>
	      <not>
		<equal caseless="yes">
		  <clip pos="1" side="sl" part="lem"/> 
		  <lit v="prpers"/>
		</equal>
	      </not>
	    </test>
	      <let>
		<var n="lema"/>
		<lit v="prnsubj2"/><!--lemes 'we all' etc, són subjectes però no desapareixen en el t2x. -->
	      </let>
	  </when>
	  <otherwise>	    
	      <let>
		<var n="lema"/>
		<lit v="prnsubj"/>
	      </let>
	  </otherwise>
	</choose>	
		  
	<out>
	  <chunk namefrom="lema" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN"/></tag>
	      <tag><clip pos="1" side="tl" part="tipus_prn"/></tag>
	      <tag><clip pos="1" side="tl" part="pers"/></tag>
	      <tag><clip pos="1" side="tl" part="gen"/></tag>
	      <tag><clip pos="1" side="tl" part="nbr"/></tag>
	    </tags>
	    <lu>   
	      <clip pos="1" side="tl" part="lem"/>  
	      <clip pos="1" side="tl" part="a_prn"/>  
	      <clip pos="1" side="tl" part="tipus_prn" link-to="2"/> 
	      <clip pos="1" side="tl" part="pers"/>
	      <clip pos="1" side="tl" part="gen"/>
	      <clip pos="1" side="tl" part="nbr"/>
	    </lu> 
	  </chunk>
	</out>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule> 

    



    <rule comment="REGLA: DET NUM (per quan va davant de desconegudes, almenys que concordin entre ells) - The two xxx : els dos xxx">
      <pattern>
	<pattern-item n="det"/>
	<pattern-item n="num"/>
      </pattern>
      <action>

	<choose>
	  <when>
	    <test><!--MG: atenció, aquí amb la modificació de link-to, es podrien ajuntar els 2 chunks en un de sol. pendent. -->
	      <equal>
		<clip pos="2" side="tl" part="gen"/>
		<lit-tag v="GD"/>
	      </equal>
	    </test>
	    <out>
	      <chunk name="det_num" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="SN.DET"/></tag>
		  <tag><lit-tag v="GD"/></tag>
		  <tag><lit-tag v="ND"/></tag>
		</tags>
		<lu>   
		  <clip pos="1" side="tl" part="lem"/> 
		  <clip pos="1" side="tl" part="a_det"/>
		  <lit-tag v="3"/>
		  <lit-tag v="4"/> 
		</lu> 
		<b pos="1"/>
		<lu> 
		  <clip pos="2" side="tl" part="lemh"/> 
		  <clip pos="2" side="tl" part="a_num"/>
		  <lit-tag v="3"/>
		  <clip pos="2" side="tl" part="nbr"/>
		</lu> 
	      </chunk>
	    </out>
	  </when>
	  <otherwise>
	    <out>
	      <chunk name="det_num" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="SN.DET"/></tag>
		  <tag><lit-tag v="GD"/></tag>
		  <tag><lit-tag v="ND"/></tag>
		</tags>
		<lu>   
		  <clip pos="1" side="tl" part="lem"/> 
		  <clip pos="1" side="tl" part="a_det"/>
		  <lit-tag v="3"/>
		  <lit-tag v="4"/> 
		</lu> 
		<b pos="1"/>
		<lu> 
		  <clip pos="2" side="tl" part="lemh"/> 
		  <clip pos="2" side="tl" part="a_num"/>
		  <clip pos="2" side="tl" part="gen"/>
		  <clip pos="2" side="tl" part="nbr"/>
		</lu> 
	      </chunk>
	    </out>
	  </otherwise>
	</choose>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>


    <rule comment="REGLA: PREPOSICIÓ PRONOM_OBJECTE : with him - amb ell" >
      <pattern>
	<pattern-item n="prep"/>
	<pattern-item n="probj"/>
      </pattern>
      <action>
	<choose>
	  <when>
	    <test>
	      <and>
		<equal>
		  <clip pos="2" side="sl" part="pers"/> 
		  <lit-tag v="p3"/>
		</equal>
		<equal>
		  <clip pos="2" side="sl" part="nbr"/> 
		  <lit-tag v="pl"/>
		</equal>
	      </and>
	    </test>
	    <let>
	      <clip pos="2" side="tl" part="gen"/>
	      <lit-tag v="m"/><!--with them : amb ells (i no elles)-->
	    </let>
	  </when>
	  <when>
	    <test>
	      <and>
		<equal>
		  <clip pos="2" side="sl" part="pers"/> 
		  <lit-tag v="p3"/>
		</equal>
		<equal>
		  <clip pos="2" side="sl" part="nbr"/> 
		  <lit-tag v="sg"/>
		</equal>
	      </and>
	    </test>
	    <let>
	      <clip pos="2" side="tl" part="gen"/>
	      <clip pos="2" side="sl" part="gen"/>
	    </let><!--with her/him : pq la traducció del pron obj 3a sg és 'mf' en català (li), cal canviar a 'm' o 'f' per al pronom tònic (ell/ella) -->
	  </when>
	  <when>
	    <test>
	      <and>
		<equal>
		  <clip pos="2" side="sl" part="pers"/> 
		  <lit-tag v="p1"/>
		</equal>
		<equal>
		  <clip pos="2" side="sl" part="nbr"/> 
		  <lit-tag v="sg"/>
		</equal>
	      </and>
	    </test>
	    <let>
	      <clip pos="2" side="tl" part="lem"/>
	      <lit v="mi"/>
	    </let>
	  </when>
	</choose>
	<out>
	  <chunk name="pr" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="PREP"/></tag>
	    </tags>
	    <lu>   
	      <clip pos="1" side="tl" part="whole"/> 
	    </lu> 
	  </chunk>	  
	  <b pos="1"/>
	  <chunk name="probj" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN"/></tag>
	      <tag><lit-tag v="tn"/></tag>
	      <tag><clip pos="2" side="tl" part="pers"/></tag>
	      <tag><clip pos="2" side="tl" part="gen"/></tag>
	      <tag><clip pos="2" side="tl" part="nbr"/></tag>
	    </tags>
	    <lu>  
	      <clip pos="2" side="tl" part="lem"/>
	      <lit-tag v="prn"/>
	      <lit-tag v="2"/>
	      <clip pos="2" side="tl" part="pers"/>
	      <clip pos="2" side="tl" part="gen" link-to="4"/>
	      <clip pos="2" side="tl" part="nbr" link-to="5"/>
	    </lu> 
	  </chunk>
	</out>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>






    <!--********************************* REGLES DE SV ***************************************************** -->
    


    <rule comment="REGLA: VERB copulatiu PP (BCN el verb 'ser' del passat agafa la forma perifràstica">
      <pattern>
	<pattern-item n="copulatiu"/>
	<pattern-item n="pp"/>
      </pattern>
      <action>    
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<let>
	  <var n="lema"/>
	  <clip pos="1" side="sl" part="lem"/>
	</let>
	<append n="lema">
	  <lit v="_pp"/>
	</append>	  
	<choose>      
	  <when> 
	    <test>
	      <and>
		<equal>
		  <clip pos="1" side="sl" part="temps"/>
		  <lit-tag v="past"/>
		</equal>
		<equal>
		  <clip pos="1" side="sl" part="nbr"/>
		  <lit v=""/>
		</equal>
	      </and>	    
	    </test>
	    <out>
	      <chunk namefrom="lema" case="caseFirstWord">
		<tags>	       
		  <tag><lit-tag v="Vcop"/></tag>
		  <tag><clip pos="1" side="tl" part="a_verb"/></tag>
		  <tag><lit-tag v="ifip"/></tag>
		  <tag><lit-tag v="PD"/></tag>
		  <tag><lit-tag v="ND"/></tag>
		  <tag><lit-tag v="GD"/></tag>
		</tags> 
		<lu>
		  <lit v="anar"/>
		  <lit-tag v="vaux"/>
		  <lit-tag v="4"/>
		  <lit-tag v="5"/>
		</lu>
		<b/>
		<lu>
		  <clip pos="1" side="tl" part="lemh"/>
		  <clip pos="1" side="tl" part="a_verb"/>
		  <lit-tag v="inf"/>
		  <clip pos="1" side="tl" part="lemq"/> 
		</lu>
		<b pos="1"/>
		<lu>
		  <clip pos="2" side="tl" part="lemh"/> 
		  <clip pos="2" side="tl" part="a_pp"/>
		  <lit-tag v="6"/>
		  <lit-tag v="5"/>
		  <clip pos="2" side="tl" part="lemq"/>
		</lu>
	      </chunk>
	    </out>
	  </when>
	  
	  <when>	
	    <test>
	      <equal>
		<clip pos="1" side="sl" part="temps"/>
		<lit-tag v="pres"/>
	      </equal>
	    </test>
	    <let>
	      <clip pos="1" side="tl" part="temps"/>
	      <lit-tag v="pri"/>
	    </let>
	    <out>
	      <chunk namefrom="lema" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="Vcop"/></tag>
		  <tag><clip pos="1" side="tl" part="a_verb"/></tag>
		  <tag><clip pos="1" side="tl" part="temps"/></tag>
		  <tag><lit-tag v="PD"/></tag>
		  <tag><lit-tag v="ND"/></tag>
		  <tag><lit-tag v="GD"/></tag>
		</tags>      
		<lu>   
		  <clip pos="1" side="tl" part="lemh"/>
		  <clip pos="1" side="tl" part="a_verb"/>
		  <clip pos="1" side="tl" part="temps" link-to="3"/>
		  <lit-tag v="4"/>
		  <lit-tag v="5"/>
		  <clip pos="1" side="tl" part="lemq"/> 
		</lu> 
		<b pos="1"/>
		<lu>
		  <clip pos="2" side="tl" part="lemh"/> 
		  <clip pos="2" side="tl" part="a_pp"/>
		  <lit-tag v="6"/>
		  <lit-tag v="5"/>
		  <clip pos="2" side="tl" part="lemq"/>
		</lu>
	      </chunk>
	    </out>
	  </when>
	  
	  <when>	
	    <test>
	      <equal>
		<clip pos="1" side="sl" part="temps"/>
		<lit-tag v="pri"/>
	      </equal>
	    </test>
	    <out>
	      <chunk namefrom="lema" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="Vcop"/></tag>
		  <tag><clip pos="1" side="tl" part="a_verb"/></tag>
		  <tag><clip pos="1" side="tl" part="temps"/></tag>
		  <tag><clip pos="1" side="tl" part="pers"/></tag>
		  <tag><clip pos="1" side="tl" part="nbr"/></tag>
		  <tag><lit-tag v="GD"/></tag>
		</tags>      
		<lu>   
		  <clip pos="1" side="tl" part="lemh"/>
		  <clip pos="1" side="tl" part="a_verb"/>
		  <clip pos="1" side="tl" part="temps" link-to="3"/>
		  <clip pos="1" side="tl" part="pers" link-to="4"/>
		  <clip pos="1" side="tl" part="nbr" link-to="5"/>
		  <clip pos="1" side="tl" part="lemq"/>
		</lu> 
		<b pos="1"/>
		<lu>
		  <clip pos="2" side="tl" part="lemh"/> 
		  <clip pos="2" side="tl" part="a_pp"/>
		  <lit-tag v="6"/>
		  <lit-tag v="5"/>
		  <clip pos="2" side="tl" part="lemq"/>
		</lu>
	      </chunk>
	    </out>
	  </when>

	  <when>	
	    <test>
	      <and>
		<equal>
		  <clip pos="1" side="sl" part="temps"/>
		  <lit-tag v="past"/>
		</equal>
		<equal>
		  <clip pos="1" side="sl" part="nbr"/>
		  <lit-tag v="sg"/>
		</equal>
	      </and>
	    </test>
	    <let>
	      <clip pos="1" side="tl" part="pers"/>
	      <lit-tag v="PD"/>
	    </let>
	    <out>
	      <chunk namefrom="lema" case="caseFirstWord">
		<tags>	       
		  <tag><lit-tag v="Vcop"/></tag>
		  <tag><clip pos="1" side="tl" part="a_verb"/></tag>
		  <tag><lit-tag v="ifip"/></tag>
		  <tag><clip pos="1" side="tl" part="pers"/></tag>
		  <tag><clip pos="1" side="tl" part="nbr"/></tag>
		  <tag><lit-tag v="GD"/></tag>
		</tags> 
		<lu>
		  <lit v="anar"/>
		  <lit-tag v="vaux"/>
		  <clip pos="1" side="tl" part="pers" link-to="4"/>
		  <clip pos="1" side="tl" part="nbr" link-to="5"/>
		</lu>
		<b/>
		<lu>
		  <clip pos="1" side="tl" part="lemh"/>
		  <clip pos="1" side="tl" part="a_verb"/>
		  <lit-tag v="inf"/>
		  <clip pos="1" side="tl" part="lemq"/>
		</lu>
		<b pos="1"/>
		<lu>
		  <clip pos="2" side="tl" part="lemh"/> 
		  <clip pos="2" side="tl" part="a_pp"/>
		  <lit-tag v="6"/>
		  <lit-tag v="5"/>
		  <clip pos="2" side="tl" part="lemq"/>
		</lu>
	      </chunk>
	    </out>
	  </when>
	</choose>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>



    
    <rule comment="REGLA: VERB copulatiu">
      <pattern>
	<pattern-item n="copulatiu"/>
      </pattern>
      <action>    
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<let>
	  <var n="lema"/>
	  <clip pos="1" side="sl" part="lem"/>
	</let>
	<choose>      
	  <!--	  <when> (BCN el passat pren la forma sintètica)
	      <test>
	      <and>
	      <equal>
	      <clip pos="1" side="sl" part="temps"/>
	      <lit-tag v="past"/>
	      </equal>
	      <equal>
	      <clip pos="1" side="sl" part="nbr"/>
	      <lit v=""/>
	      </equal>
	      </and>	    
	      </test>
	      <out>
	      <chunk namefrom="lema" case="caseFirstWord">
	      <tags>	       
	      <tag><lit-tag v="Vcop"/></tag>
	      <tag><clip pos="1" side="tl" part="a_verb"/></tag>
	      <tag><lit-tag v="ifip"/></tag>
	      <tag><lit-tag v="PD"/></tag>
	      <tag><lit-tag v="ND"/></tag>
	      </tags> 
	      <lu>
	      <lit v="anar"/>
	      <lit-tag v="vaux"/>
	      <clip pos="1" side="tl" part="pers" link-to="4"/>
	      <clip pos="1" side="tl" part="nbr" link-to="5"/>
	      </lu>
	      <b/>
	      <lu>
	      <clip pos="1" side="tl" part="lemh"/>
	      <clip pos="1" side="tl" part="a_verb"/>
	      <lit-tag v="inf"/>
	      <clip pos="1" side="tl" part="lemq"/>
	      </lu>
	      </chunk>
	      </out>
	      </when>-->
	  <when> <!--BCN forma sintètica del passat-->
	    <test>
	      <equal>
		<clip pos="1" side="sl" part="temps"/>
		<lit-tag v="past"/>
	      </equal>
	    </test>
	    <let>
	      <clip pos="1" side="tl" part="temps"/>
	      <lit-tag v="pii"/>
	    </let>
	    <out>
	      <chunk namefrom="lema" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="Vcop"/></tag>
		  <tag><clip pos="1" side="tl" part="a_verb"/></tag>
		  <tag><clip pos="1" side="tl" part="temps"/></tag>
		  <tag><lit-tag v="PD"/></tag>
		  <tag><lit-tag v="ND"/></tag>
		</tags>
		<lu>
		  <clip pos="1" side="tl" part="lemh"/>
		  <clip pos="1" side="tl" part="a_verb"/>
		  <clip pos="1" side="tl" part="temps" link-to="3"/>
		  <lit-tag v="4"/>
		  <lit-tag v="5"/>
		  <clip pos="1" side="tl" part="lemq"/>
		</lu>
	      </chunk>
	    </out>
	  </when>
	  
	  <when>	
	    <test>
	      <equal>
		<clip pos="1" side="sl" part="temps"/>
		<lit-tag v="pres"/>
	      </equal>
	    </test>
	    <let>
	      <clip pos="1" side="tl" part="temps"/>
	      <lit-tag v="pri"/>
	    </let>
	    <out>
	      <chunk namefrom="lema" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="Vcop"/></tag>
		  <tag><clip pos="1" side="tl" part="a_verb"/></tag>
		  <tag><clip pos="1" side="tl" part="temps"/></tag>
		  <tag><lit-tag v="PD"/></tag>
		  <tag><lit-tag v="ND"/></tag>
		</tags>      
		<lu>   
		  <clip pos="1" side="tl" part="lemh"/>
		  <clip pos="1" side="tl" part="a_verb"/>
		  <clip pos="1" side="tl" part="temps" link-to="3"/>
		  <lit-tag v="4"/>
		  <lit-tag v="5"/>
		  <clip pos="1" side="tl" part="lemq"/>
		</lu> 
	      </chunk>
	    </out>
	  </when>
	  
	  <when>	
	    <test>
	      <equal>
		<clip pos="1" side="sl" part="temps"/>
		<lit-tag v="pri"/>
	      </equal>
	    </test>
	    <out>
	      <chunk namefrom="lema" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="Vcop"/></tag>
		  <tag><clip pos="1" side="tl" part="a_verb"/></tag>
		  <tag><clip pos="1" side="tl" part="temps"/></tag>
		  <tag><clip pos="1" side="tl" part="pers"/></tag>
		  <tag><clip pos="1" side="tl" part="nbr"/></tag>
		</tags>      
		<lu>   
		  <clip pos="1" side="tl" part="lemh"/>
		  <clip pos="1" side="tl" part="a_verb"/>
		  <clip pos="1" side="tl" part="temps" link-to="3"/>
		  <clip pos="1" side="tl" part="pers" link-to="4"/>
		  <clip pos="1" side="tl" part="nbr" link-to="5"/>
		  <clip pos="1" side="tl" part="lemq"/>
		</lu> 
	      </chunk>
	    </out>
	  </when>

	  <when>	
	    <test>
	      <and>
		<equal>
		  <clip pos="1" side="sl" part="temps"/>
		  <lit-tag v="past"/>
		</equal>
		<equal>
		  <clip pos="1" side="sl" part="nbr"/>
		  <lit-tag v="sg"/>
		</equal>
	      </and>
	    </test>
	    <let>
	      <clip pos="1" side="tl" part="pers"/>
	      <lit-tag v="PD"/>
	    </let>
	    <out>
	      <chunk namefrom="lema" case="caseFirstWord">
		<tags>	       
		  <tag><lit-tag v="Vcop"/></tag>
		  <tag><clip pos="1" side="tl" part="a_verb"/></tag>
		  <tag><lit-tag v="ifip"/></tag>
		  <tag><clip pos="1" side="tl" part="pers"/></tag>
		  <tag><clip pos="1" side="tl" part="nbr"/></tag>
		</tags> 
		<lu>
		  <lit v="anar"/>
		  <lit-tag v="vaux"/>
		  <clip pos="1" side="tl" part="pers" link-to="4"/>
		  <clip pos="1" side="tl" part="nbr" link-to="5"/>
		</lu>
		<b/>
		<lu>
		  <clip pos="1" side="tl" part="lemh"/>
		  <clip pos="1" side="tl" part="a_verb"/>
		  <lit-tag v="inf"/>
		  <clip pos="1" side="tl" part="lemq"/>
		</lu>
	      </chunk>
	    </out>
	  </when>
	</choose>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>


    <rule comment="REGLA: VERB copulatiu ADV">
      <pattern>
	<pattern-item n="be"/>    
	<pattern-item n="adv_not"/>
      </pattern>
      <action>    
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<choose>
	  <when>
	    <test>
	      <in caseless="yes">
		<clip pos="2" side="sl" part="lem"/>
		<list n="adv_neg"/>
	      </in>
	    </test>
	    <let>
	      <var n="paraula2"/>
	      <clip pos="2" side="tl" part="whole"/>
	    </let>
	    <append n="paraula2">
	      <lit-tag v="NEG"/>
	    </append>
	    <let>
	      <clip pos="2" side="tl" part="whole"/>
	      <var n="paraula2"/>
	    </let>
	  </when>
	</choose>
	<out>
	  <chunk name="adv" case="caseFirstWord">
	    <tags>
	      <tag><clip pos="2" side="tl" part="a_adv"/></tag>
	      <tag><clip pos="2" side="tl" part="neg"/></tag>
	    </tags>
	    <lu>
	      <clip pos="2" side="tl" part="lem"/>
	      <clip pos="2" side="tl" part="a_adv"/>
	    </lu>
	  </chunk>
	  <b pos="1"/>
	</out>

	<choose>      
	  <when>
	    <test>
	      <and>
		<equal>
		  <clip pos="1" side="sl" part="temps"/>
		  <lit-tag v="past"/>
		</equal>
		<equal>
		  <clip pos="1" side="sl" part="nbr"/>
		  <lit v=""/>
		</equal>
	      </and>	    
	    </test>
	    <out>
	      <chunk name="be">
		<tags>	       
		  <tag><lit-tag v="Vcop"/></tag>
		  <tag><clip pos="1" side="tl" part="a_verb"/></tag>
		  <tag><lit-tag v="ifip"/></tag>
		  <tag><lit-tag v="PD"/></tag>
		  <tag><lit-tag v="ND"/></tag>
		</tags> 
		<lu>
		  <lit v="anar"/>
		  <lit-tag v="vaux"/>
		  <lit-tag v="4"/>
		  <lit-tag v="5"/>
		</lu>
		<b/>
		<lu>
		  <clip pos="1" side="tl" part="lemh"/>
		  <clip pos="1" side="tl" part="a_verb"/>
		  <lit-tag v="inf"/>
		  <clip pos="1" side="tl" part="lemq"/>
		</lu>
	      </chunk>
	    </out>
	  </when>
	  
	  <when>	
	    <test>
	      <equal>
		<clip pos="1" side="sl" part="temps"/>
		<lit-tag v="pres"/>
	      </equal>
	    </test>
	    <let>
	      <clip pos="1" side="tl" part="temps"/>
	      <lit-tag v="pri"/>
	    </let>
	    <out>
	      <chunk name="be">
		<tags>
		  <tag><lit-tag v="Vcop"/></tag>
		  <tag><clip pos="1" side="tl" part="a_verb"/></tag>
		  <tag><clip pos="1" side="tl" part="temps"/></tag>
		  <tag><lit-tag v="PD"/></tag>
		  <tag><lit-tag v="ND"/></tag>
		</tags>      
		<lu>   
		  <clip pos="1" side="tl" part="lemh"/>
		  <clip pos="1" side="tl" part="a_verb"/>
		  <clip pos="1" side="tl" part="temps" link-to="3"/>
		  <lit-tag v="4"/>
		  <lit-tag v="5"/>
		  <clip pos="1" side="tl" part="lemq"/>
		</lu> 
	      </chunk>
	    </out>
	  </when>
	  
	  <when>	
	    <test>
	      <equal>
		<clip pos="1" side="sl" part="temps"/>
		<lit-tag v="pri"/>
	      </equal>
	    </test>
	    <out>
	      <chunk name="be">
		<tags>
		  <tag><lit-tag v="Vcop"/></tag>
		  <tag><clip pos="1" side="tl" part="a_verb"/></tag>
		  <tag><clip pos="1" side="tl" part="temps"/></tag>
		  <tag><clip pos="1" side="tl" part="pers"/></tag>
		  <tag><clip pos="1" side="tl" part="nbr"/></tag>
		</tags>      
		<lu>   
		  <clip pos="1" side="tl" part="lemh"/>
		  <clip pos="1" side="tl" part="a_verb"/>
		  <clip pos="1" side="tl" part="temps" link-to="3"/>
		  <clip pos="1" side="tl" part="pers" link-to="4"/>
		  <clip pos="1" side="tl" part="nbr" link-to="5"/>
		  <clip pos="1" side="tl" part="lemq"/>
		</lu> 
	      </chunk>
	    </out>
	  </when>

	  <when>	
	    <test>
	      <and>
		<equal>
		  <clip pos="1" side="sl" part="temps"/>
		  <lit-tag v="past"/>
		</equal>
		<equal>
		  <clip pos="1" side="sl" part="nbr"/>
		  <lit-tag v="sg"/>
		</equal>
	      </and>
	    </test>
	    <let>
	      <clip pos="1" side="tl" part="pers"/>
	      <lit-tag v="PD"/>
	    </let>
	    <out>
	      <chunk name="be">
		<tags>	       
		  <tag><lit-tag v="Vcop"/></tag>
		  <tag><clip pos="1" side="tl" part="a_verb"/></tag>
		  <tag><lit-tag v="ifip"/></tag>
		  <tag><clip pos="1" side="tl" part="pers"/></tag>
		  <tag><clip pos="1" side="tl" part="nbr"/></tag>
		</tags> 
		<lu>
		  <lit v="anar"/>
		  <lit-tag v="vaux"/>
		  <clip pos="1" side="tl" part="pers" link-to="4"/>
		  <clip pos="1" side="tl" part="nbr" link-to="5"/>
		</lu>
		<b/>
		<lu>
		  <clip pos="1" side="tl" part="lemh"/>
		  <clip pos="1" side="tl" part="a_verb"/>
		  <lit-tag v="inf"/>
		  <clip pos="1" side="tl" part="lemq"/>
		</lu>
	      </chunk>
	    </out>
	  </when>
	</choose>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>

    <rule comment="REGLA: VERB + ING (BCN 'avoid doing -> evitar fer'">
      <pattern>
	<pattern-item n="verbcjnoser"/>
	<pattern-item n="ger"/>
      </pattern>
      <action>    
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="tipus_verbs">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="pron">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="tipus_verbs2">
	  <with-param pos="2"/>
	</call-macro>
	<call-macro n="pronenc">
	  <with-param pos="2"/>
	</call-macro>
	<choose>      
	  <when>
	    <test>
	      <and>
		<equal>
		  <clip pos="1" side="sl" part="temps"/>
		  <lit-tag v="past"/>
		</equal>
		<equal>
		  <clip pos="1" side="sl" part="pers"/>
		  <lit v=""/>
		</equal>
		<equal>
		  <clip pos="1" side="sl" part="nbr"/>
		  <lit v=""/>
		</equal>
	      </and>
	    </test>
	    <out>
	      <chunk name="verbcj_inf_perif" case="caseFirstWord">
		<tags>	       
		  <tag><lit-tag v="SV"/></tag>
		  <tag><var n="tipus_verb"/></tag>
		  <tag><lit-tag v="ifip"/></tag>
		  <tag><lit-tag v="PD"/></tag>
		  <tag><lit-tag v="ND"/></tag>
		</tags> 		
		<lu>
		  <var n="pronom"/>
		  <lit v="anar"/>
		  <lit-tag v="vaux"/>
		  <lit-tag v="4"/>
		  <lit-tag v="5"/>
		</lu>
		<b/>
		<lu>
		  <clip pos="1" side="tl" part="lemh"/>
		  <clip pos="1" side="tl" part="a_verb"/>
		  <lit-tag v="inf"/>
		  <clip pos="1" side="tl" part="lemq"/>
		</lu>
		<b pos="1"/>
		<lu>
		  <clip pos="2" side="tl" part="lemh"/>
		  <clip pos="2" side="tl" part="a_verb"/>
		  <lit-tag v="inf"/>
		  <var n="pronomenc"/>
		  <clip pos="2" side="tl" part="lemq"/>
		</lu>

	      </chunk>
	    </out>
	  </when>
	  <when>
	    <test>
	      <equal><!--és el cas de 'was' i algun altre, que tenen pers i nbr -->
		<clip pos="1" side="sl" part="temps"/>
		<lit-tag v="past"/>
	      </equal>
	    </test>
	    <out>
	      <chunk name="verbcj_inf_perif" case="caseFirstWord">
		<tags>	       
		  <tag><lit-tag v="SV"/></tag>
		  <tag><var n="tipus_verb"/></tag>
		  <tag><lit-tag v="ifip"/></tag>
		  <tag><clip pos="1" side="tl" part="pers"/></tag>
		  <tag><clip pos="1" side="tl" part="nbr"/></tag>
		</tags> 
		<lu>
		  <var n="pronom"/>
		  <lit v="anar"/>
		  <lit-tag v="vaux"/>
		  <clip pos="1" side="tl" part="pers" link-to="4"/>
		  <clip pos="1" side="tl" part="nbr" link-to="5"/>
		</lu>
		<b/>
		<lu>
		  <clip pos="1" side="tl" part="lemh"/>
		  <clip pos="1" side="tl" part="a_verb"/>
		  <lit-tag v="inf"/>
		  <clip pos="1" side="tl" part="lemq"/>
		</lu>
		<b pos="1"/>
		<lu>
		  <clip pos="2" side="tl" part="lemh"/>
		  <clip pos="2" side="tl" part="a_verb"/>
		  <lit-tag v="inf"/>
		  <var n="pronomenc"/>
		  <clip pos="2" side="tl" part="lemq"/>
		</lu>
	      </chunk>
	    </out>
	  </when>	  
	  <when>	
	    <test>
	      <equal>
		<clip pos="1" side="sl" part="temps"/>
		<lit-tag v="pres"/>
	      </equal>
	    </test>
	    <let>
	      <clip pos="1" side="tl" part="temps"/>
	      <lit-tag v="pri"/>
	    </let>
	    <out>
	      <chunk name="verbcj_inf" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="SV"/></tag>
		  <tag><var n="tipus_verb"/></tag>
		  <tag><clip pos="1" side="tl" part="temps"/></tag>
		  <tag><lit-tag v="PD"/></tag>
		  <tag><lit-tag v="ND"/></tag>
		</tags>      
		<lu>   
		  <var n="pronom"/>
		  <clip pos="1" side="tl" part="lemh"/>
		  <clip pos="1" side="tl" part="a_verb"/>
		  <clip pos="1" side="tl" part="temps" link-to="3"/>
		  <lit-tag v="4"/>
		  <lit-tag v="5"/>
		  <clip pos="1" side="tl" part="lemq"/>
		</lu> 
		<b pos="1"/>
		<lu>
		  <clip pos="2" side="tl" part="lemh"/>
		  <clip pos="2" side="tl" part="a_verb"/>
		  <lit-tag v="inf"/>
		  <var n="pronomenc"/> 
		  <clip pos="2" side="tl" part="lemq"/>
		</lu>		
	      </chunk>
	    </out>
	  </when>
	  
	  <when>	
	    <test>
	      <equal>
		<clip pos="1" side="sl" part="temps"/>
		<lit-tag v="pri"/>
	      </equal>
	    </test>
	    <out>
	      <chunk name="verbcj_inf" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="SV"/></tag>
		  <tag><var n="tipus_verb"/></tag>
		  <tag><clip pos="1" side="tl" part="temps"/></tag>
		  <tag><clip pos="1" side="tl" part="pers"/></tag>
		  <tag><clip pos="1" side="tl" part="nbr"/></tag>
		</tags>      
		<lu>   
		  <var n="pronom"/>
		  <clip pos="1" side="tl" part="lemh"/>
		  <clip pos="1" side="tl" part="a_verb"/>
		  <clip pos="1" side="tl" part="temps" link-to="3"/>
		  <clip pos="1" side="tl" part="pers" link-to="4"/>
		  <clip pos="1" side="tl" part="nbr" link-to="5"/>
		  <clip pos="1" side="tl" part="lemq"/>
		</lu>
		<b pos="1"/>
		<lu>
		  <clip pos="2" side="tl" part="lemh"/>
		  <clip pos="2" side="tl" part="a_verb"/>
		  <lit-tag v="inf"/>
		 <var n="pronomenc"/>
		  <clip pos="2" side="tl" part="lemq"/>
		</lu>
	      </chunk>
	    </out>
	  </when>
	  <otherwise><!--només queda si és 'inf' -->
	    <out>
	      <chunk name="inf_inf">
		<tags>	       
		  <tag><lit-tag v="SV"/></tag>
		  <tag><var n="tipus_verb"/></tag>
		  <tag><clip pos="1" side="tl" part="temps"/></tag>
		  <tag><lit-tag v="PD"/></tag>
		  <tag><lit-tag v="ND"/></tag>
		</tags>      
		<lu>   
		  <var n="pronom"/>
		  <clip pos="1" side="tl" part="lemh"/>
		  <clip pos="1" side="tl" part="a_verb"/>
		  <clip pos="1" side="tl" part="temps" link-to="3"/>
		  <clip pos="1" side="tl" part="lemq"/>
		</lu> 
		<b pos="1"/>
		<lu>
		  <clip pos="2" side="tl" part="lemh"/>
		  <clip pos="2" side="tl" part="a_verb"/>
		  <lit-tag v="inf"/>
		  <var n="pronomenc"/> 
		  <clip pos="2" side="tl" part="lemq"/>
		</lu>
	      </chunk>
	    </out>
	  </otherwise>
	</choose>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>


    <rule comment="REGLA: AUX + VERB + ING (BCN 'can avoid doing -> evitar fer'">
      <pattern>
	<pattern-item n="auxmod"/>
	<pattern-item n="infpres"/>
	<pattern-item n="ger"/>
      </pattern>
      <action>    
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="tipus_verbs">
	  <with-param pos="2"/>
	</call-macro>
	<call-macro n="pron">
	  <with-param pos="2"/>
	</call-macro>
	<call-macro n="tipus_verbs2">
	  <with-param pos="3"/>
	</call-macro>
	<call-macro n="pronenc">
	  <with-param pos="3"/>
	</call-macro>	
	<choose>      
          <when>
            <test>
              <and>
                <equal caseless="yes">
                  <clip pos="1" side="sl" part="lem"/>
                  <lit v="can"/>
                </equal>
                <equal>
                  <clip pos="1" side="sl" part="temps"/>
                  <lit-tag v="pres"/>
                </equal>
              </and>
            </test>
            <let>
              <clip pos="1" side="tl" part="temps"/>
              <lit-tag v="pri"/>
            </let>
          </when>
          <when>
            <test>
              <and>
                <equal caseless="yes">
                  <clip pos="1" side="sl" part="lem"/>
                  <lit v="can"/>
                </equal>
                <equal>
                  <clip pos="1" side="sl" part="temps"/>
                  <lit-tag v="past"/>
                </equal>
              </and>
            </test>
            <let>
              <clip pos="1" side="tl" part="temps"/>
              <lit-tag v="cni"/>
            </let>
          </when>
          <when>
            <test>
              <or>
                <equal caseless="yes">
                  <clip pos="1" side="sl" part="lem"/>
                  <lit v="must"/>
                </equal>
                <equal caseless="yes">
                  <clip pos="1" side="sl" part="lem"/>
                  <lit v="may"/>
                </equal>
              </or>
            </test>
            <let>
              <clip pos="1" side="tl" part="temps"/>
              <lit-tag v="pri"/>
            </let>
          </when>
          <when>
            <test>
              <or>
                <equal caseless="yes">
                  <clip pos="1" side="sl" part="lem"/>
                  <lit v="should"/>
                </equal>
                <equal caseless="yes">
                  <clip pos="1" side="sl" part="lem"/>
                  <lit v="might"/>
                </equal>
              </or>
            </test>
            <let>
              <clip pos="1" side="tl" part="temps"/>
              <lit-tag v="cni"/>
            </let>
          </when>
	</choose>
        <out>
          <chunk name="auxmod_inf_inf" case="caseFirstWord">
            <tags>
              <tag><lit-tag v="SV"/></tag>
              <tag><var n="tipus_verb"/></tag>
              <tag><clip pos="1" side="tl" part="temps"/></tag>
              <tag><lit-tag v="PD"/></tag>
              <tag><lit-tag v="ND"/></tag>
            </tags>
            <lu>
              <var n="pronom"/>
              <clip pos="1" side="tl" part="lemh"/>
              <clip pos="1" side="tl" part="a_verb"/>
              <clip pos="1" side="tl" part="temps" link-to="3"/>
              <lit-tag v="4"/>
              <lit-tag v="5"/>
              <clip pos="1" side="tl" part="lemq"/>
            </lu>
            <b pos="1"/>
            <lu>
              <clip pos="2" side="tl" part="lemh"/>
              <clip pos="2" side="tl" part="a_verb"/>
              <lit-tag v="inf"/>
              <clip pos="2" side="tl" part="lemq"/>
            </lu>
            <b pos="2"/>
	    <lu>
	      <clip pos="3" side="tl" part="lemh"/>
	      <clip pos="3" side="tl" part="a_verb"/>
	      <lit-tag v="inf"/>
	      <var n="pronomenc"/>
	      <clip pos="3" side="tl" part="lemq"/>
	    </lu>
	  </chunk>
	</out>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>


    <rule comment="REGLA: AUX (temps) + VERB + ING (BCN 'will avoid doing this -> evitar fer'">
      <pattern>
	<pattern-item n="auxtemps"/>
	<pattern-item n="infpres"/>
	<pattern-item n="ger"/>
      </pattern>
      <action>    
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="tipus_verbs">
	  <with-param pos="2"/>
	</call-macro>
	<call-macro n="pron">
	  <with-param pos="2"/>
	</call-macro>
	<call-macro n="tipus_verbs2">
	  <with-param pos="3"/>
	</call-macro>
	<call-macro n="pronenc">
	  <with-param pos="3"/>
	</call-macro>
        <choose>
          <when>
            <test>
              <or>
                <equal caseless="yes">
                  <clip pos="1" side="sl" part="lem"/>
                  <lit v="will"/>
                </equal>
                <equal caseless="yes">
                  <clip pos="1" side="sl" part="lem"/>
                  <lit v="shall"/>
                </equal>
              </or>
            </test>
            <let>
              <clip pos="2" side="tl" part="temps"/>
              <lit-tag v="fti"/>
            </let>
          </when>
          <when>
            <test>
              <equal caseless="yes">
                <clip pos="1" side="sl" part="lem"/>
                <lit v="would"/>
              </equal>
            </test>
            <let>
              <clip pos="2" side="tl" part="temps"/>
              <lit-tag v="cni"/>
            </let>
          </when>
        </choose>
	
        <out>
          <chunk name="verbcj_inf" case="caseFirstWord">
            <tags>
              <tag><lit-tag v="SV"/></tag>
              <tag><var n="tipus_verb"/></tag>
              <tag><clip pos="2" side="tl" part="temps"/></tag>
              <tag><lit-tag v="PD"/></tag>
              <tag><lit-tag v="ND"/></tag>
            </tags>
            <lu>
              <var n="pronom"/>
              <clip pos="2" side="tl" part="lemh"/>
              <clip pos="2" side="tl" part="a_verb"/>
              <clip pos="2" side="tl" part="temps" link-to="3"/>
              <lit-tag v="4"/>
              <lit-tag v="5"/>
              <clip pos="2" side="tl" part="lemq"/>
            </lu>
            <b pos="2"/>
	    <lu>
	      <clip pos="3" side="tl" part="lemh"/>
	      <clip pos="3" side="tl" part="a_verb"/>
	      <lit-tag v="inf"/>
	      <var n="pronomenc"/>
	      <clip pos="3" side="tl" part="lemq"/>
	    </lu>
	  </chunk>
	</out>	  
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>

    <rule comment="REGLA: VERB">
      <pattern>
	<pattern-item n="verbcj"/>
      </pattern>
      <action>    
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="tipus_verbs">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="pron">
	  <with-param pos="1"/>
	</call-macro>	
	<choose>      
	  <when>
	    <test>
	      <and>
		<equal>
		  <clip pos="1" side="sl" part="temps"/>
		  <lit-tag v="past"/>
		</equal>
		<equal>
		  <clip pos="1" side="sl" part="pers"/>
		  <lit v=""/>
		</equal>
		<equal>
		  <clip pos="1" side="sl" part="nbr"/>
		  <lit v=""/>
		</equal>
	      </and>
	    </test>
	    <out>
	      <chunk name="verbcj_perif" case="caseFirstWord">
		<tags>	       
		  <tag><lit-tag v="SV"/></tag>
		  <tag><var n="tipus_verb"/></tag>
		  <tag><lit-tag v="ifip"/></tag>
		  <tag><lit-tag v="PD"/></tag>
		  <tag><lit-tag v="ND"/></tag>
		</tags> 
		
		<lu>
		  <var n="pronom"/>
		  <lit v="anar"/>
		  <lit-tag v="vaux"/>
		  <lit-tag v="4"/>
		  <lit-tag v="5"/>
		</lu>
		<b/>
		<lu>
		  <clip pos="1" side="tl" part="lemh"/>
		  <clip pos="1" side="tl" part="a_verb"/>
		  <lit-tag v="inf"/>
		  <clip pos="1" side="tl" part="lemq"/>
		</lu>
	      </chunk>
	    </out>
	  </when>
	  <when>
	    <test>
	      <equal><!--és el cas de 'was' i algun altre, que tenen pers i nbr -->
		<clip pos="1" side="sl" part="temps"/>
		<lit-tag v="past"/>
	      </equal>
	    </test>
	    <out>
	      <chunk name="verbcj_perif" case="caseFirstWord">
		<tags>	       
		  <tag><lit-tag v="SV"/></tag>
		  <tag><var n="tipus_verb"/></tag>
		  <tag><lit-tag v="ifip"/></tag>
		  <tag><clip pos="1" side="tl" part="pers"/></tag>
		  <tag><clip pos="1" side="tl" part="nbr"/></tag>
		</tags> 
		<lu>
		  <var n="pronom"/>
		  <lit v="anar"/>
		  <lit-tag v="vaux"/>
		  <clip pos="1" side="tl" part="pers" link-to="4"/>
		  <clip pos="1" side="tl" part="nbr" link-to="5"/>
		</lu>
		<b/>
		<lu>
		  <clip pos="1" side="tl" part="lemh"/>
		  <clip pos="1" side="tl" part="a_verb"/>
		  <lit-tag v="inf"/>
		  <clip pos="1" side="tl" part="lemq"/>
		</lu>
	      </chunk>
	    </out>
	  </when>
	  
	  <when>	
	    <test>
	      <equal>
		<clip pos="1" side="sl" part="temps"/>
		<lit-tag v="pres"/>
	      </equal>
	    </test>
	    <let>
	      <clip pos="1" side="tl" part="temps"/>
	      <lit-tag v="pri"/>
	    </let>
	    <out>
	      <chunk name="verbcj" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="SV"/></tag>
		  <tag><var n="tipus_verb"/></tag>
		  <tag><clip pos="1" side="tl" part="temps"/></tag>
		  <tag><lit-tag v="PD"/></tag>
		  <tag><lit-tag v="ND"/></tag>
		</tags>      
		<lu>   
		  <var n="pronom"/>
		  <clip pos="1" side="tl" part="lemh"/>
		  <clip pos="1" side="tl" part="a_verb"/>
		  <clip pos="1" side="tl" part="temps" link-to="3"/>
		  <lit-tag v="4"/>
		  <lit-tag v="5"/>
		  <clip pos="1" side="tl" part="lemq"/>
		</lu> 
	      </chunk>
	    </out>
	  </when>
	  
	  <when>	
	    <test>
	      <equal>
		<clip pos="1" side="sl" part="temps"/>
		<lit-tag v="pri"/>
	      </equal>
	    </test>
	    <out>
	      <chunk name="verbcj" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="SV"/></tag>
		  <tag><var n="tipus_verb"/></tag>
		  <tag><clip pos="1" side="tl" part="temps"/></tag>
		  <tag><clip pos="1" side="tl" part="pers"/></tag>
		  <tag><clip pos="1" side="tl" part="nbr"/></tag>
		</tags>      
		<lu>   
		  <var n="pronom"/>
		  <clip pos="1" side="tl" part="lemh"/>
		  <clip pos="1" side="tl" part="a_verb"/>
		  <clip pos="1" side="tl" part="temps" link-to="3"/>
		  <clip pos="1" side="tl" part="pers" link-to="4"/>
		  <clip pos="1" side="tl" part="nbr" link-to="5"/>
		  <clip pos="1" side="tl" part="lemq"/>
		</lu> 
	      </chunk>
	    </out>
	  </when>
	</choose>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>
 
    <rule comment="REGLA: VERB+clític: finds it-> el troba">
      <pattern>
	<pattern-item n="verbcj"/>
	<pattern-item n="probj"/>
      </pattern>
      <action>    
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>		 
	<call-macro n="tipus_verbs">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="pron">
	  <with-param pos="1"/>
	</call-macro>
	
	<choose>      
	  <when>
	    <test>
	      <and>
		<equal>
		  <clip pos="1" side="sl" part="temps"/>
		  <lit-tag v="past"/>
		</equal>
		<equal>
		  <clip pos="1" side="sl" part="pers"/>
		  <lit v=""/>
		</equal>
		<equal>
		  <clip pos="1" side="sl" part="nbr"/>
		  <lit v=""/>
		</equal>
	      </and>
	    </test>
	    <out>
	      <chunk name="pro_verbcj_perif" case="caseFirstWord">
		<tags>	       
		  <tag><lit-tag v="SV"/></tag>
		  <tag><var n="tipus_verb"/></tag>
		  <tag><lit-tag v="ifip"/></tag>
		  <tag><lit-tag v="PD"/></tag>
		  <tag><lit-tag v="ND"/></tag>
		</tags> 
		<lu>
		  <var n="pronom"/>
		  <clip pos="2" side="tl" part="lem"/>
		  <clip pos="2" side="tl" part="a_prnpro"/>
		  <clip pos="2" side="tl" part="pers"/>
		  <clip pos="2" side="tl" part="gen"/>
		  <clip pos="2" side="tl" part="nbr"/>
		</lu>
		<b pos="1"/>
		<lu>
		  <lit v="anar"/>
		  <lit-tag v="vaux"/>
		  <lit-tag v="4"/>
		  <lit-tag v="5"/>
		</lu>
		<b/>
		<lu>
		  <clip pos="1" side="tl" part="lemh"/>
		  <clip pos="1" side="tl" part="a_verb"/>
		  <lit-tag v="inf"/>
		  <clip pos="1" side="tl" part="lemq"/>
		</lu>
	      </chunk>
	    </out>
	  </when>
	  <when>
	    <test>
	      <equal><!--és el cas de 'was' i algun altre, que tenen pers i nbr -->
		<clip pos="1" side="sl" part="temps"/>
		<lit-tag v="past"/>
	      </equal>
	    </test>
	    <out>
	      <chunk name="pro_verbcj_perif" case="caseFirstWord">
		<tags>	       
		  <tag><lit-tag v="SV"/></tag>
		  <tag><var n="tipus_verb"/></tag>
		  <tag><lit-tag v="ifip"/></tag>
		  <tag><clip pos="1" side="tl" part="pers"/></tag>
		  <tag><clip pos="1" side="tl" part="nbr"/></tag>
		</tags> 
		<lu>
		  <var n="pronom"/>
		  <clip pos="2" side="tl" part="lem"/>
		  <clip pos="2" side="tl" part="a_prnpro"/>
		  <clip pos="2" side="tl" part="pers"/>
		  <clip pos="2" side="tl" part="gen"/>
		  <clip pos="2" side="tl" part="nbr"/>
		</lu>
		<b pos="1"/>
		<lu>
		  <lit v="anar"/>
		  <lit-tag v="vaux"/>
		  <clip pos="1" side="tl" part="pers" link-to="4"/>
		  <clip pos="1" side="tl" part="nbr" link-to="5"/>
		</lu>
		<b/>
		<lu>
		  <clip pos="1" side="tl" part="lemh"/>
		  <clip pos="1" side="tl" part="a_verb"/>
		  <lit-tag v="inf"/>
		  <clip pos="1" side="tl" part="lemq"/>
		</lu>
	      </chunk>
	    </out>
	  </when>
	  
	  <when>	
	    <test>
	      <equal>
		<clip pos="1" side="sl" part="temps"/>
		<lit-tag v="pres"/>
	      </equal>
	    </test>
	    <let>
	      <clip pos="1" side="tl" part="temps"/>
	      <lit-tag v="pri"/>
	    </let>
	    <out>
	      <chunk name="pro_verbcj" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="SV"/></tag>
		  <tag><var n="tipus_verb"/></tag>
		  <tag><clip pos="1" side="tl" part="temps"/></tag>
		  <tag><lit-tag v="PD"/></tag>
		  <tag><lit-tag v="ND"/></tag>
		</tags>      
		<lu>
		  <var n="pronom"/>
		  <clip pos="2" side="tl" part="lem"/>
		  <clip pos="2" side="tl" part="a_prnpro"/>
		  <clip pos="2" side="tl" part="pers"/>
		  <clip pos="2" side="tl" part="gen"/>
		  <clip pos="2" side="tl" part="nbr"/>
		</lu>
		<b pos="1"/>
		<lu>   
		  <clip pos="1" side="tl" part="lemh"/>
		  <clip pos="1" side="tl" part="a_verb"/>
		  <clip pos="1" side="tl" part="temps" link-to="3"/>
		  <lit-tag v="4"/>
		  <lit-tag v="5"/>
		  <clip pos="1" side="tl" part="lemq"/>
		</lu> 
	      </chunk>
	    </out>
	  </when>
	  
	  <when>	
	    <test>
	      <equal>
		<clip pos="1" side="sl" part="temps"/>
		<lit-tag v="pri"/>
	      </equal>
	    </test>
	    <out>
	      <chunk name="pro_verbcj" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="SV"/></tag>
		  <tag><var n="tipus_verb"/></tag>
		  <tag><clip pos="1" side="tl" part="temps"/></tag>
		  <tag><clip pos="1" side="tl" part="pers"/></tag>
		  <tag><clip pos="1" side="tl" part="nbr"/></tag>
		</tags>      
		<lu>
		  <var n="pronom"/>
		  <clip pos="2" side="tl" part="lem"/>
		  <clip pos="2" side="tl" part="a_prnpro"/>
		  <clip pos="2" side="tl" part="pers"/>
		  <clip pos="2" side="tl" part="gen"/>
		  <clip pos="2" side="tl" part="nbr"/>
		</lu>
		<b pos="1"/>
		<lu>   
		  <clip pos="1" side="tl" part="lemh"/>
		  <clip pos="1" side="tl" part="a_verb"/>
		  <clip pos="1" side="tl" part="temps" link-to="3"/>
		  <clip pos="1" side="tl" part="pers" link-to="4"/>
		  <clip pos="1" side="tl" part="nbr" link-to="5"/>
		  <clip pos="1" side="tl" part="lemq"/>
		</lu> 
	      </chunk>
	    </out>
	  </when>
	</choose>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>


    <rule comment="REGLA: VERB MODAL (have to, want to). Per quan apareix sol o amb un verb desconegut">
      <pattern>
	<pattern-item n="mod"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>	
	<choose>
	  <when>
	    <test>
	      <or>
		<equal><!--De moment no sé si el tagger escull bé i els detecto els dos -->
		  <clip pos="1" side="sl" part="temps"/>
		  <lit-tag v="inf"/>
		</equal>
		<equal>
		  <clip pos="1" side="sl" part="temps"/>
		  <lit-tag v="pres"/>
		</equal>
	      </or>
	    </test>
	    <let>
	      <clip pos="1" side="tl" part="temps"/>
	      <lit-tag v="pri"/>
	    </let>
	    <out>
	      <chunk name="mod" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="SV"/></tag>
		  <tag><clip pos="1" side="tl" part="a_verb"/></tag>
		  <tag><clip pos="1" side="tl" part="temps"/></tag>
		  <tag><lit-tag v="PD"/></tag>
		  <tag><lit-tag v="ND"/></tag>
		</tags>      
		<lu>   
		  <clip pos="1" side="tl" part="lemh"/>
		  <clip pos="1" side="tl" part="a_verb"/>
		  <clip pos="1" side="tl" part="temps" link-to="3"/>
		  <lit-tag v="4"/>
		  <lit-tag v="5"/>
		  <clip pos="1" side="tl" part="lemq"/>
		</lu> 
	      </chunk>
	    </out>
	  </when>
	  <when>
	    <test>
	      <equal>
		<clip pos="1" side="sl" part="temps"/>
		<lit-tag v="past"/>
	      </equal>
	    </test>
	    <out>
	      <chunk name="mod_perif" case="caseFirstWord">
		<tags>	       
		  <tag><lit-tag v="SV"/></tag>
		  <tag><clip pos="1" side="tl" part="a_verb"/></tag>
		  <tag><lit-tag v="ifip"/></tag>
		  <tag><lit-tag v="PD"/></tag>
		  <tag><lit-tag v="ND"/></tag>
		</tags> 
		<lu>
		  <lit v="anar"/>
		  <lit-tag v="vaux"/>
		  <lit-tag v="4"/>
		  <lit-tag v="5"/>
		</lu>
		<b/>
		<lu>
		  <clip pos="1" side="tl" part="lemh"/>
		  <clip pos="1" side="tl" part="a_verb"/>
		  <lit-tag v="inf"/>
		  <clip pos="1" side="tl" part="lemq"/>
		</lu>
	      </chunk>
	    </out>
	  </when>
	  <otherwise><!-- Quan és 3a sg (has to) -->
	    <out>
	      <chunk name="mod" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="SV"/></tag>
		  <tag><clip pos="1" side="tl" part="a_verb"/></tag>
		  <tag><clip pos="1" side="tl" part="temps"/></tag>
		  <tag><clip pos="1" side="tl" part="pers"/></tag>
		  <tag><clip pos="1" side="tl" part="nbr"/></tag>
		</tags>      
		<lu>   
		  <clip pos="1" side="tl" part="lemh"/>
		  <clip pos="1" side="tl" part="a_verb"/>
		  <clip pos="1" side="tl" part="temps" link-to="3"/>
		  <clip pos="1" side="tl" part="pers" link-to="4"/>
		  <clip pos="1" side="tl" part="nbr" link-to="5"/>
		  <clip pos="1" side="tl" part="lemq"/>
		</lu> 
	      </chunk>
	    </out>
	  </otherwise>
	</choose>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>

    <rule comment="REGLA: TO INF (BCN canvia la prep 'a' per 'per' davant infinitiu')">
      <pattern>
	<pattern-item n="to"/>
	<pattern-item n="inf"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>	
	<call-macro n="tipus_verbs">
	  <with-param pos="2"/>
	</call-macro>
	<let>				<!-- canvi de preposició-->
	  <clip pos="1" side="tl" part="lem"/>
	  <lit v ="per"/>
	</let>
	<out>
	  <chunk name="pr" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="PREP"/></tag>
	    </tags>
	    <lu>   
	      <clip pos="1" side="tl" part="whole"/> 
	    </lu> 
	  </chunk>	  
	  <b pos="1"/>
	</out>
	<choose>
	  <when>
	    <test>
	      <not>
		<or>
		  <equal caseless="yes">	    	
		    <clip pos="2" side="sl" part="lem"/>
		    <lit v="will"/>
		  </equal>
		  <equal caseless="yes">	    	
		    <clip pos="2" side="sl" part="lem"/>
		    <lit v="shall"/>
		  </equal>
		  <equal caseless="yes">	    	
		    <clip pos="2" side="sl" part="lem"/>
		    <lit v="would"/>
		  </equal>
		</or>
	      </not>
	    </test>
	    <choose>
	      <when>
		<test>
		  <equal>	    	
		    <var n="tipus_verb"/>
		    <lit-tag v="pron"/>
		  </equal>
		</test>
		<out>		  
		  <chunk name="inf_enc">
		    <tags>	       
		      <tag><lit-tag v="SV"/></tag>
		      <tag><var n="tipus_verb"/></tag>
		      <tag><clip pos="2" side="tl" part="temps"/></tag>
		      <tag><lit-tag v="PD"/></tag>
		      <tag><lit-tag v="ND"/></tag>
		    </tags> 
		    <mlu>
		      <lu>
			<clip pos="2" side="tl" part="lemh"/> 
			<clip pos="2" side="tl" part="a_verb"/>
			<clip pos="2" side="tl" part="temps" link-to="3"/>			
		      </lu>
		      <lu>
			<lit v="es"/>
			<lit-tag v="prn.enc.ref.p3.mf.sp"/>
			<clip pos="2" side="tl" part="lemq"/>
		      </lu>
		    </mlu>
		  </chunk>
		</out>
	      </when>
	      <otherwise>
		<out>
		  <chunk name="inf">
		    <tags>	       
		      <tag><lit-tag v="SV"/></tag>
		      <tag><var n="tipus_verb"/></tag>
		      <tag><clip pos="2" side="tl" part="temps"/></tag>
		      <tag><lit-tag v="PD"/></tag>
		      <tag><lit-tag v="ND"/></tag>
		    </tags> 
		    <lu>
		      <clip pos="2" side="tl" part="lemh"/> 
		      <clip pos="2" side="tl" part="a_verb"/>
		      <clip pos="2" side="tl" part="temps" link-to="3"/>
		      <clip pos="2" side="tl" part="lemq"/>
		    </lu>
		  </chunk>
		</out>
	      </otherwise>
	    </choose>  
	  </when>
	</choose>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>

 <rule comment="REGLA: TO INF (BCN canvia la prep 'a' per 'per' davant infinitiu')">
      <pattern>
	<pattern-item n="to"/>
	<pattern-item n="inf"/>
	<pattern-item n="probj"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>	
	<call-macro n="tipus_verbs">
	  <with-param pos="2"/>
	</call-macro>
	<let>				<!-- canvi de preposició-->
	  <clip pos="1" side="tl" part="lem"/>
	  <lit v ="per"/>
	</let>
	<out>
	  <chunk name="pr" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="PREP"/></tag>
	    </tags>
	    <lu>   
	      <clip pos="1" side="tl" part="whole"/> 
	    </lu> 
	  </chunk>	  
	  <b pos="1"/>
	</out>
	<choose>
	  <when>
	    <test>
	      <not>
		<or>
		  <equal caseless="yes">	    	
		    <clip pos="2" side="sl" part="lem"/>
		    <lit v="will"/>
		  </equal>
		  <equal caseless="yes">	    	
		    <clip pos="2" side="sl" part="lem"/>
		    <lit v="shall"/>
		  </equal>
		  <equal caseless="yes">	    	
		    <clip pos="2" side="sl" part="lem"/>
		    <lit v="would"/>
		  </equal>
		</or>
	      </not>
	    </test>
	    <choose>
	      <when>
		<test>
		  <equal>	    	
		    <var n="tipus_verb"/>
		    <lit-tag v="pron"/>
		  </equal>
		</test>
		<out>		  
		  <chunk name="inf_enc_enc">
		    <tags>	       
		      <tag><lit-tag v="SV"/></tag>
		      <tag><var n="tipus_verb"/></tag>
		      <tag><clip pos="2" side="tl" part="temps"/></tag>
		      <tag><lit-tag v="PD"/></tag>
		      <tag><lit-tag v="ND"/></tag>
		    </tags> 
		    <mlu>
		      <lu>
			<clip pos="2" side="tl" part="lemh"/> 
			<clip pos="2" side="tl" part="a_verb"/>
			<clip pos="2" side="tl" part="temps" link-to="3"/>			
		      </lu>
		      <lu>
			<lit v="es"/>
			<lit-tag v="prn.enc.ref.p3.mf.sp"/>
		      </lu>
		      <lu>
			<clip pos="3" side="tl" part="lem"/>
			<lit-tag v="prn.enc"/>
			<clip pos="3" side="tl" part="pers"/>
			<clip pos="3" side="tl" part="gen"/>
			<clip pos="3" side="tl" part="nbr"/>
			<clip pos="2" side="tl" part="lemq"/>
		      </lu>
		    </mlu>
		  </chunk>
		</out>
	      </when>
	      <otherwise>
		<out>
		  <chunk name="inf_enc">
		    <tags>	       
		      <tag><lit-tag v="SV"/></tag>
		      <tag><var n="tipus_verb"/></tag>
		      <tag><clip pos="2" side="tl" part="temps"/></tag>
		      <tag><lit-tag v="PD"/></tag>
		      <tag><lit-tag v="ND"/></tag>
		    </tags> 
		    <mlu>
		      <lu>
			<clip pos="2" side="tl" part="lemh"/> 
			<clip pos="2" side="tl" part="a_verb"/>
			<clip pos="2" side="tl" part="temps" link-to="3"/>
		      </lu>
		      <lu>
			<clip pos="3" side="tl" part="lem"/>
			<lit-tag v="prn.enc"/>
			<clip pos="3" side="tl" part="pers"/>
			<clip pos="3" side="tl" part="gen"/>
			<clip pos="3" side="tl" part="nbr"/>
			<clip pos="2" side="tl" part="lemq"/>
		      </lu>
		    </mlu>
		  </chunk>
		</out>
	      </otherwise>
	    </choose>  
	  </when>
	</choose>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>

    <rule comment="REGLA: INF (per a col·locar la cua en les multiparaules)">
      <pattern>
	<pattern-item n="inf"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>	
	<call-macro n="tipus_verbs">
	  <with-param pos="1"/>
	</call-macro>
	<choose>
	  <when>
	    <test>
	      <not>
		<or>
		  <equal caseless="yes">	    	
		    <clip pos="1" side="sl" part="lem"/>
		    <lit v="will"/>
		  </equal>
		  <equal caseless="yes">	    	
		    <clip pos="1" side="sl" part="lem"/>
		    <lit v="shall"/>
		  </equal>
		  <equal caseless="yes">	    	
		    <clip pos="1" side="sl" part="lem"/>
		    <lit v="would"/>
		  </equal>
		</or>
	      </not>
	    </test>
	    <choose>
	      <when>
		<test>
		  <equal>	    	
		    <var n="tipus_verb"/>
		    <lit-tag v="pron"/>
		  </equal>
		</test>
		<out>		  
		  <chunk name="inf_enc" case="caseFirstWord">
		    <tags>	       
		      <tag><lit-tag v="SV"/></tag>
		      <tag><var n="tipus_verb"/></tag>
		      <tag><clip pos="1" side="tl" part="temps"/></tag>
		      <tag><lit-tag v="PD"/></tag>
		      <tag><lit-tag v="ND"/></tag>
		    </tags> 
		    <mlu>
		      <lu>
			<clip pos="1" side="tl" part="lemh"/> 
			<clip pos="1" side="tl" part="a_verb"/>
			<clip pos="1" side="tl" part="temps" link-to="3"/>			
		      </lu>
		      <lu>
			<lit v="es"/>
			<lit-tag v="prn.enc.ref.p3.mf.sp"/>
			<clip pos="1" side="tl" part="lemq"/>
		      </lu>
		    </mlu>
		  </chunk>
		</out>
	      </when>
	      <otherwise>
		<out>
		  <chunk name="inf" case="caseFirstWord">
		    <tags>	       
		      <tag><lit-tag v="SV"/></tag>
		      <tag><var n="tipus_verb"/></tag>
		      <tag><clip pos="1" side="tl" part="temps"/></tag>
		      <tag><lit-tag v="PD"/></tag>
		      <tag><lit-tag v="ND"/></tag>
		    </tags> 
		    <lu>
		      <clip pos="1" side="tl" part="lemh"/> 
		      <clip pos="1" side="tl" part="a_verb"/>
		      <clip pos="1" side="tl" part="temps" link-to="3"/>
		      <clip pos="1" side="tl" part="lemq"/>
		    </lu>
		  </chunk>
		</out>
	      </otherwise>
	    </choose>    
	    
	  </when>
	</choose>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>

    <rule comment="REGLA: INF+clític">
      <pattern>
	<pattern-item n="inf"/>
	<pattern-item n="probj"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>	
	<call-macro n="tipus_verbs">
	  <with-param pos="1"/>
	</call-macro>
	<choose>
	  <when>
	    <test>
	      <not>
		<or>
		  <equal caseless="yes">	    	
		    <clip pos="1" side="sl" part="lem"/>
		    <lit v="will"/>
		  </equal>
		  <equal caseless="yes">	    	
		    <clip pos="1" side="sl" part="lem"/>
		    <lit v="shall"/>
		  </equal>
		  <equal caseless="yes">	    	
		    <clip pos="1" side="sl" part="lem"/>
		    <lit v="would"/>
		  </equal>
		</or>
	      </not>
	    </test>
	    <choose><!--mireia2-->
	      <when>
		<test>
		  <equal>	    	
		    <var n="tipus_verb"/>
		    <lit-tag v="pron"/>
		  </equal>
		</test>
		<out>
		  <chunk name="inf_enc" case="caseFirstWord">
		    <tags>	       
		      <tag><lit-tag v="SV"/></tag>
		      <tag><var n="tipus_verb"/></tag>
		      <tag><clip pos="1" side="tl" part="temps"/></tag>
		      <tag><lit-tag v="PD"/></tag>
		      <tag><lit-tag v="ND"/></tag>
		    </tags> 
		    <mlu>
		      <lu>
			<clip pos="1" side="tl" part="lemh"/> 
			<clip pos="1" side="tl" part="a_verb"/>
			<clip pos="1" side="tl" part="temps" link-to="3"/>
			
		      </lu>
		      <lu>
			<lit v="es"/>
			<lit-tag v="prn.enc.ref.p3.mf.sp"/>
		      </lu>
		      <lu>
			<clip pos="2" side="tl" part="lem"/>
			<lit-tag v="prn.enc"/>
			<clip pos="2" side="tl" part="pers"/>
			<clip pos="2" side="tl" part="gen"/>
			<clip pos="2" side="tl" part="nbr"/>
			<clip pos="1" side="tl" part="lemq"/>
		      </lu>
		    </mlu>
		  </chunk>
		</out>
	      </when>
	      <otherwise>
		<out>
		  <chunk name="inf_enc" case="caseFirstWord">
		    <tags>	       
		      <tag><lit-tag v="SV"/></tag>
		      <tag><var n="tipus_verb"/></tag>
		      <tag><clip pos="1" side="tl" part="temps"/></tag>
		      <tag><lit-tag v="PD"/></tag>
		      <tag><lit-tag v="ND"/></tag>
		    </tags> 
		    <mlu>
		      <lu>
			<clip pos="1" side="tl" part="lemh"/> 
			<clip pos="1" side="tl" part="a_verb"/>
			<clip pos="1" side="tl" part="temps" link-to="3"/>
		      </lu>
		      <lu>
			<clip pos="2" side="tl" part="lem"/>
			<lit-tag v="prn.enc"/>
			<clip pos="2" side="tl" part="pers"/>
			<clip pos="2" side="tl" part="gen"/>
			<clip pos="2" side="tl" part="nbr"/>
			<clip pos="1" side="tl" part="lemq"/>
		      </lu>
		    </mlu>						 
		  </chunk>
		</out>
	      </otherwise>
	    </choose>
	  </when>
	</choose>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>

   <rule comment="REGLA: PPRS (per a col·locar la cua en les multiparaules. per ara 'pprs' no es fa servir per res, he copiat la regla del gerundi per treure com a chunk gerundi; si de cas, més endavant s'ha d'estudiar la utilitat del pprs.)">
      <pattern>
	<pattern-item n="pprs"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>	
	<call-macro n="tipus_verbs">
	  <with-param pos="1"/>
	</call-macro>
	<choose>
	  <when>
	    <test>
	      <equal>	    	
		<var n="tipus_verb"/>
		<lit-tag v="pron"/>
	      </equal>
	    </test>
	    <out>
	      
	      <chunk name="ger" case="caseFirstWord">
		<tags>	       
		  <tag><lit-tag v="SV"/></tag>
		  <tag><var n="tipus_verb"/></tag>
		  <tag><lit-tag v="ger"/></tag>
		  <tag><lit-tag v="PD"/></tag>
		  <tag><lit-tag v="ND"/></tag>
		</tags> 
		<mlu>
		  <lu>
		    <clip pos="1" side="tl" part="lemh"/> 
		    <clip pos="1" side="tl" part="a_verb"/>
		    <lit-tag v="3"/>
		    
		  </lu>
		  <lu>
		    <lit v="es"/>
		    <lit-tag v="prn.enc.ref.p3.mf.sp"/>
		    <clip pos="1" side="tl" part="lemq"/>
		  </lu>
		</mlu>
	      </chunk>
	    </out>
	  </when>
	  <otherwise>
	    <out>
	      <chunk name="ger" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="SV"/></tag>
		  <tag><var n="tipus_verb"/></tag>
		  <tag><lit-tag v="ger"/></tag>
		  <tag><lit-tag v="PD"/></tag> <!-- BCN -->
		  <tag><lit-tag v="ND"/></tag> <!-- BCN -->
		</tags>  	
		<lu>	
		  <clip pos="1" side="tl" part="lemh"/> 
		  <clip pos="1" side="tl" part="a_verb"/>
		  <lit-tag v="3"/>
		  <clip pos="1" side="tl" part="lemq"/>
		</lu>
	      </chunk>
	    </out>
	  </otherwise>
	</choose>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>
    
    <rule comment="REGLA: PPRS+clític (ídem regla anterior PPRS)">
      <pattern>
	<pattern-item n="pprs"/>
	<pattern-item n="probj"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>	
	<call-macro n="tipus_verbs">
	  <with-param pos="1"/>
	</call-macro>
	<choose>
	  <when>
	    <test>
	      <equal>	    	
		<var n="tipus_verb"/>
		<lit-tag v="pron"/>
	      </equal>
	    </test>
	    <out>	      
	      <chunk name="ger_enc" case="caseFirstWord">
		<tags>	       
		  <tag><lit-tag v="SV"/></tag>
		  <tag><var n="tipus_verb"/></tag>
		  <tag><lit-tag v="ger"/></tag>
		  <tag><lit-tag v="PD"/></tag>
		  <tag><lit-tag v="ND"/></tag>
		</tags> 
	<!--	<mlu> -->
		  <lu>
		    <clip pos="1" side="tl" part="lemh"/> 
		    <clip pos="1" side="tl" part="a_verb"/>
		    <lit-tag v="3"/>		    
		  </lu>
		  <b/>
		  <lu>
		    <lit v="es"/>
		    <lit-tag v="prn.enc.ref.p3.mf.sp"/>
		  </lu>
		  <b pos="1"/>
		  <lu>
		    <clip pos="2" side="tl" part="lem"/>
		    <lit-tag v="prn.enc"/>
		    <clip pos="2" side="tl" part="pers"/>
		    <clip pos="2" side="tl" part="gen"/>
		    <clip pos="2" side="tl" part="nbr"/>
		    <clip pos="1" side="tl" part="lemq"/>
		  </lu>
	<!--	</mlu> -->
	      </chunk>
	    </out>
	  </when>
	  <otherwise>
	    <out>
	      <chunk name="ger_enc" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="SV"/></tag>
		  <tag><var n="tipus_verb"/></tag>
		  <tag><lit-tag v="ger"/></tag>
		  <tag><lit-tag v="PD"/></tag>
		  <tag><lit-tag v="ND"/></tag>
		</tags>  	
	<!--	<mlu> -->
		  <lu>
		    <clip pos="1" side="tl" part="lemh"/> 
		    <clip pos="1" side="tl" part="a_verb"/>
		    <lit-tag v="3"/>
		  </lu>		  
		  <b pos="1"/>
		  <lu>
		    <clip pos="2" side="tl" part="lem"/>
		    <lit-tag v="prn.enc"/>
		    <clip pos="2" side="tl" part="pers"/>
		    <clip pos="2" side="tl" part="gen"/>
		    <clip pos="2" side="tl" part="nbr"/>
		    <clip pos="1" side="tl" part="lemq"/>
		  </lu>
	<!--	</mlu>	-->	
	      </chunk>
	    </out>
	  </otherwise>
	</choose>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>


    <rule comment="REGLA: GER (per a col·locar la cua en les multiparaules)">
      <pattern>
	<pattern-item n="ger"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>	
	<call-macro n="tipus_verbs">
	  <with-param pos="1"/>
	</call-macro>
	<choose>
	  <when>
	    <test>
	      <equal>	    	
		<var n="tipus_verb"/>
		<lit-tag v="pron"/>
	      </equal>
	    </test>
	    <out>
	      
	      <chunk name="ger" case="caseFirstWord">
		<tags>	       
		  <tag><lit-tag v="SV"/></tag>
		  <tag><var n="tipus_verb"/></tag>
		  <tag><clip pos="1" side="tl" part="temps"/></tag>
		  <tag><lit-tag v="PD"/></tag>
		  <tag><lit-tag v="ND"/></tag>
		</tags> 
		<mlu>
		  <lu>
		    <clip pos="1" side="tl" part="lemh"/> 
		    <clip pos="1" side="tl" part="a_verb"/>
		    <clip pos="1" side="tl" part="temps" link-to="3"/>
		    
		  </lu>
		  <lu>
		    <lit v="es"/>
		    <lit-tag v="prn.enc.ref.p3.mf.sp"/>
			 <clip pos="1" side="tl" part="lemq"/>
		  </lu>
		</mlu>
	      </chunk>
	    </out>
	  </when>
	  <otherwise>
	    <out>
	      <chunk name="ger" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="SV"/></tag>
		  <tag><var n="tipus_verb"/></tag>
		  <tag><clip pos="1" side="tl" part="temps"/></tag>
		  <tag><lit-tag v="PD"/></tag> <!-- BCN -->
		  <tag><lit-tag v="ND"/></tag> <!-- BCN -->
		</tags>  	
		<lu>	
		  <clip pos="1" side="tl" part="lemh"/> 
		  <clip pos="1" side="tl" part="a_verb"/>
		  <clip pos="1" side="tl" part="temps" link-to="3"/>
		  <clip pos="1" side="tl" part="lemq"/>
		</lu>
	      </chunk>
	    </out>
	  </otherwise>
	</choose>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>
    
    <rule comment="REGLA: GER+clític">
      <pattern>
	<pattern-item n="ger"/>
	<pattern-item n="probj"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>	
	<call-macro n="tipus_verbs">
	  <with-param pos="1"/>
	</call-macro>
	<choose>
	  <when>
	    <test>
	      <equal>	    	
		<var n="tipus_verb"/>
		<lit-tag v="pron"/>
	      </equal>
	    </test>
	    <out>	      
	      <chunk name="ger_enc" case="caseFirstWord">
		<tags>	       
		  <tag><lit-tag v="SV"/></tag>
		  <tag><var n="tipus_verb"/></tag>
		  <tag><clip pos="1" side="tl" part="temps"/></tag>
		  <tag><lit-tag v="PD"/></tag>
		  <tag><lit-tag v="ND"/></tag>
		</tags> 
	<!--	<mlu> -->
		  <lu>
		    <clip pos="1" side="tl" part="lemh"/> 
		    <clip pos="1" side="tl" part="a_verb"/>
		    <clip pos="1" side="tl" part="temps" link-to="3"/>		    
		  </lu>
		  <b/>
		  <lu>
		    <lit v="es"/>
		    <lit-tag v="prn.enc.ref.p3.mf.sp"/>
		  </lu>
		  <b pos="1"/>
		  <lu>
		    <clip pos="2" side="tl" part="lem"/>
		    <lit-tag v="prn.enc"/>
		    <clip pos="2" side="tl" part="pers"/>
		    <clip pos="2" side="tl" part="gen"/>
		    <clip pos="2" side="tl" part="nbr"/>
		    <clip pos="1" side="tl" part="lemq"/>
		  </lu>
	<!--	</mlu> -->
	      </chunk>
	    </out>
	  </when>
	  <otherwise>
	    <out>
	      <chunk name="ger_enc" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="SV"/></tag>
		  <tag><var n="tipus_verb"/></tag>
		  <tag><clip pos="1" side="tl" part="temps"/></tag>
		  <tag><lit-tag v="PD"/></tag>
		  <tag><lit-tag v="ND"/></tag>
		</tags>  	
	<!--	<mlu> -->
		  <lu>
		    <clip pos="1" side="tl" part="lemh"/> 
		    <clip pos="1" side="tl" part="a_verb"/>
		    <clip pos="1" side="tl" part="temps" link-to="3"/>
		  </lu>		  
		  <b pos="1"/>
		  <lu>
		    <clip pos="2" side="tl" part="lem"/>
		    <lit-tag v="prn.enc"/>
		    <clip pos="2" side="tl" part="pers"/>
		    <clip pos="2" side="tl" part="gen"/>
		    <clip pos="2" side="tl" part="nbr"/>
		    <clip pos="1" side="tl" part="lemq"/>
		  </lu>
	<!--	</mlu>	-->	
	      </chunk>
	    </out>
	  </otherwise>
	</choose>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>


   <rule comment="REGLA: PREP GER ">
      <pattern>
	<pattern-item n="prep_cnjadv"/>
	<pattern-item n="ger"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>	
	<call-macro n="tipus_verbs">
	  <with-param pos="2"/>
	</call-macro>
	<let>
	  <clip pos="2" side="tl" part="temps"/>
	  <lit-tag v="inf"/>
	</let>
	<choose>
	  <when>
	    <test>
		<equal>
		  <clip pos="1" side="sl" part="lem"/>
		  <lit v="before"/>
		</equal>
	    </test>
	    <let>
	      <clip pos="1" side="tl" part="lem"/>
	      <lit v="abans de"/>
	    </let>
	  </when>
	  <when>
	    <test>
		<equal>
		  <clip pos="1" side="sl" part="lem"/>
		  <lit v="after"/>
		</equal>
	    </test>
	    <let>
	      <clip pos="1" side="tl" part="lem"/>
	      <lit v="després de"/>
	    </let>
	  </when>
	</choose>
	<out>
	  <chunk name="pr" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="PREP"/></tag>
	    </tags>
	    <lu>   
	      <clip pos="1" side="tl" part="lem"/>
	      <lit-tag v="pr"/><!--perquè per a 'before' i 'after' no envii <cnjadv> -->
	    </lu> 
	  </chunk>	  
	  <b pos="1"/>
	</out>
	<choose>
	  <when>
	    <test>
	      <equal>	    	
		<var n="tipus_verb"/>
		<lit-tag v="pron"/>
	      </equal>
	    </test>
	    <out>
	      <chunk name="inf">
		<tags>	       
		  <tag><lit-tag v="SV"/></tag>
		  <tag><var n="tipus_verb"/></tag>
		  <tag><clip pos="2" side="tl" part="temps"/></tag>
		</tags> 
		<mlu>
		  <lu>
		    <clip pos="2" side="tl" part="lemh"/> 
		    <clip pos="2" side="tl" part="a_verb"/>
		    <clip pos="2" side="tl" part="temps" link-to="3"/>
		    
		  </lu>
		  <lu>
		    <lit v="es"/>
		    <lit-tag v="prn.enc.ref.p3.mf.sp"/>
		    <clip pos="2" side="tl" part="lemq"/>
		  </lu>
		</mlu>
	      </chunk>
	    </out>
	  </when>
	  <otherwise>
	    <out>
	      <chunk name="inf">
		<tags>
		  <tag><lit-tag v="SV"/></tag>
		  <tag><var n="tipus_verb"/></tag>
		  <tag><clip pos="2" side="tl" part="temps"/></tag>
		</tags>  	
		<lu>	
		  <clip pos="2" side="tl" part="lemh"/> 
		  <clip pos="2" side="tl" part="a_verb"/>
		  <clip pos="2" side="tl" part="temps" link-to="3"/>
		  <clip pos="2" side="tl" part="lemq"/>
		</lu>
	      </chunk>
	    </out>
	  </otherwise>
	</choose>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>
    
    <rule comment="REGLA: PREP GER+clític">
      <pattern>
	<pattern-item n="prep_cnjadv"/>
	<pattern-item n="ger"/>
	<pattern-item n="probj"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>	
	<call-macro n="tipus_verbs">
	  <with-param pos="2"/>
	</call-macro>
	<let>
	  <clip pos="2" side="tl" part="temps"/>
	  <lit-tag v="inf"/>
	</let>	
	<choose>
	  <when>
	    <test>
		<equal>
		  <clip pos="1" side="sl" part="lem"/>
		  <lit v="before"/>
		</equal>
	    </test>
	    <let>
	      <clip pos="1" side="tl" part="lem"/>
	      <lit v="abans de"/>
	    </let>
	  </when>
	  <when>
	    <test>
		<equal>
		  <clip pos="1" side="sl" part="lem"/>
		  <lit v="after"/>
		</equal>
	    </test>
	    <let>
	      <clip pos="1" side="tl" part="lem"/>
	      <lit v="després de"/>
	    </let>
	  </when>
	</choose>
	<out>
	  <chunk name="pr" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="PREP"/></tag>
	    </tags>
	    <lu>   
	      <clip pos="1" side="tl" part="lem"/> 
	      <lit-tag v="pr"/><!--perquè per a 'before' i 'after' no envii <cnjadv> -->
	    </lu> 
	  </chunk>	  
	  <b pos="1"/>
	</out>
	<choose>
	  <when>
	    <test>
	      <equal>	    	
		<var n="tipus_verb"/>
		<lit-tag v="pron"/>
	      </equal>
	    </test>
	    <out>	      
	      <chunk name="inf_enc">
		<tags>	       
		  <tag><lit-tag v="SV"/></tag>
		  <tag><var n="tipus_verb"/></tag>
		  <tag><clip pos="2" side="tl" part="temps"/></tag>
		</tags> 
		<mlu>
		  <lu>
		    <clip pos="2" side="tl" part="lemh"/> 
		    <clip pos="2" side="tl" part="a_verb"/>
		    <clip pos="2" side="tl" part="temps" link-to="3"/>
		    
		  </lu>
		  <lu>
		    <lit v="es"/>
		    <lit-tag v="prn.enc.ref.p3.mf.sp"/>
		  </lu>
		  <lu>
		    <clip pos="3" side="tl" part="lem"/>
		    <lit-tag v="prn.enc"/>
		    <clip pos="3" side="tl" part="pers"/>
		    <clip pos="3" side="tl" part="gen"/>
		    <clip pos="3" side="tl" part="nbr"/>
		    <clip pos="2" side="tl" part="lemq"/>
		  </lu>
		</mlu>
	      </chunk>
	    </out>
	  </when>
	  <otherwise>
	    <out>
	      <chunk name="inf_enc">
		<tags>
		  <tag><lit-tag v="SV"/></tag>
		  <tag><var n="tipus_verb"/></tag>
		  <tag><clip pos="2" side="tl" part="temps"/></tag>
		</tags>  	
		<mlu>
		  <lu>
		    <clip pos="2" side="tl" part="lemh"/> 
		    <clip pos="2" side="tl" part="a_verb"/>
		    <clip pos="2" side="tl" part="temps" link-to="3"/>
		  </lu>
		  <lu>
		    <clip pos="3" side="tl" part="lem"/>
		    <lit-tag v="prn.enc"/>
		    <clip pos="3" side="tl" part="pers"/>
		    <clip pos="3" side="tl" part="gen"/>
		    <clip pos="3" side="tl" part="nbr"/>
		    <clip pos="2" side="tl" part="lemq"/>
		  </lu>
		</mlu>		
	      </chunk>
	    </out>
	  </otherwise>
	</choose>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>


 <rule comment="PREP HAVERger PARTICIPI (without having finished - sense haver(inf) acabat)">
      <pattern>
	<pattern-item n="prep_cnjadv"/>
	<pattern-item n="haveger"/>
	<pattern-item n="pp"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>	
	<call-macro n="tipus_verbs">
	  <with-param pos="3"/>
	</call-macro>
	<call-macro n="pron">
	  <with-param pos="3"/>
	</call-macro>
	<let>
	  <clip pos="2" side="tl" part="temps"/>
	  <lit-tag v="inf"/>
	</let>	
	<choose>
	  <when>
	    <test>
		<equal>
		  <clip pos="1" side="sl" part="lem"/>
		  <lit v="before"/>
		</equal>
	    </test>
	    <let>
	      <clip pos="1" side="tl" part="lem"/>
	      <lit v="abans de"/>
	    </let>
	  </when>
	  <when>
	    <test>
		<equal>
		  <clip pos="1" side="sl" part="lem"/>
		  <lit v="after"/>
		</equal>
	    </test>
	    <let>
	      <clip pos="1" side="tl" part="lem"/>
	      <lit v="després de"/>
	    </let>
	  </when>
	</choose>
	<out>
	  <chunk name="pr" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="PREP"/></tag>
	    </tags>
	    <lu>   
	      <clip pos="1" side="tl" part="lem"/> 
	      <lit-tag v="pr"/><!--perquè per a 'before' i 'after' no envii <cnjadv> -->
	    </lu> 
	  </chunk>	  
	  <b pos="1"/>
	  <chunk name="have_pp">
	    <tags>
	      <tag><lit-tag v="SV"/></tag>
	      <tag><var n="tipus_verb"/></tag>
	      <tag><clip pos="2" side="tl" part="temps"/></tag>
	    </tags> 
	    <lu>   
	      <var n="pronom"/> 
	      <clip pos="2" side="tl" part="lemh"/>
	      <clip pos="2" side="tl" part="a_verb"/>
	      <clip pos="2" side="tl" part="temps" link-to="3"/>
	      <clip pos="2" side="tl" part="lemq"/> 
	    </lu> 
	    <b pos="2"/>
	    <lu>
	      <clip pos="3" side="tl" part="lemh"/> 
	      <clip pos="3" side="tl" part="a_pp"/>
	      <lit-tag v="m.sg"/>
	      <clip pos="3" side="tl" part="lemq"/> 
	    </lu>
	  </chunk>
	</out>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>

    <rule comment="PREP HAVERger PARTICIPI clític (without having finished it - sense haver-lo acabat)">
      <pattern>
	<pattern-item n="prep_cnjadv"/>
	<pattern-item n="have_aux"/>
	<pattern-item n="pp"/>
	<pattern-item n="probj"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>	
	<call-macro n="tipus_verbs">
	  <with-param pos="3"/>
	</call-macro>
	<call-macro n="pron">
	  <with-param pos="3"/>
	</call-macro>
	<let>
	  <clip pos="2" side="tl" part="temps"/>
	  <lit-tag v="inf"/>
	</let>	
	<choose>
	  <when>
	    <test>
		<equal>
		  <clip pos="1" side="sl" part="lem"/>
		  <lit v="before"/>
		</equal>
	    </test>
	    <let>
	      <clip pos="1" side="tl" part="lem"/>
	      <lit v="abans de"/>
	    </let>
	  </when>
	  <when>
	    <test>
		<equal>
		  <clip pos="1" side="sl" part="lem"/>
		  <lit v="after"/>
		</equal>
	    </test>
	    <let>
	      <clip pos="1" side="tl" part="lem"/>
	      <lit v="després de"/>
	    </let>
	  </when>
	</choose>
	<out>
	  <chunk name="pr" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="PREP"/></tag>
	    </tags>
	    <lu>    
	      <clip pos="1" side="tl" part="lem"/> 
	      <lit-tag v="pr"/><!--perquè per a 'before' i 'after' no envii <cnjadv> --> 
	    </lu> 
	  </chunk>	  
	  <b pos="1"/>
	  <chunk name="have_enc_pp">
	    <tags>
	      <tag><lit-tag v="SV"/></tag>
	      <tag><var n="tipus_verb"/></tag>
	      <tag><clip pos="2" side="tl" part="temps"/></tag>
	      <tag><clip pos="2" side="tl" part="pers"/></tag>
	      <tag><clip pos="2" side="tl" part="nbr"/></tag>
	    </tags> 
	    <mlu>
	      <lu>   
		<clip pos="2" side="tl" part="lemh"/>
		<clip pos="2" side="tl" part="a_verb"/>
		<clip pos="2" side="tl" part="temps" link-to="3"/>
		<clip pos="2" side="tl" part="lemq"/> 
	      </lu> 
	      <lu>
		<var n="pronom"/>
		<clip pos="4" side="tl" part="lem"/>
		<lit-tag v="prn.enc"/>
		<clip pos="4" side="tl" part="pers"/>
		<clip pos="4" side="tl" part="gen"/>
		<clip pos="4" side="tl" part="nbr"/>
	      </lu>
	    </mlu>
	    <b pos="2"/>	    
	    <lu>
	      <clip pos="3" side="tl" part="lemh"/> 
	      <clip pos="3" side="tl" part="a_pp"/>
	      <lit-tag v="m.sg"/>
	      <clip pos="3" side="tl" part="lemq"/> 
	    </lu>
	  </chunk>
	</out>
	<call-macro n="f_bcond">
	  <with-param pos="1"/>
	</call-macro>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>



  <!--  <rule comment="REGLA: PART.PRESENT (quan el nom al que acompanya és desconegut) 1ª APROXIMACIÓ">
      <pattern>
	<pattern-item n="pprs"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>	
	<call-macro n="tipus_verbs">
	  <with-param pos="1"/>
	</call-macro>
	<out> 
	  <chunk name="pprs" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SV"/></tag>
	      <tag><var n="tipus_verb"/></tag>
	      <tag><lit-tag v="pprs"/></tag>
	    </tags>  	
	    <lu>	
	      <clip pos="1" side="tl" part="lemh"/> 
	      <clip pos="1" side="tl" part="a_verb"/>
	      <clip pos="1" side="tl" part="temps" link-to="3"/>
	      <clip pos="1" side="tl" part="lemq"/>
	    </lu>
	  </chunk>
	</out>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule> -->
    
    <rule comment="REGLA: VERB SUBS (living -> viure)">
      <pattern>
	<pattern-item n="vbsubs"/> 
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>	
	<call-macro n="tipus_verbs">
	  <with-param pos="1"/>
	</call-macro>
	<out>
	  <chunk name="subs" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SV"/></tag>
	      <tag><var n="tipus_verb"/></tag>
	      <tag><lit-tag v="inf"/></tag>
	    </tags>  
	    <lu>
	      <clip pos="1" side="tl" part="lemh"/> 
	      <clip pos="1" side="tl" part="a_verb"/>
	      <clip pos="1" side="tl" part="temps" link-to="3"/>
	      <clip pos="1" side="tl" part="lemq"/> 
	    </lu>
	  </chunk>
	</out>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>
    
    <rule comment="REGLA: VERB SUBS+clític (living it -> viure'l) ATENCIÓ: no he pogut comprovar si funciona -carmentano">
      <pattern>
	<pattern-item n="vbsubs"/> 
	<pattern-item n="probj"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>	
	<call-macro n="tipus_verbs">
	  <with-param pos="1"/>
	</call-macro>
	<out>
	  <chunk name="subs_enc" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SV"/></tag>
	      <tag><var n="tipus_verb"/></tag>
	      <tag><lit-tag v="inf"/></tag>
	    </tags>  
	    <mlu>
	      <lu>
		<clip pos="1" side="tl" part="lemh"/> 
		<clip pos="1" side="tl" part="a_verb"/>
		<clip pos="1" side="tl" part="temps" link-to="3"/>
	      </lu>
	      <lu>
		<clip pos="2" side="tl" part="lem"/>
		<lit-tag v="prn.enc"/>
		<clip pos="2" side="tl" part="pers"/>
		<clip pos="2" side="tl" part="gen"/>
		<clip pos="2" side="tl" part="nbr"/>
		<clip pos="1" side="tl" part="lemq"/>
	      </lu>
	    </mlu>	
	  </chunk>
	</out>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>
    
    <rule comment="REGLA: VERB PART. Seran GD i ND excepte 'ser' i 'estar'. Caldria afegir el pp en les regles d'adjectiu?)">
      <pattern>
	<pattern-item n="pp"/> 
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<choose>
	  <when><!--si és verb 'ser' o 'estar' només pot ser m sg -->
	    <test>
	      <or>
		<equal>
		  <clip pos="1" side="tl" part="a_verb"/>
		  <lit-tag v="vbser"/>
		</equal>
		<equal caseless="yes">
		  <clip pos="1" side="tl" part="lemh"/>
		  <lit v="estar"/><!--tb agafa multiparaules com 'estar d'acord' -->
		</equal>
	      </or>
	    </test>
	    <out>
	      <chunk name="pp" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="SA"/></tag>
		  <tag><lit-tag v="m"/></tag>
		  <tag><lit-tag v="sg"/></tag>
		</tags>  
		<lu>
		  <clip pos="1" side="tl" part="lemh"/> 
		  <clip pos="1" side="tl" part="a_pp"/>
		  <lit-tag v="m.sg"/>
		  <clip pos="1" side="tl" part="lemq"/> 
		</lu>
	      </chunk>
	    </out>
	  </when>
	  <otherwise>	
	    <out>
	      <chunk name="pp" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="SA"/></tag>
		  <tag><lit-tag v="GD"/></tag>
		  <tag><lit-tag v="ND"/></tag>
		</tags> 
		<lu>
		  <clip pos="1" side="tl" part="lemh"/> 
		  <clip pos="1" side="tl" part="a_pp"/>
		  <lit-tag v="2"/>
		  <lit-tag v="3"/>
		  <clip pos="1" side="tl" part="lemq"/> 
		</lu>
	      </chunk>
	    </out>
	  </otherwise>
	</choose>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>




    <rule comment="REGLA: AUX (de temps) VERB (will come, would come)">		 
      <pattern>
	<pattern-item n="auxtemps"/>
	<pattern-item n="infpres"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>	
	<call-macro n="tipus_verbs">
	  <with-param pos="2"/>
	</call-macro>
	<call-macro n="pron">
	  <with-param pos="2"/>
	</call-macro>
	
	<choose>		
	  <when>
	    <test>
	      <or>
		<equal caseless="yes">
		  <clip pos="1" side="sl" part="lem"/>
		  <lit v="will"/>
		</equal>
		<equal caseless="yes">
		  <clip pos="1" side="sl" part="lem"/>
		  <lit v="shall"/>
		</equal>
	      </or>
	    </test>
	    <let>
	      <clip pos="2" side="tl" part="temps"/>
	      <lit-tag v="fti"/>
	    </let>
	  </when>
	  <when>
	    <test>
	      <equal caseless="yes">
		<clip pos="1" side="sl" part="lem"/>
		<lit v="would"/>
	      </equal>
	    </test>
	    <let>
	      <clip pos="2" side="tl" part="temps"/>
	      <lit-tag v="cni"/>
	    </let>
	  </when>		
	</choose>
	
	<out>
	  <chunk name="verbcj" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SV"/></tag>
	      <tag><var n="tipus_verb"/></tag>
	      <tag><clip pos="2" side="tl" part="temps"/></tag>
	      <tag><lit-tag v="PD"/></tag>
	      <tag><lit-tag v="ND"/></tag>
	    </tags>      
	    <lu>   
	      <var n="pronom"/>
	      <clip pos="2" side="tl" part="lemh"/>
	      <clip pos="2" side="tl" part="a_verb"/>
	      <clip pos="2" side="tl" part="temps" link-to="3"/>
	      <lit-tag v="4"/>
	      <lit-tag v="5"/>
	      <clip pos="2" side="tl" part="lemq"/>
	    </lu> 
	  </chunk>
	</out>
	<call-macro n="f_bcond">
	  <with-param pos="1"/>
	</call-macro>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>

    <rule comment="REGLA: AUX (de temps) VERB (will come, would come) + clític: will sing it -> el cantarà">		 
      <pattern>
	<pattern-item n="auxtemps"/>
	<pattern-item n="infpres"/>
	<pattern-item n="probj"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>	
	<call-macro n="tipus_verbs">
	  <with-param pos="2"/>
	</call-macro>
	<call-macro n="pron">
	  <with-param pos="2"/>
	</call-macro>
	
	<choose>		
	  <when>
	    <test>
	      <or>
		<equal caseless="yes">
		  <clip pos="1" side="sl" part="lem"/>
		  <lit v="will"/>
		</equal>
		<equal caseless="yes">
		  <clip pos="1" side="sl" part="lem"/>
		  <lit v="shall"/>
		</equal>
	      </or>
	    </test>
	    <let>
	      <clip pos="2" side="tl" part="temps"/>
	      <lit-tag v="fti"/>
	    </let>
	  </when>
	  <when>
	    <test>
	      <equal caseless="yes">
		<clip pos="1" side="sl" part="lem"/>
		<lit v="would"/>
	      </equal>
	    </test>
	    <let>
	      <clip pos="2" side="tl" part="temps"/>
	      <lit-tag v="cni"/>
	    </let>
	  </when>		
	</choose>
	
	<out>
	  <chunk name="pro_verbcj" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SV"/></tag>
	      <tag><var n="tipus_verb"/></tag>
	      <tag><clip pos="2" side="tl" part="temps"/></tag>
	      <tag><lit-tag v="PD"/></tag>
	      <tag><lit-tag v="ND"/></tag>
	    </tags>  
	    <lu>
	      <var n="pronom"/>
	      <clip pos="3" side="tl" part="lem"/>
	      <clip pos="3" side="tl" part="a_prnpro"/>
	      <clip pos="3" side="tl" part="pers"/>
	      <clip pos="3" side="tl" part="gen"/>
	      <clip pos="3" side="tl" part="nbr"/>
	    </lu>
	    <b pos="1"/>
	    
	    <lu>   
	      <clip pos="2" side="tl" part="lemh"/>
	      <clip pos="2" side="tl" part="a_verb"/>
	      <clip pos="2" side="tl" part="temps" link-to="3"/>
	      <lit-tag v="4"/>
	      <lit-tag v="5"/>
	      <clip pos="2" side="tl" part="lemq"/>
	    </lu> 
	  </chunk>
	</out>
	<call-macro n="f_bcond">
	  <with-param pos="2"/>
	</call-macro>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>
    



    <rule comment="REGLA: AUX (de mode) VERB (can come, should come)">		 
      <pattern>
	<pattern-item n="auxmod"/>
	<pattern-item n="infpres"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>	
	<call-macro n="tipus_verbs">
	  <with-param pos="2"/>
	</call-macro>
	<call-macro n="pron">
	  <with-param pos="2"/>
	</call-macro>
	
	<choose>     
	  <when>
	    <test>
	      <and>
		<equal caseless="yes">
		  <clip pos="1" side="sl" part="lem"/>
		  <lit v="can"/>
		</equal>
		<equal>
		  <clip pos="1" side="sl" part="temps"/>
		  <lit-tag v="pres"/>
		</equal>
	      </and>
	    </test>
	    <let>
	      <clip pos="1" side="tl" part="temps"/>
	      <lit-tag v="pri"/>
	    </let>
	  </when>
	  <when>
	    <test>
	      <and>
		<equal caseless="yes">
		  <clip pos="1" side="sl" part="lem"/>
		  <lit v="can"/>
		</equal>
		<equal>
		  <clip pos="1" side="sl" part="temps"/>
		  <lit-tag v="past"/>
		</equal>
	      </and>
	    </test>
	    <let>
	      <clip pos="1" side="tl" part="temps"/>
	      <lit-tag v="cni"/>
	    </let>
	  </when>
	  <when>
	    <test>
	      <or>
		<equal caseless="yes">
		  <clip pos="1" side="sl" part="lem"/>
		  <lit v="must"/>
		</equal>
		<equal caseless="yes">
		  <clip pos="1" side="sl" part="lem"/>
		  <lit v="may"/>
		</equal>
	      </or>
	    </test>
	    <let>
	      <clip pos="1" side="tl" part="temps"/>
	      <lit-tag v="pri"/>
	    </let>
	  </when>
	  <when>
	    <test>
	      <or>
		<equal caseless="yes">
		  <clip pos="1" side="sl" part="lem"/>
		  <lit v="should"/>
		</equal>
		<equal caseless="yes">
		  <clip pos="1" side="sl" part="lem"/>
		  <lit v="might"/>
		</equal>
	      </or>
	    </test>
	    <let>
	      <clip pos="1" side="tl" part="temps"/>
	      <lit-tag v="cni"/>
	    </let>
	  </when>
	</choose>
	<out>
	  <chunk name="auxmod_inf" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SV"/></tag>
	      <tag><var n="tipus_verb"/></tag>
	      <tag><clip pos="1" side="tl" part="temps"/></tag>
	      <tag><lit-tag v="PD"/></tag>
	      <tag><lit-tag v="ND"/></tag>
	    </tags>  
	    <lu>
	      <var n="pronom"/> 
	      <clip pos="1" side="tl" part="lemh"/>
	      <clip pos="1" side="tl" part="a_verb"/>
	      <clip pos="1" side="tl" part="temps" link-to="3"/>
	      <lit-tag v="4"/>
	      <lit-tag v="5"/>
	      <clip pos="1" side="tl" part="lemq"/>
	    </lu>
	    <b pos="1"/>
	    <lu>
	      <clip pos="2" side="tl" part="lemh"/> 
	      <clip pos="2" side="tl" part="a_verb"/>
	      <lit-tag v="inf"/>			
	      <clip pos="2" side="tl" part="lemq"/>
	    </lu>
	  </chunk>
	</out>    
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>

    <rule comment="REGLA: AUX (de mode) VERB (can come, should come) + clític (she should sing it -> l'hauria de cantar)">		 
      <pattern>
	<pattern-item n="auxmod"/>
	<pattern-item n="infpres"/>
	<pattern-item n="probj"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>	
	<call-macro n="tipus_verbs">
	  <with-param pos="2"/>
	</call-macro>
	<call-macro n="pron">
	  <with-param pos="2"/>
	</call-macro>
	
	<choose>     
	  <when>
	    <test>
	      <and>
		<equal caseless="yes">
		  <clip pos="1" side="sl" part="lem"/>
		  <lit v="can"/>
		</equal>
		<equal>
		  <clip pos="1" side="sl" part="temps"/>
		  <lit-tag v="pres"/>
		</equal>
	      </and>
	    </test>
	    <let>
	      <clip pos="1" side="tl" part="temps"/>
	      <lit-tag v="pri"/>
	    </let>
	  </when>
	  <when>
	    <test>
	      <and>
		<equal caseless="yes">
		  <clip pos="1" side="sl" part="lem"/>
		  <lit v="can"/>
		</equal>
		<equal>
		  <clip pos="1" side="sl" part="temps"/>
		  <lit-tag v="past"/>
		</equal>
	      </and>
	    </test>
	    <let>
	      <clip pos="1" side="tl" part="temps"/>
	      <lit-tag v="cni"/>
	    </let>
	  </when>
	  <when>
	    <test>
	      <or>
		<equal caseless="yes">
		  <clip pos="1" side="sl" part="lem"/>
		  <lit v="must"/>
		</equal>
		<equal caseless="yes">
		  <clip pos="1" side="sl" part="lem"/>
		  <lit v="may"/>
		</equal>
	      </or>
	    </test>
	    <let>
	      <clip pos="1" side="tl" part="temps"/>
	      <lit-tag v="pri"/>
	    </let>
	  </when>
	  <when>
	    <test>
	      <or>
		<equal caseless="yes">
		  <clip pos="1" side="sl" part="lem"/>
		  <lit v="should"/>
		</equal>
		<equal caseless="yes">
		  <clip pos="1" side="sl" part="lem"/>
		  <lit v="might"/>
		</equal>
	      </or>
	    </test>
	    <let>
	      <clip pos="1" side="tl" part="temps"/>
	      <lit-tag v="cni"/>
	    </let>
	  </when>
	</choose>
	<out>
	  <chunk name="pro_auxmod_inf" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SV"/></tag>
	      <tag><var n="tipus_verb"/></tag>
	      <tag><clip pos="1" side="tl" part="temps"/></tag>
	      <tag><lit-tag v="PD"/></tag>
	      <tag><lit-tag v="ND"/></tag>
	    </tags>  
	    <lu>
	      <var n="pronom"/>
	      <clip pos="3" side="tl" part="lem"/>
	      <clip pos="3" side="tl" part="a_prnpro"/>
	      <clip pos="3" side="tl" part="pers"/>
	      <clip pos="3" side="tl" part="gen"/>
	      <clip pos="3" side="tl" part="nbr"/>
	    </lu>
	    <b pos="1"/>
	    <lu>
	      <clip pos="1" side="tl" part="lemh"/>
	      <clip pos="1" side="tl" part="a_verb"/>
	      <clip pos="1" side="tl" part="temps" link-to="3"/>
	      <lit-tag v="4"/>
	      <lit-tag v="5"/>
	      <clip pos="1" side="tl" part="lemq"/>
	    </lu>
	    <b pos="2"/>
	    <lu>
	      <clip pos="2" side="tl" part="lemh"/> 
	      <clip pos="2" side="tl" part="a_verb"/>
	      <lit-tag v="inf"/>			
	      <clip pos="2" side="tl" part="lemq"/>
	    </lu>
	  </chunk>
	</out>    
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>
    

    <rule comment="REGLA: DO (aux) VERB (do come, did come -> vénen, van venir)">		 
      <pattern>
	<pattern-item n="do"/>
	<pattern-item n="infpres"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>	
	<call-macro n="tipus_verbs">
	  <with-param pos="2"/>
	</call-macro>
	<call-macro n="pron">
	  <with-param pos="2"/>
	</call-macro>
	
	<choose>
	  <when>
	    <test>
	      <equal>
		<clip pos="1" side="sl" part="temps"/>
		<lit-tag v="pri"/>
	      </equal>
	    </test>
	    <let>
	      <clip pos="2" side="tl" part="temps"/>
	      <lit-tag v="pri"/>
	    </let>
	    <out>
	      <chunk name="verbcj" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="SV"/></tag>
		  <tag><var n="tipus_verb"/></tag>
		  <tag><clip pos="2" side="tl" part="temps"/></tag>
		  <tag><clip pos="1" side="sl" part="pers"/></tag>
		  <tag><clip pos="1" side="sl" part="nbr"/></tag>
		</tags>      
		<lu>  
		  <var n="pronom"/> 
		  <clip pos="2" side="tl" part="lemh"/>
		  <clip pos="2" side="tl" part="a_verb"/>
		  <clip pos="2" side="tl" part="temps" link-to="3"/>
		  <clip pos="1" side="sl" part="pers" link-to="4"/>
		  <clip pos="1" side="sl" part="nbr" link-to="5"/>
		  <clip pos="2" side="tl" part="lemq"/>
		</lu> 
	      </chunk>
	    </out>
	  </when>
	  <when>
	    <test>
	      <or>
		<equal>
		  <clip pos="1" side="sl" part="temps"/>
		  <lit-tag v="pres"/>
		</equal>
		<equal>
		  <clip pos="1" side="sl" part="temps"/>
		  <lit-tag v="inf"/>
		</equal>
	      </or>
	    </test>
	    <let>
	      <clip pos="2" side="tl" part="temps"/>
	      <lit-tag v="pri"/>
	    </let>
	    <out>
	      <chunk name="verbcj" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="SV"/></tag>
		  <tag><var n="tipus_verb"/></tag>
		  <tag><clip pos="2" side="tl" part="temps"/></tag>
		  <tag><lit-tag v="PD"/></tag>
		  <tag><lit-tag v="ND"/></tag>
		</tags>      
		<lu> 
		  <var n="pronom"/> 
		  <clip pos="2" side="tl" part="lemh"/>
		  <clip pos="2" side="tl" part="a_verb"/>
		  <clip pos="2" side="tl" part="temps" link-to="3"/>
		  <lit-tag v="4"/>
		  <lit-tag v="5"/>
		  <clip pos="2" side="tl" part="lemq"/>
		</lu> 
	      </chunk>
	    </out>
	  </when>
	  <when>
	    <test>
	      <equal>
		<clip pos="1" side="sl" part="temps"/>
		<lit-tag v="past"/>
	      </equal> 
	    </test>

	    <out>
	      <chunk name="verbcj_perif" case="caseFirstWord">
		<tags>	       
		  <tag><lit-tag v="SV"/></tag>
		  <tag><var n="tipus_verb"/></tag>
		  <tag><lit-tag v="ifip"/></tag>
		  <tag><lit-tag v="PD"/></tag>
		  <tag><lit-tag v="ND"/></tag>
		</tags> 
		<lu>
		  <var n="pronom"/>
		  <lit v="anar"/>
		  <lit-tag v="vaux"/>
		  <lit-tag v="4"/>
		  <lit-tag v="5"/>
		</lu>
		<b/>
		<lu>
		  <clip pos="2" side="tl" part="lemh"/>
		  <clip pos="2" side="tl" part="a_verb"/>
		  <lit-tag v="inf"/>
		  <clip pos="2" side="tl" part="lemq"/>
		</lu>
	      </chunk>
	    </out>
	  </when>
	</choose>
	<call-macro n="f_bcond">
	  <with-param pos="1"/>
	</call-macro>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>

    <rule comment="REGLA: DO (aux) VERB + clític (do come, did come -> vénen, van venir)">		 
      <pattern>
	<pattern-item n="do"/>
	<pattern-item n="infpres"/>
	<pattern-item n="probj"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>	
	<call-macro n="tipus_verbs">
	  <with-param pos="2"/>
	</call-macro>
	<call-macro n="pron">
	  <with-param pos="2"/>
	</call-macro>
	
	<choose>
	  <when>
	    <test>
	      <equal>
		<clip pos="1" side="sl" part="temps"/>
		<lit-tag v="pri"/>
	      </equal>
	    </test>
	    <let>
	      <clip pos="2" side="tl" part="temps"/>
	      <lit-tag v="pri"/>
	    </let>
	    <out>
	      <chunk name="pro_verbcj" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="SV"/></tag>
		  <tag><var n="tipus_verb"/></tag>
		  <tag><clip pos="2" side="tl" part="temps"/></tag>
		  <tag><clip pos="1" side="sl" part="pers"/></tag>
		  <tag><clip pos="1" side="sl" part="nbr"/></tag>
		</tags>      
		<lu>
		  <var n="pronom"/>
		  <clip pos="3" side="tl" part="lem"/>
		  <clip pos="3" side="tl" part="a_prnpro"/>
		  <clip pos="3" side="tl" part="pers"/>
		  <clip pos="3" side="tl" part="gen"/>
		  <clip pos="3" side="tl" part="nbr"/>
		</lu>
		<b pos="1"/>
		<lu>  
		  <clip pos="2" side="tl" part="lemh"/>
		  <clip pos="2" side="tl" part="a_verb"/>
		  <clip pos="2" side="tl" part="temps" link-to="3"/>
		  <clip pos="1" side="sl" part="pers" link-to="4"/>
		  <clip pos="1" side="sl" part="nbr" link-to="5"/>
		  <clip pos="2" side="tl" part="lemq"/>
		</lu> 
	      </chunk>
	    </out>
	  </when>
	  <when>
	    <test>
	      <or>
		<equal>
		  <clip pos="1" side="sl" part="temps"/>
		  <lit-tag v="pres"/>
		</equal>
		<equal>
		  <clip pos="1" side="sl" part="temps"/>
		  <lit-tag v="inf"/>
		</equal>
	      </or>
	    </test>
	    <let>
	      <clip pos="2" side="tl" part="temps"/>
	      <lit-tag v="pri"/>
	    </let>
	    <out>
	      <chunk name="pro_verbcj" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="SV"/></tag>
		  <tag><var n="tipus_verb"/></tag>
		  <tag><clip pos="2" side="tl" part="temps"/></tag>
		  <tag><lit-tag v="PD"/></tag>
		  <tag><lit-tag v="ND"/></tag>
		</tags>      
		<lu>
		  <var n="pronom"/>
		  <clip pos="3" side="tl" part="lem"/>
		  <clip pos="3" side="tl" part="a_prnpro"/>
		  <clip pos="3" side="tl" part="pers"/>
		  <clip pos="3" side="tl" part="gen"/>
		  <clip pos="3" side="tl" part="nbr"/>
		</lu>
		<b pos="1"/>
		<lu> 
		  <clip pos="2" side="tl" part="lemh"/>
		  <clip pos="2" side="tl" part="a_verb"/>
		  <clip pos="2" side="tl" part="temps" link-to="3"/>
		  <lit-tag v="4"/>
		  <lit-tag v="5"/>
		  <clip pos="2" side="tl" part="lemq"/>
		</lu> 
	      </chunk>
	    </out>
	  </when>
	  <when>
	    <test>
	      <equal>
		<clip pos="1" side="sl" part="temps"/>
		<lit-tag v="past"/>
	      </equal> 
	    </test>
	    
	    <out>
	      <chunk name="pro_verbcj_perif" case="caseFirstWord">
		<tags>	       
		  <tag><lit-tag v="SV"/></tag>
		  <tag><var n="tipus_verb"/></tag>
		  <tag><lit-tag v="ifip"/></tag>
		  <tag><lit-tag v="PD"/></tag>
		  <tag><lit-tag v="ND"/></tag>
		</tags> 
		<lu>
		  <var n="pronom"/>
		  <clip pos="3" side="tl" part="lem"/>
		  <clip pos="3" side="tl" part="a_prnpro"/>
		  <clip pos="3" side="tl" part="pers"/>
		  <clip pos="3" side="tl" part="gen"/>
		  <clip pos="3" side="tl" part="nbr"/>
		</lu>
		<b pos="1"/>
		<lu>
		  <lit v="anar"/>
		  <lit-tag v="vaux"/>
		  <lit-tag v="4"/>
		  <lit-tag v="5"/>
		</lu>
		<b/>
		<lu>
		  <clip pos="2" side="tl" part="lemh"/>
		  <clip pos="2" side="tl" part="a_verb"/>
		  <lit-tag v="inf"/>
		  <clip pos="2" side="tl" part="lemq"/>
		</lu>
	      </chunk>
	    </out>
	  </when>
	</choose>
	<call-macro n="f_bcond">
	  <with-param pos="1"/>
	</call-macro>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>


    <rule comment="REGLA: MODAL conjugable + VERB (had to come - va/van haver de venir)">
      
      <pattern>
	<pattern-item n="mod"/>
	<pattern-item n="infpres"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>	
	<call-macro n="tipus_verbs">
	  <with-param pos="2"/>
	</call-macro>	
	<call-macro n="pron">
	  <with-param pos="2"/>
	</call-macro>
	
	<choose>
	  <when>
	    <test>
	      <or>
		<equal><!--De moment no sé si el tagger escull bé i els detecto els dos -->
		  <clip pos="1" side="sl" part="temps"/>
		  <lit-tag v="inf"/>
		</equal>
		<equal>
		  <clip pos="1" side="sl" part="temps"/>
		  <lit-tag v="pres"/>
		</equal>
	      </or>
	    </test>
	    <let>
	      <clip pos="1" side="tl" part="temps"/>
	      <lit-tag v="pri"/>
	    </let>
	    <out>
	      <chunk name="mod_inf" case="caseFirstWord">
		<tags>	       
		  <tag><lit-tag v="SV"/></tag>
		  <tag><var n="tipus_verb"/></tag>
		  <tag><clip pos="1" side="tl" part="temps"/></tag>
		  <tag><lit-tag v="PD"/></tag>
		  <tag><lit-tag v="ND"/></tag>
		</tags> 
		<lu>
		  <var n="pronom"/>
		  <clip pos="1" side="tl" part="lemh"/> 
		  <clip pos="1" side="tl" part="a_verb"/>
		  <clip pos="1" side="tl" part="temps" link-to="3"/>
		  <lit-tag v="4"/>
		  <lit-tag v="5"/>
		  <clip pos="1" side="tl" part="lemq"/> 
		</lu>
		<b pos="1"/>
		<lu>
		  <clip pos="2" side="tl" part="lemh"/>
		  <clip pos="2" side="tl" part="a_verb"/>
		  <lit-tag v="inf"/>
		  <clip pos="2" side="tl" part="lemq"/> 
		</lu> 
	      </chunk>
	    </out>
	  </when>

	  <when>
	    <test>
	      <or>
		<equal>
		  <clip pos="1" side="sl" part="temps"/>
		  <lit-tag v="past"/>
		</equal>
		<equal>
		  <clip pos="1" side="sl" part="temps"/>
		  <lit-tag v="pp"/>
		</equal>
	      </or>      
	    </test>
	    <let>
	      <clip pos="1" side="tl" part="temps"/>
	      <lit-tag v="inf"/>
	    </let>
	    <out>
	      <chunk name="mod_inf_perif" case="caseFirstWord">
		<tags>	       
		  <tag><lit-tag v="SV"/></tag>
		  <tag><var n="tipus_verb"/></tag>
		  <tag><lit-tag v="ifip"/></tag>
		  <tag><lit-tag v="PD"/></tag>
		  <tag><lit-tag v="ND"/></tag>
		</tags>
		<lu>
		  <var n="pronom"/>
		  <lit v="anar"/>
		  <lit-tag v="vaux"/>
		  <lit-tag v="4"/>
		  <lit-tag v="5"/>
		</lu>
		<b/>
		<lu>
		  <clip pos="1" side="tl" part="lemh"/>
		  <clip pos="1" side="tl" part="a_verb"/>
		  <clip pos="1" side="tl" part="temps"/>
		  <clip pos="1" side="tl" part="lemq"/>
		</lu>
		<b pos="1"/>
		<lu>
		  <clip pos="2" side="tl" part="lemh"/>
		  <clip pos="2" side="tl" part="a_verb"/>
		  <lit-tag v="inf"/>
		  <clip pos="2" side="tl" part="lemq"/> 
		</lu> 
	      </chunk>
	    </out>
	  </when>

	  <otherwise><!-- Quan és pri 3a sg (has) té gen i nbr-->
	    <out>
	      <chunk name="mod_inf" case="caseFirstWord">
		<tags>	       
		  <tag><lit-tag v="SV"/></tag>
		  <tag><var n="tipus_verb"/></tag>
		  <tag><clip pos="1" side="tl" part="temps"/></tag>
		  <tag><clip pos="1" side="tl" part="pers"/></tag>
		  <tag><clip pos="1" side="tl" part="nbr"/></tag>
		</tags>
		<lu>  
		  <var n="pronom"/>
		  <clip pos="1" side="tl" part="lemh"/>
		  <clip pos="1" side="tl" part="a_verb"/>
		  <clip pos="1" side="tl" part="temps" link-to="3"/>
		  <clip pos="1" side="tl" part="pers" link-to="4"/>
		  <clip pos="1" side="tl" part="nbr" link-to="5"/>
		  <clip pos="1" side="tl" part="lemq"/> 
		</lu> 
		<b pos="1"/>
		<lu>
		  <clip pos="2" side="tl" part="lemh"/>
		  <clip pos="2" side="tl" part="a_verb"/>
		  <lit-tag v="inf"/>
		  <clip pos="2" side="tl" part="lemq"/> 
		</lu> 
	      </chunk>
	    </out>
	  </otherwise>
	</choose>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>

    <rule comment="REGLA: MODAL conjugable + VERB + clític (had to sing it -> el van haver de cantar)">
      
      <pattern>
	<pattern-item n="mod"/>
	<pattern-item n="infpres"/>
	<pattern-item n="probj"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>	 	
	<call-macro n="tipus_verbs">
	  <with-param pos="2"/>
	</call-macro>
	<call-macro n="pron">
	  <with-param pos="2"/>
	</call-macro>
	
	<choose>
	  <when>
	    <test>
	      <or>
		<equal><!--De moment no sé si el tagger escull bé i els detecto els dos -->
		  <clip pos="1" side="sl" part="temps"/>
		  <lit-tag v="inf"/>
		</equal>
		<equal>
		  <clip pos="1" side="sl" part="temps"/>
		  <lit-tag v="pres"/>
		</equal>
	      </or>
	    </test>
	    <let>
	      <clip pos="1" side="tl" part="temps"/>
	      <lit-tag v="pri"/>
	    </let>
	    <out>
	      <chunk name="pro_mod_inf" case="caseFirstWord">
		<tags>	       
		  <tag><lit-tag v="SV"/></tag>
		  <tag><var n="tipus_verb"/></tag>
		  <tag><clip pos="1" side="tl" part="temps"/></tag>
		  <tag><lit-tag v="PD"/></tag>
		  <tag><lit-tag v="ND"/></tag>
		</tags> 
		<lu>
		  <var n="pronom"/>
		  <clip pos="3" side="tl" part="lem"/>
		  <clip pos="3" side="tl" part="a_prnpro"/>
		  <clip pos="3" side="tl" part="pers"/>
		  <clip pos="3" side="tl" part="gen"/>
		  <clip pos="3" side="tl" part="nbr"/>
		</lu>
		<b pos="1"/>
		
		<lu>
		  <clip pos="1" side="tl" part="lemh"/> 
		  <clip pos="1" side="tl" part="a_verb"/>
		  <clip pos="1" side="tl" part="temps" link-to="3"/>
		  <lit-tag v="4"/>
		  <lit-tag v="5"/>
		  <clip pos="1" side="tl" part="lemq"/> 
		</lu>
		<b pos="2"/>
		<lu>
		  <clip pos="2" side="tl" part="lemh"/>
		  <clip pos="2" side="tl" part="a_verb"/>
		  <lit-tag v="inf"/>
		  <clip pos="2" side="tl" part="lemq"/> 
		</lu> 
	      </chunk>
	    </out>
	  </when>
	  
	  <when>
	    <test>
	      <or>
		<equal>
		  <clip pos="1" side="sl" part="temps"/>
		  <lit-tag v="past"/>
		</equal>
		<equal>
		  <clip pos="1" side="sl" part="temps"/>
		  <lit-tag v="pp"/>
		</equal>
	      </or>
	    </test>
	    <let>
	      <clip pos="1" side="tl" part="temps"/>
	      <lit-tag v="inf"/>
	    </let>
	    <out>
	      <chunk name="pro_mod_inf_perif" case="caseFirstWord">
		<tags>	       
		  <tag><lit-tag v="SV"/></tag>
		  <tag><var n="tipus_verb"/></tag>
		  <tag><lit-tag v="ifip"/></tag>
		  <tag><lit-tag v="PD"/></tag>
		  <tag><lit-tag v="ND"/></tag>
		</tags>
		<lu>
		  <var n="pronom"/>
		  <clip pos="3" side="tl" part="lem"/>
		  <clip pos="3" side="tl" part="a_prnpro"/>
		  <clip pos="3" side="tl" part="pers"/>
		  <clip pos="3" side="tl" part="gen"/>
		  <clip pos="3" side="tl" part="nbr"/>
		</lu>
		<b pos="1"/>
		<lu>
		  <lit v="anar"/>
		  <lit-tag v="vaux"/>
		  <lit-tag v="4"/>
		  <lit-tag v="5"/>
		</lu>
		<b/>
		<lu>
		  <clip pos="1" side="tl" part="lemh"/>
		  <clip pos="1" side="tl" part="a_verb"/>
		  <clip pos="1" side="tl" part="temps"/>
		  <clip pos="1" side="tl" part="lemq"/>
		</lu>
		<b pos="2"/>
		<lu>
		  <clip pos="2" side="tl" part="lemh"/>
		  <clip pos="2" side="tl" part="a_verb"/>
		  <lit-tag v="inf"/>
		  <clip pos="2" side="tl" part="lemq"/> 
		</lu> 
	      </chunk>
	    </out>
	  </when>
	  
	  <otherwise><!-- Quan és pri 3a sg (has) té gen i nbr-->
	    <out>
	      <chunk name="pro_mod_inf" case="caseFirstWord">
		<tags>	       
		  <tag><lit-tag v="SV"/></tag>
		  <tag><var n="tipus_verb"/></tag>
		  <tag><clip pos="1" side="tl" part="temps"/></tag>
		  <tag><clip pos="1" side="tl" part="pers"/></tag>
		  <tag><clip pos="1" side="tl" part="nbr"/></tag>
		</tags>
		<lu>
		  <var n="pronom"/>
		  <clip pos="3" side="tl" part="lem"/>
		  <clip pos="3" side="tl" part="a_prnpro"/>
		  <clip pos="3" side="tl" part="pers"/>
		  <clip pos="3" side="tl" part="gen"/>
		  <clip pos="3" side="tl" part="nbr"/>
		</lu>
		<b pos="1"/>
		
		<lu>   
		  <clip pos="1" side="tl" part="lemh"/>
		  <clip pos="1" side="tl" part="a_verb"/>
		  <clip pos="1" side="tl" part="temps" link-to="3"/>
		  <clip pos="1" side="tl" part="pers" link-to="4"/>
		  <clip pos="1" side="tl" part="nbr" link-to="5"/>
		  <clip pos="1" side="tl" part="lemq"/> 
		</lu> 
		<b pos="2"/>
		<lu>
		  <clip pos="2" side="tl" part="lemh"/>
		  <clip pos="2" side="tl" part="a_verb"/>
		  <lit-tag v="inf"/>
		  <clip pos="2" side="tl" part="lemq"/> 
		</lu> 
	      </chunk>
	    </out>
	  </otherwise>
	</choose>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>



    <rule comment="REGLA: AUX + MODAL conjugable + VERB (I will have to come - hauré de venir)">
      
      <pattern>
	<pattern-item n="auxnocan"/>
	<pattern-item n="modinf"/>
	<pattern-item n="infpres"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>	
	<call-macro n="tipus_verbs">
	  <with-param pos="3"/>
	</call-macro>
	<call-macro n="pron">
	  <with-param pos="3"/>
	</call-macro>
	
	<choose>
	  <when>
	    <test>
	      <or>
		<equal caseless="yes">
		  <clip pos="1" side="sl" part="lem"/>
		  <lit v="will"/>
		</equal>
		<equal caseless="yes">
		  <clip pos="1" side="sl" part="lem"/>
		  <lit v="shall"/>
		</equal>
		<equal caseless="yes">
		  <clip pos="1" side="sl" part="lem"/>
		  <lit v="would"/>
		</equal>
	      </or>
	    </test>
	    <choose>		
	      <when>
		<test>
		  <or>
		    <equal caseless="yes">
		      <clip pos="1" side="sl" part="lem"/>
		      <lit v="will"/>
		    </equal>
		    <equal caseless="yes">
		      <clip pos="1" side="sl" part="lem"/>
		      <lit v="shall"/>
		    </equal>
		  </or>
		</test>
		<let>
		  <clip pos="2" side="tl" part="temps"/>
		  <lit-tag v="fti"/>
		</let>
	      </when>
	      <when>
		<test>
		  <equal caseless="yes">
		    <clip pos="1" side="sl" part="lem"/>
		    <lit v="would"/>
		  </equal>
		</test>
		<let>
		  <clip pos="2" side="tl" part="temps"/>
		  <lit-tag v="cni"/>
		</let>
	      </when>		
	    </choose>
	    <out>
	      <chunk name="mod_inf" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="SV"/></tag>
		  <tag><var n="tipus_verb"/></tag>
		  <tag><clip pos="2" side="tl" part="temps"/></tag>
		  <tag><lit-tag v="PD"/></tag>
		  <tag><lit-tag v="ND"/></tag>
		</tags>      
		<lu>  
		  <var n="pronom"/>
		  <clip pos="2" side="tl" part="lemh"/>
		  <clip pos="2" side="tl" part="a_verb"/>
		  <clip pos="2" side="tl" part="temps" link-to="3"/>
		  <lit-tag v="4"/>
		  <lit-tag v="5"/>
		  <clip pos="2" side="tl" part="lemq"/>
		</lu> 
		<b pos="2"/>
		<lu>
		  <clip pos="3" side="tl" part="lemh"/> 
		  <clip pos="3" side="tl" part="a_verb"/>
		  <lit-tag v="inf"/>
		  <clip pos="3" side="tl" part="lemq"/> 
		</lu>
	      </chunk>
	    </out>
	    <call-macro n="f_bcond">
	      <with-param pos="1"/>
	    </call-macro>
	  </when>
	  <when>
	    <test>
	      <or>
		<equal caseless="yes">
		  <clip pos="1" side="sl" part="lem"/>
		  <lit v="may"/>
		</equal>
		<equal caseless="yes">
		  <clip pos="1" side="sl" part="lem"/>
		  <lit v="might"/>
		</equal>
	      </or>
	    </test>
	    <choose>
	      <when>
		<test>
		  <equal caseless="yes">
		    <clip pos="1" side="sl" part="lem"/>
		    <lit v="may"/>
		  </equal>
		</test>
		<let>
		  <clip pos="1" side="tl" part="temps"/>
		  <lit-tag v="pri"/>
		</let>
	      </when>
	      <when>
		<test>
		  <equal caseless="yes">
		    <clip pos="1" side="sl" part="lem"/>
		    <lit v="might"/>
		  </equal>
		</test>
		<let>
		  <clip pos="1" side="tl" part="temps"/>
		  <lit-tag v="cni"/>
		</let>
	      </when>
	    </choose>  
	    <out>
	      <chunk name="auxmod_mod_inf" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="SV"/></tag>
		  <tag><var n="tipus_verb"/></tag>
		  <tag><clip pos="1" side="tl" part="temps"/></tag>
		  <tag><lit-tag v="PD"/></tag>
		  <tag><lit-tag v="ND"/></tag>
		</tags>      
		<lu>
		  <var n="pronom"/>
		  <clip pos="1" side="tl" part="lemh"/>
		  <clip pos="1" side="tl" part="a_verb"/>
		  <clip pos="1" side="tl" part="temps" link-to="3"/>
		  <lit-tag v="4"/>
		  <lit-tag v="5"/>
		  <clip pos="1" side="tl" part="lemq"/> 
		</lu>
		<b pos="1"/>
		<lu>
		  <clip pos="2" side="tl" part="lemh"/> 
		  <clip pos="2" side="tl" part="a_verb"/>
		  <lit-tag v="inf"/>			
		  <clip pos="2" side="tl" part="lemq"/>
		</lu>
		<b pos="2"/>
		<lu>
		  <clip pos="3" side="tl" part="lemh"/> 
		  <clip pos="3" side="tl" part="a_verb"/>
		  <lit-tag v="inf"/>
		  <clip pos="3" side="tl" part="lemq"/> 
		</lu>
	      </chunk>
	    </out>
	  </when>
	  <when>
	    <test>
	      <equal caseless="yes">
		<clip pos="1" side="sl" part="lem"/>
		<lit v="do"/>
	      </equal>
	    </test>
	    <choose>
	      <when>
		<test>
		  <or>
		    <equal>
		      <clip pos="1" side="sl" part="temps"/>
		      <lit-tag v="pres"/>
		    </equal>
		    <equal>
		      <clip pos="1" side="sl" part="temps"/>
		      <lit-tag v="pri"/>
		    </equal>
		  </or>
		</test>
		<choose>
		  <when>
		    <test>
		      <equal>
			<clip pos="1" side="sl" part="temps"/>
			<lit-tag v="pres"/>
		      </equal>
		    </test>
		    
		    <let>
		      <clip pos="2" side="tl" part="temps"/>
		      <lit-tag v="pri"/>
		    </let>
		    <let>
		      <var n="paraula2"/>
		      <clip pos="2" side="tl" part="lemh"/>
		    </let>
		    <append n="paraula2">
		      <clip pos="2" side="tl" part="tags"/>
		      <lit-tag v="PD"/>
		      <lit-tag v="ND"/>
		      <clip pos="2" side="tl" part="lemq"/>
		    </append>
		    <let>
		      <clip pos="2" side="tl" part="whole"/>
		      <var n="paraula2"/>
		    </let>
		  </when>
		  <when>
		    <test>
		      <equal>
			<clip pos="1" side="sl" part="temps"/>
			<lit-tag v="pri"/>
		      </equal>
		    </test>
		    <let>
		      <clip pos="2" side="tl" part="temps"/>
		      <lit-tag v="pri"/>
		    </let>
		    <let>
		      <var n="paraula2"/>
		      <clip pos="2" side="tl" part="lemh"/>
		    </let>
		    <append n="paraula2">
		      <clip pos="2" side="tl" part="tags"/>
		      <clip pos="1" side="sl" part="pers"/>
		      <clip pos="1" side="sl" part="nbr"/>
		      <clip pos="2" side="tl" part="lemq"/>
		    </append>
		    <let>
		      <clip pos="2" side="tl" part="whole"/>
		      <var n="paraula2"/>
		    </let>
		  </when>
		</choose>		    
		<out>
		  <chunk name="mod_inf" case="caseFirstWord">
		    <tags>
		      <tag><lit-tag v="SV"/></tag>
		      <tag><var n="tipus_verb"/></tag>
		      <tag><clip pos="2" side="tl" part="temps"/></tag>
		      <tag><clip pos="2" side="tl" part="pers"/></tag>
		      <tag><clip pos="2" side="tl" part="nbr"/></tag>
		    </tags>      
		    <lu>  
		      <var n="pronom"/>
		      <clip pos="2" side="tl" part="lemh"/>
		      <clip pos="2" side="tl" part="a_verb"/>
		      <clip pos="2" side="tl" part="temps" link-to="3"/>
		      <clip pos="2" side="tl" part="pers" link-to="4"/>
		      <clip pos="2" side="tl" part="nbr" link-to="5"/>
		      <clip pos="2" side="tl" part="lemq"/>
		    </lu> 
		    <b pos="2"/>
		    <lu>
		      <clip pos="3" side="tl" part="lemh"/> 
		      <clip pos="3" side="tl" part="a_verb"/>
		      <lit-tag v="inf"/>
		      <clip pos="3" side="tl" part="lemq"/> 
		    </lu>
		  </chunk>
		</out>
		<call-macro n="f_bcond">
		  <with-param pos="1"/>
		</call-macro>
	      </when>
	      <when>
		<test>
		  <equal>
		    <clip pos="1" side="sl" part="temps"/>
		    <lit-tag v="past"/>
		  </equal> 
		</test>
		<out>
		  <chunk name="mod_inf_perif" case="caseFirstWord">
		    <tags>
		      <tag><lit-tag v="SV"/></tag>
		      <tag><var n="tipus_verb"/></tag>
		      <tag><lit-tag v="ifip"/></tag>
		      <tag><lit-tag v="PD"/></tag>
		      <tag><lit-tag v="ND"/></tag>
		    </tags> 
		    <lu>
		      <var n="pronom"/>
		      <lit v="anar"/>
		      <lit-tag v="vaux"/>
		      <lit-tag v="4"/>
		      <lit-tag v="5"/>
		    </lu>
		    <b pos="1"/>
		    <lu>   
		      <clip pos="2" side="tl" part="lemh"/>
		      <clip pos="2" side="tl" part="a_verb"/>
		      <lit-tag v="inf"/>
		      <clip pos="2" side="tl" part="lemq"/>
		    </lu> 
		    <b pos="2"/>
		    <lu>
		      <clip pos="3" side="tl" part="lemh"/> 
		      <clip pos="3" side="tl" part="a_verb"/>
		      <lit-tag v="inf"/>
		      <clip pos="3" side="tl" part="lemq"/> 
		    </lu>
		  </chunk>
		</out>
	      </when>
	    </choose>
	  </when>
	</choose>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>
    
    <rule comment="REGLA: AUX + MODAL conjugable + VERB + clític (I will have to sing it - l'hauré de cantar)">
      
      <pattern>
	<pattern-item n="auxnocan"/>
	<pattern-item n="modinf"/>
	<pattern-item n="infpres"/>
	<pattern-item n="probj"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>	 	
	<call-macro n="tipus_verbs">
	  <with-param pos="3"/>
	</call-macro>
	<call-macro n="pron">
	  <with-param pos="3"/>
	</call-macro>
	
	<choose>
	  <when>
	    <test>
	      <or>
		<equal caseless="yes">
		  <clip pos="1" side="sl" part="lem"/>
		  <lit v="will"/>
		</equal>
		<equal caseless="yes">
		  <clip pos="1" side="sl" part="lem"/>
		  <lit v="shall"/>
		</equal>
		<equal caseless="yes">
		  <clip pos="1" side="sl" part="lem"/>
		  <lit v="would"/>
		</equal>
	      </or>
	    </test>
	    <choose>		
	      <when>
		<test>
		  <or>
		    <equal caseless="yes">
		      <clip pos="1" side="sl" part="lem"/>
		      <lit v="will"/>
		    </equal>
		    <equal caseless="yes">
		      <clip pos="1" side="sl" part="lem"/>
		      <lit v="shall"/>
		    </equal>
		  </or>
		</test>
		<let>
		  <clip pos="2" side="tl" part="temps"/>
		  <lit-tag v="fti"/>
		</let>
	      </when>
	      <when>
		<test>
		  <equal caseless="yes">
		    <clip pos="1" side="sl" part="lem"/>
		    <lit v="would"/>
		  </equal>
		</test>
		<let>
		  <clip pos="2" side="tl" part="temps"/>
		  <lit-tag v="cni"/>
		</let>
	      </when>		
	    </choose>
	    <out>
	      <chunk name="pro_mod_inf" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="SV"/></tag>
		  <tag><var n="tipus_verb"/></tag>
		  <tag><clip pos="2" side="tl" part="temps"/></tag>
		  <tag><lit-tag v="PD"/></tag>
		  <tag><lit-tag v="ND"/></tag>
		</tags>
		<lu>
		  <var n="pronom"/>
		  <clip pos="4" side="tl" part="lem"/>
		  <clip pos="4" side="tl" part="a_prnpro"/>
		  <clip pos="4" side="tl" part="pers"/>
		  <clip pos="4" side="tl" part="gen"/>
		  <clip pos="4" side="tl" part="nbr"/>
		</lu>
		<b pos="1"/>
		<lu>   
		  <clip pos="2" side="tl" part="lemh"/>
		  <clip pos="2" side="tl" part="a_verb"/>
		  <clip pos="2" side="tl" part="temps" link-to="3"/>
		  <lit-tag v="4"/>
		  <lit-tag v="5"/>
		  <clip pos="2" side="tl" part="lemq"/>
		</lu> 
		<b pos="2"/>
		<lu>
		  <clip pos="3" side="tl" part="lemh"/> 
		  <clip pos="3" side="tl" part="a_verb"/>
		  <lit-tag v="inf"/>
		  <clip pos="3" side="tl" part="lemq"/> 
		</lu>
	      </chunk>
	    </out>
	    <call-macro n="f_bcond">
	      <with-param pos="3"/>
	    </call-macro>
	  </when>
	  <when>
	    <test>
	      <or>
		<equal caseless="yes">
		  <clip pos="1" side="sl" part="lem"/>
		  <lit v="may"/>
		</equal>
		<equal caseless="yes">
		  <clip pos="1" side="sl" part="lem"/>
		  <lit v="might"/>
		</equal>
	      </or>
	    </test>
	    <choose>
	      <when>
		<test>
		  <equal caseless="yes">
		    <clip pos="1" side="sl" part="lem"/>
		    <lit v="may"/>
		  </equal>
		</test>
		<let>
		  <clip pos="1" side="tl" part="temps"/>
		  <lit-tag v="pri"/>
		</let>
	      </when>
	      <when>
		<test>
		  <equal caseless="yes">
		    <clip pos="1" side="sl" part="lem"/>
		    <lit v="might"/>
		  </equal>
		</test>
		<let>
		  <clip pos="1" side="tl" part="temps"/>
		  <lit-tag v="cni"/>
		</let>
	      </when>
	    </choose>  
	    <out>
	      <chunk name="pro_auxmod_mod_inf" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="SV"/></tag>
		  <tag><var n="tipus_verb"/></tag>
		  <tag><clip pos="1" side="tl" part="temps"/></tag>
		  <tag><lit-tag v="PD"/></tag>
		  <tag><lit-tag v="ND"/></tag>
		</tags>      
		<lu>
		  <var n="pronom"/>
		  <clip pos="4" side="tl" part="lem"/>
		  <clip pos="4" side="tl" part="a_prnpro"/>
		  <clip pos="4" side="tl" part="pers"/>
		  <clip pos="4" side="tl" part="gen"/>
		  <clip pos="4" side="tl" part="nbr"/>
		</lu>
		<b pos="1"/>
		<lu>
		  <clip pos="1" side="tl" part="lemh"/>
		  <clip pos="1" side="tl" part="a_verb"/>
		  <clip pos="1" side="tl" part="temps" link-to="3"/>
		  <lit-tag v="4"/>
		  <lit-tag v="5"/>
		  <clip pos="1" side="tl" part="lemq"/> 
		</lu>
		<b pos="2"/>
		<lu>
		  <clip pos="2" side="tl" part="lemh"/> 
		  <clip pos="2" side="tl" part="a_verb"/>
		  <lit-tag v="inf"/>			
		  <clip pos="2" side="tl" part="lemq"/>
		</lu>
		<b pos="3"/>
		<lu>
		  <clip pos="3" side="tl" part="lemh"/> 
		  <clip pos="3" side="tl" part="a_verb"/>
		  <lit-tag v="inf"/>
		  <clip pos="3" side="tl" part="lemq"/> 
		</lu>
	      </chunk>
	    </out>
	  </when>
	  <when>
	    <test>
	      <equal caseless="yes">
		<clip pos="1" side="sl" part="lem"/>
		<lit v="do"/>
	      </equal>
	    </test>
	    <choose>
	      <when>
		<test>
		  <or>
		    <equal>
		      <clip pos="1" side="sl" part="temps"/>
		      <lit-tag v="pres"/>
		    </equal>
		    <equal>
		      <clip pos="1" side="sl" part="temps"/>
		      <lit-tag v="pri"/>
		    </equal>
		  </or>
		</test>
		<choose>
		  <when>
		    <test>
		      <equal>
			<clip pos="1" side="sl" part="temps"/>
			<lit-tag v="pres"/>
		      </equal>
		    </test>
		    
		    <let>
		      <clip pos="2" side="tl" part="temps"/>
		      <lit-tag v="pri"/>
		    </let>
		    <let>
		      <var n="paraula2"/>
		      <clip pos="2" side="tl" part="lemh"/>
		    </let>
		    <append n="paraula2">
		      <clip pos="2" side="tl" part="tags"/>
		      <lit-tag v="PD"/>
		      <lit-tag v="ND"/>
		      <clip pos="2" side="tl" part="lemq"/>
		    </append>
		    <let>
		      <clip pos="2" side="tl" part="whole"/>
		      <var n="paraula2"/>
		    </let>
		  </when>
		  <when>
		    <test>
		      <equal>
			<clip pos="1" side="sl" part="temps"/>
			<lit-tag v="pri"/>
		      </equal>
		    </test>
		    <let>
		      <clip pos="2" side="tl" part="temps"/>
		      <lit-tag v="pri"/>
		    </let>
		    <let>
		      <var n="paraula2"/>
		      <clip pos="2" side="tl" part="lemh"/>
		    </let>
		    <append n="paraula2">
		      <clip pos="2" side="tl" part="tags"/>
		      <clip pos="1" side="sl" part="pers"/>
		      <clip pos="1" side="sl" part="nbr"/>
		      <clip pos="2" side="tl" part="lemq"/>
		    </append>
		    <let>
		      <clip pos="2" side="tl" part="whole"/>
		      <var n="paraula2"/>
		    </let>
		  </when>
		</choose>		    
		<out>
		  <chunk name="pro_mod_inf" case="caseFirstWord">
		    <tags>
		      <tag><lit-tag v="SV"/></tag>
		      <tag><var n="tipus_verb"/></tag>
		      <tag><clip pos="2" side="tl" part="temps"/></tag>
		      <tag><clip pos="2" side="tl" part="pers"/></tag>
		      <tag><clip pos="2" side="tl" part="nbr"/></tag>
		    </tags>      
		    <lu>
		      <var n="pronom"/>
		      <clip pos="4" side="tl" part="lem"/>
		      <clip pos="4" side="tl" part="a_prnpro"/>
		      <clip pos="4" side="tl" part="pers"/>
		      <clip pos="4" side="tl" part="gen"/>
		      <clip pos="4" side="tl" part="nbr"/>
		    </lu>
		    <b pos="1"/>
		    <lu>   
		      <clip pos="2" side="tl" part="lemh"/>
		      <clip pos="2" side="tl" part="a_verb"/>
		      <clip pos="2" side="tl" part="temps" link-to="3"/>
		      <clip pos="2" side="tl" part="pers" link-to="4"/>
		      <clip pos="2" side="tl" part="nbr" link-to="5"/>
		      <clip pos="2" side="tl" part="lemq"/>
		    </lu> 
		    <b pos="2"/>
		    <lu>
		      <clip pos="3" side="tl" part="lemh"/> 
		      <clip pos="3" side="tl" part="a_verb"/>
		      <lit-tag v="inf"/>
		      <clip pos="3" side="tl" part="lemq"/> 
		    </lu>
		  </chunk>
		</out>
		<call-macro n="f_bcond">
		  <with-param pos="3"/>
		</call-macro>
	      </when>
	      <when>
		<test>
		  <equal>
		    <clip pos="1" side="sl" part="temps"/>
		    <lit-tag v="past"/>
		  </equal> 
		</test>
		<out>
		  <chunk name="pro_mod_inf_perif" case="caseFirstWord">
		    <tags>
		      <tag><lit-tag v="SV"/></tag>
		      <tag><var n="tipus_verb"/></tag>
		      <tag><lit-tag v="ifip"/></tag>
		      <tag><lit-tag v="PD"/></tag>
		      <tag><lit-tag v="ND"/></tag>
		    </tags> 
		    <lu>
		      <var n="pronom"/>
		      <clip pos="4" side="tl" part="lem"/>
		      <clip pos="4" side="tl" part="a_prnpro"/>
		      <clip pos="4" side="tl" part="pers"/>
		      <clip pos="4" side="tl" part="gen"/>
		      <clip pos="4" side="tl" part="nbr"/>
		    </lu>
		    <b pos="1"/>
		    <lu>
		      <lit v="anar"/>
		      <lit-tag v="vaux"/>
		      <lit-tag v="4"/>
		      <lit-tag v="5"/>
		    </lu>
		    <b pos="2"/>
		    <lu>   
		      <clip pos="2" side="tl" part="lemh"/>
		      <clip pos="2" side="tl" part="a_verb"/>
		      <lit-tag v="inf"/>
		      <clip pos="2" side="tl" part="lemq"/>
		    </lu> 
		    <b pos="3"/>
		    <lu>
		      <clip pos="3" side="tl" part="lemh"/> 
		      <clip pos="3" side="tl" part="a_verb"/>
		      <lit-tag v="inf"/>
		      <clip pos="3" side="tl" part="lemq"/> 
		    </lu>
		  </chunk>
		</out>
	      </when>
	    </choose>
	  </when>
	</choose>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>
    
    <rule comment="REGLA: AUX + MODAL conjugable + VERB (I will have to - hauré de)">
      
      <pattern>
	<pattern-item n="auxnocan"/>
	<pattern-item n="modinf"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>	 
	<choose>
	  <when>
	    <test>
	      <or>
		<equal caseless="yes">
		  <clip pos="1" side="sl" part="lem"/>
		  <lit v="will"/>
		</equal>
		<equal caseless="yes">
		  <clip pos="1" side="sl" part="lem"/>
		  <lit v="shall"/>
		</equal>
		<equal caseless="yes">
		  <clip pos="1" side="sl" part="lem"/>
		  <lit v="would"/>
		</equal>
	      </or>
	    </test>
	    <choose>		
	      <when>
		<test>
		  <or>
		    <equal caseless="yes">
		      <clip pos="1" side="sl" part="lem"/>
		      <lit v="will"/>
		    </equal>
		    <equal caseless="yes">
		      <clip pos="1" side="sl" part="lem"/>
		      <lit v="shall"/>
		    </equal>
		  </or>
		</test>
		<let>
		  <clip pos="2" side="tl" part="temps"/>
		  <lit-tag v="fti"/>
		</let>
	      </when>
	      <when>
		<test>
		  <equal caseless="yes">
		    <clip pos="1" side="sl" part="lem"/>
		    <lit v="would"/>
		  </equal>
		</test>
		<let>
		  <clip pos="2" side="tl" part="temps"/>
		  <lit-tag v="cni"/>
		</let>
	      </when>		
	    </choose>
	    <out>
	      <chunk name="mod" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="SV"/></tag>
		  <tag><clip pos="2" side="tl" part="a_verb"/></tag>
		  <tag><clip pos="2" side="tl" part="temps"/></tag>
		  <tag><lit-tag v="PD"/></tag>
		  <tag><lit-tag v="ND"/></tag>
		</tags>      
		<lu>   
		  <clip pos="2" side="tl" part="lemh"/>
		  <clip pos="2" side="tl" part="a_verb"/>
		  <clip pos="2" side="tl" part="temps" link-to="3"/>
		  <lit-tag v="4"/>
		  <lit-tag v="5"/>
		  <clip pos="2" side="tl" part="lemq"/>
		</lu>
	      </chunk>
	    </out>
	    <call-macro n="f_bcond">
	      <with-param pos="1"/>
	    </call-macro>
	  </when>
	  <when>
	    <test>
	      <or>
		<equal caseless="yes">
		  <clip pos="1" side="sl" part="lem"/>
		  <lit v="may"/>
		</equal>
		<equal caseless="yes">
		  <clip pos="1" side="sl" part="lem"/>
		  <lit v="might"/>
		</equal>
	      </or>
	    </test>
	    <choose>
	      <when>
		<test>
		  <equal caseless="yes">
		    <clip pos="1" side="sl" part="lem"/>
		    <lit v="may"/>
		  </equal>
		</test>
		<let>
		  <clip pos="1" side="tl" part="temps"/>
		  <lit-tag v="pri"/>
		</let>
	      </when>
	      <when>
		<test>
		  <equal caseless="yes">
		    <clip pos="1" side="sl" part="lem"/>
		    <lit v="might"/>
		  </equal>
		</test>
		<let>
		  <clip pos="1" side="tl" part="temps"/>
		  <lit-tag v="cni"/>
		</let>
	      </when>
	    </choose>  
	    <out>
	      <chunk name="aux_mod" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="SV"/></tag>
		  <tag><clip pos="1" side="tl" part="a_verb"/></tag>
		  <tag><clip pos="1" side="tl" part="temps"/></tag>
		  <tag><lit-tag v="PD"/></tag>
		  <tag><lit-tag v="ND"/></tag>
		</tags>      
		<lu>
		  <clip pos="1" side="tl" part="lemh"/>
		  <clip pos="1" side="tl" part="a_verb"/>
		  <clip pos="1" side="tl" part="temps" link-to="3"/>
		  <lit-tag v="4"/>
		  <lit-tag v="5"/>
		  <clip pos="1" side="tl" part="lemq"/> 
		</lu>
		<b pos="1"/>
		<lu>
		  <clip pos="2" side="tl" part="lemh"/> 
		  <clip pos="2" side="tl" part="a_verb"/>
		  <lit-tag v="inf"/>			
		  <clip pos="2" side="tl" part="lemq"/>
		</lu>
	      </chunk>
	    </out>
	  </when>
	  <when>
	    <test>
	      <equal caseless="yes">
		<clip pos="1" side="sl" part="lem"/>
		<lit v="do"/>
	      </equal>
	    </test>
	    <choose>
	      <when>
		<test>
		  <or>
		    <equal>
		      <clip pos="1" side="sl" part="temps"/>
		      <lit-tag v="pres"/>
		    </equal>
		    <equal>
		      <clip pos="1" side="sl" part="temps"/>
		      <lit-tag v="pri"/>
		    </equal>
		  </or>
		</test>
		<choose>
		  <when>
		    <test>
		      <equal>
			<clip pos="1" side="sl" part="temps"/>
			<lit-tag v="pres"/>
		      </equal>
		    </test>
		    
		    <let>
		      <clip pos="2" side="tl" part="temps"/>
		      <lit-tag v="pri"/>
		    </let>
		    <let>
		      <var n="paraula2"/>
		      <clip pos="2" side="tl" part="lemh"/>
		    </let>
		    <append n="paraula2">
		      <clip pos="2" side="tl" part="tags"/>
		      <lit-tag v="PD"/>
		      <lit-tag v="ND"/>
		      <clip pos="2" side="tl" part="lemq"/>
		    </append>
		    <let>
		      <clip pos="2" side="tl" part="whole"/>
		      <var n="paraula2"/>
		    </let>
		  </when>
		  <when>
		    <test>
		      <equal>
			<clip pos="1" side="sl" part="temps"/>
			<lit-tag v="pri"/>
		      </equal>
		    </test>
		    <let>
		      <clip pos="2" side="tl" part="temps"/>
		      <lit-tag v="pri"/>
		    </let>
		    <let>
		      <var n="paraula2"/>
		      <clip pos="2" side="tl" part="lemh"/>
		    </let>
		    <append n="paraula2">
		      <clip pos="2" side="tl" part="tags"/>
		      <clip pos="1" side="sl" part="pers"/>
		      <clip pos="1" side="sl" part="nbr"/>
		      <clip pos="2" side="tl" part="lemq"/>
		    </append>
		    <let>
		      <clip pos="2" side="tl" part="whole"/>
		      <var n="paraula2"/>
		    </let>
		  </when>
		</choose>		    
		<out>
		  <chunk name="mod" case="caseFirstWord">
		    <tags>
		      <tag><lit-tag v="SV"/></tag>
		      <tag><clip pos="2" side="tl" part="a_verb"/></tag>
		      <tag><clip pos="2" side="tl" part="temps"/></tag>
		      <tag><clip pos="2" side="tl" part="pers"/></tag>
		      <tag><clip pos="2" side="tl" part="nbr"/></tag>
		    </tags>      
		    <lu>   
		      <clip pos="2" side="tl" part="lemh"/>
		      <clip pos="2" side="tl" part="a_verb"/>
		      <clip pos="2" side="tl" part="temps" link-to="3"/>
		      <clip pos="2" side="tl" part="pers" link-to="4"/>
		      <clip pos="2" side="tl" part="nbr" link-to="5"/>
		      <clip pos="2" side="tl" part="lemq"/>
		    </lu> 
		  </chunk>
		</out>
		<call-macro n="f_bcond">
		  <with-param pos="1"/>
		</call-macro>
	      </when>
	      <when>
		<test>
		  <equal>
		    <clip pos="1" side="sl" part="temps"/>
		    <lit-tag v="past"/>
		  </equal> 
		</test>
		<out>
		  <chunk name="mod_perif" case="caseFirstWord">
		    <tags>
		      <tag><lit-tag v="SV"/></tag>
		      <tag><clip pos="2" side="tl" part="a_verb"/></tag>
		      <tag><lit-tag v="ifip"/></tag>
		      <tag><lit-tag v="PD"/></tag>
		      <tag><lit-tag v="ND"/></tag>
		    </tags> 
		    <lu>
		      <lit v="anar"/>
		      <lit-tag v="vaux"/>
		      <lit-tag v="4"/>
		      <lit-tag v="5"/>
		    </lu>
		    <b pos="1"/>
		    <lu>   
		      <clip pos="2" side="tl" part="lemh"/>
		      <clip pos="2" side="tl" part="a_verb"/>
		      <lit-tag v="inf"/>
		      <clip pos="2" side="tl" part="lemq"/>
		    </lu> 
		  </chunk>
		</out>
	      </when>
	    </choose>
	  </when>
	</choose>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>



    <rule comment="HAVER PARTICIPI (have finished - han acabat)">
      <pattern>
	<pattern-item n="have_aux"/>
	<pattern-item n="pp"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>	
	<call-macro n="tipus_verbs">
	  <with-param pos="2"/>
	</call-macro>
	<call-macro n="pron">
	  <with-param pos="2"/>
	</call-macro>	
	<choose>
	  <when>
	    <test>
	      <or>
		<equal><!--De moment no sé si el tagger escull bé i els detecto els dos -->
		  <clip pos="1" side="sl" part="temps"/>
		  <lit-tag v="inf"/>
		</equal>
		<equal>
		  <clip pos="1" side="sl" part="temps"/>
		  <lit-tag v="pres"/>
		</equal>
	      </or>
	    </test>
	    <let>
	      <clip pos="1" side="tl" part="temps"/>
	      <lit-tag v="pri"/>
	    </let>
	  </when>
	  <when>
	    <test>
	      <equal>
		<clip pos="1" side="sl" part="temps"/>
		<lit-tag v="past"/>
	      </equal>
	    </test>
	    <let>
	      <clip pos="1" side="tl" part="temps"/>
	      <lit-tag v="pii"/>
	    </let>
	  </when>
	</choose>
	<choose>
	  <when>
	    <test>
	      <not>
		<and>
		  <equal>		 
		    <clip pos="1" side="tl" part="pers"/>
		    <lit-tag v="p3"/>
		  </equal>
		  <equal>		 
		    <clip pos="1" side="tl" part="nbr"/>
		    <lit-tag v="sg"/>
		  </equal>
		</and>
	      </not>
	    </test>
	    <let>
	      <var n="paraula1"/>
	      <clip pos="1" side="tl" part="lemh"/>
	    </let>
	    <append n="paraula1">
	      <clip pos="1" side="tl" part="tags"/>
	      <lit-tag v="PD"/>
	      <lit-tag v="ND"/>
	      <clip pos="1" side="tl" part="lemq"/>
	    </append>
	    <let>
	      <clip pos="1" side="tl" part="whole"/>
	      <var n="paraula1"/>
	    </let>
	  </when>
	</choose>
	<choose>
	  <when>
	    <test><!--MG: quan és gerundi, dintre del verb no hi ha pers i nbr, però en el chunk sí que hi ha PD i ND, per si en el
t2x es fa alguna operació que li assigna pers i nbr (en aquest cas caldrà que en el t3x es passin a dins, al verb, ja que no hi ha enllaç) -->
	      <equal>
		<clip pos="1" side="sl" part="temps"/>
		<lit-tag v="ger"/>
	      </equal>
	    </test>
	    <out>
	      <chunk name="have_pp" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="SV"/></tag>
		  <tag><var n="tipus_verb"/></tag>
		  <tag><clip pos="1" side="tl" part="temps"/></tag>
		  <tag><clip pos="1" side="tl" part="pers"/></tag>
		  <tag><clip pos="1" side="tl" part="nbr"/></tag>
		</tags> 
		<lu>   
		  <var n="pronom"/> 
		  <clip pos="1" side="tl" part="lemh"/>
		  <clip pos="1" side="tl" part="a_verb"/>
		  <clip pos="1" side="tl" part="temps" link-to="3"/>
		  <clip pos="1" side="tl" part="lemq"/> 
		</lu> 
		<b pos="1"/>
		<lu>
		  <clip pos="2" side="tl" part="lemh"/> 
		  <clip pos="2" side="tl" part="a_pp"/>
		  <lit-tag v="m.sg"/>
		  <clip pos="2" side="tl" part="lemq"/> 
		</lu>
	      </chunk>
	    </out>
	  </when>
	  <otherwise>
	    <out>
	      <chunk name="have_pp" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="SV"/></tag>
		  <tag><var n="tipus_verb"/></tag>
		  <tag><clip pos="1" side="tl" part="temps"/></tag>
		  <tag><clip pos="1" side="tl" part="pers"/></tag>
		  <tag><clip pos="1" side="tl" part="nbr"/></tag>
		</tags> 
		<lu>   
		  <var n="pronom"/> 
		  <clip pos="1" side="tl" part="lemh"/>
		  <clip pos="1" side="tl" part="a_verb"/>
		  <clip pos="1" side="tl" part="temps" link-to="3"/>
		  <clip pos="1" side="tl" part="pers" link-to="4"/>
		  <clip pos="1" side="tl" part="nbr" link-to="5"/>
		  <clip pos="1" side="tl" part="lemq"/> 
		</lu> 
		<b pos="1"/>
		<lu>
		  <clip pos="2" side="tl" part="lemh"/> 
		  <clip pos="2" side="tl" part="a_pp"/>
		  <lit-tag v="m.sg"/>
		  <clip pos="2" side="tl" part="lemq"/> 
		</lu>
	      </chunk>
	    </out>
	  </otherwise>
	</choose>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>

    <rule comment="HAVER PARTICIPI clític (have finished it - l'han acabat)">
      <pattern>
	<pattern-item n="have_aux"/>
	<pattern-item n="pp"/>
	<pattern-item n="probj"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>	
	<call-macro n="tipus_verbs">
	  <with-param pos="2"/>
	</call-macro>
	<call-macro n="pron">
	  <with-param pos="2"/>
	</call-macro>
	
	<choose>
	  <when>
	    <test>
	      <or>
		<equal><!--De moment no sé si el tagger escull bé i els detecto els dos -->
		  <clip pos="1" side="sl" part="temps"/>
		  <lit-tag v="inf"/>
		</equal>
		<equal>
		  <clip pos="1" side="sl" part="temps"/>
		  <lit-tag v="pres"/>
		</equal>
	      </or>
	    </test>
	    <let>
	      <clip pos="1" side="tl" part="temps"/>
	      <lit-tag v="pri"/>
	    </let>
	  </when>
	  <when>
	    <test>
	      <equal>
		<clip pos="1" side="sl" part="temps"/>
		<lit-tag v="past"/>
	      </equal>
	    </test>
	    <let>
	      <clip pos="1" side="tl" part="temps"/>
	      <lit-tag v="pii"/>
	    </let>
	  </when>
	</choose>
	<choose>
	  <when>
	    <test>
	      <not>
		<and>
		  <equal>		 
		    <clip pos="1" side="tl" part="pers"/>
		    <lit-tag v="p3"/>
		  </equal>
		  <equal>		 
		    <clip pos="1" side="tl" part="nbr"/>
		    <lit-tag v="sg"/>
		  </equal>
		</and>
	      </not>
	    </test>
	    <let>
	      <var n="paraula1"/>
	      <clip pos="1" side="tl" part="lemh"/>
	    </let>
	    <append n="paraula1">
	      <clip pos="1" side="tl" part="tags"/>
	      <lit-tag v="PD"/>
	      <lit-tag v="ND"/>
	      <clip pos="1" side="tl" part="lemq"/>
	    </append>
	    <let>
	      <clip pos="1" side="tl" part="whole"/>
	      <var n="paraula1"/>
	    </let>
	  </when>
	</choose>
	<choose>
	  <when>
	    <test><!--MG: quan és gerundi, dintre del verb no hi ha pers i nbr, però en el chunk sí que hi ha PD i ND, per si en el
		      t2x es fa alguna operació que li assigna pers i nbr (en aquest cas caldrà que en el t3x es passin a dins, al verb, ja que no hi ha enllaç) -->
	      <equal>
		<clip pos="1" side="sl" part="temps"/>
		<lit-tag v="ger"/>
	      </equal>
	    </test>
	    <out>
	      <chunk name="pro_have_pp" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="SV"/></tag>
		  <tag><var n="tipus_verb"/></tag>
		  <tag><clip pos="1" side="tl" part="temps"/></tag>
		  <tag><clip pos="1" side="tl" part="pers"/></tag>
		  <tag><clip pos="1" side="tl" part="nbr"/></tag>
		</tags> 
		<lu>
		  <var n="pronom"/>
		  <clip pos="3" side="tl" part="lem"/>
		  <clip pos="3" side="tl" part="a_prnpro"/>
		  <clip pos="3" side="tl" part="pers"/>
		  <clip pos="3" side="tl" part="gen"/>
		  <clip pos="3" side="tl" part="nbr"/>
		</lu>
		<b pos="1"/>
		<lu>   
		  <clip pos="1" side="tl" part="lemh"/>
		  <clip pos="1" side="tl" part="a_verb"/>
		  <clip pos="1" side="tl" part="temps" link-to="3"/>
		  <clip pos="1" side="tl" part="lemq"/> 
		</lu> 
		<b pos="2"/>
		<lu>
		  <clip pos="2" side="tl" part="lemh"/> 
		  <clip pos="2" side="tl" part="a_pp"/>
		  <lit-tag v="m.sg"/>
		  <clip pos="2" side="tl" part="lemq"/> 
		</lu>
	      </chunk>
	    </out>
	  </when>
	  <otherwise>
	    <out>
	      <chunk name="pro_have_pp" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="SV"/></tag>
		  <tag><var n="tipus_verb"/></tag>
		  <tag><clip pos="1" side="tl" part="temps"/></tag>
		  <tag><clip pos="1" side="tl" part="pers"/></tag>
		  <tag><clip pos="1" side="tl" part="nbr"/></tag>
		</tags> 
		<lu>
		  <var n="pronom"/>
		  <clip pos="3" side="tl" part="lem"/>
		  <clip pos="3" side="tl" part="a_prnpro"/>
		  <clip pos="3" side="tl" part="pers"/>
		  <clip pos="3" side="tl" part="gen"/>
		  <clip pos="3" side="tl" part="nbr"/>
		</lu>
		<b pos="1"/>
		<lu>   
		  <clip pos="1" side="tl" part="lemh"/>
		  <clip pos="1" side="tl" part="a_verb"/>
		  <clip pos="1" side="tl" part="temps" link-to="3"/>
		  <clip pos="1" side="tl" part="pers" link-to="4"/>
		  <clip pos="1" side="tl" part="nbr" link-to="5"/>
		  <clip pos="1" side="tl" part="lemq"/> 
		</lu> 
		<b pos="2"/>
		<lu>
		  <clip pos="2" side="tl" part="lemh"/> 
		  <clip pos="2" side="tl" part="a_pp"/>
		  <lit-tag v="m.sg"/>
		  <clip pos="2" side="tl" part="lemq"/> 
		</lu>
	      </chunk>
	    </out>
	  </otherwise>
	</choose>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>


    <rule comment="HAVER PARTICIPIcontrolverb TO INF (BCN)">
      <pattern>
	<pattern-item n="have_aux"/>
	<pattern-item n="controlverbpp"/>
        <pattern-item n="to"/>
        <pattern-item n="inf"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>	
	<call-macro n="tipus_verbs">
	  <with-param pos="2"/>
	</call-macro>
	<call-macro n="tipus_verbs2">
	  <with-param pos="4"/>
	</call-macro>
	<call-macro n="pronenc">
	  <with-param pos="4"/>
	</call-macro>	
	<choose>
	  <when>
	    <test>
	      <equal>
		  <clip pos="2" side="sl" part="lem"/>
		  <lit v="try"/>
	      </equal>
	    </test>
	    <let>
	      <clip pos="2" side="tl" part="lem"/>
	      <lit v="intentar"/>
	    </let>
	  </when>
	</choose>
	<choose>
	  <when>
	    <test>
	      <or>
		<equal><!--De moment no sé si el tagger escull bé i els detecto els dos -->
		  <clip pos="1" side="sl" part="temps"/>
		  <lit-tag v="inf"/>
		</equal>
		<equal>
		  <clip pos="1" side="sl" part="temps"/>
		  <lit-tag v="pres"/>
		</equal>
	      </or>
	    </test>
	    <let>
	      <clip pos="1" side="tl" part="temps"/>
	      <lit-tag v="pri"/>
	    </let>
	  </when>
	  <when>
	    <test>
	      <equal>
		<clip pos="1" side="sl" part="temps"/>
		<lit-tag v="past"/>
	      </equal>
	    </test>
	    <let>
	      <clip pos="1" side="tl" part="temps"/>
	      <lit-tag v="pii"/>
	    </let>
	  </when>
	</choose>
	<choose>
	  <when>
	    <test>
	      <not>
		<and>
		  <equal>		 
		    <clip pos="1" side="tl" part="pers"/>
		    <lit-tag v="p3"/>
		  </equal>
		  <equal>		 
		    <clip pos="1" side="tl" part="nbr"/>
		    <lit-tag v="sg"/>
		  </equal>
		</and>
	      </not>
	    </test>
	    <let>
	      <var n="paraula1"/>
	      <clip pos="1" side="tl" part="lemh"/>
	    </let>
	    <append n="paraula1">
	      <clip pos="1" side="tl" part="tags"/>
	      <lit-tag v="PD"/>
	      <lit-tag v="ND"/>
	      <clip pos="1" side="tl" part="lemq"/>
	    </append>
	    <let>
	      <clip pos="1" side="tl" part="whole"/>
	      <var n="paraula1"/>
	    </let>
	  </when>
	</choose>
	<out>
	  <chunk name="have_pp_inf" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SV"/></tag>
	      <tag><var n="tipus_verb"/></tag>
	      <tag><clip pos="1" side="tl" part="temps"/></tag>
	      <tag><clip pos="1" side="tl" part="pers"/></tag>
	      <tag><clip pos="1" side="tl" part="nbr"/></tag>
	    </tags> 
	    <lu>   
	      <var n="pronom"/> 
	      <clip pos="1" side="tl" part="lemh"/>
	      <clip pos="1" side="tl" part="a_verb"/>
	      <clip pos="1" side="tl" part="temps" link-to="3"/>
	      <clip pos="1" side="tl" part="pers" link-to="4"/>
	      <clip pos="1" side="tl" part="nbr" link-to="5"/>
	      <clip pos="1" side="tl" part="lemq"/> 
	    </lu> 
	    <b pos="1"/>
	    <lu>
	      <clip pos="2" side="tl" part="lemh"/> 
	      <clip pos="2" side="tl" part="a_pp"/>
	      <lit-tag v="m.sg"/>
	      <clip pos="2" side="tl" part="lemq"/> 
	    </lu>
	    <b pos="2"/>
	    <lu>
	      <clip pos="4" side="tl" part="lemh"/>
	      <clip pos="4" side="tl" part="a_verb"/>
	      <lit-tag v="inf"/>
	      <var n="pronomenc"/>
	      <clip pos="4" side="tl" part="lemq"/>
	    </lu>
	  </chunk>
	</out>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>


    <rule comment="REGLA: VERBcontrol + to + INF (BCN 'try/need/... to do this -> intentar/necessitar/ fer'">
      <pattern>
	<pattern-item n="controlverb"/>
	<pattern-item n="to"/>
	<pattern-item n="inf"/>
      </pattern>
      <action>   
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="tipus_verbs">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="pron">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="tipus_verbs2">
	  <with-param pos="3"/>
	</call-macro>
	<call-macro n="pronenc">
	  <with-param pos="3"/>
	</call-macro>	
	<choose>
	  <when>
	    <test>
	      <equal>
		  <clip pos="1" side="sl" part="lem"/>
		  <lit v="try"/>
	      </equal>
	    </test>
	    <let>
	      <clip pos="1" side="tl" part="lem"/>
	      <lit v="intentar"/>
	    </let>
	  </when>
	</choose>		
	<choose>      
	  <when>
	    <test>
	      <and>
		<equal>
		  <clip pos="1" side="sl" part="temps"/>
		  <lit-tag v="past"/>
		</equal>
		<equal>
		  <clip pos="1" side="sl" part="pers"/>
		  <lit v=""/>
		</equal>
		<equal>
		  <clip pos="1" side="sl" part="nbr"/>
		  <lit v=""/>
		</equal>
	      </and>
	    </test>
	    <out>
	      <chunk name="verbcj_inf_perif" case="caseFirstWord">
		<tags>	       
		  <tag><lit-tag v="SV"/></tag>
		  <tag><var n="tipus_verb"/></tag>
		  <tag><lit-tag v="ifip"/></tag>
		  <tag><lit-tag v="PD"/></tag>
		  <tag><lit-tag v="ND"/></tag>
		</tags> 		
		<lu>
		  <var n="pronom"/>
		  <lit v="anar"/>
		  <lit-tag v="vaux"/>
		  <lit-tag v="4"/>
		  <lit-tag v="5"/>
		</lu>
		<b/>
		<lu>
		  <clip pos="1" side="tl" part="lemh"/>
		  <clip pos="1" side="tl" part="a_verb"/>
		  <lit-tag v="inf"/>
		  <clip pos="1" side="tl" part="lemq"/>
		</lu>
		<b pos="1"/>
		<lu>
		  <clip pos="3" side="tl" part="lemh"/>
		  <clip pos="3" side="tl" part="a_verb"/>
		  <lit-tag v="inf"/>
		  <var n="pronomenc"/>
		  <clip pos="3" side="tl" part="lemq"/>
		</lu>
	      </chunk>
	    </out>
	  </when>
	  <when>
	    <test>
	      <equal><!--és el cas de 'was' i algun altre, que tenen pers i nbr -->
		<clip pos="1" side="sl" part="temps"/>
		<lit-tag v="past"/>
	      </equal>
	    </test>
	    <out>
	      <chunk name="verbcj_inf_perif" case="caseFirstWord">
		<tags>	       
		  <tag><lit-tag v="SV"/></tag>
		  <tag><var n="tipus_verb"/></tag>
		  <tag><lit-tag v="ifip"/></tag>
		  <tag><clip pos="1" side="tl" part="pers"/></tag>
		  <tag><clip pos="1" side="tl" part="nbr"/></tag>
		</tags> 
		<lu>
		  <var n="pronom"/>
		  <lit v="anar"/>
		  <lit-tag v="vaux"/>
		  <clip pos="1" side="tl" part="pers" link-to="4"/>
		  <clip pos="1" side="tl" part="nbr" link-to="5"/>
		</lu>
		<b/>
		<lu>
		  <clip pos="1" side="tl" part="lemh"/>
		  <clip pos="1" side="tl" part="a_verb"/>
		  <lit-tag v="inf"/>
		  <clip pos="1" side="tl" part="lemq"/>
		</lu>
		<b pos="1"/>
		<lu>
		  <clip pos="3" side="tl" part="lemh"/>
		  <clip pos="3" side="tl" part="a_verb"/>
		  <lit-tag v="inf"/>
		  <var n="pronomenc"/>
		  <clip pos="3" side="tl" part="lemq"/>
		</lu>
	      </chunk>
	    </out>
	  </when>	  
	  <when>	
	    <test>
	      <equal>
		<clip pos="1" side="sl" part="temps"/>
		<lit-tag v="pres"/>
	      </equal>
	    </test>
	    <let>
	      <clip pos="1" side="tl" part="temps"/>
	      <lit-tag v="pri"/>
	    </let>
	    <out>
	      <chunk name="verbcj_inf" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="SV"/></tag>
		  <tag><var n="tipus_verb"/></tag>
		  <tag><clip pos="1" side="tl" part="temps"/></tag>
		  <tag><lit-tag v="PD"/></tag>
		  <tag><lit-tag v="ND"/></tag>
		</tags>      
		<lu>   
		  <var n="pronom"/>
		  <clip pos="1" side="tl" part="lemh"/>
		  <clip pos="1" side="tl" part="a_verb"/>
		  <clip pos="1" side="tl" part="temps" link-to="3"/>
		  <lit-tag v="4"/>
		  <lit-tag v="5"/>
		  <clip pos="1" side="tl" part="lemq"/>
		</lu> 
		<b pos="1"/>
		<lu>
		  <clip pos="3" side="tl" part="lemh"/>
		  <clip pos="3" side="tl" part="a_verb"/>
		  <lit-tag v="inf"/>
		  <var n="pronomenc"/>
		  <clip pos="3" side="tl" part="lemq"/>
		</lu>
	      </chunk>
	    </out>
	  </when>
	  
	  <when>	
	    <test>
	      <equal>
		<clip pos="1" side="sl" part="temps"/>
		<lit-tag v="pri"/>
	      </equal>
	    </test>
	    <out>
	      <chunk name="verbcj_inf" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="SV"/></tag>
		  <tag><var n="tipus_verb"/></tag>
		  <tag><clip pos="1" side="tl" part="temps"/></tag>
		  <tag><clip pos="1" side="tl" part="pers"/></tag>
		  <tag><clip pos="1" side="tl" part="nbr"/></tag>
		</tags>      
		<lu>   
		  <var n="pronom"/>
		  <clip pos="1" side="tl" part="lemh"/>
		  <clip pos="1" side="tl" part="a_verb"/>
		  <clip pos="1" side="tl" part="temps" link-to="3"/>
		  <clip pos="1" side="tl" part="pers" link-to="4"/>
		  <clip pos="1" side="tl" part="nbr" link-to="5"/>
		  <clip pos="1" side="tl" part="lemq"/>
		</lu> 
		<b pos="1"/>
		<lu>
		  <clip pos="3" side="tl" part="lemh"/>
		  <clip pos="3" side="tl" part="a_verb"/>
		  <lit-tag v="inf"/>
		  <var n="pronomenc"/>
		  <clip pos="3" side="tl" part="lemq"/>
		</lu>
	      </chunk>
	    </out>
	  </when>
	  <when>
            <test>
              <equal>
                <clip pos="1" side="sl" part="temps"/>
                <lit-tag v="ger"/>
              </equal>
            </test>
	    <out>
	      <chunk name="verbcj_inf" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="SV"/></tag>
		  <tag><var n="tipus_verb"/></tag>
		  <tag><clip pos="1" side="tl" part="temps"/></tag>
		  <tag><lit-tag v="PD"/></tag> <!-- BCN pingui -->
		  <tag><lit-tag v="ND"/></tag> <!-- BCN -->
		</tags>  	
		<lu>	
		  <clip pos="1" side="tl" part="lemh"/> 
		  <clip pos="1" side="tl" part="a_verb"/>
		  <clip pos="1" side="tl" part="temps" link-to="3"/>
		  <clip pos="1" side="tl" part="lemq"/>
		</lu>
		<b pos="1"/>
		<lu>
                  <clip pos="3" side="tl" part="lemh"/>
                  <clip pos="3" side="tl" part="a_verb"/>
                  <lit-tag v="inf"/>
		  <var n="pronomenc"/>
                  <clip pos="3" side="tl" part="lemq"/>
		</lu>
	      </chunk>
	    </out>
	</when>
	  <otherwise><!--només queda si és 'inf' -->
	    <out>
	      <chunk name="inf_inf">
		<tags>	       
		  <tag><lit-tag v="SV"/></tag>
		  <tag><var n="tipus_verb"/></tag>
		  <tag><clip pos="1" side="tl" part="temps"/></tag>
		  <tag><lit-tag v="PD"/></tag>
		  <tag><lit-tag v="ND"/></tag>
		</tags>      
		<lu>   
		  <var n="pronom"/>
		  <clip pos="1" side="tl" part="lemh"/>
		  <clip pos="1" side="tl" part="a_verb"/>
		  <clip pos="1" side="tl" part="temps" link-to="3"/>
		  <clip pos="1" side="tl" part="lemq"/>
		</lu> 
		<b pos="1"/>
		<lu>
		  <clip pos="3" side="tl" part="lemh"/>
		  <clip pos="3" side="tl" part="a_verb"/>
		  <lit-tag v="inf"/>
		  <var n="pronomenc"/> 
		  <clip pos="3" side="tl" part="lemq"/>
		</lu>
	      </chunk>
	    </out>
	  </otherwise>
	</choose>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>

<!-- <rule comment="REGLA: VERBcontrol + to + INF (BCN 'try/need/... to do this -> intentar/necessitar/ fer. MG: PENDENT, no m'aclareixo amb els pronoms i els pronominals'">
      <pattern>
	<pattern-item n="controlverb"/>
	<pattern-item n="to"/>
	<pattern-item n="inf"/>
	<pattern-item n="probj"/>
      </pattern>
      <action>   
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="tipus_verbs">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="pron">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="tipus_verbs2">
	  <with-param pos="3"/>
	</call-macro>
	<call-macro n="pronenc">
	  <with-param pos="3"/>
	</call-macro>	
	<choose>      
	  <when>
	    <test>
	      <and>
		<equal>
		  <clip pos="1" side="sl" part="temps"/>
		  <lit-tag v="past"/>
		</equal>
		<equal>
		  <clip pos="1" side="sl" part="pers"/>
		  <lit v=""/>
		</equal>
		<equal>
		  <clip pos="1" side="sl" part="nbr"/>
		  <lit v=""/>
		</equal>
	      </and>
	    </test>
	    <out>
	      <chunk name="verbcj_inf_perif" case="caseFirstWord">
		<tags>	       
		  <tag><lit-tag v="SV"/></tag>
		  <tag><var n="tipus_verb"/></tag>
		  <tag><lit-tag v="ifip"/></tag>
		  <tag><lit-tag v="PD"/></tag>
		  <tag><lit-tag v="ND"/></tag>
		</tags> 		
		<lu>
		  <var n="pronom"/>
		  <lit v="anar"/>
		  <lit-tag v="vaux"/>
		  <lit-tag v="4"/>
		  <lit-tag v="5"/>
		</lu>
		<b/>
		<lu>
		  <clip pos="1" side="tl" part="lemh"/>
		  <clip pos="1" side="tl" part="a_verb"/>
		  <lit-tag v="inf"/>
		  <clip pos="1" side="tl" part="lemq"/>
		</lu>
		<b pos="1"/>
		<lu>
		  <clip pos="3" side="tl" part="lemh"/>
		  <clip pos="3" side="tl" part="a_verb"/>
		  <lit-tag v="inf"/>
		  <var n="pronomenc"/>
		  <clip pos="3" side="tl" part="lemq"/>
		</lu>
	      </chunk>
	    </out>
	  </when>
	  <when>
	    <test>
	      <equal><!-x-és el cas de 'was' i algun altre, que tenen pers i nbr -x->
		<clip pos="1" side="sl" part="temps"/>
		<lit-tag v="past"/>
	      </equal>
	    </test>
	    <out>
	      <chunk name="verbcj_inf_perif" case="caseFirstWord">
		<tags>	       
		  <tag><lit-tag v="SV"/></tag>
		  <tag><var n="tipus_verb"/></tag>
		  <tag><lit-tag v="ifip"/></tag>
		  <tag><clip pos="1" side="tl" part="pers"/></tag>
		  <tag><clip pos="1" side="tl" part="nbr"/></tag>
		</tags> 
		<lu>
		  <var n="pronom"/>
		  <lit v="anar"/>
		  <lit-tag v="vaux"/>
		  <clip pos="1" side="tl" part="pers" link-to="4"/>
		  <clip pos="1" side="tl" part="nbr" link-to="5"/>
		</lu>
		<b/>
		<lu>
		  <clip pos="1" side="tl" part="lemh"/>
		  <clip pos="1" side="tl" part="a_verb"/>
		  <lit-tag v="inf"/>
		  <clip pos="1" side="tl" part="lemq"/>
		</lu>
		<b pos="1"/>
		<lu>
		  <clip pos="3" side="tl" part="lemh"/>
		  <clip pos="3" side="tl" part="a_verb"/>
		  <lit-tag v="inf"/>
		  <var n="pronomenc"/>
		  <clip pos="3" side="tl" part="lemq"/>
		</lu>
	      </chunk>
	    </out>
	  </when>	  
	  <when>	
	    <test>
	      <equal>
		<clip pos="1" side="sl" part="temps"/>
		<lit-tag v="pres"/>
	      </equal>
	    </test>
	    <let>
	      <clip pos="1" side="tl" part="temps"/>
	      <lit-tag v="pri"/>
	    </let>
	    <out>
	      <chunk name="verbcj_inf" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="SV"/></tag>
		  <tag><var n="tipus_verb"/></tag>
		  <tag><clip pos="1" side="tl" part="temps"/></tag>
		  <tag><lit-tag v="PD"/></tag>
		  <tag><lit-tag v="ND"/></tag>
		</tags>      
		<lu>   
		  <var n="pronom"/>
		  <clip pos="1" side="tl" part="lemh"/>
		  <clip pos="1" side="tl" part="a_verb"/>
		  <clip pos="1" side="tl" part="temps" link-to="3"/>
		  <lit-tag v="4"/>
		  <lit-tag v="5"/>
		  <clip pos="1" side="tl" part="lemq"/>
		</lu> 
		<b pos="1"/>
		<lu>
		  <clip pos="3" side="tl" part="lemh"/>
		  <clip pos="3" side="tl" part="a_verb"/>
		  <lit-tag v="inf"/>
		  <var n="pronomenc"/>
		  <clip pos="3" side="tl" part="lemq"/>
		</lu>
	      </chunk>
	    </out>
	  </when>
	  
	  <when>	
	    <test>
	      <equal>
		<clip pos="1" side="sl" part="temps"/>
		<lit-tag v="pri"/>
	      </equal>
	    </test>
	    <out>
	      <chunk name="verbcj_inf" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="SV"/></tag>
		  <tag><var n="tipus_verb"/></tag>
		  <tag><clip pos="1" side="tl" part="temps"/></tag>
		  <tag><clip pos="1" side="tl" part="pers"/></tag>
		  <tag><clip pos="1" side="tl" part="nbr"/></tag>
		</tags>      
		<lu>   
		  <var n="pronom"/>
		  <clip pos="1" side="tl" part="lemh"/>
		  <clip pos="1" side="tl" part="a_verb"/>
		  <clip pos="1" side="tl" part="temps" link-to="3"/>
		  <clip pos="1" side="tl" part="pers" link-to="4"/>
		  <clip pos="1" side="tl" part="nbr" link-to="5"/>
		  <clip pos="1" side="tl" part="lemq"/>
		</lu> 
		<b pos="1"/>
		<lu>
		  <clip pos="3" side="tl" part="lemh"/>
		  <clip pos="3" side="tl" part="a_verb"/>
		  <lit-tag v="inf"/>
		  <var n="pronomenc"/>
		  <clip pos="3" side="tl" part="lemq"/>
		</lu>
	      </chunk>
	    </out>
	  </when>
	  <when>
            <test>
              <equal>
                <clip pos="1" side="sl" part="temps"/>
                <lit-tag v="ger"/>
              </equal>
            </test>
	    <out>
	      <chunk name="verbcj_inf" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="SV"/></tag>
		  <tag><var n="tipus_verb"/></tag>
		  <tag><clip pos="1" side="tl" part="temps"/></tag>
		  <tag><lit-tag v="PD"/></tag> <!-x- BCN pingui -x->
		  <tag><lit-tag v="ND"/></tag> <!-x- BCN -x->
		</tags>  	
		<lu>	
		  <clip pos="1" side="tl" part="lemh"/> 
		  <clip pos="1" side="tl" part="a_verb"/>
		  <clip pos="1" side="tl" part="temps" link-to="3"/>
		  <clip pos="1" side="tl" part="lemq"/>
		</lu>
		<b pos="1"/>
		<lu>
                  <clip pos="3" side="tl" part="lemh"/>
                  <clip pos="3" side="tl" part="a_verb"/>
                  <lit-tag v="inf"/>
		  <var n="pronomenc"/>
                  <clip pos="3" side="tl" part="lemq"/>
		</lu>
	      </chunk>
	    </out>
	</when>
	</choose>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>

 -->


    <rule comment="REGLA: AUX + VERBcontrol + to + INF (BCN 'try/need/... to do this -> intentar/necessitar/ fer'">
      <pattern>
	<pattern-item n="auxmod"/>
	<pattern-item n="controlverb"/>
	<pattern-item n="to"/>
	<pattern-item n="inf"/>
      </pattern>
      <action>   
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="tipus_verbs">
	  <with-param pos="2"/>
	</call-macro>
	<call-macro n="tipus_verbs2">
	  <with-param pos="4"/>
	</call-macro>
	<call-macro n="pronenc">
	  <with-param pos="4"/>
	</call-macro>	
<!--	<call-macro n="pron">
	  <with-param pos="2"/>
	</call-macro> els controlverbs no són per ara pronominals-->	
	<choose>
	  <when>
	    <test>
	      <equal>
		  <clip pos="2" side="sl" part="lem"/>
		  <lit v="try"/>
	      </equal>
	    </test>
	    <let>
	      <clip pos="2" side="tl" part="lem"/>
	      <lit v="intentar"/>
	    </let>
	  </when>
	</choose>
	<choose>      
          <when>
            <test>
              <and>
                <equal caseless="yes">
                  <clip pos="1" side="sl" part="lem"/>
                  <lit v="can"/>
                </equal>
                <equal>
                  <clip pos="1" side="sl" part="temps"/>
                  <lit-tag v="pres"/>
                </equal>
              </and>
            </test>
            <let>
              <clip pos="1" side="tl" part="temps"/>
              <lit-tag v="pri"/>
            </let>
          </when>
          <when>
            <test>
              <and>
                <equal caseless="yes">
                  <clip pos="1" side="sl" part="lem"/>
                  <lit v="can"/>
                </equal>
                <equal>
                  <clip pos="1" side="sl" part="temps"/>
                  <lit-tag v="past"/>
                </equal>
              </and>
            </test>
            <let>
              <clip pos="1" side="tl" part="temps"/>
              <lit-tag v="cni"/>
            </let>
          </when>
          <when>
            <test>
              <or>
                <equal caseless="yes">
                  <clip pos="1" side="sl" part="lem"/>
                  <lit v="must"/>
                </equal>
                <equal caseless="yes">
                  <clip pos="1" side="sl" part="lem"/>
                  <lit v="may"/>
                </equal>
              </or>
            </test>
            <let>
              <clip pos="1" side="tl" part="temps"/>
              <lit-tag v="pri"/>
            </let>
          </when>
          <when>
            <test>
              <or>
                <equal caseless="yes">
                  <clip pos="1" side="sl" part="lem"/>
                  <lit v="should"/>
                </equal>
                <equal caseless="yes">
                  <clip pos="1" side="sl" part="lem"/>
                  <lit v="might"/>
                </equal>
              </or>
            </test>
            <let>
              <clip pos="1" side="tl" part="temps"/>
              <lit-tag v="cni"/>
            </let>
	   </when>
	   </choose>
	    <out>
	      <chunk name="auxmod_inf_inf" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="SV"/></tag>
		  <tag><var n="tipus_verb"/></tag>
		  <tag><clip pos="1" side="tl" part="temps"/></tag>
              <tag><lit-tag v="PD"/></tag>
              <tag><lit-tag v="ND"/></tag>
		</tags>      
		<lu>   
		  <var n="pronom"/>
		  <clip pos="1" side="tl" part="lemh"/>
		  <clip pos="1" side="tl" part="a_verb"/>
		  <clip pos="1" side="tl" part="temps" link-to="3"/>
		  <lit-tag v="4"/>
		  <lit-tag v="5"/>
		  <clip pos="1" side="tl" part="lemq"/>
		</lu> 
		<b pos="1"/>
		<lu>
		  <clip pos="2" side="tl" part="lemh"/>
		  <clip pos="2" side="tl" part="a_verb"/>
		  <lit-tag v="inf"/>
		  <clip pos="2" side="tl" part="lemq"/>
		</lu>
		<b pos="2"/>
		<lu>
		  <clip pos="4" side="tl" part="lemh"/>
		  <clip pos="4" side="tl" part="a_verb"/>
		  <lit-tag v="inf"/>
		  <var n="pronomenc"/>
		  <clip pos="4" side="tl" part="lemq"/>
		</lu>
	      </chunk>
	    </out>
	    <let>
	      <var n="caseFirstWord"/>
	      <lit v="aa"/>
	    </let>
      </action>
    </rule>


    <rule comment="REGLA: AUX + ADV + VERBcontrol + to + INF (BCN 'try/need/... to do this -> intentar/necessitar/ fer'">
      <pattern>
	<pattern-item n="auxmod"/>
	<pattern-item n="adv"/>
	<pattern-item n="controlverb"/>
	<pattern-item n="to"/>
	<pattern-item n="inf"/>
      </pattern>
      <action>   
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="tipus_verbs">
	  <with-param pos="3"/>
	</call-macro>
	<call-macro n="tipus_verbs2">
	  <with-param pos="5"/>
	</call-macro>
	<call-macro n="pronenc">
	  <with-param pos="5"/>
	</call-macro>	
	<choose>
	  <when>
	    <test>
	      <equal>
		  <clip pos="3" side="sl" part="lem"/>
		  <lit v="try"/>
	      </equal>
	    </test>
	    <let>
	      <clip pos="3" side="tl" part="lem"/>
	      <lit v="intentar"/>
	    </let>
	  </when>
	</choose>
        <choose>
          <when>
            <test>
              <in caseless="yes">
                <clip pos="2" side="sl" part="lem"/>
                <list n="adv_neg"/>
              </in>
            </test>
            <let>
              <var n="paraula2"/>
              <clip pos="2" side="tl" part="whole"/>
            </let>
            <append n="paraula2">
              <lit-tag v="NEG"/>
            </append>
            <let>
              <clip pos="2" side="tl" part="whole"/>
              <var n="paraula2"/>
            </let>
          </when>
        </choose>
        <out>
          <chunk name="adv" case="caseFirstWord">
            <tags>
              <tag><clip pos="2" side="tl" part="a_adv"/></tag>
              <tag><clip pos="2" side="tl" part="neg"/></tag>
            </tags>
            <lu>
              <clip pos="2" side="tl" part="lem"/>
              <clip pos="2" side="tl" part="a_adv"/>
            </lu>
          </chunk>
          <b pos="1"/>
        </out>

	<choose>      
          <when>
            <test>
              <and>
                <equal caseless="yes">
                  <clip pos="1" side="sl" part="lem"/>
                  <lit v="can"/>
                </equal>
                <equal>
                  <clip pos="1" side="sl" part="temps"/>
                  <lit-tag v="pres"/>
                </equal>
              </and>
            </test>
            <let>
              <clip pos="1" side="tl" part="temps"/>
              <lit-tag v="pri"/>
            </let>
          </when>
          <when>
            <test>
              <and>
                <equal caseless="yes">
                  <clip pos="1" side="sl" part="lem"/>
                  <lit v="can"/>
                </equal>
                <equal>
                  <clip pos="1" side="sl" part="temps"/>
                  <lit-tag v="past"/>
                </equal>
              </and>
            </test>
            <let>
              <clip pos="1" side="tl" part="temps"/>
              <lit-tag v="cni"/>
            </let>
          </when>
          <when>
            <test>
              <or>
                <equal caseless="yes">
                  <clip pos="1" side="sl" part="lem"/>
                  <lit v="must"/>
                </equal>
                <equal caseless="yes">
                  <clip pos="1" side="sl" part="lem"/>
                  <lit v="may"/>
                </equal>
              </or>
            </test>
            <let>
              <clip pos="1" side="tl" part="temps"/>
              <lit-tag v="pri"/>
            </let>
          </when>
          <when>
            <test>
              <or>
                <equal caseless="yes">
                  <clip pos="1" side="sl" part="lem"/>
                  <lit v="should"/>
                </equal>
                <equal caseless="yes">
                  <clip pos="1" side="sl" part="lem"/>
                  <lit v="might"/>
                </equal>
              </or>
            </test>
            <let>
              <clip pos="1" side="tl" part="temps"/>
              <lit-tag v="cni"/>
            </let>
	   </when>
	   </choose>
	    <out>
	      <chunk name="auxmod_inf_inf" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="SV"/></tag>
		  <tag><var n="tipus_verb"/></tag>
		  <tag><clip pos="1" side="tl" part="temps"/></tag>
              <tag><lit-tag v="PD"/></tag>
              <tag><lit-tag v="ND"/></tag>
		</tags>      
		<lu>   
		  <var n="pronom"/>
		  <clip pos="1" side="tl" part="lemh"/>
		  <clip pos="1" side="tl" part="a_verb"/>
		  <clip pos="1" side="tl" part="temps" link-to="3"/>
		  <lit-tag v="4"/>
		  <lit-tag v="5"/>
		  <clip pos="1" side="tl" part="lemq"/>
		</lu> 
		<b pos="1"/>
		<lu>
		  <clip pos="3" side="tl" part="lemh"/>
		  <clip pos="3" side="tl" part="a_verb"/>
		  <lit-tag v="inf"/>
		  <clip pos="3" side="tl" part="lemq"/>
		</lu>
		<b pos="2"/>
		<lu>
		  <clip pos="5" side="tl" part="lemh"/>
		  <clip pos="5" side="tl" part="a_verb"/>
		  <lit-tag v="inf"/>
		  <var n="pronomenc"/>
		  <clip pos="5" side="tl" part="lemq"/>
		</lu>
	      </chunk>
	    </out>
	    <let>
	      <var n="caseFirstWord"/>
	      <lit v="aa"/>
	    </let>
	  </action>
	</rule>

    <rule comment="REGLA: AUX (temps) + VERBcontrol + to + INF (BCN 'try/need/... to do this -> intentar/necessitar/ fer'">
      <pattern>
	<pattern-item n="auxtemps"/>
	<pattern-item n="controlverb"/>
	<pattern-item n="to"/>
	<pattern-item n="inf"/>
      </pattern>
      <action>   
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="tipus_verbs">
	  <with-param pos="2"/>
	</call-macro>
	<call-macro n="tipus_verbs2">
	  <with-param pos="4"/>
	</call-macro>
	<call-macro n="pronenc">
	  <with-param pos="4"/>
	</call-macro>	
	<choose>
	  <when>
	    <test>
	      <equal>
		  <clip pos="2" side="sl" part="lem"/>
		  <lit v="try"/>
	      </equal>
	    </test>
	    <let>
	      <clip pos="2" side="tl" part="lem"/>
	      <lit v="intentar"/>
	    </let>
	  </when>
	</choose>
        <choose>
          <when>
            <test>
              <or>
                <equal caseless="yes">
                  <clip pos="1" side="sl" part="lem"/>
                  <lit v="will"/>
                </equal>
                <equal caseless="yes">
                  <clip pos="1" side="sl" part="lem"/>
                  <lit v="shall"/>
                </equal>
              </or>
            </test>
            <let>
              <clip pos="2" side="tl" part="temps"/>
              <lit-tag v="fti"/>
            </let>
          </when>
          <when>
            <test>
              <equal caseless="yes">
                <clip pos="1" side="sl" part="lem"/>
                <lit v="would"/>
              </equal>
            </test>
            <let>
              <clip pos="2" side="tl" part="temps"/>
              <lit-tag v="cni"/>
            </let>
          </when>
        </choose>
	    <out>
	      <chunk name="verbcj_inf" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="SV"/></tag>
		  <tag><var n="tipus_verb"/></tag>
		  <tag><clip pos="2" side="tl" part="temps"/></tag>
              <tag><lit-tag v="PD"/></tag>
              <tag><lit-tag v="ND"/></tag>
		</tags>      
		<lu>   
		  <var n="pronom"/>
		  <clip pos="2" side="tl" part="lemh"/>
		  <clip pos="2" side="tl" part="a_verb"/>
		  <clip pos="2" side="tl" part="temps" link-to="3"/>
		  <lit-tag v="4"/>
		  <lit-tag v="5"/>
		  <clip pos="2" side="tl" part="lemq"/>
		</lu> 
		<b pos="1"/>
		<lu>
		  <clip pos="4" side="tl" part="lemh"/>
		  <clip pos="4" side="tl" part="a_verb"/>
		  <lit-tag v="inf"/>
		  <var n="pronomenc"/>
		  <clip pos="4" side="tl" part="lemq"/>
		</lu>
	      </chunk>
	    </out>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>


    <rule comment="REGLA: AUX (temps) + ADV + VERBcontrol + to + INF (BCN 'try/need/... to do this -> intentar/necessitar/ fer'">
      <pattern>
	<pattern-item n="auxtemps"/>
	<pattern-item n="adv"/>
	<pattern-item n="controlverb"/>
	<pattern-item n="to"/>
	<pattern-item n="inf"/>
      </pattern>
      <action>   
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="tipus_verbs">
	  <with-param pos="3"/>
	</call-macro>
	<call-macro n="tipus_verbs2">
	  <with-param pos="5"/>
	</call-macro>
	<call-macro n="pronenc">
	  <with-param pos="5"/>
	</call-macro>	
	<choose>
	  <when>
	    <test>
	      <equal>
		  <clip pos="3" side="sl" part="lem"/>
		  <lit v="try"/>
	      </equal>
	    </test>
	    <let>
	      <clip pos="3" side="tl" part="lem"/>
	      <lit v="intentar"/>
	    </let>
	  </when>
	</choose>
        <choose>
          <when>
            <test>
              <in caseless="yes">
                <clip pos="2" side="sl" part="lem"/>
                <list n="adv_neg"/>
              </in>
            </test>
            <let>
              <var n="paraula2"/>
              <clip pos="2" side="tl" part="whole"/>
            </let>
            <append n="paraula2">
              <lit-tag v="NEG"/>
            </append>
            <let>
              <clip pos="2" side="tl" part="whole"/>
              <var n="paraula2"/>
            </let>
          </when>
        </choose>
        <out>
          <chunk name="adv" case="caseFirstWord">
            <tags>
              <tag><clip pos="2" side="tl" part="a_adv"/></tag>
              <tag><clip pos="2" side="tl" part="neg"/></tag>
            </tags>
            <lu>
              <clip pos="2" side="tl" part="lem"/>
              <clip pos="2" side="tl" part="a_adv"/>
            </lu>
          </chunk>
          <b pos="1"/>
        </out>
        <choose>
          <when>
            <test>
              <or>
                <equal caseless="yes">
                  <clip pos="1" side="sl" part="lem"/>
                  <lit v="will"/>
                </equal>
                <equal caseless="yes">
                  <clip pos="1" side="sl" part="lem"/>
                  <lit v="shall"/>
                </equal>
              </or>
            </test>
            <let>
              <clip pos="3" side="tl" part="temps"/>
              <lit-tag v="fti"/>
            </let>
          </when>
          <when>
            <test>
              <equal caseless="yes">
                <clip pos="1" side="sl" part="lem"/>
                <lit v="would"/>
              </equal>
            </test>
            <let>
              <clip pos="3" side="tl" part="temps"/>
              <lit-tag v="cni"/>
            </let>
          </when>
        </choose>

	    <out>
	      <chunk name="verbcj_inf" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="SV"/></tag>
		  <tag><var n="tipus_verb"/></tag>
		  <tag><clip pos="3" side="tl" part="temps"/></tag>
              <tag><lit-tag v="PD"/></tag>
              <tag><lit-tag v="ND"/></tag>
		</tags>      
		<lu>   
		  <var n="pronom"/>
		  <clip pos="3" side="tl" part="lemh"/>
		  <clip pos="3" side="tl" part="a_verb"/>
		  <clip pos="3" side="tl" part="temps" link-to="3"/>
		  <lit-tag v="4"/>
		  <lit-tag v="5"/>
		  <clip pos="3" side="tl" part="lemq"/>
		</lu> 		
		<b pos="1"/>
		<lu>
		  <clip pos="5" side="tl" part="lemh"/>
		  <clip pos="5" side="tl" part="a_verb"/>
		  <lit-tag v="inf"/>
		  <var n="pronomenc"/>
		  <clip pos="5" side="tl" part="lemq"/>
		</lu>
	      </chunk>
	    </out>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>


    <!--***************** present i past continuous ****************************** -->


 

    <rule comment="REGLA: BE GER (am saying -> estic dient)">
      <pattern>
	<pattern-item n="be"/>
	<pattern-item n="ger"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>	
	<call-macro n="tipus_verbs">
	  <with-param pos="2"/>
	</call-macro>
	<call-macro n="pron">
	  <with-param pos="2"/>
	</call-macro>
	<choose>
	  <when> <!-- if BE=pp then estar, i envia pronom si el verb és pronominal-->
	    <test>
	      <and>
		<equal>
		  <clip pos="1" side="sl" part="temps"/>
		  <lit-tag v="pp"/>
		</equal>
		<equal>
		  <clip pos="2" side="tl" part="a_verb"/>
		  <lit-tag v="vblex.pron"/>
		</equal>
	      </and>
	    </test>
	    <let>
	      <clip pos="1" side="tl" part="lemh"/>
	      <lit v="estar"/>
	    </let>
	    <let>
	      <clip pos="1" side="tl" part="a_verb"/>
	      <lit-tag v="vblex"/>
	    </let>
	    <out>
	      <chunk name="be_ger_enc" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="SV"/></tag>
		  <tag><var n="tipus_verb"/></tag>
		  <tag><clip pos="1" side="tl" part="temps"/></tag>
		  <tag><lit-tag v="m"/></tag>
		  <tag><lit-tag v="sg"/></tag>
		</tags>
		<lu>
		  <clip pos="1" side="tl" part="lemh"/> 
		  <clip pos="1" side="tl" part="a_verb"/>
		  <clip pos="1" side="tl" part="temps" link-to="3"/>
		  <lit-tag v="4"/>
		  <lit-tag v="5"/>
		  <clip pos="1" side="tl" part="lemq"/>
		</lu>
		<b pos="1"/>
		<mlu>
		  <lu>
		    <clip pos="2" side="tl" part="lemh"/> 
		    <clip pos="2" side="tl" part="a_verb"/>
		    <clip pos="2" side="tl" part="temps"/>
		    <clip pos="2" side="tl" part="lemq"/>
		  </lu>
		  <lu><!--enviem el pronom reflexiu perquè en aquest cas, quan es dóna el chunk 'been + ger' sense el 'have', vol dir que el 'have' està lluny i per tant, per ara, no es pot determinar la persona de l'enclític ('he has, in recent years, been caring....' -->
		    <lit v="es"/>
		    <lit-tag v="prn.enc.ref.p3.mf.sp"/>
		    <clip pos="3" side="tl" part="lemq"/>
		  </lu>
		</mlu>    
	      </chunk>
	    </out>
	  </when>
	  <when> <!-- if BE=pp then estar (entra per aquí si el verb no és pronominal)-->
	    <test>
	      <equal>
		<clip pos="1" side="sl" part="temps"/>
		<lit-tag v="pp"/>
	      </equal>
	    </test>
	    <let>
	      <clip pos="1" side="tl" part="lemh"/>
	      <lit v="estar"/>
	    </let>
	    <let>
	      <clip pos="1" side="tl" part="a_verb"/>
	      <lit-tag v="vblex"/>
	    </let>
	    <out>
	      <chunk name="be_ger" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="SV"/></tag>
		  <tag><var n="tipus_verb"/></tag>
		  <tag><clip pos="1" side="tl" part="temps"/></tag>
		  <tag><lit-tag v="m"/></tag>
		  <tag><lit-tag v="sg"/></tag>
		</tags>
		<lu>
		  <clip pos="1" side="tl" part="lemh"/> 
		  <clip pos="1" side="tl" part="a_verb"/>
		  <clip pos="1" side="tl" part="temps" link-to="3"/>
		  <lit-tag v="4"/>
		  <lit-tag v="5"/>
		  <clip pos="1" side="tl" part="lemq"/>
		</lu>
		<b pos="1"/>
		<lu>
		  <clip pos="2" side="tl" part="lemh"/> 
		  <clip pos="2" side="tl" part="a_verb"/>
		  <clip pos="2" side="tl" part="temps"/>
		  <clip pos="2" side="tl" part="lemq"/>
		</lu>
	      </chunk>
	    </out>
	  </when>
	  <otherwise> 
	    <choose>
	      <when>
		<test>
		  <equal>
		    <clip pos="1" side="sl" part="temps"/>
		    <lit-tag v="past"/>
		  </equal>
		</test>
		<let>
		  <clip pos="2" side="tl" part="temps"/>
		  <lit-tag v="pii"/><!--'deia' -->
		</let>			
		<call-macro n="f_bcond">
		  <with-param pos="1"/>
		</call-macro>
		<out><!--was/were, les dues formes són ambigues en quant a pers/nbr, per tant PD i ND si temps = past-->
		  <chunk name="verbcj" case="caseFirstWord">
		    <tags>
		      <tag><lit-tag v="SV"/></tag>
		      <tag><var n="tipus_verb"/></tag>
		      <tag><clip pos="2" side="tl" part="temps"/></tag>
		      <tag><lit-tag v="PD"/></tag>
		      <tag><lit-tag v="ND"/></tag>
		    </tags> 
		    <lu>
		      <var n="pronom"/>	
		      <clip pos="2" side="tl" part="lemh"/> 
		      <clip pos="2" side="tl" part="a_verb"/>
		      <clip pos="2" side="tl" part="temps" link-to="3"/>
		      <lit-tag v="4"/>
		      <lit-tag v="5"/>
		      <clip pos="2" side="tl" part="lemq"/>
		    </lu>
		  </chunk>
		</out>
	      </when>
	      <otherwise>
		<choose>
		  <when>
		    <test>
		      <and>
			<equal><!--Si no té pers, tampoc té nbr, llavors serà PD i ND -->
			  <clip pos="1" side="tl" part="pers"/>
			  <lit v=""/>
			</equal>
			<not><!--a menys que siguin inf o ger, ja que llavors no tenen prs ni nbr -->
			  <or>
			    <equal>
			      <clip pos="1" side="sl" part="temps"/>
			      <lit-tag v="inf"/>
			    </equal>
			    <equal>
			      <clip pos="1" side="sl" part="temps"/>
			      <lit-tag v="ger"/>
			    </equal>
			  </or>
			</not>
		      </and>
		    </test>
		    <let>
		      <var n="paraula1"/>
		      <clip pos="1" side="tl" part="lemh"/>
		    </let>
		    <append n="paraula1">
		      <clip pos="1" side="tl" part="tags"/>
		      <lit-tag v="PD"/>
		      <lit-tag v="ND"/>
		      <clip pos="1" side="tl" part="lemq"/>
		    </append>
		    <let>
		      <clip pos="1" side="tl" part="whole"/>
		      <var n="paraula1"/>
		    </let>
		  </when>
		</choose>
		
		<choose>
		  <when>
		    <test>
		      <or>
			<equal>
			  <clip pos="1" side="sl" part="temps"/>
			  <lit-tag v="pri"/>
			</equal> 
			<equal>
			  <clip pos="1" side="sl" part="temps"/>
			  <lit-tag v="pres"/>
			</equal>
		      </or>
		    </test>
		    <let>
		      <clip pos="1" side="tl" part="temps"/>
		      <lit-tag v="pri"/>
		    </let>
		    <let>
		      <clip pos="1" side="tl" part="lemh"/>
		      <lit v="estar"/>
		    </let>
		    <let>
		      <clip pos="1" side="tl" part="a_verb"/>
		      <lit-tag v="vblex"/>
		    </let>
		  </when>
		</choose>
		<out>
		  <chunk name="be_ger" case="caseFirstWord">
		    <tags>
		      <tag><lit-tag v="SV"/></tag>
		      <tag><var n="tipus_verb"/></tag>
		      <tag><clip pos="1" side="tl" part="temps"/></tag>
		      <tag><clip pos="1" side="tl" part="pers"/></tag>
		      <tag><clip pos="1" side="tl" part="nbr"/></tag>
		    </tags> 
		    <lu>
		      <var n="pronom"/>
		      <clip pos="1" side="tl" part="lemh"/> 
		      <clip pos="1" side="tl" part="a_verb"/>
		      <clip pos="1" side="tl" part="temps" link-to="3"/>
		      <clip pos="1" side="tl" part="pers" link-to="4"/>
		      <clip pos="1" side="tl" part="nbr" link-to="5"/>
		      <clip pos="1" side="tl" part="lemq"/>
		    </lu>
		    <b pos="1"/>
		    <lu>
		      <clip pos="2" side="tl" part="lemh"/> 
		      <clip pos="2" side="tl" part="a_verb"/>
		      <clip pos="2" side="tl" part="temps"/>
		      <clip pos="2" side="tl" part="lemq"/>
		    </lu>
		  </chunk>
		</out>	
	      </otherwise>
	    </choose>
	  </otherwise>
	</choose>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>

    <rule comment="REGLA: BE GER clític (am saying it-> ho estic dient)">
      <pattern>
	<pattern-item n="be"/>
	<pattern-item n="ger"/>
	<pattern-item n="probj"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>	
	<call-macro n="tipus_verbs">
	  <with-param pos="2"/>
	</call-macro>
	<call-macro n="pron">
	  <with-param pos="2"/>
	</call-macro>
	<choose>
	  <when>
	    <test>	      
	      <equal>
		<clip pos="1" side="sl" part="temps"/>
		<lit-tag v="pp"/>
	      </equal>
	    </test>
	    <let>
	      <clip pos="1" side="tl" part="lemh"/>
	      <lit v="estar"/>
	    </let>
	    <let>
	      <clip pos="1" side="tl" part="a_verb"/>
	      <lit-tag v="vblex"/>
	    </let>	    
	    <out>
	      <chunk name="be_ger_enc" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="SV"/></tag>
		  <tag><var n="tipus_verb"/></tag>
		  <tag><clip pos="1" side="tl" part="temps"/></tag>
		  <tag><lit-tag v="m"/></tag>
		  <tag><lit-tag v="sg"/></tag>
		</tags>
		<lu>
		  <clip pos="1" side="tl" part="lemh"/> 
		  <clip pos="1" side="tl" part="a_verb"/>
		  <clip pos="1" side="tl" part="temps" link-to="3"/>
		  <lit-tag v="4"/>
		  <lit-tag v="5"/>
		  <clip pos="1" side="tl" part="lemq"/>
		</lu>
		<b pos="1"/>
		<mlu>
		  <lu>
		    <clip pos="2" side="tl" part="lemh"/> 
		    <clip pos="2" side="tl" part="a_verb"/>
		    <clip pos="2" side="tl" part="temps"/>
		    <clip pos="2" side="tl" part="lemq"/>
		  </lu>
		  <lu>
		    <clip pos="3" side="tl" part="lem"/> 
		    <lit-tag v="prn.enc"/>
		    <clip pos="3" side="tl" part="pers"/>
		    <clip pos="3" side="tl" part="gen"/>
		    <clip pos="3" side="tl" part="nbr"/>
		  </lu>
		</mlu>
	      </chunk>
	    </out>
	    <call-macro n="f_bcond">
	      <with-param pos="2"/>
	    </call-macro>
	  </when>
	  <otherwise>
	    
	    <choose>
	      <when>
		<test>
		  <equal>
		    <clip pos="1" side="sl" part="temps"/>
		    <lit-tag v="past"/>
		  </equal>
		</test>
		<let>
		  <clip pos="2" side="tl" part="temps"/>
		  <lit-tag v="pii"/><!--'deia' -->
		</let>		
		<call-macro n="f_bcond">
		  <with-param pos="1"/>
		</call-macro>
		<out><!--was/were, les dues formes són ambigues en quant a pers/nbr, per tant PD i ND si temps = past-->
		  <chunk name="pro_verbcj" case="caseFirstWord">
		    <tags>
		      <tag><lit-tag v="SV"/></tag>
		      <tag><var n="tipus_verb"/></tag>
		      <tag><clip pos="2" side="tl" part="temps"/></tag>
		      <tag><lit-tag v="PD"/></tag>
		      <tag><lit-tag v="ND"/></tag>
		    </tags> 
		    <lu>
		      <var n="pronom"/>
		      <clip pos="3" side="tl" part="lem"/>
		      <clip pos="3" side="tl" part="a_prnpro"/>
		      <clip pos="3" side="tl" part="pers"/>
		      <clip pos="3" side="tl" part="gen"/>
		      <clip pos="3" side="tl" part="nbr"/>
		    </lu>
		    <b pos="2"/>
		    <lu>
		      <clip pos="2" side="tl" part="lemh"/> 
		      <clip pos="2" side="tl" part="a_verb"/>
		      <clip pos="2" side="tl" part="temps" link-to="3"/>
		      <lit-tag v="4"/>
		      <lit-tag v="5"/>
		      <clip pos="2" side="tl" part="lemq"/>
		    </lu>
		  </chunk>
		</out>
	      </when>
	      <otherwise>
		<choose>
		  <when>
		    <test>
		      <and>
			<equal><!--Si no té pers, tampoc té nbr, llavors serà PD i ND -->
			  <clip pos="1" side="tl" part="pers"/>
			  <lit v=""/>
			</equal>
			<not><!--a menys que siguin inf o ger, ja que llavors no tenen prs ni nbr -->
			  <or>
			    <equal>
			      <clip pos="1" side="sl" part="temps"/>
			      <lit-tag v="inf"/>
			    </equal>
			    <equal>
			      <clip pos="1" side="sl" part="temps"/>
			      <lit-tag v="ger"/>
			    </equal>
			  </or>
			</not>
		      </and>		  
		    </test>
		    <let>
		      <var n="paraula1"/>
		      <clip pos="1" side="tl" part="lemh"/>
		    </let>
		    <append n="paraula1">
		      <clip pos="1" side="tl" part="tags"/>
		      <lit-tag v="PD"/>
		      <lit-tag v="ND"/>
		      <clip pos="1" side="tl" part="lemq"/>
		    </append>
		    <let>
		      <clip pos="1" side="tl" part="whole"/>
		      <var n="paraula1"/>
		    </let>
		  </when>
		</choose>
		<choose>
		  <when>
		    <test>
		      <or>
			<equal>
			  <clip pos="1" side="sl" part="temps"/>
			  <lit-tag v="pri"/>
			</equal> 
			<equal>
			  <clip pos="1" side="sl" part="temps"/>
			  <lit-tag v="pres"/>
			</equal>
		      </or>
		    </test>
		    <let>
		      <clip pos="1" side="tl" part="temps"/>
		      <lit-tag v="pri"/>
		    </let>
		    <let>
		      <clip pos="1" side="tl" part="lemh"/>
		      <lit v="estar"/>
		    </let>
		    <let>
		      <clip pos="1" side="tl" part="a_verb"/>
		      <lit-tag v="vblex"/>
		    </let>
		  </when>
		</choose>
		<out>
		  <chunk name="pro_be_ger" case="caseFirstWord">
		    <tags>
		      <tag><lit-tag v="SV"/></tag>
		      <tag><var n="tipus_verb"/></tag>
		      <tag><clip pos="1" side="tl" part="temps"/></tag>
		      <tag><clip pos="1" side="tl" part="pers"/></tag>
		      <tag><clip pos="1" side="tl" part="nbr"/></tag>
		    </tags> 
		    <lu>
		      <var n="pronom"/>
		      <clip pos="3" side="tl" part="lem"/>
		      <clip pos="3" side="tl" part="a_prnpro"/>
		      <clip pos="3" side="tl" part="pers"/>
		      <clip pos="3" side="tl" part="gen"/>
		      <clip pos="3" side="tl" part="nbr"/>
		    </lu>
		    <b pos="1"/>
		    <lu>
		      <clip pos="1" side="tl" part="lemh"/> 
		      <clip pos="1" side="tl" part="a_verb"/>
		      <clip pos="1" side="tl" part="temps" link-to="3"/>
		      <clip pos="1" side="tl" part="pers" link-to="4"/>
		      <clip pos="1" side="tl" part="nbr" link-to="5"/>
		      <clip pos="1" side="tl" part="lemq"/>
		    </lu>
		    <b pos="2"/>
		    <lu>
		      <clip pos="2" side="tl" part="lemh"/> 
		      <clip pos="2" side="tl" part="a_verb"/>
		      <clip pos="2" side="tl" part="temps"/>
		      <clip pos="2" side="tl" part="lemq"/>
		    </lu>
		  </chunk>
		</out>	
	      </otherwise>
	    </choose>
	  </otherwise>
	</choose>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>



    <rule comment="REGLA: BE ADV GER (is always/not working -> sempre/no està treballant">
      <pattern>
	<pattern-item n="be"/>
	<pattern-item n="adv"/>
	<pattern-item n="ger"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>	
	<call-macro n="tipus_verbs">
	  <with-param pos="3"/>
	</call-macro>
	<call-macro n="pron">
	  <with-param pos="2"/>
	</call-macro>
	
	<choose>
	  <when>
	    <test>
	      <in caseless="yes">
		<clip pos="2" side="sl" part="lem"/>
		<list n="adv_neg"/>
	      </in>
	    </test>
	    <let>
	      <var n="paraula2"/>
	      <clip pos="2" side="tl" part="whole"/>
	    </let>
	    <append n="paraula2">
	      <lit-tag v="NEG"/>
	    </append>
	    <let>
	      <clip pos="2" side="tl" part="whole"/>
	      <var n="paraula2"/>
	    </let>
	  </when>
	</choose>
	<out>
	  <chunk name="adv" case="caseFirstWord">
	    <tags>
	      <tag><clip pos="2" side="tl" part="a_adv"/></tag>
	      <tag><clip pos="2" side="tl" part="neg"/></tag>
	    </tags>
	    <lu>
	      <clip pos="2" side="tl" part="lem"/>
	      <clip pos="2" side="tl" part="a_adv"/>
	    </lu>
	  </chunk>
	  <b pos="1"/>
	</out>
	<choose><!--i a partir d'aquí, és el tractament de 'be' + 'ger', igual que a la regla anterior -->
	  <when>
	    <test>
	      <equal>
		<clip pos="1" side="sl" part="temps"/>
		<lit-tag v="pp"/>
	      </equal>
	    </test>
	    <let>
	      <clip pos="1" side="tl" part="lemh"/>
	      <lit v="estar"/>
	    </let>
	    <let>
	      <clip pos="1" side="tl" part="a_verb"/>
	      <lit-tag v="vblex"/>
	    </let>		
	 
	    <out>
	      <chunk name="be_ger" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="SV"/></tag>
		  <tag><var n="tipus_verb"/></tag>
		  <tag><clip pos="1" side="tl" part="temps"/></tag>
		  <tag><lit-tag v="m"/></tag>
		  <tag><lit-tag v="sg"/></tag>
		</tags>
		<lu>
		  <clip pos="1" side="tl" part="lemh"/> 
		  <clip pos="1" side="tl" part="a_verb"/>
		  <clip pos="1" side="tl" part="temps" link-to="3"/>
		  <lit-tag v="4"/>
		  <lit-tag v="5"/>
		  <clip pos="1" side="tl" part="lemq"/>
		</lu>
		<b pos="2"/>
		<lu>
		  <clip pos="3" side="tl" part="lemh"/> 
		  <clip pos="3" side="tl" part="a_verb"/>
		  <clip pos="3" side="tl" part="temps"/>
		  <clip pos="3" side="tl" part="lemq"/>
		</lu>
	      </chunk>
	    </out>
	  </when>
	  <otherwise> 
	    <choose>

	      <when>
		<test>
		  <equal>
		    <clip pos="1" side="sl" part="temps"/>
		    <lit-tag v="past"/>
		  </equal>
		</test>
		<let>
		  <clip pos="3" side="tl" part="temps"/>
		  <lit-tag v="pii"/><!--'deia' -->
		</let>			
		<call-macro n="f_bcond">
		  <with-param pos="2"/>
		</call-macro>	       
		<call-macro n="firstWord">
		  <with-param pos="1"/>
		</call-macro>
		<out><!--was/were, les dues formes són ambigues en quant a pers/nbr, per tant PD i ND si temps = past-->
		  <chunk name="verbcj">
		    <tags>
		      <tag><lit-tag v="SV"/></tag>
		      <tag><var n="tipus_verb"/></tag>
		      <tag><clip pos="3" side="tl" part="temps"/></tag>
		      <tag><lit-tag v="PD"/></tag>
		      <tag><lit-tag v="ND"/></tag>
		    </tags> 
		    <lu>
		      <var n="pronom"/>
		      <clip pos="3" side="tl" part="lemh"/> 
		      <clip pos="3" side="tl" part="a_verb"/>
		      <clip pos="3" side="tl" part="temps" link-to="3"/>
		      <lit-tag v="4"/>
		      <lit-tag v="5"/>
		      <clip pos="3" side="tl" part="lemq"/>
		    </lu>
		  </chunk>
		</out>
	      </when>
	      <otherwise>
		<choose>
		  <when>
		    <test>
		      <and>
			<equal><!--Si no té pers, tampoc té nbr, llavors serà PD i ND -->
			  <clip pos="1" side="tl" part="pers"/>
			  <lit v=""/>
			</equal>
			<not><!--a menys que siguin inf o ger, ja que llavors no tenen prs ni nbr -->
			  <or>
			    <equal>
			      <clip pos="1" side="sl" part="temps"/>
			      <lit-tag v="inf"/>
			    </equal>
			    <equal>
			      <clip pos="1" side="sl" part="temps"/>
			      <lit-tag v="ger"/>
			    </equal>
			  </or>
			</not>
		      </and>
		    </test>
		    <let>
		      <var n="paraula1"/>
		      <clip pos="1" side="tl" part="lemh"/>
		    </let>
		    <append n="paraula1">
		      <clip pos="1" side="tl" part="tags"/>
		      <lit-tag v="PD"/>
		      <lit-tag v="ND"/>
		      <clip pos="1" side="tl" part="lemq"/>
		    </append>
		    <let>
		      <clip pos="1" side="tl" part="whole"/>
		      <var n="paraula1"/>
		    </let>
		  </when>
		</choose>
		<choose>
		  <when>
		    <test>
		      <or>
			<equal>
			  <clip pos="1" side="sl" part="temps"/>
			  <lit-tag v="pri"/>
			</equal> 
			<equal>
			  <clip pos="1" side="sl" part="temps"/>
			  <lit-tag v="pres"/>
			</equal>
		      </or>
		    </test>
		    <let>
		      <clip pos="1" side="tl" part="temps"/>
		      <lit-tag v="pri"/>
		    </let>
		    <let>
		      <clip pos="1" side="tl" part="lemh"/>
		      <lit v="estar"/>
		    </let>
		    <let>
		      <clip pos="1" side="tl" part="a_verb"/>
		      <lit-tag v="vblex"/>
		    </let>
		  </when>
		</choose>
		<out>
		  <chunk name="be_ger">
		    <tags>
		      <tag><lit-tag v="SV"/></tag>
		      <tag><var n="tipus_verb"/></tag>
		      <tag><clip pos="1" side="tl" part="temps"/></tag>
		      <tag><clip pos="1" side="tl" part="pers"/></tag>
		      <tag><clip pos="1" side="tl" part="nbr"/></tag>
		    </tags> 
		    <lu>
		      <var n="pronom"/>
		      <clip pos="1" side="tl" part="lemh"/> 
		      <clip pos="1" side="tl" part="a_verb"/>
		      <clip pos="1" side="tl" part="temps" link-to="3"/>
		      <clip pos="1" side="tl" part="pers" link-to="4"/>
		      <clip pos="1" side="tl" part="nbr" link-to="5"/>
		      <clip pos="1" side="tl" part="lemq"/>
		    </lu>
		    <b pos="2"/>
		    <lu>
		      <clip pos="3" side="tl" part="lemh"/> 
		      <clip pos="3" side="tl" part="a_verb"/>
		      <clip pos="3" side="tl" part="temps"/>
		      <clip pos="3" side="tl" part="lemq"/>
		    </lu>
		  </chunk>
		</out>	
	      </otherwise>
	    </choose>
	  </otherwise>
	</choose>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>

    <rule comment="REGLA: BE ADV GER clític (is always singing it-> sempre l'està cantant">
      <pattern>
	<pattern-item n="be"/>
	<pattern-item n="adv"/>
	<pattern-item n="ger"/>
	<pattern-item n="probj"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>	
	<call-macro n="tipus_verbs">
	  <with-param pos="3"/>
	</call-macro>
	<call-macro n="pron">
	  <with-param pos="3"/>
	</call-macro>
	
	<choose>
	  <when>
	    <test>
	      <in caseless="yes">
		<clip pos="2" side="sl" part="lem"/>
		<list n="adv_neg"/>
	      </in>
	    </test>
	    <let>
	      <var n="paraula2"/>
	      <clip pos="2" side="tl" part="whole"/>
	    </let>
	    <append n="paraula2">
	      <lit-tag v="NEG"/>
	    </append>
	    <let>
	      <clip pos="2" side="tl" part="whole"/>
	      <var n="paraula2"/>
	    </let>
	  </when>
	</choose>
	<out>
	  <chunk name="adv" case="caseFirstWord">
	    <tags>
	      <tag><clip pos="2" side="tl" part="a_adv"/></tag>
	      <tag><clip pos="2" side="tl" part="neg"/></tag>
	    </tags>
	    <lu>
	      <clip pos="2" side="tl" part="lem"/>
	      <clip pos="2" side="tl" part="a_adv"/>
	    </lu>
	  </chunk>
	  <b pos="1"/>
	</out>
	<choose><!--i a partir d'aquí, és el tractament de 'be' + 'ger', igual que a la regla anterior -->
	  <when>
	    <test>
	      
	      <equal>
		<clip pos="1" side="sl" part="temps"/>
		<lit-tag v="pp"/>
	      </equal>
	    </test>
	    <let>
	      <clip pos="1" side="tl" part="lemh"/>
	      <lit v="estar"/>
	    </let>
	    <let>
	      <clip pos="1" side="tl" part="a_verb"/>
	      <lit-tag v="vblex"/>
	    </let>	   
	    <out>
	      <chunk name="be_ger_enc" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="SV"/></tag>
		  <tag><var n="tipus_verb"/></tag>
		  <tag><clip pos="1" side="tl" part="temps"/></tag>
		  <tag><lit-tag v="m"/></tag>
		  <tag><lit-tag v="sg"/></tag>
		</tags>
		<lu>
		  <clip pos="1" side="tl" part="lemh"/> 
		  <clip pos="1" side="tl" part="a_verb"/>
		  <clip pos="1" side="tl" part="temps" link-to="3"/>
		  <lit-tag v="4"/>
		  <lit-tag v="5"/>
		  <clip pos="1" side="tl" part="lemq"/>
		</lu>

		<b pos="2"/>
		<mlu>
		  <lu>
		    <clip pos="3" side="tl" part="lemh"/> 
		    <clip pos="3" side="tl" part="a_verb"/>
		    <clip pos="3" side="tl" part="temps"/>
		    <clip pos="3" side="tl" part="lemq"/>
		  </lu>
		  <lu>
		    <clip pos="4" side="tl" part="lem"/> 
		    <lit-tag v="prn.enc"/>
		    <clip pos="4" side="tl" part="pers"/>
		    <clip pos="4" side="tl" part="gen"/>
		    <clip pos="4" side="tl" part="nbr"/>
		  </lu>
		</mlu>
	      </chunk>
	    </out>
	    <call-macro n="f_bcond">
	      <with-param pos="2"/>
	    </call-macro>
	  </when>
	  <otherwise>
	    <choose>
	      <when>
		<test>
		  <equal>
		    <clip pos="1" side="sl" part="temps"/>
		    <lit-tag v="past"/>
		  </equal>
		</test>
		<let>
		  <clip pos="3" side="tl" part="temps"/>
		  <lit-tag v="pii"/><!--'deia' -->
		</let>	 		
		<call-macro n="f_bcond">
		  <with-param pos="2"/>
		</call-macro>	       
		<call-macro n="firstWord">
		  <with-param pos="1"/>
		</call-macro>
		<out><!--was/were, les dues formes són ambigues en quant a pers/nbr, per tant PD i ND si temps = past-->
		  <chunk name="pro_verbcj">
		    <tags>
		      <tag><lit-tag v="SV"/></tag>
		      <tag><var n="tipus_verb"/></tag>
		      <tag><clip pos="3" side="tl" part="temps"/></tag>
		      <tag><lit-tag v="PD"/></tag>
		      <tag><lit-tag v="ND"/></tag>
		    </tags> 
		    <lu>
		      <var n="pronom"/>
		      <clip pos="4" side="tl" part="lem"/>
		      <clip pos="4" side="tl" part="a_prnpro"/>
		      <clip pos="4" side="tl" part="pers"/>
		      <clip pos="4" side="tl" part="gen"/>
		      <clip pos="4" side="tl" part="nbr"/>
		    </lu>
		    <b pos="2"/>
		    <lu>
		      <clip pos="3" side="tl" part="lemh"/> 
		      <clip pos="3" side="tl" part="a_verb"/>
		      <clip pos="3" side="tl" part="temps" link-to="3"/>
		      <lit-tag v="4"/>
		      <lit-tag v="5"/>
		      <clip pos="3" side="tl" part="lemq"/>
		    </lu>
		  </chunk>
		</out>
		<call-macro n="f_bcond">
		  <with-param pos="3"/>
		</call-macro>		
	      </when>
	      <otherwise>
		<choose>
		  <when>
		    <test>
		      <and>
			<equal><!--Si no té pers, tampoc té nbr, llavors serà PD i ND -->
			  <clip pos="1" side="tl" part="pers"/>
			  <lit v=""/>
			</equal>
			<not><!--a menys que siguin inf o ger, ja que llavors no tenen prs ni nbr -->
			  <or>
			    <equal>
			      <clip pos="1" side="sl" part="temps"/>
			      <lit-tag v="inf"/>
			    </equal>
			    <equal>
			      <clip pos="1" side="sl" part="temps"/>
			      <lit-tag v="ger"/>
			    </equal>
			  </or>
			</not>
		      </and>
		    </test>
		    <let>
		      <var n="paraula1"/>
		      <clip pos="1" side="tl" part="lemh"/>
		    </let>
		    <append n="paraula1">
		      <clip pos="1" side="tl" part="tags"/>
		      <lit-tag v="PD"/>
		      <lit-tag v="ND"/>
		      <clip pos="1" side="tl" part="lemq"/>
		    </append>
		    <let>
		      <clip pos="1" side="tl" part="whole"/>
		      <var n="paraula1"/>
		    </let>
		  </when>
		</choose>
		<choose>
		  <when>
		    <test>
		      <or>
			<equal>
			  <clip pos="1" side="sl" part="temps"/>
			  <lit-tag v="pri"/>
			</equal> 
			<equal>
			  <clip pos="1" side="sl" part="temps"/>
			  <lit-tag v="pres"/>
			</equal>
		      </or>
		    </test>
		    <let>
		      <clip pos="1" side="tl" part="temps"/>
		      <lit-tag v="pri"/>
		    </let>
		    <let>
		      <clip pos="1" side="tl" part="lemh"/>
		      <lit v="estar"/>
		    </let>
		    <let>
		      <clip pos="1" side="tl" part="a_verb"/>
		      <lit-tag v="vblex"/>
		    </let>
		  </when>
		</choose>
		<out>
		  <chunk name="pro_be_ger">
		    <tags>
		      <tag><lit-tag v="SV"/></tag>
		      <tag><var n="tipus_verb"/></tag>
		      <tag><clip pos="1" side="tl" part="temps"/></tag>
		      <tag><clip pos="1" side="tl" part="pers"/></tag>
		      <tag><clip pos="1" side="tl" part="nbr"/></tag>
		    </tags> 
		    <lu>
		      <var n="pronom"/>
		      <clip pos="4" side="tl" part="lem"/>
		      <clip pos="4" side="tl" part="a_prnpro"/>
		      <clip pos="4" side="tl" part="pers"/>
		      <clip pos="4" side="tl" part="gen"/>
		      <clip pos="4" side="tl" part="nbr"/>
		    </lu>
		    <b pos="2"/>
		    <lu>
		      <clip pos="1" side="tl" part="lemh"/> 
		      <clip pos="1" side="tl" part="a_verb"/>
		      <clip pos="1" side="tl" part="temps" link-to="3"/>
		      <clip pos="1" side="tl" part="pers" link-to="4"/>
		      <clip pos="1" side="tl" part="nbr" link-to="5"/>
		      <clip pos="1" side="tl" part="lemq"/>
		    </lu>
		    <b pos="3"/>
		    <lu>
		      <clip pos="3" side="tl" part="lemh"/> 
		      <clip pos="3" side="tl" part="a_verb"/>
		      <clip pos="3" side="tl" part="temps"/>
		      <clip pos="3" side="tl" part="lemq"/>
		    </lu>
		  </chunk>
		</out>	
	      </otherwise>
	    </choose>
	  </otherwise>
	</choose>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>



   <rule comment="REGLA: BE CONTROLger TO INF(BCN am planing to go -> estic planejant anar)">
      <pattern>
	<pattern-item n="be"/>
	<pattern-item n="controlverbger"/>
	<pattern-item n="to"/>
	<pattern-item n="inf"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>	
	<call-macro n="tipus_verbs">
	  <with-param pos="2"/>
	</call-macro>
	<call-macro n="tipus_verbs2">
	  <with-param pos="4"/>
	</call-macro>
	<call-macro n="pronenc">
	  <with-param pos="4"/>
	</call-macro>	
	<choose>
	  <when>
	    <test>
	      <equal>
		  <clip pos="2" side="sl" part="lem"/>
		  <lit v="try"/>
	      </equal>
	    </test>
	    <let>
	      <clip pos="2" side="tl" part="lem"/>
	      <lit v="intentar"/>
	    </let>
	  </when>
	</choose>
	<choose>
	  <when>
	    <test>
	      <equal>
		<clip pos="1" side="sl" part="temps"/>
		<lit-tag v="pp"/>
	      </equal>
	    </test>
	    <let>
	      <clip pos="1" side="tl" part="lemh"/>
	      <lit v="estar"/>
	    </let>
	    <let>
	      <clip pos="1" side="tl" part="a_verb"/>
	      <lit-tag v="vblex"/>
	    </let>
	    <out>
	      <chunk name="be_inf_inf" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="SV"/></tag>
		  <tag><var n="tipus_verb"/></tag>
		  <tag><clip pos="1" side="tl" part="temps"/></tag>
		  <tag><lit-tag v="m"/></tag>
		  <tag><lit-tag v="sg"/></tag>
		</tags>
		<lu>
		  <clip pos="1" side="tl" part="lemh"/> 
		  <clip pos="1" side="tl" part="a_verb"/>
		  <clip pos="1" side="tl" part="temps" link-to="3"/>
		  <lit-tag v="4"/>
		  <lit-tag v="5"/>
		  <clip pos="1" side="tl" part="lemq"/>
		</lu>
		<b pos="1"/>
		<lu>
		  <clip pos="2" side="tl" part="lemh"/> 
		  <clip pos="2" side="tl" part="a_verb"/>
		  <clip pos="2" side="tl" part="temps"/>
		  <clip pos="2" side="tl" part="lemq"/>
		</lu>
		<b pos="2"/>
		<lu>
		  <clip pos="4" side="tl" part="lemh"/>
		  <clip pos="4" side="tl" part="a_verb"/>
		  <lit-tag v="inf"/>
		  <var n="pronomenc"/>
		  <clip pos="4" side="tl" part="lemq"/>
		</lu>
	      </chunk>
	    </out>
	  </when>
	  <otherwise> 
	    <choose>
	      <when>
		<test>
		  <equal>
		    <clip pos="1" side="sl" part="temps"/>
		    <lit-tag v="past"/>
		  </equal>
		</test>
		<let>
		  <clip pos="2" side="tl" part="temps"/>
		  <lit-tag v="pii"/><!--'deia' -->
		</let>
		<call-macro n="f_bcond">
		  <with-param pos="1"/>
		</call-macro>
		<out><!--was/were, les dues formes són ambigues en quant a pers/nbr, per tant PD i ND si temps = past-->
		  <chunk name="verbcj_inf" case="caseFirstWord">
		    <tags>
		      <tag><lit-tag v="SV"/></tag>
		      <tag><var n="tipus_verb"/></tag>
		      <tag><clip pos="2" side="tl" part="temps"/></tag>
		      <tag><lit-tag v="PD"/></tag>
		      <tag><lit-tag v="ND"/></tag>
		    </tags> 
		    <lu>
		      <var n="pronom"/>	
		      <clip pos="2" side="tl" part="lemh"/> 
		      <clip pos="2" side="tl" part="a_verb"/>
		      <clip pos="2" side="tl" part="temps" link-to="3"/>
		      <lit-tag v="4"/>
		      <lit-tag v="5"/>
		      <clip pos="2" side="tl" part="lemq"/>
		    </lu>
		    <b pos="1"/>
		    <lu>
		      <clip pos="4" side="tl" part="lemh"/>
		      <clip pos="4" side="tl" part="a_verb"/>
		      <lit-tag v="inf"/>
		      <var n="pronomenc"/>
		      <clip pos="4" side="tl" part="lemq"/>
		    </lu>
		  </chunk>
		</out>
	      </when>
	      <otherwise>
		<choose>
		  <when>
		    <test>
		      <and>
			<equal><!--Si no té pers, tampoc té nbr, llavors serà PD i ND -->
			  <clip pos="1" side="tl" part="pers"/>
			  <lit v=""/>
			</equal>
			<not><!--a menys que siguin inf o ger, ja que llavors no tenen prs ni nbr -->
			  <or>
			    <equal>
			      <clip pos="1" side="sl" part="temps"/>
			      <lit-tag v="inf"/>
			    </equal>
			    <equal>
			      <clip pos="1" side="sl" part="temps"/>
			      <lit-tag v="ger"/>
			    </equal>
			  </or>
			</not>
		      </and>
		    </test>
		    <let>
		      <var n="paraula1"/>
		      <clip pos="1" side="tl" part="lemh"/>
		    </let>
		    <append n="paraula1">
		      <clip pos="1" side="tl" part="tags"/>
		      <lit-tag v="PD"/>
		      <lit-tag v="ND"/>
		      <clip pos="1" side="tl" part="lemq"/>
		    </append>
		    <let>
		      <clip pos="1" side="tl" part="whole"/>
		      <var n="paraula1"/>
		    </let>
		  </when>
		</choose>
		
		<choose>
		  <when>
		    <test>
		      <or>
			<equal>
			  <clip pos="1" side="sl" part="temps"/>
			  <lit-tag v="pri"/>
			</equal> 
			<equal>
			  <clip pos="1" side="sl" part="temps"/>
			  <lit-tag v="pres"/>
			</equal>
		      </or>
		    </test>
		    <let>
		      <clip pos="1" side="tl" part="temps"/>
		      <lit-tag v="pri"/>
		    </let>
		    <let>
		      <clip pos="1" side="tl" part="lemh"/>
		      <lit v="estar"/>
		    </let>
		    <let>
		      <clip pos="1" side="tl" part="a_verb"/>
		      <lit-tag v="vblex"/>
		    </let>
		  </when>
		</choose>
		<out>
		  <chunk name="be_inf_inf" case="caseFirstWord">
		    <tags>
		      <tag><lit-tag v="SV"/></tag>
		      <tag><var n="tipus_verb"/></tag>
		      <tag><clip pos="1" side="tl" part="temps"/></tag>
		      <tag><clip pos="1" side="tl" part="pers"/></tag>
		      <tag><clip pos="1" side="tl" part="nbr"/></tag>
		    </tags> 
		    <lu>
		      <var n="pronom"/>
		      <clip pos="1" side="tl" part="lemh"/> 
		      <clip pos="1" side="tl" part="a_verb"/>
		      <clip pos="1" side="tl" part="temps" link-to="3"/>
		      <clip pos="1" side="tl" part="pers" link-to="4"/>
		      <clip pos="1" side="tl" part="nbr" link-to="5"/>
		      <clip pos="1" side="tl" part="lemq"/>
		    </lu>
		    <b pos="1"/>
		    <lu>
		      <clip pos="2" side="tl" part="lemh"/> 
		      <clip pos="2" side="tl" part="a_verb"/>
		      <clip pos="2" side="tl" part="temps"/>
		      <clip pos="2" side="tl" part="lemq"/>
		    </lu>
		    <b pos="2"/>
		    <lu>
		      <clip pos="4" side="tl" part="lemh"/>
		      <clip pos="4" side="tl" part="a_verb"/>
		      <lit-tag v="inf"/>
		      <var n="pronomenc"/>
		      <clip pos="4" side="tl" part="lemq"/>
		    </lu>
		  </chunk>
		</out>	
	      </otherwise>
	    </choose>
	  </otherwise>
	</choose>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>


    <rule comment="REGLA: AUX ADV VERB (will always think -> sempre pensaré. will not think -> no pensaré.)">
      <pattern>
	<pattern-item n="auxtemps"/>
	<pattern-item n="adv"/>
	<pattern-item n="infpres"/>
      </pattern>
      <action>    
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>	
	<call-macro n="tipus_verbs">
	  <with-param pos="3"/>
	</call-macro>
	<call-macro n="pron">
	  <with-param pos="3"/>
	</call-macro>
	
	<choose>
	  <when>
	    <test>
	      <in caseless="yes">
		<clip pos="2" side="sl" part="lem"/>
		<list n="adv_neg"/>
	      </in>
	    </test>
	    <let>
	      <var n="paraula2"/>
	      <clip pos="2" side="tl" part="whole"/>
	    </let>
	    <append n="paraula2">
	      <lit-tag v="NEG"/>
	    </append>
	    <let>
	      <clip pos="2" side="tl" part="whole"/>
	      <var n="paraula2"/>
	    </let>
	  </when>
	</choose>
	<out>
	  <chunk name="adv" case="caseFirstWord">
	    <tags>
	      <tag><clip pos="2" side="tl" part="a_adv"/></tag>
	      <tag><clip pos="2" side="tl" part="neg"/></tag>
	    </tags>
	    <lu>
	      <clip pos="2" side="tl" part="lem"/>
	      <clip pos="2" side="tl" part="a_adv"/>
	    </lu>
	  </chunk>
	  <b pos="1"/>
	</out>
	<choose>		
	  <when>
	    <test>
	      <or>
		<equal caseless="yes">
		  <clip pos="1" side="sl" part="lem"/>
		  <lit v="will"/>
		</equal>
		<equal caseless="yes">
		  <clip pos="1" side="sl" part="lem"/>
		  <lit v="shall"/>
		</equal>
	      </or>
	    </test>
	    <let>
	      <clip pos="3" side="tl" part="temps"/>
	      <lit-tag v="fti"/>
	    </let>
	  </when>
	  <when>
	    <test>
	      <equal caseless="yes">
		<clip pos="1" side="sl" part="lem"/>
		<lit v="would"/>
	      </equal>
	    </test>
	    <let>
	      <clip pos="3" side="tl" part="temps"/>
	      <lit-tag v="cni"/>
	    </let>
	  </when>		
	</choose>
	
	<out>
	  <chunk name="verbcj">
	    <tags>
	      <tag><lit-tag v="SV"/></tag>
	      <tag><var n="tipus_verb"/></tag>
	      <tag><clip pos="3" side="tl" part="temps"/></tag>
	      <tag><lit-tag v="PD"/></tag>
	      <tag><lit-tag v="ND"/></tag>
	    </tags>      
	    <lu>   
	      <var n="pronom"/> 
	      <clip pos="3" side="tl" part="lemh"/>
	      <clip pos="3" side="tl" part="a_verb"/>
	      <clip pos="3" side="tl" part="temps" link-to="3"/>
	      <lit-tag v="4"/>
	      <lit-tag v="5"/>
	      <clip pos="3" side="tl" part="lemq"/>
	    </lu> 
	  </chunk>
	</out>
	<call-macro n="f_bcond">
	  <with-param pos="2"/>
	</call-macro>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>

    <rule comment="REGLA: AUX ADV VERB clític (will always sing it-> sempre el cantaré. will not sing it-> no el cantaré.)">
      <pattern>
	<pattern-item n="auxtemps"/>
	<pattern-item n="adv"/>
	<pattern-item n="infpres"/>
	<pattern-item n="probj"/>
      </pattern>
      <action>    
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>	
	<call-macro n="tipus_verbs">
	  <with-param pos="3"/>
	</call-macro>
	<call-macro n="pron">
	  <with-param pos="3"/>
	</call-macro>
	
	<choose>
	  <when>
	    <test>
	      <in caseless="yes">
		<clip pos="2" side="sl" part="lem"/>
		<list n="adv_neg"/>
	      </in>
	    </test>
	    <let>
	      <var n="paraula2"/>
	      <clip pos="2" side="tl" part="whole"/>
	    </let>
	    <append n="paraula2">
	      <lit-tag v="NEG"/>
	    </append>
	    <let>
	      <clip pos="2" side="tl" part="whole"/>
	      <var n="paraula2"/>
	    </let>
	  </when>
	</choose>
	<out>
	  <chunk name="adv" case="caseFirstWord">
	    <tags>
	      <tag><clip pos="2" side="tl" part="a_adv"/></tag>
	      <tag><clip pos="2" side="tl" part="neg"/></tag>
	    </tags>
	    <lu>
	      <clip pos="2" side="tl" part="lem"/>
	      <clip pos="2" side="tl" part="a_adv"/>
	    </lu>
	  </chunk>
	  <b pos="1"/>
	</out>
	<choose>		
	  <when>
	    <test>
	      <or>
		<equal caseless="yes">
		  <clip pos="1" side="sl" part="lem"/>
		  <lit v="will"/>
		</equal>
		<equal caseless="yes">
		  <clip pos="1" side="sl" part="lem"/>
		  <lit v="shall"/>
		</equal>
	      </or>		
	    </test>
	    <let>
	      <clip pos="3" side="tl" part="temps"/>
	      <lit-tag v="fti"/>
	    </let>
	  </when>
	  <when>
	    <test>
	      <equal caseless="yes">
		<clip pos="1" side="sl" part="lem"/>
		<lit v="would"/>
	      </equal>
	    </test>
	    <let>
	      <clip pos="3" side="tl" part="temps"/>
	      <lit-tag v="cni"/>
	    </let>
	  </when>		
	</choose>
	
	<out>
	  <chunk name="pro_verbcj">
	    <tags>
	      <tag><lit-tag v="SV"/></tag>
	      <tag><var n="tipus_verb"/></tag>
	      <tag><clip pos="3" side="tl" part="temps"/></tag>
	      <tag><lit-tag v="PD"/></tag>
	      <tag><lit-tag v="ND"/></tag>
	    </tags> 
	    <lu>
	      <var n="pronom"/>
	      <clip pos="4" side="tl" part="lem"/>
	      <clip pos="4" side="tl" part="a_prnpro"/>
	      <clip pos="4" side="tl" part="pers"/>
	      <clip pos="4" side="tl" part="gen"/>
	      <clip pos="4" side="tl" part="nbr"/>
	    </lu>
	    <b pos="2"/>
	    
	    <lu>   
	      <clip pos="3" side="tl" part="lemh"/>
	      <clip pos="3" side="tl" part="a_verb"/>
	      <clip pos="3" side="tl" part="temps" link-to="3"/>
	      <lit-tag v="4"/>
	      <lit-tag v="5"/>
	      <clip pos="3" side="tl" part="lemq"/>
	    </lu> 
	  </chunk>
	</out>
	<call-macro n="f_bcond">
	  <with-param pos="3"/>
	</call-macro>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>
    
    
    <rule comment="REGLA: AUX ADV VERB (can always think -> sempre puc pensar)">    
      <pattern>
	<pattern-item n="auxmod"/> 
	<pattern-item n="adv"/>
	<pattern-item n="infpres"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>	
	<call-macro n="tipus_verbs">
	  <with-param pos="3"/>
	</call-macro>
	<call-macro n="pron">
	  <with-param pos="3"/>
	</call-macro>
	
	<choose>
	  <when>
	    <test>
	      <in caseless="yes">
		<clip pos="2" side="sl" part="lem"/>
		<list n="adv_neg"/>
	      </in>
	    </test>
	    <let>
	      <var n="paraula2"/>
	      <clip pos="2" side="tl" part="whole"/>
	    </let>
	    <append n="paraula2">
	      <lit-tag v="NEG"/>
	    </append>
	    <let>
	      <clip pos="2" side="tl" part="whole"/>
	      <var n="paraula2"/>
	    </let>
	  </when>
	</choose>
	<out>
	  <chunk name="adv" case="caseFirstWord">
	    <tags>
	      <tag><clip pos="2" side="tl" part="a_adv"/></tag>
	      <tag><clip pos="2" side="tl" part="neg"/></tag>
	    </tags>
	    <lu>
	      <clip pos="2" side="tl" part="lem"/>
	      <clip pos="2" side="tl" part="a_adv"/>
	    </lu>
	  </chunk>
	  <b pos="1"/>
	</out>
	<choose>     
	  <when>
	    <test>
	      <and>
		<equal caseless="yes">
		  <clip pos="1" side="sl" part="lem"/>
		  <lit v="can"/>
		</equal>
		<equal>
		  <clip pos="1" side="sl" part="temps"/>
		  <lit-tag v="pres"/>
		</equal>
	      </and>
	    </test>
	    <let>
	      <clip pos="1" side="tl" part="temps"/>
	      <lit-tag v="pri"/>
	    </let>
	  </when>
	  <when>
	    <test>
	      <and>
		<equal caseless="yes">
		  <clip pos="1" side="sl" part="lem"/>
		  <lit v="can"/>
		</equal>
		<equal>
		  <clip pos="1" side="sl" part="temps"/>
		  <lit-tag v="past"/>
		</equal>
	      </and>
	    </test>
	    <let>
	      <clip pos="1" side="tl" part="temps"/>
	      <lit-tag v="cni"/>
	    </let>
	  </when>
	  <when>
	    <test>
	      <or>
		<equal caseless="yes">
		  <clip pos="1" side="sl" part="lem"/>
		  <lit v="must"/>
		</equal>
		<equal caseless="yes">
		  <clip pos="1" side="sl" part="lem"/>
		  <lit v="may"/>
		</equal>
	      </or>
	    </test>
	    <let>
	      <clip pos="1" side="tl" part="temps"/>
	      <lit-tag v="pri"/>
	    </let>
	  </when>
	  <when>
	    <test>
	      <or>
		<equal caseless="yes">
		  <clip pos="1" side="sl" part="lem"/>
		  <lit v="should"/>
		</equal>
		<equal caseless="yes">
		  <clip pos="1" side="sl" part="lem"/>
		  <lit v="might"/>
		</equal>
	      </or>
	    </test>
	    <let>
	      <clip pos="1" side="tl" part="temps"/>
	      <lit-tag v="cni"/>
	    </let>
	  </when>
	</choose>
	<out>
	  <chunk name="auxmod_inf">
	    <tags>
	      <tag><lit-tag v="SV"/></tag>
	      <tag><var n="tipus_verb"/></tag>
	      <tag><clip pos="1" side="tl" part="temps"/></tag>
	      <tag><lit-tag v="PD"/></tag>
	      <tag><lit-tag v="ND"/></tag>
	    </tags>  
	    <lu>
	      <var n="pronom"/>
	      <clip pos="1" side="tl" part="lemh"/>
	      <clip pos="1" side="tl" part="a_verb"/>
	      <clip pos="1" side="tl" part="temps" link-to="3"/>
	      <lit-tag v="4"/>
	      <lit-tag v="5"/>
	      <clip pos="1" side="tl" part="lemq"/>
	    </lu>
	    <b pos="2"/>
	    <lu>
	      <clip pos="3" side="tl" part="lemh"/> 
	      <clip pos="3" side="tl" part="a_verb"/>
	      <lit-tag v="inf"/>			
	      <clip pos="3" side="tl" part="lemq"/>
	    </lu>
	  </chunk>
	</out>    
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>

    <rule comment="REGLA: AUX ADV VERB clític (can always think it -> sempre el puc pensar)">    
      <pattern>
	<pattern-item n="auxmod"/> 
	<pattern-item n="adv"/>
	<pattern-item n="infpres"/>
	<pattern-item n="probj"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>	
	<call-macro n="tipus_verbs">
	  <with-param pos="3"/>
	</call-macro>
	<call-macro n="pron">
	  <with-param pos="3"/>
	</call-macro>
	
	<choose>
	  <when>
	    <test>
	      <in caseless="yes">
		<clip pos="2" side="sl" part="lem"/>
		<list n="adv_neg"/>
	      </in>
	    </test>
	    <let>
	      <var n="paraula2"/>
	      <clip pos="2" side="tl" part="whole"/>
	    </let>
	    <append n="paraula2">
	      <lit-tag v="NEG"/>
	    </append>
	    <let>
	      <clip pos="2" side="tl" part="whole"/>
	      <var n="paraula2"/>
	    </let>
	  </when>
	</choose>
	<out>
	  <chunk name="adv" case="caseFirstWord">
	    <tags>
	      <tag><clip pos="2" side="tl" part="a_adv"/></tag>
	      <tag><clip pos="2" side="tl" part="neg"/></tag>
	    </tags>
	    <lu>
	      <clip pos="2" side="tl" part="lem"/>
	      <clip pos="2" side="tl" part="a_adv"/>
	    </lu>
	  </chunk>
	  <b pos="1"/>
	</out>
	<choose>     
	  <when>
	    <test>
	      <and>
		<equal caseless="yes">
		  <clip pos="1" side="sl" part="lem"/>
		  <lit v="can"/>
		</equal>
		<equal>
		  <clip pos="1" side="sl" part="temps"/>
		  <lit-tag v="pres"/>
		</equal>
	      </and>
	    </test>
	    <let>
	      <clip pos="1" side="tl" part="temps"/>
	      <lit-tag v="pri"/>
	    </let>
	  </when>
	  <when>
	    <test>
	      <and>
		<equal caseless="yes">
		  <clip pos="1" side="sl" part="lem"/>
		  <lit v="can"/>
		</equal>
		<equal>
		  <clip pos="1" side="sl" part="temps"/>
		  <lit-tag v="past"/>
		</equal>
	      </and>
	    </test>
	    <let>
	      <clip pos="1" side="tl" part="temps"/>
	      <lit-tag v="cni"/>
	    </let>
	  </when>
	  <when>
	    <test>
	      <or>
		<equal caseless="yes">
		  <clip pos="1" side="sl" part="lem"/>
		  <lit v="must"/>
		</equal>
		<equal caseless="yes">
		  <clip pos="1" side="sl" part="lem"/>
		  <lit v="may"/>
		</equal>
	      </or>
	    </test>
	    <let>
	      <clip pos="1" side="tl" part="temps"/>
	      <lit-tag v="pri"/>
	    </let>
	  </when>
	  <when>
	    <test>
	      <or>
		<equal caseless="yes">
		  <clip pos="1" side="sl" part="lem"/>
		  <lit v="should"/>
		</equal>
		<equal caseless="yes">
		  <clip pos="1" side="sl" part="lem"/>
		  <lit v="might"/>
		</equal>
	      </or>
	    </test>
	    <let>
	      <clip pos="1" side="tl" part="temps"/>
	      <lit-tag v="cni"/>
	    </let>
	  </when>
	</choose>
	<out>
	  <chunk name="pro_auxmod_inf">
	    <tags>
	      <tag><lit-tag v="SV"/></tag>
	      <tag><var n="tipus_verb"/></tag>
	      <tag><clip pos="1" side="tl" part="temps"/></tag>
	      <tag><lit-tag v="PD"/></tag>
	      <tag><lit-tag v="ND"/></tag>
	    </tags>  
	    <lu>
	      <var n="pronom"/>	
	      <clip pos="4" side="tl" part="lem"/>
	      <clip pos="4" side="tl" part="a_prnpro"/>
	      <clip pos="4" side="tl" part="pers"/>
	      <clip pos="4" side="tl" part="gen"/>
	      <clip pos="4" side="tl" part="nbr"/>
	    </lu>
	    <b pos="2"/>
	    <lu>
	      <clip pos="1" side="tl" part="lemh"/>
	      <clip pos="1" side="tl" part="a_verb"/>
	      <clip pos="1" side="tl" part="temps" link-to="3"/>
	      <lit-tag v="4"/>
	      <lit-tag v="5"/>
	      <clip pos="1" side="tl" part="lemq"/>
	    </lu>
	    <b pos="3"/>
	    <lu>
	      <clip pos="3" side="tl" part="lemh"/> 
	      <clip pos="3" side="tl" part="a_verb"/>
	      <lit-tag v="inf"/>			
	      <clip pos="3" side="tl" part="lemq"/>
	    </lu>
	  </chunk>
	</out>    
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>




    <rule comment="REGLA: AUX ADV VERB (I do not think -> no penso. I do always think -> sempre penso)">    
      <pattern>
	<pattern-item n="do"/> 
	<pattern-item n="adv"/>
	<pattern-item n="infpres"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>	
	<call-macro n="tipus_verbs">
	  <with-param pos="3"/>
	</call-macro>
	<call-macro n="pron">
	  <with-param pos="3"/>
	</call-macro>
	
	<choose>
	  <when>
	    <test>
	      <in caseless="yes">
		<clip pos="2" side="sl" part="lem"/>
		<list n="adv_neg"/>
	      </in>
	    </test>
	    <let>
	      <var n="paraula2"/>
	      <clip pos="2" side="tl" part="whole"/>
	    </let>
	    <append n="paraula2">
	      <lit-tag v="NEG"/>
	    </append>
	    <let>
	      <clip pos="2" side="tl" part="whole"/>
	      <var n="paraula2"/>
	    </let>
	  </when>
	</choose>
	<out>
	  <chunk name="adv" case="caseFirstWord">
	    <tags>
	      <tag><clip pos="2" side="tl" part="a_adv"/></tag>
	      <tag><clip pos="2" side="tl" part="neg"/></tag>
	    </tags>
	    <lu>
	      <clip pos="2" side="tl" part="lem"/>
	      <clip pos="2" side="tl" part="a_adv"/>
	    </lu>
	  </chunk>
	  <b pos="1"/>
	</out>
	<choose>
	  <when>
	    <test>
	      <equal>
		<clip pos="1" side="sl" part="temps"/>
		<lit-tag v="pri"/>
	      </equal>
	    </test>
	    <let>
	      <clip pos="3" side="tl" part="temps"/>
	      <lit-tag v="pri"/>
	    </let>
	    <out>
	      <chunk name="verbcj">
		<tags>
		  <tag><lit-tag v="SV"/></tag>
		  <tag><var n="tipus_verb"/></tag>
		  <tag><clip pos="3" side="tl" part="temps"/></tag>
		  <tag><clip pos="1" side="sl" part="pers"/></tag>
		  <tag><clip pos="1" side="sl" part="nbr"/></tag>
		</tags>      
		<lu>   
		  <var n="pronom"/>
		  <clip pos="3" side="tl" part="lemh"/>
		  <clip pos="3" side="tl" part="a_verb"/>
		  <clip pos="3" side="tl" part="temps" link-to="3"/>
		  <clip pos="1" side="sl" part="pers" link-to="4"/>
		  <clip pos="1" side="sl" part="nbr" link-to="5"/>
		  <clip pos="3" side="tl" part="lemq"/>
		</lu> 
	      </chunk>
	    </out>
	  </when>
	  <when>
	    <test>
	      <or>
		<equal>
		  <clip pos="1" side="sl" part="temps"/>
		  <lit-tag v="pres"/>
		</equal>
		<equal>
		  <clip pos="1" side="sl" part="temps"/>
		  <lit-tag v="inf"/>
		</equal>
	      </or>
	    </test>
	    <let>
	      <clip pos="3" side="tl" part="temps"/>
	      <lit-tag v="pri"/>
	    </let>
	    <out>
	      <chunk name="verbcj">
		<tags>
		  <tag><lit-tag v="SV"/></tag>
		  <tag><var n="tipus_verb"/></tag>
		  <tag><clip pos="3" side="tl" part="temps"/></tag>
		  <tag><lit-tag v="PD"/></tag>
		  <tag><lit-tag v="ND"/></tag>
		</tags>      
		<lu>   
		  <var n="pronom"/>
		  <clip pos="3" side="tl" part="lemh"/>
		  <clip pos="3" side="tl" part="a_verb"/>
		  <clip pos="3" side="tl" part="temps" link-to="3"/>
		  <lit-tag v="4"/>
		  <lit-tag v="5"/>
		  <clip pos="3" side="tl" part="lemq"/>
		</lu> 
	      </chunk>
	    </out>
	  </when>
	  <when>
	    <test>
	      <equal>
		<clip pos="1" side="sl" part="temps"/>
		<lit-tag v="past"/>
	      </equal> 
	    </test>

	    <out>
	      <chunk name="verbcj_perif">
		<tags>	       
		  <tag><lit-tag v="SV"/></tag>
		  <tag><var n="tipus_verb"/></tag>
		  <tag><lit-tag v="ifip"/></tag>
		  <tag><lit-tag v="PD"/></tag>
		  <tag><lit-tag v="ND"/></tag>
		</tags> 
		<lu>
		  <var n="pronom"/>
		  <lit v="anar"/>
		  <lit-tag v="vaux"/>
		  <lit-tag v="4"/>
		  <lit-tag v="5"/>
		</lu>
		<b/>
		<lu>
		  <clip pos="3" side="tl" part="lemh"/>
		  <clip pos="3" side="tl" part="a_verb"/>
		  <lit-tag v="inf"/>
		  <clip pos="3" side="tl" part="lemq"/>
		</lu>
	      </chunk>
	    </out>
	  </when>
	</choose>
	<call-macro n="f_bcond">
	  <with-param pos="1"/>
	</call-macro>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>

    <rule comment="REGLA: AUX ADV VERB clític (I do not sing it -> no el canto. I do always sing it-> sempre el canto)">    
      <pattern>
	<pattern-item n="do"/> 
	<pattern-item n="adv"/>
	<pattern-item n="infpres"/>
	<pattern-item n="probj"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>	
	<call-macro n="tipus_verbs">
	  <with-param pos="3"/>
	</call-macro>
	<call-macro n="pron">
	  <with-param pos="3"/>
	</call-macro>
	<choose>
	  <when>
	    <test>
	      <in caseless="yes">
		<clip pos="2" side="sl" part="lem"/>
		<list n="adv_neg"/>
	      </in>
	    </test>
	    <let>
	      <var n="paraula2"/>
	      <clip pos="2" side="tl" part="whole"/>
	    </let>
	    <append n="paraula2">
	      <lit-tag v="NEG"/>
	    </append>
	    <let>
	      <clip pos="2" side="tl" part="whole"/>
	      <var n="paraula2"/>
	    </let>
	  </when>
	</choose>
	<out>
	  <chunk name="adv" case="caseFirstWord">
	    <tags>
	      <tag><clip pos="2" side="tl" part="a_adv"/></tag>
	      <tag><clip pos="2" side="tl" part="neg"/></tag>
	    </tags>
	    <lu>
	      <clip pos="2" side="tl" part="lem"/>
	      <clip pos="2" side="tl" part="a_adv"/>
	    </lu>
	  </chunk>
	  <b pos="1"/>
	</out>
	<choose>
	  <when>
	    <test>
	      <equal>
		<clip pos="1" side="sl" part="temps"/>
		<lit-tag v="pri"/>
	      </equal>
	    </test>
	    <let>
	      <clip pos="3" side="tl" part="temps"/>
	      <lit-tag v="pri"/>
	    </let>
	    <out>
	      <chunk name="pro_verbcj">
		<tags>
		  <tag><lit-tag v="SV"/></tag>
		  <tag><var n="tipus_verb"/></tag>
		  <tag><clip pos="3" side="tl" part="temps"/></tag>
		  <tag><clip pos="1" side="sl" part="pers"/></tag>
		  <tag><clip pos="1" side="sl" part="nbr"/></tag>
		</tags>      
		<lu>
		  <var n="pronom"/>
		  <clip pos="4" side="tl" part="lem"/>
		  <clip pos="4" side="tl" part="a_prnpro"/>
		  <clip pos="4" side="tl" part="pers"/>
		  <clip pos="4" side="tl" part="gen"/>
		  <clip pos="4" side="tl" part="nbr"/>
		</lu>
		<b pos="2"/>
		<lu>   
		  <clip pos="3" side="tl" part="lemh"/>
		  <clip pos="3" side="tl" part="a_verb"/>
		  <clip pos="3" side="tl" part="temps" link-to="3"/>
		  <clip pos="1" side="sl" part="pers" link-to="4"/>
		  <clip pos="1" side="sl" part="nbr" link-to="5"/>
		  <clip pos="3" side="tl" part="lemq"/>
		</lu> 
	      </chunk>
	    </out>
	  </when>
	  <when>
	    <test>
	      <or>
		<equal>
		  <clip pos="1" side="sl" part="temps"/>
		  <lit-tag v="pres"/>
		</equal>
		<equal>
		  <clip pos="1" side="sl" part="temps"/>
		  <lit-tag v="inf"/>
		</equal>
	      </or>
	    </test>
	    <let>
	      <clip pos="3" side="tl" part="temps"/>
	      <lit-tag v="pri"/>
	    </let>
	    <out>
	      <chunk name="pro_verbcj">
		<tags>
		  <tag><lit-tag v="SV"/></tag>
		  <tag><var n="tipus_verb"/></tag>
		  <tag><clip pos="3" side="tl" part="temps"/></tag>
		  <tag><lit-tag v="PD"/></tag>
		  <tag><lit-tag v="ND"/></tag>
		</tags>      
		<lu>
		  <var n="pronom"/>
		  <clip pos="4" side="tl" part="lem"/>
		  <clip pos="4" side="tl" part="a_prnpro"/>
		  <clip pos="4" side="tl" part="pers"/>
		  <clip pos="4" side="tl" part="gen"/>
		  <clip pos="4" side="tl" part="nbr"/>
		</lu>
		<b pos="2"/>
		<lu>   
		  <clip pos="3" side="tl" part="lemh"/>
		  <clip pos="3" side="tl" part="a_verb"/>
		  <clip pos="3" side="tl" part="temps" link-to="3"/>
		  <lit-tag v="4"/>
		  <lit-tag v="5"/>
		  <clip pos="3" side="tl" part="lemq"/>
		</lu> 
	      </chunk>
	    </out>
	  </when>
	  <when>
	    <test>
	      <equal>
		<clip pos="1" side="sl" part="temps"/>
		<lit-tag v="past"/>
	      </equal> 
	    </test>
	    
	    <out>
	      <chunk name="pro_verbcj_perif">
		<tags>	       
		  <tag><lit-tag v="SV"/></tag>
		  <tag><var n="tipus_verb"/></tag>
		  <tag><lit-tag v="ifip"/></tag>
		  <tag><lit-tag v="PD"/></tag>
		  <tag><lit-tag v="ND"/></tag>
		</tags> 
		<lu>
		  <var n="pronom"/>
		  <clip pos="4" side="tl" part="lem"/>
		  <clip pos="4" side="tl" part="a_prnpro"/>
		  <clip pos="4" side="tl" part="pers"/>
		  <clip pos="4" side="tl" part="gen"/>
		  <clip pos="4" side="tl" part="nbr"/>
		</lu>
		<b pos="2"/>
		<lu>
		  <lit v="anar"/>
		  <lit-tag v="vaux"/>
		  <lit-tag v="4"/>
		  <lit-tag v="5"/>
		</lu>
		<b/>
		<lu>
		  <clip pos="3" side="tl" part="lemh"/>
		  <clip pos="3" side="tl" part="a_verb"/>
		  <lit-tag v="inf"/>
		  <clip pos="3" side="tl" part="lemq"/>
		</lu>
	      </chunk>
	    </out>
	  </when>
	</choose>
	<call-macro n="f_bcond">
	  <with-param pos="3"/>
	</call-macro>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>

    <rule comment="AUX + ADV + MODAL conjugable + VERB (He will sometimes have to explain - Alguna vegada haurà d'explicar. He will not have to explain -> No haurà d'explicar. He does not have to explain - No ha d'explicar)">
      <pattern>
	<pattern-item n="auxnocan"/>
	<pattern-item n="adv"/>
	<pattern-item n="modinf"/>
	<pattern-item n="infpres"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>	
	<call-macro n="tipus_verbs">
	  <with-param pos="4"/>
	</call-macro>
	<call-macro n="pron">
	  <with-param pos="4"/>
	</call-macro>
	
	<choose>
	  <when>
	    <test>
	      <in caseless="yes">
		<clip pos="2" side="sl" part="lem"/>
		<list n="adv_neg"/>
	      </in>
	    </test>
	    <let>
	      <var n="paraula2"/>
	      <clip pos="2" side="tl" part="whole"/>
	    </let>
	    <append n="paraula2">
	      <lit-tag v="NEG"/>
	    </append>
	    <let>
	      <clip pos="2" side="tl" part="whole"/>
	      <var n="paraula2"/>
	    </let>
	  </when>
	</choose>
	<out>
	  <chunk name="adv" case="caseFirstWord">
	    <tags>
	      <tag><clip pos="2" side="tl" part="a_adv"/></tag>
	      <tag><clip pos="2" side="tl" part="neg"/></tag>
	    </tags>
	    <lu>
	      <clip pos="2" side="tl" part="lem"/>
	      <clip pos="2" side="tl" part="a_adv"/>
	    </lu>
	  </chunk>
	  <b pos="1"/>
	</out>
	
	<choose><!--A partir d'aquí és el tractament del verb com en la regla anterior de 'auxnocan + modinf + infpres' -->
	  <when>
	    <test>
	      <or>
		<equal caseless="yes">
		  <clip pos="1" side="sl" part="lem"/>
		  <lit v="will"/>
		</equal>
		<equal caseless="yes">
		  <clip pos="1" side="sl" part="lem"/>
		  <lit v="shall"/>
		</equal>
		<equal caseless="yes">
		  <clip pos="1" side="sl" part="lem"/>
		  <lit v="would"/>
		</equal>
	      </or>
	    </test>
	    <choose>		
	      <when>
		<test>
		  <or>
		    <equal caseless="yes">
		      <clip pos="1" side="sl" part="lem"/>
		      <lit v="will"/>
		    </equal>
		    <equal caseless="yes">
		      <clip pos="1" side="sl" part="lem"/>
		      <lit v="shall"/>
		    </equal>
		  </or>
		</test>
		<let>
		  <clip pos="3" side="tl" part="temps"/>
		  <lit-tag v="fti"/>
		</let>
	      </when>
	      <when>
		<test>
		  <equal caseless="yes">
		    <clip pos="1" side="sl" part="lem"/>
		    <lit v="would"/>
		  </equal>
		</test>
		<let>
		  <clip pos="3" side="tl" part="temps"/>
		  <lit-tag v="cni"/>
		</let>
	      </when>		
	    </choose>
	    <out>
	      <chunk name="mod_inf">
		<tags>
		  <tag><lit-tag v="SV"/></tag>
		  <tag><var n="tipus_verb"/></tag>
		  <tag><clip pos="3" side="tl" part="temps"/></tag>
		  <tag><lit-tag v="PD"/></tag>
		  <tag><lit-tag v="ND"/></tag>
		</tags>      
		<lu>   
		  <var n="pronom"/>
		  <clip pos="3" side="tl" part="lemh"/>
		  <clip pos="3" side="tl" part="a_verb"/>
		  <clip pos="3" side="tl" part="temps" link-to="3"/>
		  <lit-tag v="4"/>
		  <lit-tag v="5"/>
		  <clip pos="3" side="tl" part="lemq"/>
		</lu> 
		<b pos="2"/>
		<lu>
		  <clip pos="4" side="tl" part="lemh"/> 
		  <clip pos="4" side="tl" part="a_verb"/>
		  <lit-tag v="inf"/>
		  <clip pos="4" side="tl" part="lemq"/> 
		</lu>
	      </chunk>
	    </out>
	    <call-macro n="f_bcond">
	      <with-param pos="3"/>
	    </call-macro>
	  </when>
	  <when>
	    <test>
	      <or>
		<equal caseless="yes">
		  <clip pos="1" side="sl" part="lem"/>
		  <lit v="may"/>
		</equal>
		<equal caseless="yes">
		  <clip pos="1" side="sl" part="lem"/>
		  <lit v="might"/>
		</equal>
	      </or>
	    </test>
	    <choose>
	      <when>
		<test>
		  <equal caseless="yes">
		    <clip pos="1" side="sl" part="lem"/>
		    <lit v="may"/>
		  </equal>
		</test>
		<let>
		  <clip pos="1" side="tl" part="temps"/>
		  <lit-tag v="pri"/>
		</let>
	      </when>
	      <when>
		<test>
		  <equal caseless="yes">
		    <clip pos="1" side="sl" part="lem"/>
		    <lit v="might"/>
		  </equal>
		</test>
		<let>
		  <clip pos="1" side="tl" part="temps"/>
		  <lit-tag v="cni"/>
		</let>
	      </when>
	    </choose>  
	    <out>
	      <chunk name="auxmod_mod_inf">
		<tags>
		  <tag><lit-tag v="SV"/></tag>
		  <tag><var n="tipus_verb"/></tag>
		  <tag><clip pos="1" side="tl" part="temps"/></tag>
		  <tag><lit-tag v="PD"/></tag>
		  <tag><lit-tag v="ND"/></tag>
		</tags>      
		<lu>
		  <var n="pronom"/>
		  <clip pos="1" side="tl" part="lemh"/>
		  <clip pos="1" side="tl" part="a_verb"/>
		  <clip pos="1" side="tl" part="temps" link-to="3"/>
		  <lit-tag v="4"/>
		  <lit-tag v="5"/>
		  <clip pos="1" side="tl" part="lemq"/> 
		</lu>
		<b pos="2"/>
		<lu>
		  <clip pos="3" side="tl" part="lemh"/> 
		  <clip pos="3" side="tl" part="a_verb"/>
		  <lit-tag v="inf"/>			
		  <clip pos="3" side="tl" part="lemq"/>
		</lu>
		<b pos="3"/>
		<lu>
		  <clip pos="4" side="tl" part="lemh"/> 
		  <clip pos="4" side="tl" part="a_verb"/>
		  <lit-tag v="inf"/>
		  <clip pos="4" side="tl" part="lemq"/> 
		</lu>
	      </chunk>
	    </out>
	  </when>
	  <when>
	    <test>
	      <equal caseless="yes">
		<clip pos="1" side="sl" part="lem"/>
		<lit v="do"/>
	      </equal>
	    </test>
	    <choose>
	      <when>
		<test>
		  <or>
		    <equal>
		      <clip pos="1" side="sl" part="temps"/>
		      <lit-tag v="pres"/>
		    </equal>
		    <equal>
		      <clip pos="1" side="sl" part="temps"/>
		      <lit-tag v="pri"/>
		    </equal>
		  </or>
		</test>
		<choose>
		  <when>
		    <test>
		      <equal>
			<clip pos="1" side="sl" part="temps"/>
			<lit-tag v="pres"/>
		      </equal>
		    </test>
		    
		    <let>
		      <clip pos="3" side="tl" part="temps"/>
		      <lit-tag v="pri"/>
		    </let>
		    <let>
		      <var n="paraula2"/>
		      <clip pos="3" side="tl" part="lemh"/>
		    </let>
		    <append n="paraula2">
		      <clip pos="3" side="tl" part="tags"/>
		      <lit-tag v="PD"/>
		      <lit-tag v="ND"/>
		      <clip pos="3" side="tl" part="lemq"/>
		    </append>
		    <let>
		      <clip pos="3" side="tl" part="whole"/>
		      <var n="paraula2"/>
		    </let>
		  </when>
		  <when>
		    <test>
		      <equal>
			<clip pos="1" side="sl" part="temps"/>
			<lit-tag v="pri"/>
		      </equal>
		    </test>
		    <let>
		      <clip pos="3" side="tl" part="temps"/>
		      <lit-tag v="pri"/>
		    </let>
		    <let>
		      <var n="paraula2"/>
		      <clip pos="3" side="tl" part="lemh"/>
		    </let>
		    <append n="paraula2">
		      <clip pos="3" side="tl" part="tags"/>
		      <clip pos="1" side="sl" part="pers"/>
		      <clip pos="1" side="sl" part="nbr"/>
		      <clip pos="3" side="tl" part="lemq"/>
		    </append>
		    <let>
		      <clip pos="3" side="tl" part="whole"/>
		      <var n="paraula2"/>
		    </let>
		  </when>
		</choose>		    
		<out>
		  <chunk name="mod_inf">
		    <tags>
		      <tag><lit-tag v="SV"/></tag>
		      <tag><var n="tipus_verb"/></tag>
		      <tag><clip pos="3" side="tl" part="temps"/></tag>
		      <tag><clip pos="3" side="tl" part="pers"/></tag>
		      <tag><clip pos="3" side="tl" part="nbr"/></tag>
		    </tags>      
		    <lu>   
		      <var n="pronom"/>
		      <clip pos="3" side="tl" part="lemh"/>
		      <clip pos="3" side="tl" part="a_verb"/>
		      <clip pos="3" side="tl" part="temps" link-to="3"/>
		      <clip pos="3" side="tl" part="pers" link-to="4"/>
		      <clip pos="3" side="tl" part="nbr" link-to="5"/>
		      <clip pos="3" side="tl" part="lemq"/>
		    </lu> 
		    <b pos="2"/>
		    <lu>
		      <clip pos="4" side="tl" part="lemh"/> 
		      <clip pos="4" side="tl" part="a_verb"/>
		      <lit-tag v="inf"/>
		      <clip pos="4" side="tl" part="lemq"/> 
		    </lu>
		  </chunk>
		</out>
		<call-macro n="f_bcond">
		  <with-param pos="3"/>
		</call-macro>
	      </when>
	      <when>
		<test>
		  <equal>
		    <clip pos="1" side="sl" part="temps"/>
		    <lit-tag v="past"/>
		  </equal> 
		</test>
		<out>
		  <chunk name="mod_inf_perif">
		    <tags>
		      <tag><lit-tag v="SV"/></tag>
		      <tag><var n="tipus_verb"/></tag>
		      <tag><lit-tag v="ifip"/></tag>
		      <tag><lit-tag v="PD"/></tag>
		      <tag><lit-tag v="ND"/></tag>
		    </tags> 
		    <lu>
		      <var n="pronom"/>
		      <lit v="anar"/>
		      <lit-tag v="vaux"/>
		      <lit-tag v="4"/>
		      <lit-tag v="5"/>
		    </lu>
		    <b pos="2"/>
		    <lu>   
		      <clip pos="3" side="tl" part="lemh"/>
		      <clip pos="3" side="tl" part="a_verb"/>
		      <lit-tag v="inf"/>
		      <clip pos="3" side="tl" part="lemq"/>
		    </lu> 
		    <b pos="3"/>
		    <lu>
		      <clip pos="4" side="tl" part="lemh"/> 
		      <clip pos="4" side="tl" part="a_verb"/>
		      <lit-tag v="inf"/>
		      <clip pos="4" side="tl" part="lemq"/> 
		    </lu>
		  </chunk>
		</out>
	      </when>
	    </choose>
	  </when>
	</choose>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>





    <rule comment="AUX + ADV + MODAL conjugable + VERB + clític (He will sometimes have to explain it- Alguna vegada l'haurà d'explicar. He will not have to explain it-> No l'haurà d'explicar. He does not have to explain it- No l'ha d'explicar)">
      <pattern>
	<pattern-item n="auxnocan"/>
	<pattern-item n="adv"/>
	<pattern-item n="modinf"/>
	<pattern-item n="infpres"/>
	<pattern-item n="probj"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>	
	<call-macro n="tipus_verbs">
	  <with-param pos="4"/>
	</call-macro>
	<call-macro n="pron">
	  <with-param pos="4"/>
	</call-macro>
	
	<choose>
	  <when>
	    <test>
	      <in caseless="yes">
		<clip pos="2" side="sl" part="lem"/>
		<list n="adv_neg"/>
	      </in>
	    </test>
	    <let>
	      <var n="paraula2"/>
	      <clip pos="2" side="tl" part="whole"/>
	    </let>
	    <append n="paraula2">
	      <lit-tag v="NEG"/>
	    </append>
	    <let>
	      <clip pos="2" side="tl" part="whole"/>
	      <var n="paraula2"/>
	    </let>
	  </when>
	</choose>
	<out>
	  <chunk name="adv" case="caseFirstWord">
	    <tags>
	      <tag><clip pos="2" side="tl" part="a_adv"/></tag>
	      <tag><clip pos="2" side="tl" part="neg"/></tag>
	    </tags>
	    <lu>
	      <clip pos="2" side="tl" part="lem"/>
	      <clip pos="2" side="tl" part="a_adv"/>
	    </lu>
	  </chunk>
	  <b pos="1"/>
	</out>
	
	<choose><!--A partir d'aquí és el tractament del verb com en la regla anterior de 'auxnocan + modinf + infpres' -->
	  <when>
	    <test>
	      <or>
		<equal caseless="yes">
		  <clip pos="1" side="sl" part="lem"/>
		  <lit v="will"/>
		</equal>
		<equal caseless="yes">
		  <clip pos="1" side="sl" part="lem"/>
		  <lit v="shall"/>
		</equal>
		<equal caseless="yes">
		  <clip pos="1" side="sl" part="lem"/>
		  <lit v="would"/>
		</equal>
	      </or>
	    </test>
	    <choose>		
	      <when>
		<test>
		  <or>
		    <equal caseless="yes">
		      <clip pos="1" side="sl" part="lem"/>
		      <lit v="will"/>
		    </equal>
		    <equal caseless="yes">
		      <clip pos="1" side="sl" part="lem"/>
		      <lit v="shall"/>
		    </equal>
		  </or>
		</test>
		<let>
		  <clip pos="3" side="tl" part="temps"/>
		  <lit-tag v="fti"/>
		</let>
	      </when>
	      <when>
		<test>
		  <equal caseless="yes">
		    <clip pos="1" side="sl" part="lem"/>
		    <lit v="would"/>
		  </equal>
		</test>
		<let>
		  <clip pos="3" side="tl" part="temps"/>
		  <lit-tag v="cni"/>
		</let>
	      </when>		
	    </choose>
	    <out>
	      <chunk name="pro_mod_inf">
		<tags>
		  <tag><lit-tag v="SV"/></tag>
		  <tag><var n="tipus_verb"/></tag>
		  <tag><clip pos="3" side="tl" part="temps"/></tag>
		  <tag><lit-tag v="PD"/></tag>
		  <tag><lit-tag v="ND"/></tag>
		</tags> 
		<lu>
		  <var n="pronom"/>
		  <clip pos="5" side="tl" part="lem"/>
		  <clip pos="5" side="tl" part="a_prnpro"/>
		  <clip pos="5" side="tl" part="pers"/>
		  <clip pos="5" side="tl" part="gen"/>
		  <clip pos="5" side="tl" part="nbr"/>
		</lu>
		<b pos="2"/>
		<lu>   
		  <clip pos="3" side="tl" part="lemh"/>
		  <clip pos="3" side="tl" part="a_verb"/>
		  <clip pos="3" side="tl" part="temps" link-to="3"/>
		  <lit-tag v="4"/>
		  <lit-tag v="5"/>
		  <clip pos="3" side="tl" part="lemq"/>
		</lu> 
		<b pos="3"/>
		<lu>
		  <clip pos="4" side="tl" part="lemh"/> 
		  <clip pos="4" side="tl" part="a_verb"/>
		  <lit-tag v="inf"/>
		  <clip pos="4" side="tl" part="lemq"/> 
		</lu>
	      </chunk>
	    </out>
	    <call-macro n="f_bcond">
	      <with-param pos="4"/>
	    </call-macro>
	  </when>
	  <when>
	    <test>
	      <or>
		<equal caseless="yes">
		  <clip pos="1" side="sl" part="lem"/>
		  <lit v="may"/>
		</equal>
		<equal caseless="yes">
		  <clip pos="1" side="sl" part="lem"/>
		  <lit v="might"/>
		</equal>
	      </or>
	    </test>
	    <choose>
	      <when>
		<test>
		  <equal caseless="yes">
		    <clip pos="1" side="sl" part="lem"/>
		    <lit v="may"/>
		  </equal>
		</test>
		<let>
		  <clip pos="1" side="tl" part="temps"/>
		  <lit-tag v="pri"/>
		</let>
	      </when>
	      <when>
		<test>
		  <equal caseless="yes">
		    <clip pos="1" side="sl" part="lem"/>
		    <lit v="might"/>
		  </equal>
		</test>
		<let>
		  <clip pos="1" side="tl" part="temps"/>
		  <lit-tag v="cni"/>
		</let>
	      </when>
	    </choose>  
	    <out>
	      <chunk name="pro_auxmod_mod_inf">
		<tags>
		  <tag><lit-tag v="SV"/></tag>
		  <tag><var n="tipus_verb"/></tag>
		  <tag><clip pos="1" side="tl" part="temps"/></tag>
		  <tag><lit-tag v="PD"/></tag>
		  <tag><lit-tag v="ND"/></tag>
		</tags>      
		<lu>
		  <var n="pronom"/> 
		  <clip pos="5" side="tl" part="lem"/>
		  <clip pos="5" side="tl" part="a_prnpro"/>
		  <clip pos="5" side="tl" part="pers"/>
		  <clip pos="5" side="tl" part="gen"/>
		  <clip pos="5" side="tl" part="nbr"/>
		</lu>
		<b pos="2"/>
		<lu>
		  <clip pos="1" side="tl" part="lemh"/>
		  <clip pos="1" side="tl" part="a_verb"/>
		  <clip pos="1" side="tl" part="temps" link-to="3"/>
		  <lit-tag v="4"/>
		  <lit-tag v="5"/>
		  <clip pos="1" side="tl" part="lemq"/> 
		</lu>
		<b pos="3"/>
		<lu>
		  <clip pos="3" side="tl" part="lemh"/> 
		  <clip pos="3" side="tl" part="a_verb"/>
		  <lit-tag v="inf"/>			
		  <clip pos="3" side="tl" part="lemq"/>
		</lu>
		<b pos="4"/>
		<lu>
		  <clip pos="4" side="tl" part="lemh"/> 
		  <clip pos="4" side="tl" part="a_verb"/>
		  <lit-tag v="inf"/>
		  <clip pos="4" side="tl" part="lemq"/> 
		</lu>
	      </chunk>
	    </out>
	  </when>
	  <when>
	    <test>
	      <equal caseless="yes">
		<clip pos="1" side="sl" part="lem"/>
		<lit v="do"/>
	      </equal>
	    </test>
	    <choose>
	      <when>
		<test>
		  <or>
		    <equal>
		      <clip pos="1" side="sl" part="temps"/>
		      <lit-tag v="pres"/>
		    </equal>
		    <equal>
		      <clip pos="1" side="sl" part="temps"/>
		      <lit-tag v="pri"/>
		    </equal>
		  </or>
		</test>
		<choose>
		  <when>
		    <test>
		      <equal>
			<clip pos="1" side="sl" part="temps"/>
			<lit-tag v="pres"/>
		      </equal>
		    </test>
		    
		    <let>
		      <clip pos="3" side="tl" part="temps"/>
		      <lit-tag v="pri"/>
		    </let>
		    <let>
		      <var n="paraula2"/>
		      <clip pos="3" side="tl" part="lemh"/>
		    </let>
		    <append n="paraula2">
		      <clip pos="3" side="tl" part="tags"/>
		      <lit-tag v="PD"/>
		      <lit-tag v="ND"/>
		      <clip pos="3" side="tl" part="lemq"/>
		    </append>
		    <let>
		      <clip pos="3" side="tl" part="whole"/>
		      <var n="paraula2"/>
		    </let>
		  </when>
		  <when>
		    <test>
		      <equal>
			<clip pos="1" side="sl" part="temps"/>
			<lit-tag v="pri"/>
		      </equal>
		    </test>
		    <let>
		      <clip pos="3" side="tl" part="temps"/>
		      <lit-tag v="pri"/>
		    </let>
		    <let>
		      <var n="paraula2"/>
		      <clip pos="3" side="tl" part="lemh"/>
		    </let>
		    <append n="paraula2">
		      <clip pos="3" side="tl" part="tags"/>
		      <clip pos="1" side="sl" part="pers"/>
		      <clip pos="1" side="sl" part="nbr"/>
		      <clip pos="3" side="tl" part="lemq"/>
		    </append>
		    <let>
		      <clip pos="3" side="tl" part="whole"/>
		      <var n="paraula2"/>
		    </let>
		  </when>
		</choose>		    
		<out>
		  <chunk name="pro_mod_inf">
		    <tags>
		      <tag><lit-tag v="SV"/></tag>
		      <tag><var n="tipus_verb"/></tag>
		      <tag><clip pos="3" side="tl" part="temps"/></tag>
		      <tag><clip pos="3" side="tl" part="pers"/></tag>
		      <tag><clip pos="3" side="tl" part="nbr"/></tag>
		    </tags>      
		    <lu>
		      <var n="pronom"/>
		      <clip pos="5" side="tl" part="lem"/>
		      <clip pos="5" side="tl" part="a_prnpro"/>
		      <clip pos="5" side="tl" part="pers"/>
		      <clip pos="5" side="tl" part="gen"/>
		      <clip pos="5" side="tl" part="nbr"/>
		    </lu>
		    <b pos="2"/>
		    <lu>   
		      <clip pos="3" side="tl" part="lemh"/>
		      <clip pos="3" side="tl" part="a_verb"/>
		      <clip pos="3" side="tl" part="temps" link-to="3"/>
		      <clip pos="3" side="tl" part="pers" link-to="4"/>
		      <clip pos="3" side="tl" part="nbr" link-to="5"/>
		      <clip pos="3" side="tl" part="lemq"/>
		    </lu> 
		    <b pos="3"/>
		    <lu>
		      <clip pos="4" side="tl" part="lemh"/> 
		      <clip pos="4" side="tl" part="a_verb"/>
		      <lit-tag v="inf"/>
		      <clip pos="4" side="tl" part="lemq"/> 
		    </lu>
		  </chunk>
		</out>
		<call-macro n="f_bcond">
		  <with-param pos="4"/>
		</call-macro>
	      </when>
	      <when>
		<test>
		  <equal>
		    <clip pos="1" side="sl" part="temps"/>
		    <lit-tag v="past"/>
		  </equal> 
		</test>
		<out>
		  <chunk name="pro_mod_inf_perif">
		    <tags>
		      <tag><lit-tag v="SV"/></tag>
		      <tag><var n="tipus_verb"/></tag>
		      <tag><lit-tag v="ifip"/></tag>
		      <tag><lit-tag v="PD"/></tag>
		      <tag><lit-tag v="ND"/></tag>
		    </tags> 
		    <lu>
		      <var n="pronom"/>
		      <clip pos="5" side="tl" part="lem"/>
		      <clip pos="5" side="tl" part="a_prnpro"/>
		      <clip pos="5" side="tl" part="pers"/>
		      <clip pos="5" side="tl" part="gen"/>
		      <clip pos="5" side="tl" part="nbr"/>
		    </lu>
		    <b pos="2"/>
		    <lu>
		      <lit v="anar"/>
		      <lit-tag v="vaux"/>
		      <lit-tag v="4"/>
		      <lit-tag v="5"/>
		    </lu>
		    <b pos="3"/>
		    <lu>   
		      <clip pos="3" side="tl" part="lemh"/>
		      <clip pos="3" side="tl" part="a_verb"/>
		      <lit-tag v="inf"/>
		      <clip pos="3" side="tl" part="lemq"/>
		    </lu> 
		    <b pos="4"/>
		    <lu>
		      <clip pos="4" side="tl" part="lemh"/> 
		      <clip pos="4" side="tl" part="a_verb"/>
		      <lit-tag v="inf"/>
		      <clip pos="4" side="tl" part="lemq"/> 
		    </lu>
		  </chunk>
		</out>
	      </when>
	    </choose>
	  </when>
	</choose>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>


    <rule comment="HAVER ADV PARTICIPI (have always/not asked - Sempre/No han preguntat)">
      <pattern>
	<pattern-item n="have_aux"/>
	<pattern-item n="adv"/>
	<pattern-item n="pp"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>	
	<call-macro n="tipus_verbs">
	  <with-param pos="3"/>
	</call-macro>
	<call-macro n="pron">
	  <with-param pos="3"/>
	</call-macro>	
	<choose>
	  <when>
	    <test>
	      <in caseless="yes">
		<clip pos="2" side="sl" part="lem"/>
		<list n="adv_neg"/>
	      </in>
	    </test>
	    <let>
	      <var n="paraula2"/>
	      <clip pos="2" side="tl" part="whole"/>
	    </let>
	    <append n="paraula2">
	      <lit-tag v="NEG"/>
	    </append>
	    <let>
	      <clip pos="2" side="tl" part="whole"/>
	      <var n="paraula2"/>
	    </let>
	  </when>
	</choose>
	<out>
	  <chunk name="adv" case="caseFirstWord">
	    <tags>
	      <tag><clip pos="2" side="tl" part="a_adv"/></tag>
	      <tag><clip pos="2" side="tl" part="neg"/></tag>
	    </tags>
	    <lu>
	      <clip pos="2" side="tl" part="lem"/>
	      <clip pos="2" side="tl" part="a_adv"/>
	    </lu>
	  </chunk>
	  <b pos="1"/>
	</out>    

	<choose>
	  <when>
	    <test>
	      <or>
		<equal><!--De moment no sé si el tagger escull bé i els detecto els dos -->
		  <clip pos="1" side="sl" part="temps"/>
		  <lit-tag v="inf"/>
		</equal>
		<equal>
		  <clip pos="1" side="sl" part="temps"/>
		  <lit-tag v="pres"/>
		</equal>
	      </or>
	    </test>
	    <let>
	      <clip pos="1" side="tl" part="temps"/>
	      <lit-tag v="pri"/>
	    </let>
	  </when>
	  <when>
	    <test>
	      <equal>
		<clip pos="1" side="sl" part="temps"/>
		<lit-tag v="past"/>
	      </equal>
	    </test>
	    <let>
	      <clip pos="1" side="tl" part="temps"/>
	      <lit-tag v="pii"/>
	    </let>
	  </when>
	</choose>
	<choose>
	  <when>
	    <test>
	      <not>
		<and>
		  <equal>		 
		    <clip pos="1" side="tl" part="pers"/>
		    <lit-tag v="p3"/>
		  </equal>
		  <equal>		 
		    <clip pos="1" side="tl" part="nbr"/>
		    <lit-tag v="sg"/>
		  </equal>
		</and>
	      </not>
	    </test>
	    <let>
	      <var n="paraula1"/>
	      <clip pos="1" side="tl" part="lemh"/>
	    </let>
	    <append n="paraula1">
	      <clip pos="1" side="tl" part="tags"/>
	      <lit-tag v="PD"/>
	      <lit-tag v="ND"/>
	      <clip pos="1" side="tl" part="lemq"/>
	    </append>
	    <let>
	      <clip pos="1" side="tl" part="whole"/>
	      <var n="paraula1"/>
	    </let>
	  </when>
	</choose>
	<out>
	  <chunk name="have_pp" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SV"/></tag>
	      <tag><var n="tipus_verb"/></tag>
	      <tag><clip pos="1" side="tl" part="temps"/></tag>
	      <tag><clip pos="1" side="tl" part="pers"/></tag>
	      <tag><clip pos="1" side="tl" part="nbr"/></tag>
	    </tags> 
	    <lu>   
	      <var n="pronom"/> 
	      <clip pos="1" side="tl" part="lemh"/>
	      <clip pos="1" side="tl" part="a_verb"/>
	      <clip pos="1" side="tl" part="temps" link-to="3"/>
	      <clip pos="1" side="tl" part="pers" link-to="4"/>
	      <clip pos="1" side="tl" part="nbr" link-to="5"/>
	      <clip pos="1" side="tl" part="lemq"/> 
	    </lu> 
	    <b pos="2"/>
	    <lu>
	      <clip pos="3" side="tl" part="lemh"/> 
	      <clip pos="3" side="tl" part="a_pp"/>
	      <lit-tag v="m.sg"/>
	      <clip pos="3" side="tl" part="lemq"/> 
	    </lu>
	  </chunk>
	</out>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>

    <rule comment="PRONOM HAVER PARTICIPI clític (have always/not asked it- Sempre/No l'han preguntat)">
      <pattern>
	<pattern-item n="have_aux"/>
	<pattern-item n="adv"/>
	<pattern-item n="pp"/>
	<pattern-item n="probj"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>	
	<call-macro n="tipus_verbs">
	  <with-param pos="3"/>
	</call-macro>
	<call-macro n="pron">
	  <with-param pos="3"/>
	</call-macro>
	
	<choose>
	  <when>
	    <test>
	      <in caseless="yes">
		<clip pos="2" side="sl" part="lem"/>
		<list n="adv_neg"/>
	      </in>
	    </test>
	    <let>
	      <var n="paraula2"/>
	      <clip pos="2" side="tl" part="whole"/>
	    </let>
	    <append n="paraula2">
	      <lit-tag v="NEG"/>
	    </append>
	    <let>
	      <clip pos="2" side="tl" part="whole"/>
	      <var n="paraula2"/>
	    </let>
	  </when>
	</choose>
	<out>
	  <chunk name="adv" case="caseFirstWord">
	    <tags>
	      <tag><clip pos="2" side="tl" part="a_adv"/></tag>
	      <tag><clip pos="2" side="tl" part="neg"/></tag>
	    </tags>
	    <lu>
	      <clip pos="2" side="tl" part="lem"/>
	      <clip pos="2" side="tl" part="a_adv"/>
	    </lu>
	  </chunk>
	  <b pos="1"/>
	</out>    
	
	<choose>
	  <when>
	    <test>
	      <or>
		<equal><!--De moment no sé si el tagger escull bé i els detecto els dos -->
		  <clip pos="1" side="sl" part="temps"/>
		  <lit-tag v="inf"/>
		</equal>
		<equal>
		  <clip pos="1" side="sl" part="temps"/>
		  <lit-tag v="pres"/>
		</equal>
	      </or>
	    </test>
	    <let>
	      <clip pos="1" side="tl" part="temps"/>
	      <lit-tag v="pri"/>
	    </let>
	  </when>
	  <when>
	    <test>
	      <equal>
		<clip pos="1" side="sl" part="temps"/>
		<lit-tag v="past"/>
	      </equal>
	    </test>
	    <let>
	      <clip pos="1" side="tl" part="temps"/>
	      <lit-tag v="pii"/>
	    </let>
	  </when>
	</choose>
	<choose>
	  <when>
	    <test>
	      <not>
		<and>
		  <equal>		 
		    <clip pos="1" side="tl" part="pers"/>
		    <lit-tag v="p3"/>
		  </equal>
		  <equal>		 
		    <clip pos="1" side="tl" part="nbr"/>
		    <lit-tag v="sg"/>
		  </equal>
		</and>
	      </not>
	    </test>
	    <let>
	      <var n="paraula1"/>
	      <clip pos="1" side="tl" part="lemh"/>
	    </let>
	    <append n="paraula1">
	      <clip pos="1" side="tl" part="tags"/>
	      <lit-tag v="PD"/>
	      <lit-tag v="ND"/>
	      <clip pos="1" side="tl" part="lemq"/>
	    </append>
	    <let>
	      <clip pos="1" side="tl" part="whole"/>
	      <var n="paraula1"/>
	    </let>
	  </when>
	</choose>
	<out>
	  <chunk name="pro_have_pp" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SV"/></tag>
	      <tag><var n="tipus_verb"/></tag>
	      <tag><clip pos="1" side="tl" part="temps"/></tag>
	      <tag><clip pos="1" side="tl" part="pers"/></tag>
	      <tag><clip pos="1" side="tl" part="nbr"/></tag>
	    </tags> 
	    <lu>
	      <var n="pronom"/>
	      <clip pos="4" side="tl" part="lem"/>
	      <clip pos="4" side="tl" part="a_prnpro"/>
	      <clip pos="4" side="tl" part="pers"/>
	      <clip pos="4" side="tl" part="gen"/>
	      <clip pos="4" side="tl" part="nbr"/>
	    </lu>
	    <b pos="2"/>
	    <lu>   
	      <clip pos="1" side="tl" part="lemh"/>
	      <clip pos="1" side="tl" part="a_verb"/>
	      <clip pos="1" side="tl" part="temps" link-to="3"/>
	      <clip pos="1" side="tl" part="pers" link-to="4"/>
	      <clip pos="1" side="tl" part="nbr" link-to="5"/>
	      <clip pos="1" side="tl" part="lemq"/> 
	    </lu> 
	    <b pos="3"/>
	    <lu>
	      <clip pos="3" side="tl" part="lemh"/> 
	      <clip pos="3" side="tl" part="a_pp"/>
	      <lit-tag v="m.sg"/>
	      <clip pos="3" side="tl" part="lemq"/> 
	    </lu>
	  </chunk>
	</out>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>



<!--pingui would have-->

   <rule comment="AUXtemps HAVER PARTICIPI (would have finished - hauria acabat)">
      <pattern>
	<pattern-item n="auxtemps"/>
	<pattern-item n="have_aux_inf"/>
	<pattern-item n="pp"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>	
	<call-macro n="tipus_verbs">
	  <with-param pos="3"/>
	</call-macro>
	<call-macro n="pron">
	  <with-param pos="3"/>
	</call-macro>
	<choose>
          <when>
            <test>
              <or>
                <equal caseless="yes">
                  <clip pos="1" side="sl" part="lem"/>
                  <lit v="will"/>
                </equal>
                <equal caseless="yes">
                  <clip pos="1" side="sl" part="lem"/>
                  <lit v="shall"/>
                </equal>
              </or>
            </test>
            <let>
              <clip pos="2" side="tl" part="temps"/>
              <lit-tag v="fti"/>
            </let>
          </when>
          <when>
            <test>
              <equal caseless="yes">
                <clip pos="1" side="sl" part="lem"/>
                <lit v="would"/>
              </equal>
            </test>
            <let>
              <clip pos="2" side="tl" part="temps"/>
              <lit-tag v="cni"/>
            </let>
          </when>
        </choose>
	<call-macro n="f_bcond">
	  <with-param pos="1"/>
	</call-macro>
	<out>
	  <chunk name="have_pp" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SV"/></tag>
	      <tag><var n="tipus_verb"/></tag>
	      <tag><clip pos="2" side="tl" part="temps"/></tag>
	      <tag><lit-tag v="PD"/></tag>
	      <tag><lit-tag v="ND"/></tag>
	    </tags> 
	    <lu>   
	      <var n="pronom"/> 
	      <clip pos="2" side="tl" part="lemh"/>
	      <clip pos="2" side="tl" part="a_verb"/>
	      <clip pos="2" side="tl" part="temps" link-to="3"/>
              <lit-tag v="4"/>
              <lit-tag v="5"/>
	      <clip pos="2" side="tl" part="lemq"/> 
	    </lu> 
	    <b pos="2"/>
	    <lu>
	      <clip pos="3" side="tl" part="lemh"/> 
	      <clip pos="3" side="tl" part="a_pp"/>
	      <lit-tag v="m.sg"/>
	      <clip pos="3" side="tl" part="lemq"/> 
	    </lu>
	  </chunk>
	</out>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>


   <rule comment="AUXmod HAVER PARTICIPI (might have finished - podria haver acabat)">
      <pattern>
	<pattern-item n="auxmod"/>
	<pattern-item n="have_aux_inf"/>
	<pattern-item n="pp"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>	
	<call-macro n="tipus_verbs">
	  <with-param pos="3"/>
	</call-macro>
	<call-macro n="pron">
	  <with-param pos="3"/>
	</call-macro>
	<choose>     
	  <when>
	    <test>
	      <and>
		<equal caseless="yes">
		  <clip pos="1" side="sl" part="lem"/>
		  <lit v="can"/>
		</equal>
		<equal>
		  <clip pos="1" side="sl" part="temps"/>
		  <lit-tag v="pres"/>
		</equal>
	      </and>
	    </test>
	    <let>
	      <clip pos="1" side="tl" part="temps"/>
	      <lit-tag v="pri"/>
	    </let>
	  </when>
	  <when>
	    <test>
	      <and>
		<equal caseless="yes">
		  <clip pos="1" side="sl" part="lem"/>
		  <lit v="can"/>
		</equal>
		<equal>
		  <clip pos="1" side="sl" part="temps"/>
		  <lit-tag v="past"/>
		</equal>
	      </and>
	    </test>
	    <let>
	      <clip pos="1" side="tl" part="temps"/>
	      <lit-tag v="cni"/>
	    </let>
	  </when>
	  <when>
	    <test>
	      <or>
		<equal caseless="yes">
		  <clip pos="1" side="sl" part="lem"/>
		  <lit v="must"/>
		</equal>
		<equal caseless="yes">
		  <clip pos="1" side="sl" part="lem"/>
		  <lit v="may"/>
		</equal>
	      </or>
	    </test>
	    <let>
	      <clip pos="1" side="tl" part="temps"/>
	      <lit-tag v="pri"/>
	    </let>
	  </when>
	  <when>
	    <test>
	      <or>
		<equal caseless="yes">
		  <clip pos="1" side="sl" part="lem"/>
		  <lit v="should"/>
		</equal>
		<equal caseless="yes">
		  <clip pos="1" side="sl" part="lem"/>
		  <lit v="might"/>
		</equal>
	      </or>
	    </test>
	    <let>
	      <clip pos="1" side="tl" part="temps"/>
	      <lit-tag v="cni"/>
	    </let>
	  </when>
	</choose>
	<out>
	  <chunk name="auxmod_have_pp" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SV"/></tag>
	      <tag><var n="tipus_verb"/></tag>
	      <tag><clip pos="1" side="tl" part="temps"/></tag>
	      <tag><lit-tag v="PD"/></tag>
	      <tag><lit-tag v="ND"/></tag>
	    </tags>   
	    <lu>
	      <var n="pronom"/> 
	      <clip pos="1" side="tl" part="lemh"/>
	      <clip pos="1" side="tl" part="a_verb"/>
	      <clip pos="1" side="tl" part="temps" link-to="3"/>
	      <lit-tag v="4"/>
	      <lit-tag v="5"/>
	      <clip pos="1" side="tl" part="lemq"/>
	    </lu>
	    <b pos="1"/>
	    <lu>   
	      <clip pos="2" side="tl" part="lemh"/>
	      <clip pos="2" side="tl" part="a_verb"/>
	      <lit-tag v="inf"/>		
	      <clip pos="2" side="tl" part="lemq"/> 
	    </lu> 
	    <b pos="2"/>
	    <lu>
	      <clip pos="3" side="tl" part="lemh"/> 
	      <clip pos="3" side="tl" part="a_pp"/>
	      <lit-tag v="m.sg"/>
	      <clip pos="3" side="tl" part="lemq"/> 
	    </lu>
	  </chunk>
	</out>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>



    <rule comment="AUXtemps HAVER PARTICIPI clític (would have finished it - l'hauria acabat)">
      <pattern>
	<pattern-item n="auxtemps"/>
	<pattern-item n="have_aux_inf"/>
	<pattern-item n="pp"/>
	<pattern-item n="probj"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>	
	<call-macro n="tipus_verbs">
	  <with-param pos="3"/>
	</call-macro>
	<call-macro n="pron">
	  <with-param pos="3"/>
	</call-macro>
	<choose>
          <when>
            <test>
              <or>
                <equal caseless="yes">
                  <clip pos="1" side="sl" part="lem"/>
                  <lit v="will"/>
                </equal>
                <equal caseless="yes">
                  <clip pos="1" side="sl" part="lem"/>
                  <lit v="shall"/>
                </equal>
              </or>
            </test>
            <let>
              <clip pos="2" side="tl" part="temps"/>
              <lit-tag v="fti"/>
            </let>
          </when>
          <when>
            <test>
              <equal caseless="yes">
                <clip pos="1" side="sl" part="lem"/>
                <lit v="would"/>
              </equal>
            </test>
            <let>
              <clip pos="2" side="tl" part="temps"/>
              <lit-tag v="cni"/>
            </let>
          </when>
        </choose>

	    <out>
	      <chunk name="pro_have_pp" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="SV"/></tag>
		  <tag><var n="tipus_verb"/></tag>
		  <tag><clip pos="2" side="tl" part="temps"/></tag>
		  <tag><lit-tag v="PD"/></tag>
		  <tag><lit-tag v="ND"/></tag>
		</tags> 
		<lu>
		  <var n="pronom"/>
		  <clip pos="4" side="tl" part="lem"/>
		  <clip pos="4" side="tl" part="a_prnpro"/>
		  <clip pos="4" side="tl" part="pers"/>
		  <clip pos="4" side="tl" part="gen"/>
		  <clip pos="4" side="tl" part="nbr"/>
		</lu>
		<b pos="1"/>
		<lu>   
		  <clip pos="2" side="tl" part="lemh"/>
		  <clip pos="2" side="tl" part="a_verb"/>
		  <clip pos="2" side="tl" part="temps" link-to="3"/>
		  <lit-tag v="4"/>
		  <lit-tag v="5"/>
		  <clip pos="2" side="tl" part="lemq"/> 
		</lu> 
		<b pos="2"/>
		<lu>
		  <clip pos="3" side="tl" part="lemh"/> 
		  <clip pos="3" side="tl" part="a_pp"/>
		  <lit-tag v="m.sg"/>
		  <clip pos="3" side="tl" part="lemq"/> 
		</lu>
	      </chunk>
	    </out>
	    <call-macro n="f_bcond">
	      <with-param pos="3"/>
	    </call-macro>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>


  <rule comment="AUXmod HAVER PARTICIPI clític (might have finished it - el podria haver acabat)">
      <pattern>
	<pattern-item n="auxmod"/>
	<pattern-item n="have_aux_inf"/>
	<pattern-item n="pp"/>
	<pattern-item n="probj"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>	
	<call-macro n="tipus_verbs">
	  <with-param pos="3"/>
	</call-macro>
	<call-macro n="pron">
	  <with-param pos="3"/>
	</call-macro>

	<choose>     
	  <when>
	    <test>
	      <and>
		<equal caseless="yes">
		  <clip pos="1" side="sl" part="lem"/>
		  <lit v="can"/>
		</equal>
		<equal>
		  <clip pos="1" side="sl" part="temps"/>
		  <lit-tag v="pres"/>
		</equal>
	      </and>
	    </test>
	    <let>
	      <clip pos="1" side="tl" part="temps"/>
	      <lit-tag v="pri"/>
	    </let>
	  </when>
	  <when>
	    <test>
	      <and>
		<equal caseless="yes">
		  <clip pos="1" side="sl" part="lem"/>
		  <lit v="can"/>
		</equal>
		<equal>
		  <clip pos="1" side="sl" part="temps"/>
		  <lit-tag v="past"/>
		</equal>
	      </and>
	    </test>
	    <let>
	      <clip pos="1" side="tl" part="temps"/>
	      <lit-tag v="cni"/>
	    </let>
	  </when>
	  <when>
	    <test>
	      <or>
		<equal caseless="yes">
		  <clip pos="1" side="sl" part="lem"/>
		  <lit v="must"/>
		</equal>
		<equal caseless="yes">
		  <clip pos="1" side="sl" part="lem"/>
		  <lit v="may"/>
		</equal>
	      </or>
	    </test>
	    <let>
	      <clip pos="1" side="tl" part="temps"/>
	      <lit-tag v="pri"/>
	    </let>
	  </when>
	  <when>
	    <test>
	      <or>
		<equal caseless="yes">
		  <clip pos="1" side="sl" part="lem"/>
		  <lit v="should"/>
		</equal>
		<equal caseless="yes">
		  <clip pos="1" side="sl" part="lem"/>
		  <lit v="might"/>
		</equal>
	      </or>
	    </test>
	    <let>
	      <clip pos="1" side="tl" part="temps"/>
	      <lit-tag v="cni"/>
	    </let>
	  </when>
	</choose>

	<out>
	  <chunk name="pro_auxmod_have_pp" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SV"/></tag>
	      <tag><var n="tipus_verb"/></tag>
	      <tag><clip pos="1" side="tl" part="temps"/></tag>
	      <tag><lit-tag v="PD"/></tag>
	      <tag><lit-tag v="ND"/></tag>
	    </tags> 
	    <lu>
	      <var n="pronom"/>
	      <clip pos="4" side="tl" part="lem"/>
	      <clip pos="4" side="tl" part="a_prnpro"/>
	      <clip pos="4" side="tl" part="pers"/>
	      <clip pos="4" side="tl" part="gen"/>
	      <clip pos="4" side="tl" part="nbr"/>
	    </lu>
	    <b pos="1"/>
	    <lu>
	      <clip pos="1" side="tl" part="lemh"/>
	      <clip pos="1" side="tl" part="a_verb"/>
	      <clip pos="1" side="tl" part="temps" link-to="3"/>
	      <lit-tag v="4"/>
	      <lit-tag v="5"/>
	      <clip pos="1" side="tl" part="lemq"/>
	    </lu>
	    <b pos="2"/>
	    <lu>   
	      <clip pos="2" side="tl" part="lemh"/>
	      <clip pos="2" side="tl" part="a_verb"/>
	      <lit-tag v="inf"/>		
	      <clip pos="2" side="tl" part="lemq"/> 
	    </lu> 
	    <b pos="3"/>
	    <lu>
	      <clip pos="3" side="tl" part="lemh"/> 
	      <clip pos="3" side="tl" part="a_pp"/>
	      <lit-tag v="m.sg"/>
	      <clip pos="3" side="tl" part="lemq"/> 
	    </lu>
	  </chunk>
	</out>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>


    <rule comment="AUXtemps HAVER PARTICIPIcontrolverb TO INF (would have decided to come)">
      <pattern>
	<pattern-item n="auxtemps"/>
	<pattern-item n="have_aux_inf"/>
	<pattern-item n="controlverbpp"/>
        <pattern-item n="to"/>
        <pattern-item n="inf"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>	
	<call-macro n="tipus_verbs">
	  <with-param pos="3"/>
	</call-macro>
	<call-macro n="tipus_verbs2">
	  <with-param pos="5"/>
	</call-macro>
	<call-macro n="pronenc">
	  <with-param pos="5"/>
	</call-macro>	
	<choose>
	  <when>
	    <test>
	      <equal>
		  <clip pos="3" side="sl" part="lem"/>
		  <lit v="try"/>
	      </equal>
	    </test>
	    <let>
	      <clip pos="3" side="tl" part="lem"/>
	      <lit v="intentar"/>
	    </let>
	  </when>
	</choose>
	<choose>
          <when>
            <test>
              <or>
                <equal caseless="yes">
                  <clip pos="1" side="sl" part="lem"/>
                  <lit v="will"/>
                </equal>
                <equal caseless="yes">
                  <clip pos="1" side="sl" part="lem"/>
                  <lit v="shall"/>
                </equal>
              </or>
            </test>
            <let>
              <clip pos="2" side="tl" part="temps"/>
              <lit-tag v="fti"/>
            </let>
          </when>
          <when>
            <test>
              <equal caseless="yes">
                <clip pos="1" side="sl" part="lem"/>
                <lit v="would"/>
              </equal>
            </test>
            <let>
              <clip pos="2" side="tl" part="temps"/>
              <lit-tag v="cni"/>
            </let>
          </when>
        </choose>
	<call-macro n="f_bcond">
	  <with-param pos="1"/>
	</call-macro>
	<out>
	  <chunk name="have_pp_inf" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SV"/></tag>
	      <tag><var n="tipus_verb"/></tag>
	      <tag><clip pos="2" side="tl" part="temps"/></tag>
	      <tag><lit-tag v="PD"/></tag>
	      <tag><lit-tag v="ND"/></tag>
	    </tags> 
	    <lu>   
	      <var n="pronom"/> 
	      <clip pos="2" side="tl" part="lemh"/>
	      <clip pos="2" side="tl" part="a_verb"/>
	      <clip pos="2" side="tl" part="temps" link-to="3"/>
              <lit-tag v="4"/>
              <lit-tag v="5"/>
	      <clip pos="2" side="tl" part="lemq"/> 
	    </lu> 
	    <b pos="2"/>
	    <lu>
	      <clip pos="3" side="tl" part="lemh"/> 
	      <clip pos="3" side="tl" part="a_pp"/>
	      <lit-tag v="m.sg"/>
	      <clip pos="3" side="tl" part="lemq"/> 
	    </lu>
	    <b pos="3"/>
	    <lu>
	      <clip pos="5" side="tl" part="lemh"/>
	      <clip pos="5" side="tl" part="a_verb"/>
	      <lit-tag v="inf"/>
	      <var n="pronomenc"/>
	      <clip pos="5" side="tl" part="lemq"/>
	    </lu>
	  </chunk>
	</out>
	<call-macro n="f_bcond">
	  <with-param pos="4"/>
	</call-macro>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>

   <rule comment="AUXmod HAVER PARTICIPIcontrolverb TO INF (should have decided to come)">
      <pattern>
	<pattern-item n="auxmod"/>
	<pattern-item n="have_aux_inf"/>
	<pattern-item n="controlverbpp"/>
        <pattern-item n="to"/>
        <pattern-item n="inf"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>	
	<call-macro n="tipus_verbs">
	  <with-param pos="3"/>
	</call-macro>
	<call-macro n="tipus_verbs2">
	  <with-param pos="5"/>
	</call-macro>
	<call-macro n="pronenc">
	  <with-param pos="5"/>
	</call-macro>	
	<choose>
	  <when>
	    <test>
	      <equal>
		  <clip pos="3" side="sl" part="lem"/>
		  <lit v="try"/>
	      </equal>
	    </test>
	    <let>
	      <clip pos="3" side="tl" part="lem"/>
	      <lit v="intentar"/>
	    </let>
	  </when>
	</choose>
	<choose>     
	  <when>
	    <test>
	      <and>
		<equal caseless="yes">
		  <clip pos="1" side="sl" part="lem"/>
		  <lit v="can"/>
		</equal>
		<equal>
		  <clip pos="1" side="sl" part="temps"/>
		  <lit-tag v="pres"/>
		</equal>
	      </and>
	    </test>
	    <let>
	      <clip pos="1" side="tl" part="temps"/>
	      <lit-tag v="pri"/>
	    </let>
	  </when>
	  <when>
	    <test>
	      <and>
		<equal caseless="yes">
		  <clip pos="1" side="sl" part="lem"/>
		  <lit v="can"/>
		</equal>
		<equal>
		  <clip pos="1" side="sl" part="temps"/>
		  <lit-tag v="past"/>
		</equal>
	      </and>
	    </test>
	    <let>
	      <clip pos="1" side="tl" part="temps"/>
	      <lit-tag v="cni"/>
	    </let>
	  </when>
	  <when>
	    <test>
	      <or>
		<equal caseless="yes">
		  <clip pos="1" side="sl" part="lem"/>
		  <lit v="must"/>
		</equal>
		<equal caseless="yes">
		  <clip pos="1" side="sl" part="lem"/>
		  <lit v="may"/>
		</equal>
	      </or>
	    </test>
	    <let>
	      <clip pos="1" side="tl" part="temps"/>
	      <lit-tag v="pri"/>
	    </let>
	  </when>
	  <when>
	    <test>
	      <or>
		<equal caseless="yes">
		  <clip pos="1" side="sl" part="lem"/>
		  <lit v="should"/>
		</equal>
		<equal caseless="yes">
		  <clip pos="1" side="sl" part="lem"/>
		  <lit v="might"/>
		</equal>
	      </or>
	    </test>
	    <let>
	      <clip pos="1" side="tl" part="temps"/>
	      <lit-tag v="cni"/>
	    </let>
	  </when>
	</choose>
	<out>
	  <chunk name="auxmod_have_pp_inf" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SV"/></tag>
	      <tag><var n="tipus_verb"/></tag>
	      <tag><clip pos="1" side="tl" part="temps"/></tag>
	      <tag><lit-tag v="PD"/></tag>
	      <tag><lit-tag v="ND"/></tag>
	    </tags> 
	    <lu>   
	      <var n="pronom"/> 
	      <clip pos="1" side="tl" part="lemh"/>
	      <clip pos="1" side="tl" part="a_verb"/>
	      <clip pos="1" side="tl" part="temps" link-to="3"/>
              <lit-tag v="4"/>
              <lit-tag v="5"/>
	      <clip pos="1" side="tl" part="lemq"/> 
	    </lu> 
	    <b pos="1"/>
	    <lu>   
	      <clip pos="2" side="tl" part="lemh"/>
	      <clip pos="2" side="tl" part="a_verb"/>
	      <lit-tag v="inf"/>		
	      <clip pos="2" side="tl" part="lemq"/> 
	    </lu> 
	    <b pos="2"/>
	    <lu>
	      <clip pos="3" side="tl" part="lemh"/> 
	      <clip pos="3" side="tl" part="a_pp"/>
	      <lit-tag v="m.sg"/>
	      <clip pos="3" side="tl" part="lemq"/> 
	    </lu>
	    <b pos="3"/>
	    <lu>
	      <clip pos="5" side="tl" part="lemh"/>
	      <clip pos="5" side="tl" part="a_verb"/>
	      <lit-tag v="inf"/>
	      <var n="pronomenc"/>
	      <clip pos="5" side="tl" part="lemq"/>
	    </lu>
	  </chunk>
	</out>
	<call-macro n="f_bcond">
	  <with-param pos="4"/>
	</call-macro>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>



    <rule comment="AUXtemps ADV HAVER PARTICIPI (would always/not have asked - Sempre/No hauria preguntat)">
      <pattern>
	<pattern-item n="auxtemps"/>
	<pattern-item n="adv"/>
	<pattern-item n="have_aux_inf"/>
	<pattern-item n="pp"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>	
	<call-macro n="tipus_verbs">
	  <with-param pos="4"/>
	</call-macro>
	<call-macro n="pron">
	  <with-param pos="4"/>
	</call-macro>	
	<choose>
	  <when>
	    <test>
	      <in caseless="yes">
		<clip pos="2" side="sl" part="lem"/>
		<list n="adv_neg"/>
	      </in>
	    </test>
	    <let>
	      <var n="paraula2"/>
	      <clip pos="2" side="tl" part="whole"/>
	    </let>
	    <append n="paraula2">
	      <lit-tag v="NEG"/>
	    </append>
	    <let>
	      <clip pos="2" side="tl" part="whole"/>
	      <var n="paraula2"/>
	    </let>
	  </when>
	</choose>
	<out>
	  <chunk name="adv" case="caseFirstWord">
	    <tags>
	      <tag><clip pos="2" side="tl" part="a_adv"/></tag>
	      <tag><clip pos="2" side="tl" part="neg"/></tag>
	    </tags>
	    <lu>
	      <clip pos="2" side="tl" part="lem"/>
	      <clip pos="2" side="tl" part="a_adv"/>
	    </lu>
	  </chunk>
	  <b pos="1"/>
	</out>    
	<choose>
          <when>
            <test>
              <or>
                <equal caseless="yes">
                  <clip pos="1" side="sl" part="lem"/>
                  <lit v="will"/>
                </equal>
                <equal caseless="yes">
                  <clip pos="1" side="sl" part="lem"/>
                  <lit v="shall"/>
                </equal>
              </or>
            </test>
            <let>
              <clip pos="3" side="tl" part="temps"/>
              <lit-tag v="fti"/>
            </let>
          </when>
          <when>
            <test>
              <equal caseless="yes">
                <clip pos="1" side="sl" part="lem"/>
                <lit v="would"/>
              </equal>
            </test>
            <let>
              <clip pos="3" side="tl" part="temps"/>
              <lit-tag v="cni"/>
            </let>
          </when>
        </choose>	
	<out>
	  <chunk name="have_pp" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SV"/></tag>
	      <tag><var n="tipus_verb"/></tag>
	      <tag><clip pos="3" side="tl" part="temps"/></tag>
	      <tag><lit-tag v="PD"/></tag>
	      <tag><lit-tag v="ND"/></tag>
	    </tags> 
	    <lu>   
	      <var n="pronom"/> 
	      <clip pos="3" side="tl" part="lemh"/>
	      <clip pos="3" side="tl" part="a_verb"/>
	      <clip pos="3" side="tl" part="temps" link-to="3"/>
              <lit-tag v="4"/>
              <lit-tag v="5"/>
	      <clip pos="3" side="tl" part="lemq"/> 
	    </lu> 
	    <b pos="2"/>
	    <lu>
	      <clip pos="4" side="tl" part="lemh"/> 
	      <clip pos="4" side="tl" part="a_pp"/>
	      <lit-tag v="m.sg"/>
	      <clip pos="4" side="tl" part="lemq"/> 
	    </lu>
	  </chunk>
	</out>
	<call-macro n="f_bcond">
	  <with-param pos="3"/>
	</call-macro>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>


 <rule comment="AUXmod ADV HAVER PARTICIPI (should always/not have asked - Sempre/No hauria d'haver preguntat)">
      <pattern>
	<pattern-item n="auxmod"/>
	<pattern-item n="adv"/>
	<pattern-item n="have_aux_inf"/>
	<pattern-item n="pp"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>	
	<call-macro n="tipus_verbs">
	  <with-param pos="4"/>
	</call-macro>
	<call-macro n="pron">
	  <with-param pos="4"/>
	</call-macro>	
	<choose>
	  <when>
	    <test>
	      <in caseless="yes">
		<clip pos="2" side="sl" part="lem"/>
		<list n="adv_neg"/>
	      </in>
	    </test>
	    <let>
	      <var n="paraula2"/>
	      <clip pos="2" side="tl" part="whole"/>
	    </let>
	    <append n="paraula2">
	      <lit-tag v="NEG"/>
	    </append>
	    <let>
	      <clip pos="2" side="tl" part="whole"/>
	      <var n="paraula2"/>
	    </let>
	  </when>
	</choose>
	<out>
	  <chunk name="adv" case="caseFirstWord">
	    <tags>
	      <tag><clip pos="2" side="tl" part="a_adv"/></tag>
	      <tag><clip pos="2" side="tl" part="neg"/></tag>
	    </tags>
	    <lu>
	      <clip pos="2" side="tl" part="lem"/>
	      <clip pos="2" side="tl" part="a_adv"/>
	    </lu>
	  </chunk>
	  <b pos="1"/>
	</out> 
	
	<choose>     
	  <when>
	    <test>
	      <and>
		<equal caseless="yes">
		  <clip pos="1" side="sl" part="lem"/>
		  <lit v="can"/>
		</equal>
		<equal>
		  <clip pos="1" side="sl" part="temps"/>
		  <lit-tag v="pres"/>
		</equal>
	      </and>
	    </test>
	    <let>
	      <clip pos="1" side="tl" part="temps"/>
	      <lit-tag v="pri"/>
	    </let>
	  </when>
	  <when>
	    <test>
	      <and>
		<equal caseless="yes">
		  <clip pos="1" side="sl" part="lem"/>
		  <lit v="can"/>
		</equal>
		<equal>
		  <clip pos="1" side="sl" part="temps"/>
		  <lit-tag v="past"/>
		</equal>
	      </and>
	    </test>
	    <let>
	      <clip pos="1" side="tl" part="temps"/>
	      <lit-tag v="cni"/>
	    </let>
	  </when>
	  <when>
	    <test>
	      <or>
		<equal caseless="yes">
		  <clip pos="1" side="sl" part="lem"/>
		  <lit v="must"/>
		</equal>
		<equal caseless="yes">
		  <clip pos="1" side="sl" part="lem"/>
		  <lit v="may"/>
		</equal>
	      </or>
	    </test>
	    <let>
	      <clip pos="1" side="tl" part="temps"/>
	      <lit-tag v="pri"/>
	    </let>
	  </when>
	  <when>
	    <test>
	      <or>
		<equal caseless="yes">
		  <clip pos="1" side="sl" part="lem"/>
		  <lit v="should"/>
		</equal>
		<equal caseless="yes">
		  <clip pos="1" side="sl" part="lem"/>
		  <lit v="might"/>
		</equal>
	      </or>
	    </test>
	    <let>
	      <clip pos="1" side="tl" part="temps"/>
	      <lit-tag v="cni"/>
	    </let>
	  </when>
	</choose>
	<out>
	  <chunk name="auxmod_have_pp" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SV"/></tag>
	      <tag><var n="tipus_verb"/></tag>
	      <tag><clip pos="1" side="tl" part="temps"/></tag>
	      <tag><lit-tag v="PD"/></tag>
	      <tag><lit-tag v="ND"/></tag>
	    </tags> 
	    <lu>   
	      <var n="pronom"/> 
	      <clip pos="1" side="tl" part="lemh"/>
	      <clip pos="1" side="tl" part="a_verb"/>
	      <clip pos="1" side="tl" part="temps" link-to="3"/>
              <lit-tag v="4"/>
              <lit-tag v="5"/>
	      <clip pos="1" side="tl" part="lemq"/> 
	    </lu> 
	    <b pos="2"/>
	    <lu>   
	      <clip pos="3" side="tl" part="lemh"/>
	      <clip pos="3" side="tl" part="a_verb"/>
	      <lit-tag v="inf"/>		
	      <clip pos="3" side="tl" part="lemq"/> 
	    </lu> 
	    <b pos="3"/>
	    <lu>
	      <clip pos="4" side="tl" part="lemh"/> 
	      <clip pos="4" side="tl" part="a_pp"/>
	      <lit-tag v="m.sg"/>
	      <clip pos="4" side="tl" part="lemq"/> 
	    </lu>
	  </chunk>
	</out>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>

    <rule comment="AUXtemps PRONOM HAVER PARTICIPI clític (would always/not have asked it- Sempre/No ho hauria preguntat)">
      <pattern>
	<pattern-item n="auxtemps"/>
	<pattern-item n="adv"/>
	<pattern-item n="have_aux_inf"/>
	<pattern-item n="pp"/>
	<pattern-item n="probj"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>	
	<call-macro n="tipus_verbs">
	  <with-param pos="4"/>
	</call-macro>
	<call-macro n="pron">
	  <with-param pos="4"/>
	</call-macro>
	
	<choose>
	  <when>
	    <test>
	      <in caseless="yes">
		<clip pos="2" side="sl" part="lem"/>
		<list n="adv_neg"/>
	      </in>
	    </test>
	    <let>
	      <var n="paraula2"/>
	      <clip pos="2" side="tl" part="whole"/>
	    </let>
	    <append n="paraula2">
	      <lit-tag v="NEG"/>
	    </append>
	    <let>
	      <clip pos="2" side="tl" part="whole"/>
	      <var n="paraula2"/>
	    </let>
	  </when>
	</choose>
	<out>
	  <chunk name="adv" case="caseFirstWord">
	    <tags>
	      <tag><clip pos="2" side="tl" part="a_adv"/></tag>
	      <tag><clip pos="2" side="tl" part="neg"/></tag>
	    </tags>
	    <lu>
	      <clip pos="2" side="tl" part="lem"/>
	      <clip pos="2" side="tl" part="a_adv"/>
	    </lu>
	  </chunk>
	  <b pos="1"/>
	</out>    

	<choose>
          <when>
            <test>
              <or>
                <equal caseless="yes">
                  <clip pos="1" side="sl" part="lem"/>
                  <lit v="will"/>
                </equal>
                <equal caseless="yes">
                  <clip pos="1" side="sl" part="lem"/>
                  <lit v="shall"/>
                </equal>
              </or>
            </test>
            <let>
              <clip pos="3" side="tl" part="temps"/>
              <lit-tag v="fti"/>
            </let>
          </when>
          <when>
            <test>
              <equal caseless="yes">
                <clip pos="1" side="sl" part="lem"/>
                <lit v="would"/>
              </equal>
            </test>
            <let>
              <clip pos="3" side="tl" part="temps"/>
              <lit-tag v="cni"/>
            </let>
          </when>
        </choose>
	<out>
	  <chunk name="pro_have_pp" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SV"/></tag>
	      <tag><var n="tipus_verb"/></tag>
	      <tag><clip pos="3" side="tl" part="temps"/></tag>
	      <tag><lit-tag v="PD"/></tag>
	      <tag><lit-tag v="ND"/></tag>
	    </tags> 
	    <lu>
	      <var n="pronom"/>
	      <clip pos="5" side="tl" part="lem"/>
	      <clip pos="5" side="tl" part="a_prnpro"/>
	      <clip pos="5" side="tl" part="pers"/>
	      <clip pos="5" side="tl" part="gen"/>
	      <clip pos="5" side="tl" part="nbr"/>
	    </lu>
	    <b pos="2"/>
	    <lu>   
	      <clip pos="3" side="tl" part="lemh"/>
	      <clip pos="3" side="tl" part="a_verb"/>
	      <clip pos="3" side="tl" part="temps" link-to="3"/>
              <lit-tag v="4"/>
              <lit-tag v="5"/>
	      <clip pos="3" side="tl" part="lemq"/> 
	    </lu> 
	    <b pos="3"/>
	    <lu>
	      <clip pos="4" side="tl" part="lemh"/> 
	      <clip pos="4" side="tl" part="a_pp"/>
	      <lit-tag v="m.sg"/>
	      <clip pos="4" side="tl" part="lemq"/> 
	    </lu>
	  </chunk>
	</out>
	<call-macro n="f_bcond">
	  <with-param pos="4"/>
	</call-macro>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>


  <rule comment="AUXmod PRONOM HAVER PARTICIPI clític (should always/not have asked it- Sempre/No ho hauria d'haver preguntat)">
      <pattern>
	<pattern-item n="auxmod"/>
	<pattern-item n="adv"/>
	<pattern-item n="have_aux_inf"/>
	<pattern-item n="pp"/>
	<pattern-item n="probj"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>	
	<call-macro n="tipus_verbs">
	  <with-param pos="4"/>
	</call-macro>
	<call-macro n="pron">
	  <with-param pos="4"/>
	</call-macro>
	
	<choose>
	  <when>
	    <test>
	      <in caseless="yes">
		<clip pos="2" side="sl" part="lem"/>
		<list n="adv_neg"/>
	      </in>
	    </test>
	    <let>
	      <var n="paraula2"/>
	      <clip pos="2" side="tl" part="whole"/>
	    </let>
	    <append n="paraula2">
	      <lit-tag v="NEG"/>
	    </append>
	    <let>
	      <clip pos="2" side="tl" part="whole"/>
	      <var n="paraula2"/>
	    </let>
	  </when>
	</choose>
	<out>
	  <chunk name="adv" case="caseFirstWord">
	    <tags>
	      <tag><clip pos="2" side="tl" part="a_adv"/></tag>
	      <tag><clip pos="2" side="tl" part="neg"/></tag>
	    </tags>
	    <lu>
	      <clip pos="2" side="tl" part="lem"/>
	      <clip pos="2" side="tl" part="a_adv"/>
	    </lu>
	  </chunk>
	  <b pos="1"/>
	</out>  
	<choose>     
	  <when>
	    <test>
	      <and>
		<equal caseless="yes">
		  <clip pos="1" side="sl" part="lem"/>
		  <lit v="can"/>
		</equal>
		<equal>
		  <clip pos="1" side="sl" part="temps"/>
		  <lit-tag v="pres"/>
		</equal>
	      </and>
	    </test>
	    <let>
	      <clip pos="1" side="tl" part="temps"/>
	      <lit-tag v="pri"/>
	    </let>
	  </when>
	  <when>
	    <test>
	      <and>
		<equal caseless="yes">
		  <clip pos="1" side="sl" part="lem"/>
		  <lit v="can"/>
		</equal>
		<equal>
		  <clip pos="1" side="sl" part="temps"/>
		  <lit-tag v="past"/>
		</equal>
	      </and>
	    </test>
	    <let>
	      <clip pos="1" side="tl" part="temps"/>
	      <lit-tag v="cni"/>
	    </let>
	  </when>
	  <when>
	    <test>
	      <or>
		<equal caseless="yes">
		  <clip pos="1" side="sl" part="lem"/>
		  <lit v="must"/>
		</equal>
		<equal caseless="yes">
		  <clip pos="1" side="sl" part="lem"/>
		  <lit v="may"/>
		</equal>
	      </or>
	    </test>
	    <let>
	      <clip pos="1" side="tl" part="temps"/>
	      <lit-tag v="pri"/>
	    </let>
	  </when>
	  <when>
	    <test>
	      <or>
		<equal caseless="yes">
		  <clip pos="1" side="sl" part="lem"/>
		  <lit v="should"/>
		</equal>
		<equal caseless="yes">
		  <clip pos="1" side="sl" part="lem"/>
		  <lit v="might"/>
		</equal>
	      </or>
	    </test>
	    <let>
	      <clip pos="1" side="tl" part="temps"/>
	      <lit-tag v="cni"/>
	    </let>
	  </when>
	</choose>
	<out>
	  <chunk name="pro_auxmod_have_pp" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SV"/></tag>
	      <tag><var n="tipus_verb"/></tag>
	      <tag><clip pos="1" side="tl" part="temps"/></tag>
	      <tag><lit-tag v="PD"/></tag>
	      <tag><lit-tag v="ND"/></tag>
	    </tags> 
	    <lu>
	      <var n="pronom"/>
	      <clip pos="5" side="tl" part="lem"/>
	      <clip pos="5" side="tl" part="a_prnpro"/>
	      <clip pos="5" side="tl" part="pers"/>
	      <clip pos="5" side="tl" part="gen"/>
	      <clip pos="5" side="tl" part="nbr"/>
	    </lu>
	    <b pos="2"/>
	    <lu>
	      <clip pos="1" side="tl" part="lemh"/>
	      <clip pos="1" side="tl" part="a_verb"/>
	      <clip pos="1" side="tl" part="temps" link-to="3"/>
	      <lit-tag v="4"/>
	      <lit-tag v="5"/>
	      <clip pos="1" side="tl" part="lemq"/>
	    </lu>
	    <b pos="3"/>
	    <lu>   
	      <clip pos="3" side="tl" part="lemh"/>
	      <clip pos="3" side="tl" part="a_verb"/>
	      <lit-tag v="inf"/>		
	      <clip pos="3" side="tl" part="lemq"/> 
	    </lu> 
	    <b pos="4"/>
	    <lu>
	      <clip pos="4" side="tl" part="lemh"/> 
	      <clip pos="4" side="tl" part="a_pp"/>
	      <lit-tag v="m.sg"/>
	      <clip pos="4" side="tl" part="lemq"/> 
	    </lu>
	  </chunk>
	</out>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>



<!--*********************************************************************************************** -->

    <rule comment="REL (funció de nom)"> 
      <pattern>
	<pattern-item n="relnom"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<out>
	  <chunk name="relnom" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="REL"/></tag>
	      <tag><clip pos="1" side="tl" part="tipus_rel"/></tag>
	      <tag><clip pos="1" side="tl" part="gen"/></tag>
	      <tag><clip pos="1" side="tl" part="nbr"/></tag>
	    </tags>
	    <lu>
	      <clip pos="1" side="tl" part="lem"/> 
	      <clip pos="1" side="tl" part="a_rel"/>
	      <clip pos="1" side="tl" part="gen" link-to="3"/>
	      <clip pos="1" side="tl" part="nbr" link-to="4"/>
	    </lu> 
	  </chunk>
	</out>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>
    

    <rule comment="REL (funció adjectiva: visitors who search peace)"> 
      <pattern>
	<pattern-item n="reladj"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<out>
	  <chunk name="reladj" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="REL"/></tag>
	      <tag><clip pos="1" side="tl" part="tipus_rel"/></tag>
	      <tag><clip pos="1" side="tl" part="gen"/></tag>
	      <tag><clip pos="1" side="tl" part="nbr"/></tag>
	    </tags>
	    <lu>
	      <clip pos="1" side="tl" part="lem"/> 
	      <clip pos="1" side="tl" part="a_rel"/>
	      <clip pos="1" side="tl" part="gen" link-to="3"/>
	      <clip pos="1" side="tl" part="nbr" link-to="4"/>
	    </lu> 
	  </chunk>
	</out>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>




    <rule comment="PRONOM tònic/interrogatiu/possessiu (queda com a GD o ND si és el cas)"> 
      <pattern>
	<pattern-item n="tn_itg_pos"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<out>
	  <chunk name="prn" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN"/></tag>
	      <tag><clip pos="1" side="tl" part="tipus_prn"/></tag>
	      <tag><clip pos="1" side="tl" part="gen"/></tag>
	      <tag><clip pos="1" side="tl" part="nbr"/></tag>
	    </tags>
	    <lu>
	      <clip pos="1" side="tl" part="lem"/> 
	      <clip pos="1" side="tl" part="a_prn"/>
	      <clip pos="1" side="tl" part="tipus_prn"/>
	      <clip pos="1" side="tl" part="gen" link-to="3"/>
	      <clip pos="1" side="tl" part="nbr" link-to="4"/>
	    </lu> 
	  </chunk>
	</out>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>




    <rule comment="PREP">
      <pattern>
	<pattern-item n="prep"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<out>
	  <chunk name="pr" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="PREP"/></tag>
	    </tags>
	    <lu>
	      <clip pos="1" side="tl" part="whole"/>
	    </lu>
	  </chunk>
	</out>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>
    

 <rule comment="THERE">
      <pattern>
	<pattern-item n="there"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>	
	<out>
	  <chunk name="there" case="caseFirstWord">
	    <tags>
	      <tag><clip pos="1" side="tl" part="a_adv"/></tag>		
	    </tags>
	    <lu>
	      <clip pos="1" side="tl" part="whole"/>
	    </lu>
	  </chunk>
	</out>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>


    <rule comment="ADV">
      <pattern>
	<pattern-item n="adv"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<choose>
	  <when>
	    <test>
	      <in caseless="yes">
		<clip pos="1" side="sl" part="lem"/>
		<list n="adv_neg"/>
	      </in>
	    </test>
	    <let>
	      <var n="paraula1"/>
	      <clip pos="1" side="tl" part="whole"/>
	    </let>
	    <append n="paraula1">
	      <lit-tag v="NEG"/>
	    </append>
	    <let>
	      <clip pos="1" side="tl" part="whole"/>
	      <var n="paraula1"/>
	    </let>
	  </when>
	</choose>
	<out>
	  <chunk name="adv" case="caseFirstWord">
	    <tags>
	      <tag><clip pos="1" side="tl" part="a_adv"/></tag>
	      <tag><clip pos="1" side="tl" part="neg"/></tag>		
	    </tags>
	    <lu>
	      <clip pos="1" side="tl" part="lem"/>
	      <clip pos="1" side="tl" part="a_adv"/>
	    </lu>
	  </chunk>
	</out>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>


<rule comment="ADV ITG">
      <pattern>
	<pattern-item n="advitg"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<out>
	  <chunk name="adv" case="caseFirstWord">
	    <tags>
	      <tag><clip pos="1" side="tl" part="a_adv"/></tag>	
	    </tags>
	    <lu>
	      <clip pos="1" side="tl" part="whole"/>
	    </lu>
	  </chunk>
	</out>  
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>


    <rule comment="PREADV">
      <pattern>
	<pattern-item n="preadv"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	
	<out>
	  <chunk name="preadv" case="caseFirstWord">
	    <tags>
	      <tag><clip pos="1" side="tl" part="a_adv"/></tag>		
	    </tags>
	    <lu>
	      <clip pos="1" side="tl" part="lem"/>
	      <clip pos="1" side="tl" part="a_adv"/>
	    </lu>
	  </chunk>
	</out>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>


 <rule comment="CNJ">
      <pattern>
	<pattern-item n="cnj"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>	
	<out>
	  <chunk name="cnj" case="caseFirstWord">
	    <tags>
	      <tag><clip pos="1" side="tl" part="tags"/></tag>		
	    </tags>
	    <lu>
	      <clip pos="1" side="tl" part="whole"/>
	    </lu>
	  </chunk>
	</out>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>



    <rule comment="REGLA: reset variables">
      <pattern>
	<pattern-item n="sent"/>
      </pattern>
      <action>
	<let>
	  <var n="nombre"/>
	  <lit-tag v="sg"/>
	</let>
	<let>
	  <var n="genere"/>
	  <lit-tag v="m"/>
	</let>
	<choose>
	  <when>
	    <test>
	      <not>
		<or>
		  <equal>
		    <clip pos="1" side="sl" part="lem"/>
		    <lit v=";"/>
		  </equal>
		  <equal>
		    <clip pos="1" side="sl" part="lem"/>
		    <lit v=":"/>
		  </equal>
		</or>
	      </not>
	    </test>	      
	    <let>
	      <var n="EOS"/>
	      <lit v="true"/>
	    </let>
	  </when>
	</choose>
	<out>
	  <chunk name="punt">
	    <tags>
	      <tag><lit-tag v="sent"/></tag>
	    </tags>
	    <lu>
	      <clip pos="1" side="tl" part="whole"/>
	    </lu>
	  </chunk>
	</out>
      </action>
    </rule>
    
    

  </section-rules>
</transfer>
