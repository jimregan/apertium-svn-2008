<?xml version="1.0" encoding="ISO-8859-1"?> <!-- -*- nxml -*- -->
<transfer default="chunk">
  <section-def-cats>

  <def-cat n="ari_izan">
      <cat-item lemma="ari izan" tags="vbper.*"/>
    </def-cat>

    <def-cat n="nom">
      <cat-item tags="n"/>
      <cat-item tags="np.*"/>
      <cat-item tags="n.acr"/>
    </def-cat>

    <def-cat n="nom_adv">
      <cat-item tags="n"/>
      <cat-item tags="np.*"/>
      <cat-item tags="adv"/>
      <cat-item tags="adv.gen"/>
    </def-cat>

     <def-cat n="adv">
      <cat-item tags="adv"/>
      <cat-item tags="adv.gen"/>
    </def-cat>

     <def-cat n="adj">
      <cat-item tags="adj.*"/>
    </def-cat>

    <def-cat n="adjizl">
      <cat-item tags="adj.izl"/>
    </def-cat>


    <def-cat n="det">
      <cat-item tags="det.art.*"/>
      <cat-item tags="det.ind.*"/>
      <cat-item tags="det.dem.*"/>
      <cat-item lemma="bat" tags="num.sg"/>
    </def-cat>

 <def-cat n="detindizl"><!--determinantes indefinidos que van generalmente delante del nombre -->
      <cat-item tags="det.indizl.*"/>
    </def-cat>

    <def-cat n="detart">
      <cat-item tags="det.art.*"/>
    </def-cat>

     <def-cat n="post">
      <cat-item tags="post"/>
      <cat-item tags="post.*"/>
    </def-cat>

<def-cat n="spost">
      <cat-item tags="spost"/>
    </def-cat>

     <def-cat n="part">
      <cat-item lemma="ik" tags="post"/>
    </def-cat>

    <def-cat n="num">
      <cat-item tags="num.*"/>
      <cat-item tags="num"/>
      
    </def-cat>

    <def-cat n="vbsint">
      <cat-item tags="vbsint.*"/>
    </def-cat>


    <def-cat n="vbper">
      <cat-item tags="vbper.*"/>
    </def-cat>

     <def-cat n="pp">
      <cat-item tags="vblex.pp"/>
    </def-cat>

   <def-cat n="perpp">
      <cat-item tags="vbper.pp"/>
    </def-cat>

  <def-cat n="padv">
      <cat-item tags="vblex.padv"/>
    </def-cat>

 <def-cat n="pp_adv">
      <cat-item tags="vblex.padv"/>
      <cat-item tags="vblex.pp"/>
    </def-cat>

 <def-cat n="ger">
      <cat-item tags="vblex.ger"/>
    </def-cat>


 <def-cat n="perger">
      <cat-item tags="vbper.ger"/>
    </def-cat>

<def-cat n="pfut">
      <cat-item tags="vblex.pfut"/>
    </def-cat>

<def-cat n="perpfut">
      <cat-item tags="vbper.pfut"/>
    </def-cat>

<def-cat n="vbizen">
      <cat-item tags="vblex.izen"/>
    </def-cat>

<def-cat n="ezinda">
      <cat-item lemma="ezinda" tags="vblex.inf"/>
    </def-cat>

    <def-cat n="prnpers">
      <cat-item tags="prn.pers.*"/>
    </def-cat>

    <def-cat n="prnpos"><!--pronoms que es transformen en possessius en castellà -->
      <cat-item tags="prn.pers.*"/>
      <cat-item lemma="hura" tags="det.dem.*"/>
    </def-cat>
  
    <def-cat n="prep">
      <cat-item tags="pr"/>
    </def-cat>

    <def-cat n="en">
      <cat-item lemma="en" tags="post"/>
    </def-cat>

 <def-cat n="ko">
      <cat-item lemma="ko" tags="post"/>
    </def-cat>

  <def-cat n="ko_en">
      <cat-item lemma="ko" tags="post"/>
      <cat-item lemma="en" tags="post"/>
    </def-cat>

 <def-cat n="gra">
      <cat-item tags="gra.*"/>
    </def-cat>

<def-cat n="sup">
      <cat-item lemma="en" tags="gra.sup"/>
    </def-cat>

<def-cat n="nez">
      <cat-item lemma="nez" tags="cnjadv"/>
    </def-cat>


 <def-cat n="reladj">
      <cat-item lemma="n" tags="rel"/>
    </def-cat>


    <def-cat n="sent">
      <cat-item tags="sent"/>
    </def-cat>

  

  </section-def-cats>
  <section-def-attrs>
    <def-attr n="a_nom">
      <attr-item tags="n"/>
      <attr-item tags="n.acr"/>
      <attr-item tags="np.loc"/>
      <attr-item tags="np.ant"/>
      <attr-item tags="np.al"/>	 
    </def-attr>

    <def-attr n="a_np">
      <attr-item tags="np"/>
    </def-attr>

    <def-attr n="a_np_acr">
      <attr-item tags="np"/>
      <attr-item tags="acr"/>
    </def-attr>

    <def-attr n="a_adj">          
      <attr-item tags="adj"/>    
      <attr-item tags="adjant"/> 
      <attr-item tags="det"/>
    </def-attr>  

    <def-attr n="a_det">          
      <attr-item tags="det"/>    
      <attr-item tags="predet"/>
    </def-attr> 

    <def-attr n="a_verb">          
      <attr-item tags="vblex"/>  
      <attr-item tags="vbser"/>  
      <attr-item tags="vbsint"/>  
      <attr-item tags="vbhaver"/>    
      <attr-item tags="vbmod"/> 
    </def-attr>
   
    <def-attr n="a_prep">          
      <attr-item tags="pr"/>
    </def-attr>

    <def-attr n="a_post">          
      <attr-item tags="ko"/>
    </def-attr>
  
    <def-attr n="a_adv">          
      <attr-item tags="adv"/>   
      <attr-item tags="pr"/>
    </def-attr>

     <def-attr n="a_num">          
      <attr-item tags="num"/>
    </def-attr>

     <def-attr n="tipus_det">          
      <attr-item tags="art"/>         
      <attr-item tags="def"/>         
      <attr-item tags="ind"/>         
      <attr-item tags="indizl"/>         
      <attr-item tags="dem"/>         
      <attr-item tags="num"/>         
      <attr-item tags="ord"/>  
    </def-attr>

  <def-attr n="det_pos">          
      <attr-item tags="prn.pers"/> 
      <attr-item tags="prn.tn"/>         
      <attr-item tags="det.dem"/>        
      <attr-item tags="det.pos"/>
    </def-attr>

 <def-attr n="pers">
      <attr-item tags="p1"/>
      <attr-item tags="p2"/>
      <attr-item tags="p3"/>
      <attr-item tags="PD"/>
 </def-attr>
  
    <def-attr n="persnbr">
      <attr-item tags="p1.sg"/>
      <attr-item tags="p1.pl"/>
      <attr-item tags="p2.sg"/>
      <attr-item tags="p2.pl"/>
      <attr-item tags="p3.sg"/>
      <attr-item tags="p3.pl"/>
      <attr-item tags="PD.ND"/>

      <attr-item tags="NR_HK"/>
      <attr-item tags="NR_HU"/>
      <attr-item tags="NR_NI"/>
      <attr-item tags="NR_ZK"/>
      <attr-item tags="NR_GU"/>
      <attr-item tags="NR_ZU"/>
      <attr-item tags="NR_HI"/>

      <attr-item tags="NK_HK"/>
      <attr-item tags="NK_HU"/>
      <attr-item tags="NK_NI"/>
      <attr-item tags="NK_ZK"/>
      <attr-item tags="NK_GU"/>
      <attr-item tags="NK_ZU"/>
      <attr-item tags="NK_HI"/>

      <attr-item tags="NI_HK"/>
      <attr-item tags="NI_HU"/>
      <attr-item tags="NI_NI"/>
      <attr-item tags="NI_ZK"/>
      <attr-item tags="NI_GU"/>
      <attr-item tags="NI_ZU"/>
      <attr-item tags="NI_HI"/>
    </def-attr>

<def-attr n="nor">
  <attr-item tags="NR_HK"/>
  <attr-item tags="NR_HU"/>
  <attr-item tags="NR_NI"/>
  <attr-item tags="NR_ZK"/>
  <attr-item tags="NR_GU"/>
  <attr-item tags="NR_ZU"/>
  <attr-item tags="NR_HI"/>
</def-attr>

<def-attr n="nori">
  <attr-item tags="NI_HK"/>
  <attr-item tags="NI_HU"/>
  <attr-item tags="NI_NI"/>
  <attr-item tags="NI_ZK"/>
  <attr-item tags="NI_GU"/>
  <attr-item tags="NI_ZU"/>
  <attr-item tags="NI_HI"/>
</def-attr>

<def-attr n="nork">
  <attr-item tags="NK_HK"/>
  <attr-item tags="NK_HU"/>
  <attr-item tags="NK_NI"/>
  <attr-item tags="NK_ZK"/>
  <attr-item tags="NK_GU"/>
  <attr-item tags="NK_ZU"/>
  <attr-item tags="NK_HI"/>
</def-attr>


    <def-attr n="gen">
      <attr-item tags="m"/>
      <attr-item tags="f"/>
      <attr-item tags="mf"/>
      <attr-item tags="GD"/>
      <attr-item tags="nt"/>
    </def-attr>

     <def-attr n="GD">
      <attr-item tags="GD"/>
    </def-attr>

    <def-attr n="mf">
      <attr-item tags="mf"/>
      <attr-item tags="m"/>
      <attr-item tags="f"/>
    </def-attr>

 
    <def-attr n="nbr">
      <attr-item tags="sg"/>
      <attr-item tags="pl"/>
      <attr-item tags="sp"/>
      <attr-item tags="ND"/>
    </def-attr>

    <def-attr n="temps">
      <attr-item tags="inf"/>
      <attr-item tags="pres"/>
      <attr-item tags="past"/>
      <attr-item tags="pri"/>
      <attr-item tags="pp"/>
      <attr-item tags="ger"/>
      <attr-item tags="pprs"/>
      <attr-item tags="subs"/>	  
      <attr-item tags="pii"/>	  
      <attr-item tags="pfut"/>	  
      <attr-item tags="padv"/>	  
      <attr-item tags="fti"/>	  
      <attr-item tags="cni"/>	  
      <attr-item tags="izen"/>
    </def-attr>

    <def-attr n="tipus_prn">          
      <attr-item tags="pers"/>       
      <attr-item tags="tn"/>   
    </def-attr> 

  </section-def-attrs>

  <section-def-vars>    
    <def-var n="caseFirstWord"/>
    <def-var n="EOS"/>
    <def-var n="genere"/>
    <def-var n="nombre"/>
    <def-var n="chunk"/>
    <def-var n="tipusdet"/>
    <def-var n="procl"/>
    <def-var n="procltags"/>
  </section-def-vars>




  <section-def-lists>

    <def-list n="nombrescol"> 
      <list-item v="jende"/>
      <list-item v="ogi"/>
      <list-item v="su"/>
      <list-item v="ur"/>
      <list-item v="diru"/>
    </def-list>


  </section-def-lists>
      


  <section-def-macros>


 <def-macro n="f_bcond" npar="1"><!--Per mirar si el blanc conté o no format. Cal posar aquesta funció en les regles en què desaparegui alguna paraula, per tal de decidir si el blanc de la paraula eliminada s'ha d'eliminar o conservar. Si conté format cal conservar-la, si no en conté cal eliminar-la perquè no apareguin dos espais seguits. -->
      <choose>
	<when>
	  <test>
	    <not>
	      <equal>
		<b pos="1"/>
		<lit v=" "/>
	      </equal>
	    </not>
	  </test>
	  <out>
	    <b pos="1"/>
	  </out>
	</when>     	    
      </choose>
    </def-macro>



 <def-macro n="firstWord" npar="1">
      <choose>
	<when>
	  <test>
	    <equal>
	      <clip pos="1" side="sl" part="a_np_acr"/>
	      <lit v=""/>
	    </equal>
	  </test>
	  <choose>
	    <when>
	      <test>
		<equal> 
		  <var n="EOS"/>
		  <lit v="true"/>
		</equal> 
	      </test>
	      <modify-case>
		<clip pos="1" side="tl" part="lem"/>
		<lit v="aa"/>
	      </modify-case>
	      <let>
		<var n="caseFirstWord"/>
		<lit v="Aa"/>
	      </let>
	    </when>
	  </choose>
	</when>
	<otherwise>
	  <let>
	    <var n="caseFirstWord"/>
	    <lit v="aa"/>
	  </let>
	</otherwise>
      </choose>
      <let>
	<var n="EOS"/>
	<lit v="false"/>
      </let>
    </def-macro>



<def-macro n="concord_n2" npar="2"><!--par 1= nombre; par 2= det/adj
Si el nombre en español es mf, se asigna <m> al determinante. Solución provisional, considerar si sería posible determinar el género de ciertos nombres (el/la profesor/a) -->
  <choose>
	  <when>
	    <test>
	      <equal>
		<clip pos="2" side="tl" part="gen"/> 
		<lit-tag v="GD"/>
	      </equal>
	    </test>
	    <choose>
	      <when>
		<test>
		  <equal>
		    <clip pos="1" side="tl" part="gen"/> 
		    <lit-tag v="mf"/>
		  </equal>
		</test>
		<let>
		  <clip pos="2" side="tl" part="gen"/> 
		  <lit-tag v="m"/>
		</let>
	      </when>
	      <otherwise>
		<let>
		  <clip pos="2" side="tl" part="gen"/> 
		  <clip pos="1" side="tl" part="gen"/>
		</let>
	      </otherwise>
	    </choose>
	  </when>
  </choose>
  <choose>
	  <when>
	    <test>
	      <equal>
		<clip pos="1" side="tl" part="nbr"/> 
		<lit-tag v="ND"/>
	      </equal>
	    </test>
	    <choose>
	      <when>
		<test>
		  <not>
		    <or>
		      <equal>		    
			<clip pos="2" side="tl" part="nbr"/> 
			<lit-tag v="ND"/>
		      </equal>
		      <equal>		    
			<clip pos="2" side="tl" part="nbr"/> 
			<lit-tag v="sp"/>
		      </equal>
		    </or>
		  </not>
		</test>
		<let>		  
		  <clip pos="1" side="tl" part="nbr"/> 
		  <clip pos="2" side="tl" part="nbr"/> 
		</let>
	      </when>
	      <when>
		<test>
		  <and>
		    <equal>
		      <clip pos="2" side="tl" part="nbr"/> 
		      <lit-tag v="sp"/>
		    </equal>
		    <or>
		      <equal>
			<clip pos="2" side="sl" part="nbr"/> 
			<lit-tag v="sg"/>
		      </equal>
		      <equal>
			<clip pos="2" side="sl" part="nbr"/> 
			<lit-tag v="pl"/>
		      </equal>
		    </or>
		  </and>
		</test>
		<let>		  
		  <clip pos="1" side="tl" part="nbr"/> 
		  <clip pos="2" side="sl" part="nbr"/> 
		</let>
	      </when>

	      <when>
		<test>
		  <equal>		    
		    <clip pos="2" side="sl" part="nbr"/> 
		    <lit-tag v="sp"/>
		  </equal>
		</test>
		<choose>
		  <when>
		    <test>
		      <in caseless="yes">
			<clip pos="1" side="sl" part="lemh"/>
			<list n="nombrescol"/>
		      </in>
		    </test>
		    <let>
		      <clip pos="1" side="tl" part="nbr"/> 
		      <lit-tag v="sg"/> 
		    </let>
		    <choose>
		      <when>
			<test>
			  <equal>
			    <clip pos="2" side="tl" part="nbr"/> 
			    <lit-tag v="ND"/>
			  </equal>
			</test>
			<let>
			  <clip pos="2" side="tl" part="nbr"/> 
			  <lit-tag v="sg"/> 
			</let>
		      </when>
		    </choose>
		  </when>
		  <otherwise>
		    <let>
		      <clip pos="1" side="tl" part="nbr"/> 
		      <lit-tag v="pl"/> 
		    </let>
		    <choose>
		      <when>
			<test>
			  <equal>
			    <clip pos="2" side="tl" part="nbr"/> 
			    <lit-tag v="ND"/>
			  </equal>
			</test>
			<let>
			  <clip pos="2" side="tl" part="nbr"/> 
			  <lit-tag v="pl"/> 
			</let>
		      </when>
		    </choose>
		  </otherwise>
		</choose>
	      </when>
	    </choose>
	  </when>
	</choose>
	<choose>
	  <when>
	    <test>
	      <equal>
		<clip pos="2" side="tl" part="nbr"/> 
		<lit-tag v="ND"/>
	      </equal>
	    </test>		
	    <let>
	      <clip pos="2" side="tl" part="nbr"/> 
	      <clip pos="1" side="tl" part="nbr"/> 
	    </let>
	  </when>
	  <when><!--si ha habido cambio de número de sl a tl, el nombre manda y asigna número al det/adj (ingurua = los alrededores) -->
	    <test>
	      <or>
		<and>
		  <equal>
		    <clip pos="2" side="tl" part="nbr"/> 
		    <lit-tag v="sg"/>
		  </equal>
		  <equal>
		    <clip pos="1" side="tl" part="nbr"/> 
		    <lit-tag v="pl"/>
		  </equal>
		</and>
		<and>
		  <equal>
		    <clip pos="2" side="tl" part="nbr"/> 
		    <lit-tag v="pl"/>
		  </equal>
		  <equal>
		    <clip pos="1" side="tl" part="nbr"/> 
		    <lit-tag v="sg"/>
		  </equal>
		</and>
	      </or>
	    </test>
	    <let>
	      <clip pos="2" side="tl" part="nbr"/> 
	      <clip pos="1" side="tl" part="nbr"/> 
	    </let>
	  </when>
	</choose>
</def-macro>

<def-macro n="concord_n3" npar="3"><!--par 1= nombre; par 2= det/adj; par 3=det
Si el nombre en español es mf, se asigna <m> al determinante. Solución provisional, considerar si sería posible determinar el género de ciertos nombres (el/la profesor/a) -->
  <choose>
	  <when>
	    <test>
	      <equal>
		<clip pos="2" side="tl" part="gen"/> 
		<lit-tag v="GD"/>
	      </equal>
	    </test>
	    <choose>
	      <when>
		<test>
		  <equal>
		    <clip pos="1" side="tl" part="gen"/> 
		    <lit-tag v="mf"/>
		  </equal>
		</test>
		<let>
		  <clip pos="2" side="tl" part="gen"/> 
		  <lit-tag v="m"/>
		</let>
	      </when>
	      <otherwise>
		<let>
		  <clip pos="2" side="tl" part="gen"/> 
		  <clip pos="1" side="tl" part="gen"/>
		</let>
	      </otherwise>
	    </choose>
	  </when>
	</choose>
	<choose>
	  <when>
	    <test>
	      <equal>
		<clip pos="3" side="tl" part="gen"/> 
		<lit-tag v="GD"/>
	      </equal>
	    </test>
	    <choose>
	      <when>
		<test>
		  <equal>
		    <clip pos="1" side="tl" part="gen"/> 
		    <lit-tag v="mf"/>
		  </equal>
		</test>
		<let>
		  <clip pos="3" side="tl" part="gen"/> 
		  <lit-tag v="m"/>
		</let>
	      </when>
	      <otherwise>
		<let>
		  <clip pos="3" side="tl" part="gen"/> 
		  <clip pos="1" side="tl" part="gen"/>
		</let>
	      </otherwise>
	    </choose>
	  </when>
	</choose>


	<choose>
	  <when>
	    <test>
	      <equal>
		<clip pos="1" side="tl" part="nbr"/> 
		<lit-tag v="ND"/>
	      </equal>
	    </test>
	    <choose>	      
	      <when>
		<test><!--cuando 2 tiene número sg o pl -->
		  <not>
		    <or>
		      <equal>		    
			<clip pos="2" side="tl" part="nbr"/> 
			<lit-tag v="ND"/>
		      </equal>
		      <equal>		    
			<clip pos="2" side="tl" part="nbr"/> 
			<lit-tag v="sp"/>
		      </equal>
		    </or>
		  </not>
		</test>
		<let>	<!--asigna el nbr de 2 a 1 -->	  
		  <clip pos="1" side="tl" part="nbr"/> 
		  <clip pos="2" side="tl" part="nbr"/> 
		</let>
	      </when>
	      <when>
		<test>
		  <and>
		    <equal>
		      <clip pos="2" side="tl" part="nbr"/> 
		      <lit-tag v="sp"/>
		    </equal>
		    <or>
		      <equal>
			<clip pos="2" side="sl" part="nbr"/> 
			<lit-tag v="sg"/>
		      </equal>
		      <equal>
			<clip pos="2" side="sl" part="nbr"/> 
			<lit-tag v="pl"/>
		      </equal>
		    </or>
		  </and>
		</test>
		<let>		  
		  <clip pos="1" side="tl" part="nbr"/> 
		  <clip pos="2" side="sl" part="nbr"/> 
		</let>
	      </when>
	      <when>
		<test><!--cuando 2 es sp en origen (determinantes indefinidos) -->
		  <and>
		    <equal>		    
		      <clip pos="2" side="sl" part="nbr"/> 
		      <lit-tag v="sp"/>
		    </equal>
		    <equal>		    
		      <clip pos="3" side="tl" part="nbr"/> 
		      <lit-tag v="pl"/>
		    </equal>
		  </and>
		</test>
		<let>		  
		  <clip pos="1" side="tl" part="nbr"/> 
		  <lit v="pl"/> 
		</let>
	      </when>
	      <when>
		<test>
		  <and>
		    <equal>		    
		      <clip pos="2" side="sl" part="nbr"/> 
		      <lit-tag v="sp"/>
		    </equal>
		    <equal>		    
		      <clip pos="3" side="tl" part="nbr"/> 
		      <lit-tag v="sg"/>
		    </equal>
		  </and>
		</test>
		<let>		  
		  <clip pos="1" side="tl" part="nbr"/> 
		  <lit v="sg"/> 
		</let>
	      </when>
	      <when>
		<test>
		  <and>
		    <equal>		    
		      <clip pos="2" side="sl" part="nbr"/> 
		      <lit-tag v="sp"/>
		    </equal>
		    <in caseless="yes">
			<clip pos="1" side="sl" part="lemh"/>
			<list n="nombrescol"/>
		      </in>
		  </and>
		</test>
		<let>
		  <clip pos="1" side="tl" part="nbr"/> 
		  <lit-tag v="sg"/> 
		</let>
		<choose>
		  <when>
		    <test>
		      <equal>
			<clip pos="3" side="tl" part="nbr"/> 
			<lit-tag v="ND"/>
		      </equal>
		    </test>
		    <let>
		      <clip pos="3" side="tl" part="nbr"/> 
		      <lit-tag v="sg"/> 
		    </let>
		  </when>
		</choose>
	      </when>
	      <when>
		<test>
		  <and>
		    <equal>		    
		      <clip pos="2" side="sl" part="nbr"/> 
		      <lit-tag v="sp"/>
		    </equal>
		    <not>
		      <in caseless="yes">
			<clip pos="1" side="sl" part="lemh"/>
			<list n="nombrescol"/>
		      </in>
		    </not>
		  </and>
		</test>
		<let>
		  <clip pos="1" side="tl" part="nbr"/> 
		  <lit-tag v="pl"/> 
		</let>
		<choose>
		  <when>
		    <test>
		      <equal>
			<clip pos="3" side="tl" part="nbr"/> 
			<lit-tag v="ND"/>
		      </equal>
		    </test>
		    <let>
		      <clip pos="3" side="tl" part="nbr"/> 
		      <lit-tag v="pl"/> 
		    </let>
		  </when>
		</choose>
	      </when>
	    </choose>
	    <choose>
	      <when>
		<test>
		  <and>
		    <equal>
		      <clip pos="3" side="tl" part="nbr"/> 
		      <lit-tag v="sp"/>
		    </equal>
		    <or>
		      <equal>
			<clip pos="3" side="sl" part="nbr"/> 
			<lit-tag v="sg"/>
		      </equal>
		      <equal>
			<clip pos="3" side="sl" part="nbr"/> 
			<lit-tag v="pl"/>
		      </equal>
		    </or>
		  </and>
		</test>
		<let>		  
		  <clip pos="1" side="tl" part="nbr"/> 
		  <clip pos="3" side="sl" part="nbr"/> 
		</let>
		<choose>
		  <when>
		    <test>
		      <equal>
			<clip pos="2" side="tl" part="nbr"/> 
			<lit-tag v="ND"/>
		      </equal>
		    </test>
		    <let>		  
		      <clip pos="2" side="tl" part="nbr"/> 
		      <clip pos="3" side="sl" part="nbr"/> 
		    </let>
		  </when>
		</choose>
	      </when>
	      <when>
		<test><!--cuando 3 es sp en origen (determinantes indefinidos) -->
		  <equal>		    
		    <clip pos="3" side="sl" part="nbr"/> 
		    <lit-tag v="sp"/>
		  </equal>
		</test>
		<choose>
		  <when>
		    <test>
		      <in caseless="yes">
			<clip pos="1" side="sl" part="lemh"/>
			<list n="nombrescol"/>
		      </in>
		    </test>
		    <let>
		      <clip pos="1" side="tl" part="nbr"/> 
		      <lit-tag v="sg"/> 
		    </let>
		    <choose>
		      <when>
			<test>
			  <equal>
			    <clip pos="3" side="tl" part="nbr"/> 
			    <lit-tag v="ND"/>
			  </equal>
			</test>
			<let>
			  <clip pos="2" side="tl" part="nbr"/> 
			  <lit-tag v="sg"/> 
			</let>
		      </when>
		    </choose>
		    <choose>
		      <when>
			<test>
			  <equal>
			    <clip pos="2" side="tl" part="nbr"/> 
			    <lit-tag v="ND"/>
			  </equal>
			</test>
			<let>
			  <clip pos="2" side="tl" part="nbr"/> 
			  <lit-tag v="sg"/> 
			</let>
		      </when>
		    </choose>
		  </when>
		  <otherwise>
		    <let>
		      <clip pos="1" side="tl" part="nbr"/> 
		      <lit-tag v="pl"/> 
		    </let>
		    <choose>
		      <when>
			<test>
			  <equal>
			    <clip pos="3" side="tl" part="nbr"/> 
			    <lit-tag v="ND"/>
			  </equal>
			</test>
			<let>
			  <clip pos="3" side="tl" part="nbr"/> 
			  <lit-tag v="pl"/> 
			</let>
		      </when>
		    </choose>
		    <choose>
		      <when>
			<test>
			  <equal>
			    <clip pos="2" side="tl" part="nbr"/> 
			    <lit-tag v="ND"/>
			  </equal>
			</test>
			<let>
			  <clip pos="2" side="tl" part="nbr"/> 
			  <lit-tag v="pl"/> 
			</let>
		      </when>
		    </choose>
		  </otherwise>
		</choose>
	      </when>
	    </choose>
	    <choose><!--otros casos: cuando 3 tiene número i 2 es ND (etxe ederra) -->
	      <when>
		<test>
		  <equal>
		    <clip pos="2" side="tl" part="nbr"/>
		    <lit-tag v="ND"/>
		  </equal>
		</test>
		<let>
		  <clip pos="2" side="tl" part="nbr"/> 
		  <clip pos="3" side="tl" part="nbr"/>
		</let>
		<let>
		  <clip pos="1" side="tl" part="nbr"/> 
		  <clip pos="3" side="tl" part="nbr"/>
		</let>
	      </when>
	    </choose>
	  </when>
	</choose><!--Falta fer el que he afegit a concord2: quan hi ha hagut canvi de nbr de sl a tl (ingurua) -->
<!--i quan 3 es ND i origen no és sp? es pot donar el cas?? repassar -->


</def-macro>




<def-macro n="concord_n4" npar="4"><!--par 1= nombre; par 2= adj; par 3=det/adj; par 4=det
Si el nombre en español es mf, se asigna <m> al determinante. Solución provisional, considerar si sería posible determinar el género de ciertos nombres (el/la profesor/a) -->
  <choose>
	  <when>
	    <test>
	      <equal>
		<clip pos="2" side="tl" part="gen"/> 
		<lit-tag v="GD"/>
	      </equal>
	    </test>
	    <choose>
	      <when>
		<test>
		  <equal>
		    <clip pos="1" side="tl" part="gen"/> 
		    <lit-tag v="mf"/>
		  </equal>
		</test>
		<let>
		  <clip pos="2" side="tl" part="gen"/> 
		  <lit-tag v="m"/>
		</let>
	      </when>
	      <otherwise>
		<let>
		  <clip pos="2" side="tl" part="gen"/> 
		  <clip pos="1" side="tl" part="gen"/>
		</let>
	      </otherwise>
	    </choose>
	  </when>
	</choose>
	<choose>
	  <when>
	    <test>
	      <equal>
		<clip pos="3" side="tl" part="gen"/> 
		<lit-tag v="GD"/>
	      </equal>
	    </test>
	    <choose>
	      <when>
		<test>
		  <equal>
		    <clip pos="1" side="tl" part="gen"/> 
		    <lit-tag v="mf"/>
		  </equal>
		</test>
		<let>
		  <clip pos="3" side="tl" part="gen"/> 
		  <lit-tag v="m"/>
		</let>
	      </when>
	      <otherwise>
		<let>
		  <clip pos="3" side="tl" part="gen"/> 
		  <clip pos="1" side="tl" part="gen"/>
		</let>
	      </otherwise>
	    </choose>
	  </when>
	</choose>
	<choose>
	  <when>
	    <test>
	      <equal>
		<clip pos="4" side="tl" part="gen"/> 
		<lit-tag v="GD"/>
	      </equal>
	    </test>
	    <choose>
	      <when>
		<test>
		  <equal>
		    <clip pos="1" side="tl" part="gen"/> 
		    <lit-tag v="mf"/>
		  </equal>
		</test>
		<let>
		  <clip pos="4" side="tl" part="gen"/> 
		  <lit-tag v="m"/>
		</let>
	      </when>
	      <otherwise>
		<let>
		  <clip pos="4" side="tl" part="gen"/> 
		  <clip pos="1" side="tl" part="gen"/>
		</let>
	      </otherwise>
	    </choose>
	  </when>
	</choose>


	<choose>
	  <when>
	    <test><!--el nombre siempre es ND en los diccionarios actuales-->
	      <equal>
		<clip pos="1" side="tl" part="nbr"/> 
		<lit-tag v="ND"/>
	      </equal>
	    </test>
	    <choose>
	      <when>
		<test><!--cuando 3 tienen número sg o pl -->
		  <not>
		    <or>
		      <equal>		    
			<clip pos="3" side="tl" part="nbr"/> 
			<lit-tag v="ND"/>
		      </equal>
		      <equal>		    
			<clip pos="3" side="tl" part="nbr"/> 
			<lit-tag v="sp"/>
		      </equal>
		    </or>
		  </not>
		</test>
		<let>	<!--asigna el nbr de 3 a 1 -->	  
		  <clip pos="1" side="tl" part="nbr"/> 
		  <clip pos="3" side="tl" part="nbr"/> 
		</let>
	      </when>
	      <when>
		<test><!--cuando 3 es sp en origen (determinantes indefinidos) -->
		  <and>
		    <equal>		    
		      <clip pos="3" side="sl" part="nbr"/> 
		      <lit-tag v="sp"/>
		    </equal>
		    <equal>		    
		      <clip pos="4" side="tl" part="nbr"/> 
		      <lit-tag v="pl"/>
		    </equal>
		  </and>
		</test>
		<let>		  
		  <clip pos="1" side="tl" part="nbr"/> 
		  <lit v="pl"/> 
		</let>
	      </when>
	      <when>
		<test>
		  <and>
		    <equal>		    
		      <clip pos="3" side="sl" part="nbr"/> 
		      <lit-tag v="sp"/>
		    </equal>
		    <equal>		    
		      <clip pos="4" side="tl" part="nbr"/> 
		      <lit-tag v="sg"/>
		    </equal>
		  </and>
		</test>
		<let>		  
		  <clip pos="1" side="tl" part="nbr"/> 
		  <lit v="sg"/> 
		</let>
	      </when>
	      <when>
		<test>
		  <and>
		    <equal>		    
		      <clip pos="3" side="sl" part="nbr"/> 
		      <lit-tag v="sp"/>
		    </equal>
		    <in caseless="yes">
			<clip pos="1" side="sl" part="lemh"/>
			<list n="nombrescol"/>
		      </in>
		  </and>
		</test>
		<let>
		  <clip pos="1" side="tl" part="nbr"/> 
		  <lit-tag v="sg"/> 
		</let>
		<choose>
		  <when>
		    <test>
		      <equal>
			<clip pos="4" side="tl" part="nbr"/> 
			<lit-tag v="ND"/>
		      </equal>
		    </test>
		    <let>
		      <clip pos="4" side="tl" part="nbr"/> 
		      <lit-tag v="sg"/> 
		    </let>
		  </when>
		</choose>
	      </when>
	      <when>
		<test>
		  <and>
		    <equal>		    
		      <clip pos="3" side="sl" part="nbr"/> 
		      <lit-tag v="sp"/>
		    </equal>
		    <not>
		      <in caseless="yes">
			<clip pos="1" side="sl" part="lemh"/>
			<list n="nombrescol"/>
		      </in>
		    </not>
		  </and>
		</test>
		<let>
		  <clip pos="1" side="tl" part="nbr"/> 
		  <lit-tag v="pl"/> 
		</let>
		<choose>
		  <when>
		    <test>
		      <equal>
			<clip pos="4" side="tl" part="nbr"/> 
			<lit-tag v="ND"/>
		      </equal>
		    </test>
		    <let>
		      <clip pos="4" side="tl" part="nbr"/> 
		      <lit-tag v="pl"/> 
		    </let>
		  </when>
		</choose>
	      </when>
	    </choose>

	    <choose>
	      <when>
		<test><!--cuando 4 es sp en origen (determinantes indefinidos) -->
		  <equal>		    
		    <clip pos="4" side="sl" part="nbr"/> 
		    <lit-tag v="sp"/>
		  </equal>
		</test>
		<choose>
		  <when>
		    <test>
		      <in caseless="yes">
			<clip pos="1" side="sl" part="lemh"/>
			<list n="nombrescol"/>
		      </in>
		    </test>
		    <let>
		      <clip pos="1" side="tl" part="nbr"/> 
		      <lit-tag v="sg"/> 
		    </let>
		    <choose>
		      <when>
			<test>
			  <equal>
			    <clip pos="4" side="tl" part="nbr"/> 
			    <lit-tag v="ND"/>
			  </equal>
			</test>
			<let>
			  <clip pos="3" side="tl" part="nbr"/> 
			  <lit-tag v="sg"/> 
			</let>
		      </when>
		    </choose>
		    <choose>
		      <when>
			<test>
			  <equal>
			    <clip pos="3" side="tl" part="nbr"/> 
			    <lit-tag v="ND"/>
			  </equal>
			</test>
			<let>
			  <clip pos="3" side="tl" part="nbr"/> 
			  <lit-tag v="sg"/> 
			</let>
		      </when>
		    </choose>
		  </when>
		  <otherwise>
		    <let>
		      <clip pos="1" side="tl" part="nbr"/> 
		      <lit-tag v="pl"/> 
		    </let>
		    <choose>
		      <when>
			<test>
			  <equal>
			    <clip pos="4" side="tl" part="nbr"/> 
			    <lit-tag v="ND"/>
			  </equal>
			</test>
			<let>
			  <clip pos="4" side="tl" part="nbr"/> 
			  <lit-tag v="pl"/> 
			</let>
		      </when>
		    </choose>
		    <choose>
		      <when>
			<test>
			  <equal>
			    <clip pos="3" side="tl" part="nbr"/> 
			    <lit-tag v="ND"/>
			  </equal>
			</test>
			<let>
			  <clip pos="3" side="tl" part="nbr"/> 
			  <lit-tag v="pl"/> 
			</let>
		      </when>
		    </choose>
		  </otherwise>
		</choose>
	      </when>
	    </choose>
	    <choose><!--otros casos: cuando 4 tiene número i 3 es ND (etxe ederra) -->
	      <when>
		<test>
		  <equal>
		    <clip pos="3" side="tl" part="nbr"/>
		    <lit-tag v="ND"/>
		  </equal>
		</test>
		<let>
		  <clip pos="3" side="tl" part="nbr"/> 
		  <clip pos="4" side="tl" part="nbr"/>
		</let>
		<let>
		  <clip pos="1" side="tl" part="nbr"/> 
		  <clip pos="4" side="tl" part="nbr"/>
		</let>
	      </when>
	    </choose>
	    <choose><!--y finalmente, si el 2 es ND, a estas alturas de la regla el nombre ya tiene número, que se asignará a 2 -->
	      <when>
		<test>
		  <equal>
		    <clip pos="2" side="tl" part="nbr"/>
		    <lit-tag v="ND"/>
		  </equal>
		</test>
		<let>
		  <clip pos="2" side="tl" part="nbr"/> 
		  <clip pos="1" side="tl" part="nbr"/>
		</let>
	      </when>
	    </choose>
	  </when>
	</choose>
</def-macro>
		    



<def-macro n="gen_n" npar="2"><!--par 1= nombre; par 2= det/adj
Si el nombre en español es mf, se asigna <m> al determinante. Solución provisional, considerar si sería posible determinar el género de ciertos nombres (el/la profesor/a) -->
  <choose>
	  <when>
	    <test>
	      <equal>
		<clip pos="2" side="tl" part="gen"/> 
		<lit-tag v="GD"/>
	      </equal>
	    </test>
	    <choose>
	      <when>
		<test>
		  <equal>
		    <clip pos="1" side="tl" part="gen"/> 
		    <lit-tag v="mf"/>
		  </equal>
		</test>
		<let>
		  <clip pos="2" side="tl" part="gen"/> 
		  <lit-tag v="m"/>
		</let>
	      </when>
	      <otherwise>
		<let>
		  <clip pos="2" side="tl" part="gen"/> 
		  <clip pos="1" side="tl" part="gen"/>
		</let>
	      </otherwise>
	    </choose>
	  </when>
	</choose>
	
</def-macro>


<def-macro n="gen_prn" npar="1"><!-- vosotros/vosotras - solució provisional -->
  <choose>
	  <when>
	    <test>
	      <equal>
		<clip pos="1" side="tl" part="gen"/> 
		<lit-tag v="GD"/>
	      </equal>
	    </test>
	    <let>
	      <clip pos="1" side="tl" part="gen"/> 
	      <lit-tag v="m"/>
	    </let>
	  </when>
  </choose>
</def-macro>

  <def-macro n="nbr_n1" npar="1"><!-- asginar singular cuando el nombre va sin determinante -->
  <choose>
	  <when>
	    <test>
	      <or><!--cuando se trata de un nombre que debe llevar número en español-->
		<equal>
		  <clip pos="1" side="tl" part="a_nom"/>
		  <lit v="n"/>
		</equal>
		<equal>
		  <clip pos="1" side="tl" part="a_nom"/>
		  <lit v="n.acr"/>
		</equal>
	      </or>
	    </test>
	    <let>
	      <var n="nombre"/> 
	      <lit-tag v="sg"/>
	    </let>
	  </when>
	  <otherwise>
	     <let>
	      <var n="nombre"/> 
	      <lit v=""/>
	    </let>
	  </otherwise>
  </choose>
</def-macro>

<def-macro n="posesivo" npar="2"><!--Parámetro 1 = pronombre/demostrativo. Parámetro 2 = nombre -->
  <let>	    
    <clip pos="1" side="tl" part="det_pos"/> 
    <lit-tag v="det.pos"/>
  </let>
  <choose>
	  <when>
	    <test>
	      <or>
		<equal caseless="yes">
		  <clip pos="1" side="sl" part="lem"/> 
		  <lit v="hura"/>
		</equal>
		<equal caseless="yes">
		  <clip pos="1" side="sl" part="lem"/> 
		  <lit v="ber"/>
		</equal>
		<equal caseless="yes">
		  <clip pos="1" side="sl" part="lem"/> 
		  <lit v="eurak"/>
		</equal>
	      </or>
	    </test>
	    <let>	      
	      <clip pos="1" side="tl" part="lem"/> 
	      <lit v="suyo"/>
	    </let>
	    <let>	      
	      <clip pos="1" side="tl" part="gen"/> 
	      <lit-tag v="mf"/>
	    </let>
	  </when>
	  <when>
	    <test>
	      <or>
		<equal caseless="yes">
		  <clip pos="1" side="sl" part="lem"/> 
		  <lit v="ni"/>
		</equal>
		<equal caseless="yes">
		  <clip pos="1" side="sl" part="lem"/> 
		  <lit v="neu"/>
		</equal>
		<equal caseless="yes">
		  <clip pos="1" side="sl" part="lem"/> 
		  <lit v="en"/>
		</equal>
	      </or>
	    </test>
	    <let>	      
	      <clip pos="1" side="tl" part="lem"/> 
	      <lit v="mi"/>
	    </let>
	  </when>
	  <when>
	    <test>
	      <or>
		<equal caseless="yes">
		  <clip pos="1" side="sl" part="lem"/> 
		  <lit v="zu"/>
		</equal>
		<equal caseless="yes">
		  <clip pos="1" side="sl" part="lem"/> 
		  <lit v="hi"/>
		</equal>
		<equal caseless="yes">
		  <clip pos="1" side="sl" part="lem"/> 
		  <lit v="zeu"/>
		</equal>
		<equal caseless="yes">
		  <clip pos="1" side="sl" part="lem"/> 
		  <lit v="heu"/>
		</equal>
	      </or>
	    </test>
	    <let>	      
	      <clip pos="1" side="tl" part="lem"/> 
	      <lit v="tuyo"/>
	    </let>
	  </when>
	  <when>
	    <test>
	      <or>
		<equal caseless="yes">
		  <clip pos="1" side="sl" part="lem"/> 
		  <lit v="gu"/>
		</equal>
		<equal caseless="yes">
		  <clip pos="1" side="sl" part="lem"/> 
		  <lit v="geu"/>
		</equal>
	      </or>
	    </test>
	    <let>	      
	      <clip pos="1" side="tl" part="lem"/> 
	      <lit v="nuestro"/>
	    </let>
	    <let>	      
	      <clip pos="1" side="tl" part="gen"/> 
	      <clip pos="2" side="tl" part="gen"/> 
	    </let>
	  </when>
	  <when>
	    <test>
	      <or>
	      <equal caseless="yes">
		<clip pos="1" side="sl" part="lem"/> 
		<lit v="zuek"/>
	      </equal>
	      <equal caseless="yes">
		<clip pos="1" side="sl" part="lem"/> 
		<lit v="zeuek"/>
	      </equal>
	      </or>
	    </test>
	    <let>	      
	      <clip pos="1" side="tl" part="lem"/> 
	      <lit v="vuestro"/>
	    </let>
	    <let>	      
	      <clip pos="1" side="tl" part="gen"/> 
	      <clip pos="2" side="tl" part="gen"/> 
	    </let>
	  </when>
	</choose>
</def-macro>


<def-macro n="SPgenitivo" npar="1"><!--si la postposición és ko/en, el nombre del chunk serà SPGEN para que el t2x realice las operaciones necesarias. Nota: hay reglas que detectan ya chunks con CN dentro ('aitaren etxea'), la marca de genitivo es para los chunks que escapan a estas reglas, para que el t2x pueda tractarlos. -->

	<choose>
	  <when>
	    <test>
	      <or>
		<equal>		
		  <clip pos="1" side="sl" part="lem"/> 
		  <lit v="en"/>
		</equal>
		<equal>		
		  <clip pos="1" side="sl" part="lem"/> 
		  <lit v="ko"/>
		</equal>
		<equal>		
		  <clip pos="1" side="sl" part="a_post"/> 
		  <lit-tag v="ko"/>
		</equal>
	      </or>
	    </test>
	    <let>
	      <var n="chunk"/>
	      <lit-tag v="SPGEN"/>
	    </let>
	  </when>
	  <when>
	    <test>
	      <equal>
		<clip pos="1" side="sl" part="lem"/> 
		<lit v="k"/>
	      </equal>
	    </test>
	    <let>
	      <var n="chunk"/>
	      <lit-tag v="SN"/>
	    </let>
	  </when>
	  <otherwise>
	    <let>
	      <var n="chunk"/>
	      <lit-tag v="SPR"/>
	    </let>
	  </otherwise>
	</choose>
</def-macro>


<def-macro n="tipo_det" npar="1">
	<choose>
	  <when>
	    <test>
	      <equal>
		<clip pos="1" side="sl" part="tipus_det"/>
		<lit-tag v="art"/>
	      </equal>
	    </test>
	    <let>
	      <var n="tipusdet"/>
	      <lit-tag v="art"/>
	    </let>
	  </when>
	  <when>
	    <test>
	      <equal>
		<clip pos="1" side="sl" part="tipus_det"/>
		<lit-tag v="num"/>
	      </equal>
	    </test>
	    <let>
	      <var n="tipusdet"/>
	      <lit-tag v="ind"/>
	    </let>
	  </when>
	  <otherwise>
	    <let>
	      <var n="tipusdet"/>
	      <clip pos="1" side="tl" part="tipus_det"/>
	    </let>
	  </otherwise>
	</choose>
</def-macro>



<def-macro n="verbal_flex" npar="1"><!--Determina la persona del verbo y la presencia de pronombres proclíticos -->
	<choose>
	  <when>
	    <test><!--si es verbo NOR-NORI o NOR-NORI-NORK, envía pronombre de NORI. -->
	      <not>
		<equal>
		  <clip pos="1" side="sl" part="nori"/>
		  <lit v=""/>
		</equal>
	      </not>
	    </test>
	    <choose>
	      <when>
		<test>
		  <equal>		    
		    <clip pos="1" side="sl" part="nori"/>
		    <lit-tag v="NI_NI"/>
		  </equal>
		</test>
		<let>
		  <var n="procl"/>
		  <lit v="me"/>
		</let>
		<let>
		  <var n="procltags"/>
		  <lit-tag v="prn.pro.p1.mf.sg"/>
		</let>
	      </when>
	      <when>
		<test>
		  <or>
		    <equal>		    
		      <clip pos="1" side="sl" part="nori"/>
		      <lit-tag v="NI_ZU"/>
		    </equal>
		    <equal>		    
		      <clip pos="1" side="sl" part="nori"/>
		      <lit-tag v="NI_HI"/>
		    </equal>
		  </or>
		</test>
		<let>
		  <var n="procl"/>
		  <lit v="te"/>
		</let>
		<let>
		  <var n="procltags"/>
		  <lit-tag v="prn.pro.p2.mf.sg"/>
		</let>
	      </when>
	      <when>
		<test>
		    <equal>		    
		      <clip pos="1" side="sl" part="nori"/>
		      <lit-tag v="NI_HU"/>
		    </equal>
		  </test>
		  <let>
		    <var n="procl"/>
		    <lit v="le"/>
		  </let>
		  <let>
		    <var n="procltags"/>
		    <lit-tag v="prn.pro.p3.mf.sg"/>
		  </let>
	      </when>
	      <when>
		<test>
		    <equal>		    
		      <clip pos="1" side="sl" part="nori"/>
		      <lit-tag v="NI_GU"/>
		    </equal>
		  </test>
		<let>
		  <var n="procl"/>
		  <lit v="nos"/>
		</let>
		<let>
		  <var n="procltags"/>
		  <lit-tag v="prn.pro.p1.mf.pl"/>
		</let>
	      </when>
	      <when>
		<test>
		    <equal>		    
		      <clip pos="1" side="sl" part="nori"/>
		      <lit-tag v="NI_ZK"/>
		    </equal>
		  </test>
		<let>
		  <var n="procl"/>
		  <lit v="os"/>
		</let>
		<let>
		  <var n="procltags"/>
		  <lit-tag v="prn.pro.p2.mf.pl"/>
		</let>
	      </when>
	      <when>
		<test>
		    <equal>		    
		      <clip pos="1" side="sl" part="nori"/>
		      <lit-tag v="NI_HK"/>
		    </equal>
		  </test>
		<let>
		  <var n="procl"/>
		  <lit v="le"/>
		</let>
		<let>
		  <var n="procltags"/>
		  <lit-tag v="prn.pro.p3.mf.pl"/>
		</let>
	      </when>
	    </choose>
	    <out>
	      <chunk name="procl" case="caseFirstWord">
		<tags>
		  <tag><var n="procltags"/></tag>
		</tags>
		<lu>
		  <var n="procl"/>
		  <var n="procltags"/>
		</lu>
	      </chunk>
	     <b/>
	    </out>
	  </when>
	  <when>
	    <test><!--Si se trata de un verbo NOR-NORK cuyo NOR no sea 3a sg o 3a pl, envía proclítico con valor de NOR -->
	      <and>
		<not>
		  <equal>
		    <clip pos="1" side="sl" part="nork"/>
		    <lit v=""/>
		  </equal>
		</not>
		<not>
		  <equal>		    
		    <clip pos="1" side="sl" part="nor"/>
		    <lit-tag v="NR_HU"/>
		  </equal>
		</not>
		<not>
		  <equal>		    
		    <clip pos="1" side="sl" part="nor"/>
		    <lit-tag v="NR_HK"/>
		  </equal>
		</not>
	      </and>
	    </test>
	    <choose>
	      <when>
		<test>
		  <equal>		    
		    <clip pos="1" side="sl" part="nor"/>
		    <lit-tag v="NR_NI"/>
		  </equal>
		</test>
		<let>
		  <var n="procl"/>
		  <lit v="me"/>
		</let>
		<let>
		  <var n="procltags"/>
		  <lit-tag v="prn.pro.p1.mf.sg"/>
		</let>
	      </when>
	      <when>
		<test>
		  <or>
		    <equal>		    
		      <clip pos="1" side="sl" part="nor"/>
		      <lit-tag v="NR_ZU"/>
		    </equal>
		    <equal>		    
		      <clip pos="1" side="sl" part="nor"/>
		      <lit-tag v="NR_HI"/>
		    </equal>
		  </or>
		</test>
		<let>
		  <var n="procl"/>
		  <lit v="te"/>
		</let>
		<let>
		  <var n="procltags"/>
		  <lit-tag v="prn.pro.p2.mf.sg"/>
		</let>
	      </when>
	   <!--   <when>
		<test>
		    <equal>		    
		      <clip pos="1" side="sl" part="nor"/>
		      <lit-tag v="NR_HU"/>
		    </equal>
		  </test>
		  <let>
		    <var n="procl"/>
		    <lit v="le"/>
		  </let>
		  <let>
		    <var n="procltags"/>
		    <lit-tag v="prn.pro.p3.mf.sg"/>
		  </let>
	      </when> -->
	      <when>
		<test>
		    <equal>		    
		      <clip pos="1" side="sl" part="nor"/>
		      <lit-tag v="NR_GU"/>
		    </equal>
		  </test>
		<let>
		  <var n="procl"/>
		  <lit v="nos"/>
		</let>
		<let>
		  <var n="procltags"/>
		  <lit-tag v="prn.pro.p1.mf.pl"/>
		</let>
	      </when>
	      <when>
		<test>
		    <equal>		    
		      <clip pos="1" side="sl" part="nor"/>
		      <lit-tag v="NR_ZK"/>
		    </equal>
		  </test>
		<let>
		  <var n="procl"/>
		  <lit v="os"/>
		</let>
		<let>
		  <var n="procltags"/>
		  <lit-tag v="prn.pro.p2.mf.pl"/>
		</let>
	      </when>
	   <!--   <when>
		<test>
		    <equal>		    
		      <clip pos="1" side="sl" part="nor"/>
		      <lit-tag v="NR_HK"/>
		    </equal>
		  </test>
		<let>
		  <var n="procl"/>
		  <lit v="le"/>
		</let>
		<let>
		  <var n="procltags"/>
		  <lit-tag v="prn.pro.p3.mf.pl"/>
		</let>
	      </when> -->
	    </choose>
	    <out>
	      <chunk name="procl" case="caseFirstWord">
		<tags>
		  <tag><var n="procltags"/></tag>
		</tags>
		<lu>
		  <var n="procl"/>
		  <var n="procltags"/>
		</lu>
	      </chunk>
	      <b/>
	    </out>
	  </when>
	</choose>
	<choose>
	  <when>
	    <test>
	      <not>
		<equal>
		  <clip pos="1" side="sl" part="nork"/>
		  <lit v=""/>
		</equal>
	      </not>
	    </test>
	    <choose>
	      <when>
		<test>
		  <equal>		    
		    <clip pos="1" side="sl" part="nork"/>
		    <lit-tag v="NK_NI"/>
		  </equal>
		</test>
		<let>		  
		  <clip pos="1" side="tl" part="persnbr"/>
		  <lit-tag v="p1.sg"/>
		</let>
	      </when>
	      <when>
		<test>
		  <equal>		    
		    <clip pos="1" side="sl" part="nork"/>
		    <lit-tag v="NK_ZU"/>
		  </equal>
		</test>
		<let>		  
		  <clip pos="1" side="tl" part="persnbr"/>
		  <lit-tag v="p2.sg"/>
		</let>
	      </when>
	      <when>
		<test>
		  <equal>		    
		    <clip pos="1" side="sl" part="nork"/>
		    <lit-tag v="NK_HI"/>
		  </equal>
		</test>
		<let>		  
		  <clip pos="1" side="tl" part="persnbr"/>
		  <lit-tag v="p2.sg"/>
		</let>
	      </when>
	      <when>
		<test>
		  <equal>		    
		    <clip pos="1" side="sl" part="nork"/>
		    <lit-tag v="NK_HU"/>
		  </equal>
		</test>
		<let>		  
		  <clip pos="1" side="tl" part="persnbr"/>
		  <lit-tag v="p3.sg"/>
		</let>
	      </when>
	      <when>
		<test>
		  <equal>		    
		    <clip pos="1" side="sl" part="nork"/>
		    <lit-tag v="NK_GU"/>
		  </equal>
		</test>
		<let>		  
		  <clip pos="1" side="tl" part="persnbr"/>
		  <lit-tag v="p1.pl"/>
		</let>
	      </when>
	      <when>
		<test>
		  <equal>		    
		    <clip pos="1" side="sl" part="nork"/>
		    <lit-tag v="NK_ZK"/>
		  </equal>
		</test>
		<let>		  
		  <clip pos="1" side="tl" part="persnbr"/>
		  <lit-tag v="p2.pl"/>
		</let>
	      </when>
	      <when>
		<test>
		  <equal>		    
		    <clip pos="1" side="sl" part="nork"/>
		    <lit-tag v="NK_HK"/>
		  </equal>
		</test>
		<let>		  
		  <clip pos="1" side="tl" part="persnbr"/>
		  <lit-tag v="p3.pl"/>
		</let>
	      </when>
	    </choose>
	  </when>
	  <otherwise><!--cuando el verbo no tiene sujeto NORK -->
	    <choose>
	      <when>
		<test>
		  <equal>		    
		    <clip pos="1" side="sl" part="nor"/>
		    <lit-tag v="NR_NI"/>
		  </equal>
		</test>
		<let>		  
		  <clip pos="1" side="tl" part="persnbr"/>
		  <lit-tag v="p1.sg"/>
		</let>
	      </when>
	      <when>
		<test>
		  <equal>		    
		    <clip pos="1" side="sl" part="nor"/>
		    <lit-tag v="NR_ZU"/>
		  </equal>
		</test>
		<let>		  
		  <clip pos="1" side="tl" part="persnbr"/>
		  <lit-tag v="p2.sg"/>
		</let>
	      </when>
	      <when>
		<test>
		  <equal>		    
		    <clip pos="1" side="sl" part="nor"/>
		    <lit-tag v="NR_HI"/>
		  </equal>
		</test>
		<let>		  
		  <clip pos="1" side="tl" part="persnbr"/>
		  <lit-tag v="p2.sg"/>
		</let>
	      </when>
	      <when>
		<test>
		  <equal>		    
		    <clip pos="1" side="sl" part="nor"/>
		    <lit-tag v="NR_HU"/>
		  </equal>
		</test>
		<let>		  
		  <clip pos="1" side="tl" part="persnbr"/>
		  <lit-tag v="p3.sg"/>
		</let>
	      </when>
	      <when>
		<test>
		  <equal>		    
		    <clip pos="1" side="sl" part="nor"/>
		    <lit-tag v="NR_GU"/>
		  </equal>
		</test>
		<let>		  
		  <clip pos="1" side="tl" part="persnbr"/>
		  <lit-tag v="p1.pl"/>
		</let>
	      </when>
	      <when>
		<test>
		  <equal>		    
		    <clip pos="1" side="sl" part="nor"/>
		    <lit-tag v="NR_ZK"/>
		  </equal>
		</test>
		<let>		  
		  <clip pos="1" side="tl" part="persnbr"/>
		  <lit-tag v="p2.pl"/>
		</let>
	      </when>
	      <when>
		<test>
		  <equal>		    
		    <clip pos="1" side="sl" part="nor"/>
		    <lit-tag v="NR_HK"/>
		  </equal>
		</test>
		<let>		  
		  <clip pos="1" side="tl" part="persnbr"/>
		  <lit-tag v="p3.pl"/>
		</let>
	      </when>
	    </choose>
	  </otherwise>  
	    
	</choose>

	
</def-macro>


  </section-def-macros>

  <section-rules>

    <!--********************************* REGLES DE SN   **************************************************** -->


   <rule comment="REGLA: NOM ( per a col·locar la cua en les multiparaules amb g i traduir noms sense determinant">
      <pattern>
	<pattern-item n="nom"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<choose>
	  <when>
	    <test>
	      <equal>
		<clip pos="1" side="tl" part="nbr"/>
		<lit-tag v="ND"/>
	      </equal>
	    </test>
	    <let>
		<clip pos="1" side="tl" part="nbr"/>
		<lit-tag v="sg"/>
	    </let>
	  </when>
	</choose>	      
	<out> 
	  <chunk name="nom" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN.UNDET"/></tag>
	      <tag><clip pos="1" side="tl" part="gen"/></tag>
	      <tag><clip pos="1" side="tl" part="nbr"/></tag>
	    </tags>
	    <lu> 
	      <clip pos="1" side="tl" part="lemh"/> 
	      <clip pos="1" side="tl" part="a_nom"/>
	      <clip pos="1" side="tl" part="gen" link-to="3"/>
	      <lit-tag v="4"/>
	      <clip pos="1" side="tl" part="lemq"/> 
	    </lu>
	  </chunk>
	</out>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>

 <rule comment="REGLA: DET (guztiak, gehienak) Para cuando va solo o con palabras desconocidas">
      <pattern>
	<pattern-item n="det"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="tipo_det">
	  <with-param pos="1"/>
	</call-macro>	
	<out> 
	  <chunk name="det" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN"/></tag>
	      <tag><var n="tipusdet"/></tag>
	      <tag><clip pos="1" side="tl" part="gen"/></tag>
	      <tag><clip pos="1" side="tl" part="nbr"/></tag>
	    </tags>
	    <lu>
	      <clip pos="1" side="tl" part="lem"/> 
	      <clip pos="1" side="tl" part="a_det"/> 
	      <lit-tag v="2"/> 
	      <clip pos="1" side="tl" part="GD" link-to="3"/>
	      <clip pos="1" side="tl" part="mf"/>
	      <clip pos="1" side="tl" part="nbr"/>
	    </lu>
	  </chunk>
	</out>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
 </rule>

 <rule comment="REGLA: DETIND Para cuando va solo o con palabras desconocidas">
      <pattern>
	<pattern-item n="detindizl"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="tipo_det">
	  <with-param pos="1"/>
	</call-macro>	
	<out> 
	  <chunk name="det" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN"/></tag>
	      <tag><var n="tipusdet"/></tag>
	      <tag><clip pos="1" side="tl" part="gen"/></tag>
	      <tag><clip pos="1" side="tl" part="nbr"/></tag>
	    </tags>
	    <lu>
	      <clip pos="1" side="tl" part="lem"/> 
	      <clip pos="1" side="tl" part="a_det"/> 
	      <lit-tag v="2"/> 
	      <clip pos="1" side="tl" part="GD" link-to="3"/>
	      <clip pos="1" side="tl" part="mf"/>
	      <clip pos="1" side="tl" part="nbr" link-to="4"/>
	    </lu>
	  </chunk>
	</out>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
 </rule>


 <rule comment="REGLA: NOM + DET (etxea)">
      <pattern>
	<pattern-item n="nom"/>
	<pattern-item n="det"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="concord_n2">
	  <with-param pos="1"/>
	  <with-param pos="2"/>
	</call-macro>
	<call-macro n="tipo_det">
	  <with-param pos="2"/>
	</call-macro>	
	<out> 
	  <chunk name="det_nom" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN"/></tag>
	      <tag><var n="tipusdet"/></tag>
	      <tag><clip pos="1" side="tl" part="gen"/></tag>
	      <tag><clip pos="1" side="tl" part="nbr"/></tag>
	    </tags>
	    <lu>
	      <clip pos="2" side="tl" part="lem"/> 
	      <clip pos="2" side="tl" part="a_det"/> 
	      <lit-tag v="2"/> 
	      <clip pos="2" side="tl" part="GD" link-to="3"/>
	      <clip pos="2" side="tl" part="mf"/>
	      <clip pos="2" side="tl" part="nbr"/>
	    </lu>
	    <b/>
	    <lu> 
	      <clip pos="1" side="tl" part="lemh"/> 
	      <clip pos="1" side="tl" part="a_nom"/>
	      <clip pos="1" side="tl" part="GD" link-to="3"/>
	      <clip pos="1" side="tl" part="mf"/>
	      <clip pos="1" side="tl" part="nbr" link-to="4"/>
	      <clip pos="1" side="tl" part="lemq"/> 
	    </lu>
	  </chunk>
	</out>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
 </rule>

 <rule comment="REGLA: NOM + ADJ + DET (etxe gorria)">
      <pattern>
	<pattern-item n="nom"/>
	<pattern-item n="adj"/>
	<pattern-item n="det"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="concord_n3">
	  <with-param pos="1"/>
	  <with-param pos="2"/>
	  <with-param pos="3"/>
	</call-macro>
	<call-macro n="tipo_det">
	  <with-param pos="3"/>
	</call-macro>
	<choose>
	  <when>
	    <test>
	      <or>
		<equal>		
		  <clip pos="2" side="tl" part="a_adj"/>
		  <lit-tag v="adjant"/>
		</equal>
		<equal>		
		  <clip pos="2" side="tl" part="a_adj"/>
		  <lit-tag v="det"/>
		</equal>
	      </or>
	    </test>
	    <out> 
	      <chunk name="det_adj_nom" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="SN"/></tag>
		  <tag><var n="tipusdet"/></tag>
		  <tag><clip pos="1" side="tl" part="gen"/></tag>
		  <tag><clip pos="1" side="tl" part="nbr"/></tag>
		</tags>	
		<lu>
		  <clip pos="3" side="tl" part="lem"/> 
		  <clip pos="3" side="tl" part="a_det"/> 
		  <lit-tag v="2"/> 
		  <clip pos="3" side="tl" part="GD" link-to="3"/>
		  <clip pos="3" side="tl" part="mf"/>
		  <clip pos="3" side="tl" part="nbr"/>
		</lu>
		<b pos="1"/>	
		<lu> 
		  <clip pos="2" side="tl" part="lem"/> 
		  <clip pos="2" side="tl" part="a_adj"/>
		  <clip pos="2" side="tl" part="tipus_det"/>
		  <clip pos="2" side="tl" part="GD" link-to="3"/>
		  <clip pos="2" side="tl" part="mf"/>
		  <clip pos="2" side="tl" part="nbr" link-to="4"/>
		</lu>
		<b/>
		<lu> 
		  <clip pos="1" side="tl" part="lemh"/> 
		  <clip pos="1" side="tl" part="a_nom"/>
		  <clip pos="1" side="tl" part="GD" link-to="3"/>
		  <clip pos="1" side="tl" part="mf"/>
		  <clip pos="1" side="tl" part="nbr" link-to="4"/>
		  <clip pos="1" side="tl" part="lemq"/> 
		</lu>
		<b/>
	      </chunk>
	    </out>
	  </when>
	  <otherwise>
	<out> 
	  <chunk name="det_nom_adj" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN"/></tag>
	      <tag><var n="tipusdet"/></tag>
	      <tag><clip pos="1" side="tl" part="gen"/></tag>
	      <tag><clip pos="1" side="tl" part="nbr"/></tag>
	    </tags>
	    <lu>
	      <clip pos="3" side="tl" part="lem"/> 
	      <clip pos="3" side="tl" part="a_det"/> 
	      <lit-tag v="2"/> 
	      <clip pos="3" side="tl" part="GD" link-to="3"/>
	      <clip pos="3" side="tl" part="mf"/>
	      <clip pos="3" side="tl" part="nbr"/>
	    </lu>
	    <b pos="1"/>
	    <lu> 
	      <clip pos="1" side="tl" part="lemh"/> 
	      <clip pos="1" side="tl" part="a_nom"/>
	      <clip pos="1" side="tl" part="GD" link-to="3"/>
	      <clip pos="1" side="tl" part="mf"/>
	      <clip pos="1" side="tl" part="nbr" link-to="4"/>
	      <clip pos="1" side="tl" part="lemq"/> 
	    </lu>
	    <b/>
	    <lu> 
	      <clip pos="2" side="tl" part="lem"/> 
	      <clip pos="2" side="tl" part="a_adj"/>
	      <clip pos="2" side="tl" part="GD" link-to="3"/>
	      <clip pos="2" side="tl" part="mf"/>
	      <clip pos="2" side="tl" part="nbr" link-to="4"/>
	    </lu>
	  </chunk>
	</out>
	  </otherwise>
	</choose>
		<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
 </rule>



 <rule comment="REGLA: NOM + POST (etxetara)">
      <pattern>
	<pattern-item n="nom"/>
	<pattern-item n="post"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="SPgenitivo">
	  <with-param pos="2"/>
	</call-macro>
	<out> 
	  <chunk name="pr_nom" case="caseFirstWord">
	    <tags>
	      <tag><var n="chunk"/></tag>
	      <tag><lit-tag v="UNDET"/></tag>
	      <tag><clip pos="1" side="tl" part="gen"/></tag>
	      <tag><lit-tag v="sg"/></tag>
	    </tags>
	    <lu>
	      <clip pos="2" side="tl" part="lem"/> 
	      <clip pos="2" side="tl" part="a_prep"/>
	    </lu>
	    <b/>
	    <lu> 
	      <clip pos="1" side="tl" part="lemh"/> 
	      <clip pos="1" side="tl" part="a_nom"/>
	      <clip pos="1" side="tl" part="GD" link-to="3"/>
	      <clip pos="1" side="tl" part="mf"/>
	      <lit-tag v="4"/>
	      <clip pos="1" side="tl" part="lemq"/> 
	    </lu>
	  </chunk>
	</out>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
 </rule>


<rule comment="REGLA: NOM + DET + POST (etxera)">
      <pattern>
	<pattern-item n="nom"/>
	<pattern-item n="det"/>
	<pattern-item n="post"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="concord_n2">
	  <with-param pos="1"/>
	  <with-param pos="2"/>
	</call-macro>
	<call-macro n="SPgenitivo">
	  <with-param pos="3"/>
	</call-macro>
	<call-macro n="tipo_det">
	  <with-param pos="2"/>
	</call-macro>
	<out> 
	  <chunk name="pr_det_nom" case="caseFirstWord">
	    <tags>
	      <tag><var n="chunk"/></tag>
	      <tag><var n="tipusdet"/></tag>
	      <tag><clip pos="1" side="tl" part="gen"/></tag>
	      <tag><clip pos="1" side="tl" part="nbr"/></tag>
	    </tags>
	    <lu>
	      <clip pos="3" side="tl" part="lem"/> 
	      <clip pos="3" side="tl" part="a_prep"/>
	    </lu>
	    <b/>
	    <lu>
	      <clip pos="2" side="tl" part="lem"/> 
	      <clip pos="2" side="tl" part="a_det"/> 
	      <lit-tag v="2"/> 
	      <clip pos="2" side="tl" part="GD" link-to="3"/>
	      <clip pos="2" side="tl" part="mf"/>
	      <clip pos="2" side="tl" part="nbr"/>
	    </lu>
	    <b/>
	    <lu> 
	      <clip pos="1" side="tl" part="lemh"/> 
	      <clip pos="1" side="tl" part="a_nom"/>
	      <clip pos="1" side="tl" part="GD" link-to="3"/>
	      <clip pos="1" side="tl" part="mf"/>
	      <clip pos="1" side="tl" part="nbr" link-to="4"/>
	      <clip pos="1" side="tl" part="lemq"/> 
	    </lu>
	  </chunk>
	</out>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
 </rule>

<rule comment="REGLA: NOM + ADJ + DET + POST (etxe gorrira)">
      <pattern>
	<pattern-item n="nom"/>
	<pattern-item n="adj"/>
	<pattern-item n="det"/>
	<pattern-item n="post"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="concord_n3">
	  <with-param pos="1"/>
	  <with-param pos="2"/>
	  <with-param pos="3"/>
	</call-macro>
	<call-macro n="SPgenitivo">
	  <with-param pos="4"/>
	</call-macro>
	<call-macro n="tipo_det">
	  <with-param pos="3"/>
	</call-macro>
	<choose>
	  <when>
	    <test>
	      <or>
	      <equal>		
		<clip pos="2" side="tl" part="a_adj"/>
		<lit-tag v="adjant"/>
	      </equal>
		<equal>		
		  <clip pos="2" side="tl" part="a_adj"/>
		  <lit-tag v="det"/>
		</equal>
	      </or>
	    </test>
	<out> 	
	  <chunk name="pr_det_adj_nom" case="caseFirstWord">
	    <tags>
	      <tag><var n="chunk"/></tag>
	      <tag><var n="tipusdet"/></tag>
	      <tag><clip pos="1" side="tl" part="gen"/></tag>
	      <tag><clip pos="1" side="tl" part="nbr"/></tag>
	    </tags>
	    <lu>
	      <clip pos="4" side="tl" part="lem"/> 
	      <clip pos="4" side="tl" part="a_prep"/>
	    </lu>
	    <b pos="1"/>
	    <lu>
	      <clip pos="3" side="tl" part="lem"/> 
	      <clip pos="3" side="tl" part="a_det"/> 
	      <lit-tag v="2"/> 
	      <clip pos="3" side="tl" part="GD" link-to="3"/>
	      <clip pos="3" side="tl" part="mf"/>
	      <clip pos="3" side="tl" part="nbr"/>
	    </lu>	    
	    <b/>
	    <lu> 
	      <clip pos="2" side="tl" part="lem"/> 
	      <clip pos="2" side="tl" part="a_adj"/>
	      <clip pos="2" side="tl" part="tipus_det"/>
	      <clip pos="2" side="tl" part="GD" link-to="3"/>
	      <clip pos="2" side="tl" part="mf"/>
	      <clip pos="2" side="tl" part="nbr" link-to="4"/>
	    </lu>
	    <b/> 
	    <lu> 
	      <clip pos="1" side="tl" part="lemh"/> 
	      <clip pos="1" side="tl" part="a_nom"/>
	      <clip pos="1" side="tl" part="GD" link-to="3"/>
	      <clip pos="1" side="tl" part="mf"/>
	      <clip pos="1" side="tl" part="nbr" link-to="4"/>
	      <clip pos="1" side="tl" part="lemq"/> 
	    </lu>
	  </chunk>
	</out>
	    </when>
	    <otherwise>

	<out> 	
	  <chunk name="pr_det_nom_adj" case="caseFirstWord">
	    <tags>
	      <tag><var n="chunk"/></tag>
	      <tag><var n="tipusdet"/></tag>
	      <tag><clip pos="1" side="tl" part="gen"/></tag>
	      <tag><clip pos="1" side="tl" part="nbr"/></tag>
	    </tags>
	    <lu>
	      <clip pos="4" side="tl" part="lem"/> 
	      <clip pos="4" side="tl" part="a_prep"/>
	    </lu>
	    <b pos="1"/>
	    <lu>
	      <clip pos="3" side="tl" part="lem"/> 
	      <clip pos="3" side="tl" part="a_det"/> 
	      <lit-tag v="2"/> 
	      <clip pos="3" side="tl" part="GD" link-to="3"/>
	      <clip pos="3" side="tl" part="mf"/>
	      <clip pos="3" side="tl" part="nbr"/>
	    </lu>	    
	    <b/>
	    <lu> 
	      <clip pos="1" side="tl" part="lemh"/> 
	      <clip pos="1" side="tl" part="a_nom"/>
	      <clip pos="1" side="tl" part="GD" link-to="3"/>
	      <clip pos="1" side="tl" part="mf"/>
	      <clip pos="1" side="tl" part="nbr" link-to="4"/>
	      <clip pos="1" side="tl" part="lemq"/> 
	    </lu>
	    <b/> 
	    <lu> 
	      <clip pos="2" side="tl" part="lem"/> 
	      <clip pos="2" side="tl" part="a_adj"/>
	      <clip pos="2" side="tl" part="GD" link-to="3"/>
	      <clip pos="2" side="tl" part="mf"/>
	      <clip pos="2" side="tl" part="nbr" link-to="4"/>
	    </lu>
	  </chunk>
	</out>
	    </otherwise>
	  </choose>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
 </rule>


   <rule comment="REGLA: PRONOMBRE ( para asignar género a 'nosotros' y 'vosotros'. Por ahora será 'm' por defecto) ">
      <pattern>
	<pattern-item n="prnpers"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="gen_prn">
	  <with-param pos="1"/>
	</call-macro>
	<out> 
	  <chunk name="prnpers" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="PRN"/></tag>
	      <tag><clip pos="1" side="tl" part="tipus_prn"/></tag>
	      <tag><clip pos="1" side="tl" part="pers"/></tag>
	      <tag><clip pos="1" side="tl" part="nbr"/></tag>
	    </tags>
	    <lu> 
	      <clip pos="1" side="tl" part="whole"/> 
	    </lu>
	  </chunk>
	</out>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>

 <rule comment="REGLA: DET + NOM  (zenbait etxe - algunas casas / 
nahiko jende = bastante jende.....  pensar singular/plural nom!!!!!!!!!!!!!!!!!!!!!!!!!!!!
pingui pingui pingui MG

)">
      <pattern>
	<pattern-item n="detindizl"/>
	<pattern-item n="nom"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="concord_n2">
	  <with-param pos="2"/>
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="tipo_det">
	  <with-param pos="1"/>
	</call-macro>
	    <out> 
	      <chunk name="det_nom" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="SN"/></tag>
		  <tag><var n="tipusdet"/></tag>
		  <tag><clip pos="2" side="tl" part="gen"/></tag>
		  <tag><clip pos="2" side="tl" part="nbr"/></tag>
		</tags>	
		<lu> 
		  <clip pos="1" side="tl" part="lem"/> 
		  <clip pos="1" side="tl" part="a_adj"/>
		  <clip pos="1" side="tl" part="tipus_det"/>
		  <clip pos="1" side="tl" part="GD" link-to="3"/>
		  <clip pos="1" side="tl" part="mf"/>
		  <clip pos="1" side="tl" part="nbr" link-to="4"/>
		</lu>
		<b pos="1"/>
		<lu> 
		  <clip pos="2" side="tl" part="lemh"/> 
		  <clip pos="2" side="tl" part="a_nom"/>
		  <clip pos="2" side="tl" part="GD" link-to="3"/>
		  <clip pos="2" side="tl" part="mf"/>
		  <clip pos="2" side="tl" part="nbr" link-to="4"/>
		  <clip pos="2" side="tl" part="lemq"/> 
		</lu>
	      </chunk>
	    </out>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
 </rule>

<rule comment="REGLA: DET + NOM  (zenbait etxetan - en algunas casas / 
nahiko jende = bastante jende.....  pensar singular/plural nom!!!!!!!!!!!!!!!!!!!!!!!!!!!!
pingui pingui pingui MG

)">
      <pattern>
	<pattern-item n="detindizl"/>
	<pattern-item n="nom"/>
	<pattern-item n="post"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="concord_n2">
	  <with-param pos="2"/>
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="tipo_det">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="SPgenitivo">
	  <with-param pos="3"/>
	</call-macro>
	    <out> 
	      <chunk name="pr_det_nom" case="caseFirstWord">
		<tags>
		  <tag><var n="chunk"/></tag>
		  <tag><var n="tipusdet"/></tag>
		  <tag><clip pos="2" side="tl" part="gen"/></tag>
		  <tag><clip pos="2" side="tl" part="nbr"/></tag>
		</tags>
		<lu>		  
		  <clip pos="3" side="tl" part="whole"/> 
		</lu>
		<b pos="1"/>	
		<lu> 
		  <clip pos="1" side="tl" part="lem"/> 
		  <clip pos="1" side="tl" part="a_adj"/>
		  <clip pos="1" side="tl" part="tipus_det"/>
		  <clip pos="1" side="tl" part="GD" link-to="3"/>
		  <clip pos="1" side="tl" part="mf"/>
		  <clip pos="1" side="tl" part="nbr" link-to="4"/>
		</lu>
		<b/>
		<lu> 
		  <clip pos="2" side="tl" part="lemh"/> 
		  <clip pos="2" side="tl" part="a_nom"/>
		  <clip pos="2" side="tl" part="GD" link-to="3"/>
		  <clip pos="2" side="tl" part="mf"/>
		  <clip pos="2" side="tl" part="nbr" link-to="4"/>
		  <clip pos="2" side="tl" part="lemq"/> 
		</lu>
	      </chunk>
	    </out>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
 </rule>



 <rule comment="REGLA: ADJ + NOM + DET (euskal presoak)">
      <pattern>
	<pattern-item n="adjizl"/>
	<pattern-item n="nom"/>
	<pattern-item n="det"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="concord_n3">
	  <with-param pos="2"/>
	  <with-param pos="1"/>
	  <with-param pos="3"/>
	</call-macro>
	<call-macro n="tipo_det">
	  <with-param pos="3"/>
	</call-macro>
	<choose>
	  <when>
	    <test>
	      <or>
		<equal>		
		  <clip pos="1" side="tl" part="a_adj"/>
		  <lit-tag v="adjant"/>
		</equal>
		<equal>		
		  <clip pos="1" side="tl" part="a_adj"/>
		  <lit-tag v="det"/>
		</equal>
	      </or>
	    </test>
	    <out> 
	      <chunk name="det_adj_nom" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="SN"/></tag>
		  <tag><var n="tipusdet"/></tag>
		  <tag><clip pos="2" side="tl" part="gen"/></tag>
		  <tag><clip pos="2" side="tl" part="nbr"/></tag>
		</tags>	
		<lu>
		  <clip pos="3" side="tl" part="lem"/> 
		  <clip pos="3" side="tl" part="a_det"/> 
		  <lit-tag v="2"/> 
		  <clip pos="3" side="tl" part="GD" link-to="3"/>
		  <clip pos="3" side="tl" part="mf"/>
		  <clip pos="3" side="tl" part="nbr"/>
		</lu>
		<b pos="1"/>	
		<lu> 
		  <clip pos="1" side="tl" part="lem"/> 
		  <clip pos="1" side="tl" part="a_adj"/>
		  <clip pos="1" side="tl" part="tipus_det"/>
		  <clip pos="1" side="tl" part="GD" link-to="3"/>
		  <clip pos="1" side="tl" part="mf"/>
		  <clip pos="1" side="tl" part="nbr" link-to="4"/>
		</lu>
		<b/>
		<lu> 
		  <clip pos="2" side="tl" part="lemh"/> 
		  <clip pos="2" side="tl" part="a_nom"/>
		  <clip pos="2" side="tl" part="GD" link-to="3"/>
		  <clip pos="2" side="tl" part="mf"/>
		  <clip pos="2" side="tl" part="nbr" link-to="4"/>
		  <clip pos="2" side="tl" part="lemq"/> 
		</lu>
	      </chunk>
	    </out>
	  </when>
	  <otherwise>
	    <out> 
	      <chunk name="det_nom_adj" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="SN"/></tag>
		  <tag><var n="tipusdet"/></tag>
		  <tag><clip pos="2" side="tl" part="gen"/></tag>
		  <tag><clip pos="2" side="tl" part="nbr"/></tag>
		</tags>
		<lu>
		  <clip pos="3" side="tl" part="lem"/> 
		  <clip pos="3" side="tl" part="a_det"/> 
		  <lit-tag v="2"/> 
		  <clip pos="3" side="tl" part="GD" link-to="3"/>
		  <clip pos="3" side="tl" part="mf"/>
		  <clip pos="3" side="tl" part="nbr"/>
		</lu>
		<b pos="1"/>
		<lu> 
		  <clip pos="2" side="tl" part="lemh"/> 
		  <clip pos="2" side="tl" part="a_nom"/>
		  <clip pos="2" side="tl" part="GD" link-to="3"/>
		  <clip pos="2" side="tl" part="mf"/>
		  <clip pos="2" side="tl" part="nbr" link-to="4"/>
		  <clip pos="2" side="tl" part="lemq"/> 
		</lu>
		<b/>
		<lu> 
		  <clip pos="1" side="tl" part="lem"/> 
		  <clip pos="1" side="tl" part="a_adj"/>
		  <clip pos="1" side="tl" part="GD" link-to="3"/>
		  <clip pos="1" side="tl" part="mf"/>
		  <clip pos="1" side="tl" part="nbr" link-to="4"/>
		</lu>
	      </chunk>
	    </out>
	  </otherwise>
	</choose>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
 </rule>

 <rule comment="REGLA: ADJ + NOM + DET + POST (lehen orrialdean)">
      <pattern>
	<pattern-item n="adjizl"/>
	<pattern-item n="nom"/>
	<pattern-item n="det"/>
	<pattern-item n="post"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="concord_n3">
	  <with-param pos="2"/>
	  <with-param pos="1"/>
	  <with-param pos="3"/>
	</call-macro>
	<call-macro n="tipo_det">
	  <with-param pos="3"/>
	</call-macro>
	<call-macro n="SPgenitivo">
	  <with-param pos="4"/>
	</call-macro>
	<choose>
	  <when>
	    <test>
	      <or>
		<equal>		
		  <clip pos="1" side="tl" part="a_adj"/>
		  <lit-tag v="adjant"/>
		</equal>
		<equal>		
		  <clip pos="1" side="tl" part="a_adj"/>
		  <lit-tag v="det"/>
		</equal>
	      </or>
	    </test>
	    <out> 
	      <chunk name="pr_det_adj_nom" case="caseFirstWord">
		<tags>
		  <tag><var n="chunk"/></tag>
		  <tag><var n="tipusdet"/></tag>
		  <tag><clip pos="2" side="tl" part="gen"/></tag>
		  <tag><clip pos="2" side="tl" part="nbr"/></tag>
		</tags>	
		<lu>
		  <clip pos="4" side="tl" part="whole"/> 
		</lu>
		<b pos="1"/>
		<lu>
		  <clip pos="3" side="tl" part="lem"/> 
		  <clip pos="3" side="tl" part="a_det"/> 
		  <lit-tag v="2"/> 
		  <clip pos="3" side="tl" part="GD" link-to="3"/>
		  <clip pos="3" side="tl" part="mf"/>
		  <clip pos="3" side="tl" part="nbr"/>
		</lu>
		<b/>	
		<lu> 
		  <clip pos="1" side="tl" part="lem"/> 
		  <clip pos="1" side="tl" part="a_adj"/>
		  <clip pos="1" side="tl" part="tipus_det"/>
		  <clip pos="1" side="tl" part="GD" link-to="3"/>
		  <clip pos="1" side="tl" part="mf"/>
		  <clip pos="1" side="tl" part="nbr" link-to="4"/>
		</lu>
		<b/>
		<lu> 
		  <clip pos="2" side="tl" part="lemh"/> 
		  <clip pos="2" side="tl" part="a_nom"/>
		  <clip pos="2" side="tl" part="GD" link-to="3"/>
		  <clip pos="2" side="tl" part="mf"/>
		  <clip pos="2" side="tl" part="nbr" link-to="4"/>
		  <clip pos="2" side="tl" part="lemq"/> 
		</lu>
	      </chunk>
	    </out>
	  </when>
	  <otherwise>
	    <out> 
	      <chunk name="pr_det_nom_adj" case="caseFirstWord">
		<tags>
		  <tag><var n="chunk"/></tag>
		  <tag><var n="tipusdet"/></tag>
		  <tag><clip pos="2" side="tl" part="gen"/></tag>
		  <tag><clip pos="2" side="tl" part="nbr"/></tag>
		</tags>
		<lu>
		  <clip pos="4" side="tl" part="whole"/> 
		</lu>
		<b pos="1"/>
		<lu>
		  <clip pos="3" side="tl" part="lem"/> 
		  <clip pos="3" side="tl" part="a_det"/> 
		  <lit-tag v="2"/> 
		  <clip pos="3" side="tl" part="GD" link-to="3"/>
		  <clip pos="3" side="tl" part="mf"/>
		  <clip pos="3" side="tl" part="nbr"/>
		</lu>
		<b/>
		<lu> 
		  <clip pos="2" side="tl" part="lemh"/> 
		  <clip pos="2" side="tl" part="a_nom"/>
		  <clip pos="2" side="tl" part="GD" link-to="3"/>
		  <clip pos="2" side="tl" part="mf"/>
		  <clip pos="2" side="tl" part="nbr" link-to="4"/>
		  <clip pos="2" side="tl" part="lemq"/> 
		</lu>
		<b/>
		<lu> 
		  <clip pos="1" side="tl" part="lem"/> 
		  <clip pos="1" side="tl" part="a_adj"/>
		  <clip pos="1" side="tl" part="GD" link-to="3"/>
		  <clip pos="1" side="tl" part="mf"/>
		  <clip pos="1" side="tl" part="nbr" link-to="4"/>
		</lu>
	      </chunk>
	    </out>
	  </otherwise>
	</choose>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
 </rule>

<rule comment="REGLA: ADJ + NOM + DET + POST (azken urtetako)">
      <pattern>
	<pattern-item n="adjizl"/>
	<pattern-item n="nom"/>
	<pattern-item n="post"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="concord_n2">
	  <with-param pos="2"/>
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="SPgenitivo">
	  <with-param pos="3"/>
	</call-macro>
	<choose>
	  <when>
	    <test>
	      <or>
		<equal>		
		  <clip pos="1" side="tl" part="a_adj"/>
		  <lit-tag v="adjant"/>
		</equal>
		<equal>		
		  <clip pos="1" side="tl" part="a_adj"/>
		  <lit-tag v="det"/>
		</equal>
	      </or>
	    </test>
	    <out> 
	      <chunk name="pr_adj_nom" case="caseFirstWord">
		<tags>
		  <tag><var n="chunk"/></tag>
		  <tag><lit-tag v="UNDET"/></tag>
		  <tag><clip pos="2" side="tl" part="gen"/></tag>
		  <tag><clip pos="2" side="tl" part="nbr"/></tag>
		</tags>	
		<lu>
		  <clip pos="3" side="tl" part="whole"/> 
		</lu>
		<b pos="1"/>
		<lu> 
		  <clip pos="1" side="tl" part="lem"/> 
		  <clip pos="1" side="tl" part="a_adj"/>
		  <clip pos="1" side="tl" part="tipus_det"/>
		  <clip pos="1" side="tl" part="GD" link-to="3"/>
		  <clip pos="1" side="tl" part="mf"/>
		  <clip pos="1" side="tl" part="nbr" link-to="4"/>
		</lu>
		<b/>
		<lu> 
		  <clip pos="2" side="tl" part="lemh"/> 
		  <clip pos="2" side="tl" part="a_nom"/>
		  <clip pos="2" side="tl" part="GD" link-to="3"/>
		  <clip pos="2" side="tl" part="mf"/>
		  <clip pos="2" side="tl" part="nbr" link-to="4"/>
		  <clip pos="2" side="tl" part="lemq"/> 
		</lu>
	      </chunk>
	    </out>
	  </when>
	  <otherwise>
	    <out> 
	      <chunk name="pr_nom_adj" case="caseFirstWord">
		<tags>
		  <tag><var n="chunk"/></tag>
		  <tag><lit-tag v="UNDET"/></tag>
		  <tag><clip pos="2" side="tl" part="gen"/></tag>
		  <tag><clip pos="2" side="tl" part="nbr"/></tag>
		</tags>
		<lu>
		  <clip pos="3" side="tl" part="whole"/> 
		</lu>
		<b pos="1"/>
		<lu> 
		  <clip pos="2" side="tl" part="lemh"/> 
		  <clip pos="2" side="tl" part="a_nom"/>
		  <clip pos="2" side="tl" part="GD" link-to="3"/>
		  <clip pos="2" side="tl" part="mf"/>
		  <clip pos="2" side="tl" part="nbr" link-to="4"/>
		  <clip pos="2" side="tl" part="lemq"/> 
		</lu>
		<b/>
		<lu> 
		  <clip pos="1" side="tl" part="lem"/> 
		  <clip pos="1" side="tl" part="a_adj"/>
		  <clip pos="1" side="tl" part="GD" link-to="3"/>
		  <clip pos="1" side="tl" part="mf"/>
		  <clip pos="1" side="tl" part="nbr" link-to="4"/>
		</lu>
	      </chunk>
	    </out>
	  </otherwise>
	</choose>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
 </rule>


 <rule comment="REGLA: ADJ + NOM + ADJ + DET (beste etxe ederra)">
      <pattern>
	<pattern-item n="adjizl"/>
	<pattern-item n="nom"/>
	<pattern-item n="adj"/>
	<pattern-item n="det"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="concord_n4">
	  <with-param pos="2"/>
	  <with-param pos="3"/>
	  <with-param pos="1"/>
	  <with-param pos="4"/>
	</call-macro>
	<call-macro n="tipo_det">
	  <with-param pos="4"/>
	</call-macro>
	<choose>
	  <when>
	    <test>
	      <or>
		<equal>		
		  <clip pos="1" side="tl" part="a_adj"/>
		  <lit-tag v="adjant"/>
		</equal>
		<equal>		
		  <clip pos="1" side="tl" part="a_adj"/>
		  <lit-tag v="det"/>
		</equal>
	      </or>
	    </test>
	    <out> 
	      <chunk name="det_adj_nom_adj" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="SN"/></tag>
		  <tag><var n="tipusdet"/></tag>
		  <tag><clip pos="2" side="tl" part="gen"/></tag>
		  <tag><clip pos="2" side="tl" part="nbr"/></tag>
		</tags>	
		<lu>
		  <clip pos="4" side="tl" part="lem"/> 
		  <clip pos="4" side="tl" part="a_det"/> 
		  <lit-tag v="2"/> 
		  <clip pos="4" side="tl" part="GD" link-to="3"/>
		  <clip pos="4" side="tl" part="mf"/>
		  <clip pos="4" side="tl" part="nbr"/>
		</lu>
		<b pos="1"/>	
		<lu> 
		  <clip pos="1" side="tl" part="lem"/> 
		  <clip pos="1" side="tl" part="a_adj"/>
		  <clip pos="1" side="tl" part="tipus_det"/>
		  <clip pos="1" side="tl" part="GD" link-to="3"/>
		  <clip pos="1" side="tl" part="mf"/>
		  <clip pos="1" side="tl" part="nbr" link-to="4"/>
		</lu>
		<b pos="2"/>
		<lu> 
		  <clip pos="2" side="tl" part="lemh"/> 
		  <clip pos="2" side="tl" part="a_nom"/>
		  <clip pos="2" side="tl" part="GD" link-to="3"/>
		  <clip pos="2" side="tl" part="mf"/>
		  <clip pos="2" side="tl" part="nbr" link-to="4"/>
		  <clip pos="2" side="tl" part="lemq"/> 
		</lu>
		<b/>
		<lu> 
		  <clip pos="3" side="tl" part="lem"/> 
		  <clip pos="3" side="tl" part="a_adj"/>
		  <clip pos="3" side="tl" part="GD" link-to="3"/>
		  <clip pos="3" side="tl" part="mf"/>
		  <clip pos="3" side="tl" part="nbr" link-to="4"/>
		</lu>
	      </chunk>
	    </out>
	  </when>
	  <otherwise>
	    <out> 
	      <chunk name="det_nom_adj_adj" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="SN"/></tag>
		  <tag><var n="tipusdet"/></tag>
		  <tag><clip pos="2" side="tl" part="gen"/></tag>
		  <tag><clip pos="2" side="tl" part="nbr"/></tag>
		</tags>	
		<lu>
		  <clip pos="4" side="tl" part="lem"/> 
		  <clip pos="4" side="tl" part="a_det"/> 
		  <lit-tag v="2"/> 
		  <clip pos="4" side="tl" part="GD" link-to="3"/>
		  <clip pos="4" side="tl" part="mf"/>
		  <clip pos="4" side="tl" part="nbr"/>
		</lu>
		<b pos="1"/>	
		
		<lu> 
		  <clip pos="2" side="tl" part="lemh"/> 
		  <clip pos="2" side="tl" part="a_nom"/>
		  <clip pos="2" side="tl" part="GD" link-to="3"/>
		  <clip pos="2" side="tl" part="mf"/>
		  <clip pos="2" side="tl" part="nbr" link-to="4"/>
		  <clip pos="2" side="tl" part="lemq"/> 
		</lu>
		<b pos="2"/>
		<lu> 
		  <clip pos="3" side="tl" part="lem"/> 
		  <clip pos="3" side="tl" part="a_adj"/>
		  <clip pos="3" side="tl" part="GD" link-to="3"/>
		  <clip pos="3" side="tl" part="mf"/>
		  <clip pos="3" side="tl" part="nbr" link-to="4"/>
		</lu>
		<b/>
		<lu> 
		  <clip pos="1" side="tl" part="lem"/> 
		  <clip pos="1" side="tl" part="a_adj"/>
		  <clip pos="1" side="tl" part="tipus_det"/>
		  <clip pos="1" side="tl" part="GD" link-to="3"/>
		  <clip pos="1" side="tl" part="mf"/>
		  <clip pos="1" side="tl" part="nbr" link-to="4"/>
		</lu>
	      </chunk>
	    </out>
	  </otherwise>
	</choose>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
 </rule>


 <rule comment="REGLA: ADJ + NOM + ADJ + DET + POST (beste etxe ederran)">
      <pattern>
	<pattern-item n="adjizl"/>
	<pattern-item n="nom"/>
	<pattern-item n="adj"/>
	<pattern-item n="det"/>
	<pattern-item n="post"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="concord_n4">
	  <with-param pos="2"/>
	  <with-param pos="3"/>
	  <with-param pos="1"/>
	  <with-param pos="4"/>
	</call-macro>
	<call-macro n="tipo_det">
	  <with-param pos="4"/>
	</call-macro>
	<call-macro n="SPgenitivo">
	  <with-param pos="5"/>
	</call-macro>
	<choose>
	  <when>
	    <test>
	      <or>
		<equal>		
		  <clip pos="1" side="tl" part="a_adj"/>
		  <lit-tag v="adjant"/>
		</equal>
		<equal>		
		  <clip pos="1" side="tl" part="a_adj"/>
		  <lit-tag v="det"/>
		</equal>
	      </or>
	    </test>
	    <out> 
	      <chunk name="pr_det_adj_nom_adj" case="caseFirstWord">
		<tags>
		  <tag><var n="chunk"/></tag>
		  <tag><var n="tipusdet"/></tag>
		  <tag><clip pos="2" side="tl" part="gen"/></tag>
		  <tag><clip pos="2" side="tl" part="nbr"/></tag>
		</tags>	
		<lu>
		  <clip pos="5" side="tl" part="whole"/> 
		</lu>
		<b pos="1"/>
		<lu>
		  <clip pos="4" side="tl" part="lem"/> 
		  <clip pos="4" side="tl" part="a_det"/> 
		  <lit-tag v="2"/> 
		  <clip pos="4" side="tl" part="GD" link-to="3"/>
		  <clip pos="4" side="tl" part="mf"/>
		  <clip pos="4" side="tl" part="nbr"/>
		</lu>
		<b pos="2"/>	
		<lu> 
		  <clip pos="1" side="tl" part="lem"/> 
		  <clip pos="1" side="tl" part="a_adj"/>
		  <clip pos="1" side="tl" part="tipus_det"/>
		  <clip pos="1" side="tl" part="GD" link-to="3"/>
		  <clip pos="1" side="tl" part="mf"/>
		  <clip pos="1" side="tl" part="nbr" link-to="4"/>
		</lu>
		<b/>
		<lu> 
		  <clip pos="2" side="tl" part="lemh"/> 
		  <clip pos="2" side="tl" part="a_nom"/>
		  <clip pos="2" side="tl" part="GD" link-to="3"/>
		  <clip pos="2" side="tl" part="mf"/>
		  <clip pos="2" side="tl" part="nbr" link-to="4"/>
		  <clip pos="2" side="tl" part="lemq"/> 
		</lu>
		<b/>
		<lu> 
		  <clip pos="3" side="tl" part="lem"/> 
		  <clip pos="3" side="tl" part="a_adj"/>
		  <clip pos="3" side="tl" part="GD" link-to="3"/>
		  <clip pos="3" side="tl" part="mf"/>
		  <clip pos="3" side="tl" part="nbr" link-to="4"/>
		</lu>
	      </chunk>
	    </out>
	  </when>
	  <otherwise>
	    <out> 
	      <chunk name="pr_det_nom_adj_adj" case="caseFirstWord">
		<tags>
		  <tag><var n="chunk"/></tag>
		  <tag><var n="tipusdet"/></tag>
		  <tag><clip pos="2" side="tl" part="gen"/></tag>
		  <tag><clip pos="2" side="tl" part="nbr"/></tag>
		</tags>	
		<lu>
		  <clip pos="5" side="tl" part="whole"/> 
		</lu>
		<b pos="1"/>
		<lu>
		  <clip pos="4" side="tl" part="lem"/> 
		  <clip pos="4" side="tl" part="a_det"/> 
		  <lit-tag v="2"/> 
		  <clip pos="4" side="tl" part="GD" link-to="3"/>
		  <clip pos="4" side="tl" part="mf"/>
		  <clip pos="4" side="tl" part="nbr"/>
		</lu>
		<b pos="2"/>		
		<lu> 
		  <clip pos="2" side="tl" part="lemh"/> 
		  <clip pos="2" side="tl" part="a_nom"/>
		  <clip pos="2" side="tl" part="GD" link-to="3"/>
		  <clip pos="2" side="tl" part="mf"/>
		  <clip pos="2" side="tl" part="nbr" link-to="4"/>
		  <clip pos="2" side="tl" part="lemq"/> 
		</lu>
		<b/>
		<lu> 
		  <clip pos="3" side="tl" part="lem"/> 
		  <clip pos="3" side="tl" part="a_adj"/>
		  <clip pos="3" side="tl" part="GD" link-to="3"/>
		  <clip pos="3" side="tl" part="mf"/>
		  <clip pos="3" side="tl" part="nbr" link-to="4"/>
		</lu>
		<b/>
		<lu> 
		  <clip pos="1" side="tl" part="lem"/> 
		  <clip pos="1" side="tl" part="a_adj"/>
		  <clip pos="1" side="tl" part="tipus_det"/>
		  <clip pos="1" side="tl" part="GD" link-to="3"/>
		  <clip pos="1" side="tl" part="mf"/>
		  <clip pos="1" side="tl" part="nbr" link-to="4"/>
		</lu>
	      </chunk>
	    </out>
	  </otherwise>
	</choose>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
 </rule>

<!-- SN precedidos de complementos de nombre -->

<rule comment="REGLA: N(incluye adv) + ko/ren + NOM + DET (gaurko egunkaria)">
      <pattern>
	<pattern-item n="nom_adv"/>
	<pattern-item n="ko_en"/>
	<pattern-item n="nom"/>
	<pattern-item n="det"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="concord_n2">
	  <with-param pos="3"/>
	  <with-param pos="4"/>
	</call-macro>
	<call-macro n="nbr_n1">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="tipo_det">
	  <with-param pos="4"/>
	</call-macro>
	<out> 
	  <chunk name="d_n_pr_n" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN"/></tag>
	      <tag><var n="tipusdet"/></tag>
	      <tag><clip pos="3" side="tl" part="gen"/></tag>
	      <tag><clip pos="3" side="tl" part="nbr"/></tag>
	    </tags>
	    <lu>
	      <clip pos="4" side="tl" part="lem"/> 
	      <clip pos="4" side="tl" part="a_det"/> 
	      <lit-tag v="2"/> 
	      <clip pos="4" side="tl" part="GD" link-to="3"/>
	      <clip pos="4" side="tl" part="mf"/>
	      <clip pos="4" side="tl" part="nbr"/>
	    </lu>
	    <b pos="1"/>
	    <lu> 
	      <clip pos="3" side="tl" part="lemh"/> 
	      <clip pos="3" side="tl" part="a_nom"/>
	      <clip pos="3" side="tl" part="GD" link-to="3"/>
	      <clip pos="3" side="tl" part="mf"/>
	      <clip pos="3" side="tl" part="nbr" link-to="4"/>
	      <clip pos="3" side="tl" part="lemq"/> 
	    </lu>
	    <b/>
	    <lu> 
	      <clip pos="2" side="tl" part="whole"/> 
	    </lu>
	    <b/>
	    <lu> 
	      <clip pos="1" side="tl" part="lemh"/> 
	      <clip pos="1" side="tl" part="a_nom"/>
	      <clip pos="1" side="tl" part="a_adv"/>
	      <clip pos="1" side="tl" part="gen"/>
	      <var n="nombre"/>
	      <clip pos="1" side="tl" part="lemq"/> 
	    </lu>
	  </chunk>
	</out>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
 </rule>


<rule comment="REGLA: N(incluye adv) + ko/ren + NOM + DET + POST (gaurko entzierroan)">
      <pattern>
	<pattern-item n="nom_adv"/>
	<pattern-item n="ko_en"/>
	<pattern-item n="nom"/>
	<pattern-item n="det"/>
	<pattern-item n="post"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="concord_n2">
	  <with-param pos="3"/>
	  <with-param pos="4"/>
	</call-macro>
	<call-macro n="nbr_n1">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="tipo_det">
	  <with-param pos="4"/>
	</call-macro>
	<call-macro n="SPgenitivo">
	  <with-param pos="5"/>
	</call-macro>
	<out> 
	  <chunk name="pr_d_n_pr_n" case="caseFirstWord">
	    <tags>
	      <tag><var n="chunk"/></tag>
	      <tag><var n="tipusdet"/></tag>
	      <tag><clip pos="3" side="tl" part="gen"/></tag>
	      <tag><clip pos="3" side="tl" part="nbr"/></tag>
	    </tags>
	     <lu> 
	      <clip pos="5" side="tl" part="whole"/> 
	    </lu>
	    <b pos="1"/>
	    <lu>
	      <clip pos="4" side="tl" part="lem"/> 
	      <clip pos="4" side="tl" part="a_det"/> 
	      <lit-tag v="2"/> 
	      <clip pos="4" side="tl" part="GD" link-to="3"/>
	      <clip pos="4" side="tl" part="mf"/>
	      <clip pos="4" side="tl" part="nbr"/>
	    </lu>
	    <b/>
	    <lu> 
	      <clip pos="3" side="tl" part="lemh"/> 
	      <clip pos="3" side="tl" part="a_nom"/>
	      <clip pos="3" side="tl" part="GD" link-to="3"/>
	      <clip pos="3" side="tl" part="mf"/>
	      <clip pos="3" side="tl" part="nbr" link-to="4"/>
	      <clip pos="3" side="tl" part="lemq"/> 
	    </lu>
	    <b/>
	    <lu> 
	      <clip pos="2" side="tl" part="whole"/> 
	    </lu>
	    <b/>
	    <lu> 
	      <clip pos="1" side="tl" part="lemh"/> 
	      <clip pos="1" side="tl" part="a_nom"/>
	      <clip pos="1" side="tl" part="a_adv"/>
	      <clip pos="1" side="tl" part="gen"/>
	      <var n="nombre"/>
	      <clip pos="1" side="tl" part="lemq"/> 
	    </lu>
	  </chunk>
	</out>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
 </rule>

<rule comment="REGLA: N + ART + ko/ren + NOM + DET (emakumearen egunkaria)"> 
      <pattern>
	<pattern-item n="nom"/>
	<pattern-item n="det"/>
	<pattern-item n="ko_en"/>
	<pattern-item n="nom"/>
	<pattern-item n="det"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="concord_n2">
	  <with-param pos="4"/>
	  <with-param pos="5"/>
	</call-macro>
	<call-macro n="concord_n2">
	  <with-param pos="1"/>
	  <with-param pos="2"/>
	</call-macro>
	<call-macro n="tipo_det">
	  <with-param pos="5"/>
	</call-macro>
	<out> 
	  <chunk name="d_n_pr_d_n" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN"/></tag>
	      <tag><var n="tipusdet"/></tag>
	      <tag><clip pos="4" side="tl" part="gen"/></tag>
	      <tag><clip pos="4" side="tl" part="nbr"/></tag>
	    </tags>
	    <lu>
	      <clip pos="5" side="tl" part="lem"/> 
	      <clip pos="5" side="tl" part="a_det"/> 
	      <lit-tag v="2"/> 
	      <clip pos="5" side="tl" part="GD" link-to="3"/>
	      <clip pos="5" side="tl" part="mf"/>
	      <clip pos="5" side="tl" part="nbr"/>
	    </lu>
	    <b pos="1"/>
	    <lu> 
	      <clip pos="4" side="tl" part="lemh"/> 
	      <clip pos="4" side="tl" part="a_nom"/>
	      <clip pos="4" side="tl" part="GD" link-to="3"/>
	      <clip pos="4" side="tl" part="mf"/>
	      <clip pos="4" side="tl" part="nbr" link-to="4"/>
	      <clip pos="4" side="tl" part="lemq"/> 
	    </lu>
	    <b/>
	    <lu> 
	      <clip pos="3" side="tl" part="whole"/> 
	    </lu>
	    <b/>
	    <lu>
	      <clip pos="2" side="tl" part="whole"/>
	    </lu>
	    <b/>
	    <lu> 
	      <clip pos="1" side="tl" part="lemh"/> 
	      <clip pos="1" side="tl" part="a_nom"/>
	      <clip pos="1" side="tl" part="gen"/>
	      <clip pos="1" side="tl" part="nbr"/>
	      <clip pos="1" side="tl" part="lemq"/> 
	    </lu>
	  </chunk>
	</out>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
 </rule>

<rule comment="REGLA: N + ART + ko/ren + NOM + DET (larunbateko etapan)"> 
      <pattern>
	<pattern-item n="nom"/>
	<pattern-item n="det"/>
	<pattern-item n="ko_en"/>
	<pattern-item n="nom"/>
	<pattern-item n="det"/>
	<pattern-item n="post"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="concord_n2">
	  <with-param pos="4"/>
	  <with-param pos="5"/>
	</call-macro>
	<call-macro n="concord_n2">
	  <with-param pos="1"/>
	  <with-param pos="2"/>
	</call-macro>
	<call-macro n="tipo_det">
	  <with-param pos="5"/>
	</call-macro>
	<call-macro n="SPgenitivo">
	  <with-param pos="6"/>
	</call-macro>
	<out> 
	  <chunk name="pr_d_n_pr_d_n" case="caseFirstWord">
	    <tags>
	      <tag><var n="chunk"/></tag>
	      <tag><var n="tipusdet"/></tag>
	      <tag><clip pos="4" side="tl" part="gen"/></tag>
	      <tag><clip pos="4" side="tl" part="nbr"/></tag>
	    </tags>
	    <lu>
	      <clip pos="6" side="tl" part="whole"/> 
	    </lu>
	    <b pos="1"/>
	    <lu>
	      <clip pos="5" side="tl" part="lem"/> 
	      <clip pos="5" side="tl" part="a_det"/> 
	      <lit-tag v="2"/> 
	      <clip pos="5" side="tl" part="GD" link-to="3"/>
	      <clip pos="5" side="tl" part="mf"/>
	      <clip pos="5" side="tl" part="nbr"/>
	    </lu>
	    <b/>
	    <lu> 
	      <clip pos="4" side="tl" part="lemh"/> 
	      <clip pos="4" side="tl" part="a_nom"/>
	      <clip pos="4" side="tl" part="GD" link-to="3"/>
	      <clip pos="4" side="tl" part="mf"/>
	      <clip pos="4" side="tl" part="nbr" link-to="4"/>
	      <clip pos="4" side="tl" part="lemq"/> 
	    </lu>
	    <b/>
	    <lu> 
	      <clip pos="3" side="tl" part="whole"/> 
	    </lu>
	    <b/>
	    <lu>
	      <clip pos="2" side="tl" part="whole"/>
	    </lu>
	    <b/>
	    <lu> 
	      <clip pos="1" side="tl" part="lemh"/> 
	      <clip pos="1" side="tl" part="a_nom"/>
	      <clip pos="1" side="tl" part="gen"/>
	      <clip pos="1" side="tl" part="nbr"/>
	      <clip pos="1" side="tl" part="lemq"/> 
	    </lu>
	  </chunk>
	</out>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
 </rule>

<rule comment="REGLA: N(incluye adv) + ko/ren + NOM + DET (hurrengo Nafarroako Gobernua)">
      <pattern>
	<pattern-item n="adjizl"/>
	<pattern-item n="nom_adv"/>
	<pattern-item n="ko_en"/>
	<pattern-item n="nom"/>
	<pattern-item n="det"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="concord_n3">
	  <with-param pos="4"/>
	  <with-param pos="5"/>
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="nbr_n1">
	  <with-param pos="2"/>
	</call-macro>
	<call-macro n="tipo_det">
	  <with-param pos="5"/>
	</call-macro>
	<choose>
	  <when>
	    <test>
	      <or>
		<equal>		
		  <clip pos="1" side="tl" part="a_adj"/>
		  <lit-tag v="adjant"/>
		</equal>
		<equal>		
		  <clip pos="1" side="tl" part="a_adj"/>
		  <lit-tag v="det"/>
		</equal>
	      </or>
	    </test>
	<out> 
	  <chunk name="d_a_n_pr_n" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN"/></tag>
	      <tag><var n="tipusdet"/></tag>
	      <tag><clip pos="4" side="tl" part="gen"/></tag>
	      <tag><clip pos="4" side="tl" part="nbr"/></tag>
	    </tags>
	    <lu>
	      <clip pos="5" side="tl" part="lem"/> 
	      <clip pos="5" side="tl" part="a_det"/> 
	      <lit-tag v="2"/> 
	      <clip pos="5" side="tl" part="GD" link-to="3"/>
	      <clip pos="5" side="tl" part="mf"/>
	      <clip pos="5" side="tl" part="nbr"/>
	    </lu>
	    <b pos="1"/>
	    <lu> 
	      <clip pos="1" side="tl" part="lem"/> 
	      <clip pos="1" side="tl" part="a_adj"/>
	      <clip pos="1" side="tl" part="tipus_det"/>
	      <clip pos="1" side="tl" part="GD" link-to="3"/>
	      <clip pos="1" side="tl" part="mf"/>
	      <clip pos="1" side="tl" part="nbr" link-to="4"/>
	    </lu>
	    <b pos="2"/>
	    <lu> 
	      <clip pos="4" side="tl" part="lemh"/> 
	      <clip pos="4" side="tl" part="a_nom"/>
	      <clip pos="4" side="tl" part="GD" link-to="3"/>
	      <clip pos="4" side="tl" part="mf"/>
	      <clip pos="4" side="tl" part="nbr" link-to="4"/>
	      <clip pos="4" side="tl" part="lemq"/> 
	    </lu>
	    <b/>
	    <lu> 
	      <clip pos="3" side="tl" part="whole"/> 
	    </lu>
	    <b/>
	    <lu> 
	      <clip pos="2" side="tl" part="lemh"/> 
	      <clip pos="2" side="tl" part="a_nom"/>
	      <clip pos="2" side="tl" part="a_adv"/>
	      <clip pos="2" side="tl" part="gen"/>
	      <var n="nombre"/>
	      <clip pos="2" side="tl" part="lemq"/> 
	    </lu>
	  </chunk>
	</out>
	  </when>
	  <otherwise>
	    <out> 
	  <chunk name="d_n_pr_n_a" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN"/></tag>
	      <tag><var n="tipusdet"/></tag>
	      <tag><clip pos="4" side="tl" part="gen"/></tag>
	      <tag><clip pos="4" side="tl" part="nbr"/></tag>
	    </tags>
	    <lu>
	      <clip pos="5" side="tl" part="lem"/> 
	      <clip pos="5" side="tl" part="a_det"/> 
	      <lit-tag v="2"/> 
	      <clip pos="5" side="tl" part="GD" link-to="3"/>
	      <clip pos="5" side="tl" part="mf"/>
	      <clip pos="5" side="tl" part="nbr"/>
	    </lu>
	    <b pos="1"/>
	    <lu> 
	      <clip pos="4" side="tl" part="lemh"/> 
	      <clip pos="4" side="tl" part="a_nom"/>
	      <clip pos="4" side="tl" part="GD" link-to="3"/>
	      <clip pos="4" side="tl" part="mf"/>
	      <clip pos="4" side="tl" part="nbr" link-to="4"/>
	      <clip pos="4" side="tl" part="lemq"/> 
	    </lu>
	    <b pos="2"/>
	    <lu> 
	      <clip pos="3" side="tl" part="whole"/> 
	    </lu>
	    <b/>
	    <lu> 
	      <clip pos="2" side="tl" part="lemh"/> 
	      <clip pos="2" side="tl" part="a_nom"/>
	      <clip pos="2" side="tl" part="a_adv"/>
	      <clip pos="2" side="tl" part="gen"/>
	      <var n="nombre"/>
	      <clip pos="2" side="tl" part="lemq"/> 
	    </lu>
	     <b/>
	    <lu> 
	      <clip pos="1" side="tl" part="lem"/> 
	      <clip pos="1" side="tl" part="a_adj"/>
	      <clip pos="1" side="tl" part="tipus_det"/>
	      <clip pos="1" side="tl" part="GD" link-to="3"/>
	      <clip pos="1" side="tl" part="mf"/>
	      <clip pos="1" side="tl" part="nbr" link-to="4"/>
	    </lu>
	  </chunk>
	</out>
	  </otherwise>
	</choose>	    
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
 </rule>


<rule comment="REGLA: N + ART + ko/ren + NOM + DET (bulegoko zuzendari ohia - el ex director de la oficina)"> 
      <pattern>
	<pattern-item n="nom"/>
	<pattern-item n="det"/>
	<pattern-item n="ko_en"/>
	<pattern-item n="nom"/>
	<pattern-item n="adj"/>
	<pattern-item n="det"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="concord_n3">
	  <with-param pos="4"/>
	  <with-param pos="5"/>
	  <with-param pos="6"/>
	</call-macro>
	<call-macro n="concord_n2">
	  <with-param pos="1"/>
	  <with-param pos="2"/>
	</call-macro>
	<call-macro n="tipo_det">
	  <with-param pos="6"/>
	</call-macro>
	<choose>
	  <when>
	    <test>
	      <or>
		<equal>		
		  <clip pos="5" side="tl" part="a_adj"/>
		  <lit-tag v="adjant"/>
		</equal>
		<equal>		
		  <clip pos="5" side="tl" part="a_adj"/>
		  <lit-tag v="det"/>
		</equal>
	      </or>
	    </test>
	    <out> 
	      <chunk name="d_a_n_pr_d_n" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN"/></tag>
	      <tag><var n="tipusdet"/></tag>
	      <tag><clip pos="4" side="tl" part="gen"/></tag>
	      <tag><clip pos="4" side="tl" part="nbr"/></tag>
	    </tags>
	    <lu>
	      <clip pos="6" side="tl" part="lem"/> 
	      <clip pos="6" side="tl" part="a_det"/> 
	      <lit-tag v="2"/> 
	      <clip pos="6" side="tl" part="GD" link-to="3"/>
	      <clip pos="6" side="tl" part="mf"/>
	      <clip pos="6" side="tl" part="nbr"/>
	    </lu>
	    <b pos="1"/>
	    <lu> 
	      <clip pos="5" side="tl" part="lem"/> 
	      <clip pos="5" side="tl" part="a_adj"/>
	      <clip pos="5" side="tl" part="tipus_det"/>
	      <clip pos="5" side="tl" part="GD" link-to="3"/>
	      <clip pos="5" side="tl" part="mf"/>
	      <clip pos="5" side="tl" part="nbr" link-to="4"/>
	    </lu>
	    <b pos="2"/>
	    <lu> 
	      <clip pos="4" side="tl" part="lemh"/> 
	      <clip pos="4" side="tl" part="a_nom"/>
	      <clip pos="4" side="tl" part="GD" link-to="3"/>
	      <clip pos="4" side="tl" part="mf"/>
	      <clip pos="4" side="tl" part="nbr" link-to="4"/>
	      <clip pos="4" side="tl" part="lemq"/> 
	    </lu>
	    <b/>
	    <lu> 
	      <clip pos="3" side="tl" part="whole"/> 
	    </lu>
	    <b/>
	    <lu>
	      <clip pos="2" side="tl" part="whole"/>
	    </lu>
	    <b/>
	    <lu> 
	      <clip pos="1" side="tl" part="lemh"/> 
	      <clip pos="1" side="tl" part="a_nom"/>
	      <clip pos="1" side="tl" part="gen"/>
	      <clip pos="1" side="tl" part="nbr"/>
	      <clip pos="1" side="tl" part="lemq"/> 
	    </lu>
	  </chunk>
	</out>
	  </when>
	  <otherwise>

	    <out> 
	      <chunk name="d_n_a_pr_d_n" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN"/></tag>
	      <tag><var n="tipusdet"/></tag>
	      <tag><clip pos="4" side="tl" part="gen"/></tag>
	      <tag><clip pos="4" side="tl" part="nbr"/></tag>
	    </tags>
	    <lu>
	      <clip pos="6" side="tl" part="lem"/> 
	      <clip pos="6" side="tl" part="a_det"/> 
	      <lit-tag v="2"/> 
	      <clip pos="6" side="tl" part="GD" link-to="3"/>
	      <clip pos="6" side="tl" part="mf"/>
	      <clip pos="6" side="tl" part="nbr"/>
	    </lu>
	    <b pos="1"/>
	   
	    <lu> 
	      <clip pos="4" side="tl" part="lemh"/> 
	      <clip pos="4" side="tl" part="a_nom"/>
	      <clip pos="4" side="tl" part="GD" link-to="3"/>
	      <clip pos="4" side="tl" part="mf"/>
	      <clip pos="4" side="tl" part="nbr" link-to="4"/>
	      <clip pos="4" side="tl" part="lemq"/> 
	    </lu>
	    <b pos="2"/>
	     <lu> 
	      <clip pos="5" side="tl" part="lem"/> 
	      <clip pos="5" side="tl" part="a_adj"/>
	      <clip pos="5" side="tl" part="GD" link-to="3"/>
	      <clip pos="5" side="tl" part="mf"/>
	      <clip pos="5" side="tl" part="nbr" link-to="4"/>
	    </lu>
	    <b/>
	    <lu>
	      <clip pos="3" side="tl" part="whole"/> 
	    </lu>
	    <b/>
	    <lu>
	      <clip pos="2" side="tl" part="whole"/>
	    </lu>
	    <b/>
	    <lu> 
	      <clip pos="1" side="tl" part="lemh"/> 
	      <clip pos="1" side="tl" part="a_nom"/>
	      <clip pos="1" side="tl" part="gen"/>
	      <clip pos="1" side="tl" part="nbr"/>
	      <clip pos="1" side="tl" part="lemq"/> 
	    </lu>
	  </chunk>
	</out>
	  </otherwise>
	</choose>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
 </rule>


<rule comment="REGLA: N(incluye adv) + ko/ren + N + DET + ko/ren + NOM + DET (Espainiako Errepublikako Gobernua)">
      <pattern>
	<pattern-item n="nom_adv"/>
	<pattern-item n="ko_en"/>
	<pattern-item n="nom_adv"/>
	<pattern-item n="det"/>
	<pattern-item n="ko_en"/>
	<pattern-item n="nom"/>
	<pattern-item n="det"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="concord_n2">
	  <with-param pos="3"/>
	  <with-param pos="4"/>
	</call-macro>
	<call-macro n="concord_n2">
	  <with-param pos="6"/>
	  <with-param pos="7"/>
	</call-macro>
	<call-macro n="nbr_n1">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="tipo_det">
	  <with-param pos="7"/>
	</call-macro>
	<out> 
	  <chunk name="d_n_pr_d_n_pr_n" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN"/></tag>
	      <tag><var n="tipusdet"/></tag>
	      <tag><clip pos="6" side="tl" part="gen"/></tag>
	      <tag><clip pos="6" side="tl" part="nbr"/></tag>
	    </tags>
	    <lu>
	      <clip pos="7" side="tl" part="lem"/> 
	      <clip pos="7" side="tl" part="a_det"/> 
	      <lit-tag v="2"/> 
	      <clip pos="7" side="tl" part="GD" link-to="3"/>
	      <clip pos="7" side="tl" part="mf"/>
	      <clip pos="7" side="tl" part="nbr"/>
	    </lu>
	    <b pos="1"/>
	    <lu> 
	      <clip pos="6" side="tl" part="lemh"/> 
	      <clip pos="6" side="tl" part="a_nom"/>
	      <clip pos="6" side="tl" part="GD" link-to="3"/>
	      <clip pos="6" side="tl" part="mf"/>
	      <clip pos="6" side="tl" part="nbr" link-to="4"/>
	      <clip pos="6" side="tl" part="lemq"/> 
	    </lu>
	    <b pos="2"/>
	    <lu> 
	      <clip pos="5" side="tl" part="whole"/> 
	    </lu>
	    <b/>
	    <lu>
	      <clip pos="4" side="tl" part="whole"/> 
	    </lu>
	    <b/>
	    <lu> 
	      <clip pos="3" side="tl" part="lemh"/> 
	      <clip pos="3" side="tl" part="a_nom"/>
	      <clip pos="3" side="tl" part="gen"/>
	      <clip pos="3" side="tl" part="nbr"/>
	      <clip pos="3" side="tl" part="lemq"/> 
	    </lu>
	    <b/>
	    <lu> 
	      <clip pos="2" side="tl" part="whole"/> 
	    </lu>
	    <b/>
	    <lu> 
	      <clip pos="1" side="tl" part="lemh"/> 
	      <clip pos="1" side="tl" part="a_nom"/>
	      <clip pos="1" side="tl" part="a_adv"/>
	      <clip pos="1" side="tl" part="gen"/>
	      <var n="nombre"/>
	      <clip pos="1" side="tl" part="lemq"/> 
	    </lu>
	  </chunk>
	</out>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
 </rule>


<rule comment="REGLA: N(incluye adv) + ko/ren + N + DET + ko/ren + NOM + DET + POST(Irakeko Gobernuaren aurreikuspenen)">
      <pattern>
	<pattern-item n="nom_adv"/>
	<pattern-item n="ko_en"/>
	<pattern-item n="nom_adv"/>
	<pattern-item n="det"/>
	<pattern-item n="ko_en"/>
	<pattern-item n="nom"/>
	<pattern-item n="det"/>
	<pattern-item n="post"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="concord_n2">
	  <with-param pos="3"/>
	  <with-param pos="4"/>
	</call-macro>
	<call-macro n="concord_n2">
	  <with-param pos="6"/>
	  <with-param pos="7"/>
	</call-macro>
	<call-macro n="nbr_n1">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="tipo_det">
	  <with-param pos="7"/>
	</call-macro>
	<call-macro n="SPgenitivo">
	  <with-param pos="8"/>
	</call-macro>
	<out> 
	  <chunk name="pr_d_n_pr_d_n_pr_n" case="caseFirstWord">
	    <tags>
	      <tag><var n="chunk"/></tag>
	      <tag><var n="tipusdet"/></tag>
	      <tag><clip pos="6" side="tl" part="gen"/></tag>
	      <tag><clip pos="6" side="tl" part="nbr"/></tag>
	    </tags>
	    <lu>
	      <clip pos="8" side="tl" part="whole"/> 
	    </lu>
	    <b pos="1"/>
	    <lu>
	      <clip pos="7" side="tl" part="lem"/> 
	      <clip pos="7" side="tl" part="a_det"/> 
	      <lit-tag v="2"/> 
	      <clip pos="7" side="tl" part="GD" link-to="3"/>
	      <clip pos="7" side="tl" part="mf"/>
	      <clip pos="7" side="tl" part="nbr"/>
	    </lu>
	    <b pos="2"/>
	    <lu> 
	      <clip pos="6" side="tl" part="lemh"/> 
	      <clip pos="6" side="tl" part="a_nom"/>
	      <clip pos="6" side="tl" part="GD" link-to="3"/>
	      <clip pos="6" side="tl" part="mf"/>
	      <clip pos="6" side="tl" part="nbr" link-to="4"/>
	      <clip pos="6" side="tl" part="lemq"/> 
	    </lu>
	    <b/>
	    <lu> 
	      <clip pos="5" side="tl" part="whole"/> 
	    </lu>
	    <b/>
	    <lu>
	      <clip pos="4" side="tl" part="whole"/> 
	    </lu>
	    <b/>
	    <lu> 
	      <clip pos="3" side="tl" part="lemh"/> 
	      <clip pos="3" side="tl" part="a_nom"/>
	      <clip pos="3" side="tl" part="gen"/>
	      <clip pos="3" side="tl" part="nbr"/>
	      <clip pos="3" side="tl" part="lemq"/> 
	    </lu>
	    <b/>
	    <lu> 
	      <clip pos="2" side="tl" part="whole"/> 
	    </lu>
	    <b/>
	    <lu> 
	      <clip pos="1" side="tl" part="lemh"/> 
	      <clip pos="1" side="tl" part="a_nom"/>
	      <clip pos="1" side="tl" part="a_adv"/>
	      <clip pos="1" side="tl" part="gen"/>
	      <var n="nombre"/>
	      <clip pos="1" side="tl" part="lemq"/> 
	    </lu>
	  </chunk>
	</out>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
 </rule>


<rule comment="REGLA: N(incluye adv) + ko/ren + N + DET + ko/ren + NOM + DET (Espainiako Errepublikako Gobernua)">
      <pattern>
	<pattern-item n="nom_adv"/>
	<pattern-item n="det"/>
	<pattern-item n="ko_en"/>
	<pattern-item n="nom_adv"/>
	<pattern-item n="det"/>
	<pattern-item n="ko_en"/>
	<pattern-item n="nom"/>
	<pattern-item n="det"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="concord_n2">
	  <with-param pos="1"/>
	  <with-param pos="2"/>
	</call-macro>
	<call-macro n="concord_n2">
	  <with-param pos="4"/>
	  <with-param pos="5"/>
	</call-macro>
	<call-macro n="concord_n2">
	  <with-param pos="7"/>
	  <with-param pos="8"/>
	</call-macro>
	<call-macro n="tipo_det">
	  <with-param pos="8"/>
	</call-macro>
	<out> 
	  <chunk name="d_n_pr_d_n_pr_d_n" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN"/></tag>
	      <tag><var n="tipusdet"/></tag>
	      <tag><clip pos="7" side="tl" part="gen"/></tag>
	      <tag><clip pos="7" side="tl" part="nbr"/></tag>
	    </tags>
	    <lu>
	      <clip pos="8" side="tl" part="lem"/> 
	      <clip pos="8" side="tl" part="a_det"/> 
	      <lit-tag v="2"/> 
	      <clip pos="8" side="tl" part="GD" link-to="3"/>
	      <clip pos="8" side="tl" part="mf"/>
	      <clip pos="8" side="tl" part="nbr"/>
	    </lu>
	    <b pos="1"/>
	    <lu> 
	      <clip pos="7" side="tl" part="lemh"/> 
	      <clip pos="7" side="tl" part="a_nom"/>
	      <clip pos="7" side="tl" part="GD" link-to="3"/>
	      <clip pos="7" side="tl" part="mf"/>
	      <clip pos="7" side="tl" part="nbr" link-to="4"/>
	      <clip pos="7" side="tl" part="lemq"/> 
	    </lu>
	    <b pos="2"/>
	    <lu> 
	      <clip pos="6" side="tl" part="whole"/> 
	    </lu>
	    <b/>
	    <lu>
	      <clip pos="5" side="tl" part="whole"/> 
	    </lu>
	    <b/>
	    <lu> 
	      <clip pos="4" side="tl" part="lemh"/> 
	      <clip pos="4" side="tl" part="a_nom"/>
	      <clip pos="4" side="tl" part="gen"/>
	      <clip pos="4" side="tl" part="nbr"/>
	      <clip pos="4" side="tl" part="lemq"/> 
	    </lu>
	    <b/>
	    <lu> 
	      <clip pos="3" side="tl" part="whole"/> 
	    </lu>
	    <b/>
	    <lu> 
	      <clip pos="2" side="tl" part="whole"/> 
	    </lu>
	    <b/>
	    <lu> 
	      <clip pos="1" side="tl" part="lemh"/> 
	      <clip pos="1" side="tl" part="a_nom"/>
	      <clip pos="1" side="tl" part="a_adv"/>
	      <clip pos="1" side="tl" part="gen"/>
	      <clip pos="1" side="tl" part="nbr"/>
	      <clip pos="1" side="tl" part="lemq"/> 
	    </lu>
	  </chunk>
	</out>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
 </rule>


<rule comment="REGLA: N(incluye adv) + ko/ren + N + DET + ko/ren + NOM + DET + POST (Espainiako Errepublikako Gobernua)">
      <pattern>
	<pattern-item n="nom_adv"/>
	<pattern-item n="det"/>
	<pattern-item n="ko_en"/>
	<pattern-item n="nom_adv"/>
	<pattern-item n="det"/>
	<pattern-item n="ko_en"/>
	<pattern-item n="nom"/>
	<pattern-item n="det"/>
	<pattern-item n="post"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="concord_n2">
	  <with-param pos="1"/>
	  <with-param pos="2"/>
	</call-macro>
	<call-macro n="concord_n2">
	  <with-param pos="4"/>
	  <with-param pos="5"/>
	</call-macro>
	<call-macro n="concord_n2">
	  <with-param pos="7"/>
	  <with-param pos="8"/>
	</call-macro>
	<call-macro n="tipo_det">
	  <with-param pos="8"/>
	</call-macro>
	<call-macro n="SPgenitivo">
	  <with-param pos="9"/>
	</call-macro>
	<out> 
	  <chunk name="pr_d_n_pr_d_n_pr_d_n" case="caseFirstWord">
	    <tags>
	      <tag><var n="chunk"/></tag>
	      <tag><var n="tipusdet"/></tag>
	      <tag><clip pos="7" side="tl" part="gen"/></tag>
	      <tag><clip pos="7" side="tl" part="nbr"/></tag>
	    </tags>
	    <lu>
	      <clip pos="9" side="tl" part="whole"/> 
	    </lu>
	    <b pos="1"/>
	    <lu>
	      <clip pos="8" side="tl" part="lem"/> 
	      <clip pos="8" side="tl" part="a_det"/> 
	      <lit-tag v="2"/> 
	      <clip pos="8" side="tl" part="GD" link-to="3"/>
	      <clip pos="8" side="tl" part="mf"/>
	      <clip pos="8" side="tl" part="nbr"/>
	    </lu>
	    <b pos="2"/>
	    <lu> 
	      <clip pos="7" side="tl" part="lemh"/> 
	      <clip pos="7" side="tl" part="a_nom"/>
	      <clip pos="7" side="tl" part="GD" link-to="3"/>
	      <clip pos="7" side="tl" part="mf"/>
	      <clip pos="7" side="tl" part="nbr" link-to="4"/>
	      <clip pos="7" side="tl" part="lemq"/> 
	    </lu>
	    <b/>
	    <lu> 
	      <clip pos="6" side="tl" part="whole"/> 
	    </lu>
	    <b/>
	    <lu>
	      <clip pos="5" side="tl" part="whole"/> 
	    </lu>
	    <b/>
	    <lu> 
	      <clip pos="4" side="tl" part="lemh"/> 
	      <clip pos="4" side="tl" part="a_nom"/>
	      <clip pos="4" side="tl" part="gen"/>
	      <clip pos="4" side="tl" part="nbr"/>
	      <clip pos="4" side="tl" part="lemq"/> 
	    </lu>
	    <b/>
	    <lu> 
	      <clip pos="3" side="tl" part="whole"/> 
	    </lu>
	    <b/>
	    <lu> 
	      <clip pos="2" side="tl" part="whole"/> 
	    </lu>
	    <b/>
	    <lu> 
	      <clip pos="1" side="tl" part="lemh"/> 
	      <clip pos="1" side="tl" part="a_nom"/>
	      <clip pos="1" side="tl" part="a_adv"/>
	      <clip pos="1" side="tl" part="gen"/>
	      <clip pos="1" side="tl" part="nbr"/>
	      <clip pos="1" side="tl" part="lemq"/> 
	    </lu>
	  </chunk>
	</out>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
 </rule>


<rule comment="REGLA: NUM + NOM (bi emakume - dos mujeres (pl))">
      <pattern>
	<pattern-item n="num"/>
	<pattern-item n="nom"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<let>
	  <clip pos="2" side="tl" part="nbr"/>
	  <lit-tag v="pl"/>
	</let>
	<choose>
	  <when>
	    <test>
	      <equal>		
		<clip pos="1" side="tl" part="gen"/>
		<lit-tag v="GD"/>
	      </equal>
	    </test>
	    <choose>
	      <when>
		<test>
		  <not>
		    <equal>		      		
		      <clip pos="2" side="tl" part="gen"/>
		      <lit-tag v="mf"/>
		    </equal>
		  </not>
		</test>
		<let>
		  <clip pos="1" side="tl" part="gen"/>
		  <clip pos="2" side="tl" part="gen"/>
		</let>
	      </when>
	    </choose>
	  </when>
	</choose>	  
	<out> 
	  <chunk name="num_n" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN.num"/></tag>
	      <tag><clip pos="2" side="tl" part="gen"/></tag>
	      <tag><clip pos="2" side="tl" part="nbr"/></tag>
	    </tags>
	    <lu>
	      <clip pos="1" side="tl" part="lem"/> 
	      <clip pos="1" side="tl" part="a_num"/> 
	      <clip pos="1" side="tl" part="GD" link-to="3"/>
	      <clip pos="1" side="tl" part="mf"/>
	      <clip pos="1" side="tl" part="nbr"/>
	    </lu>
	    <b/>
	    <lu> 
	      <clip pos="2" side="tl" part="lemh"/> 
	      <clip pos="2" side="tl" part="a_nom"/>
	      <clip pos="2" side="tl" part="GD" link-to="3"/>
	      <clip pos="2" side="tl" part="mf"/>
	      <clip pos="2" side="tl" part="nbr"/>
	      <clip pos="2" side="tl" part="lemq"/> 
	    </lu>
	  </chunk>
	</out>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
</rule>



<rule comment="REGLA: NUM + NOM + DET (bi emakumeak - las dos mujeres">
      <pattern>
	<pattern-item n="num"/>
	<pattern-item n="nom"/>
	<pattern-item n="det"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="tipo_det">
	  <with-param pos="3"/>
	</call-macro>
	<let>
	  <clip pos="2" side="tl" part="nbr"/>
	  <lit-tag v="pl"/>
	</let>
	<let>
	  <clip pos="3" side="tl" part="nbr"/>
	  <lit-tag v="pl"/>
	</let>
	<choose>
	  <when>
	    <test>
	      <equal>		
		<clip pos="1" side="tl" part="gen"/>
		<lit-tag v="GD"/>
	      </equal>
	    </test>
	    <choose>
	      <when>
		<test>
		  <not>
		    <equal>		      		
		      <clip pos="2" side="tl" part="gen"/>
		      <lit-tag v="mf"/>
		    </equal>
		  </not>
		</test>
		<let>
		  <clip pos="1" side="tl" part="gen"/>
		  <clip pos="2" side="tl" part="gen"/>
		</let>
	      </when>
	    </choose>
	  </when>
	</choose>
	<out> 
	  <chunk name="d_num_n" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN"/></tag>
	      <tag><var n="tipusdet"/></tag>
	      <tag><clip pos="2" side="tl" part="gen"/></tag>
	      <tag><clip pos="2" side="tl" part="nbr"/></tag>
	    </tags>
	    <lu>
	      <clip pos="3" side="tl" part="lem"/> 
	      <clip pos="3" side="tl" part="a_det"/> 
	      <lit-tag v="2"/> 
	      <clip pos="3" side="tl" part="GD" link-to="3"/>
	      <clip pos="3" side="tl" part="mf"/>
	      <clip pos="3" side="tl" part="nbr"/>
	    </lu>
	    <b pos="1"/>
	    <lu>
	      <clip pos="1" side="tl" part="lem"/> 
	      <clip pos="1" side="tl" part="a_num"/> 
	      <clip pos="1" side="tl" part="GD" link-to="3"/>
	      <clip pos="1" side="tl" part="mf"/>
	      <clip pos="1" side="tl" part="nbr"/>
	    </lu>
	    <b/>
	    <lu> 
	      <clip pos="2" side="tl" part="lemh"/> 
	      <clip pos="2" side="tl" part="a_nom"/>
	      <clip pos="2" side="tl" part="GD" link-to="3"/>
	      <clip pos="2" side="tl" part="mf"/>
	      <clip pos="2" side="tl" part="nbr"/>
	      <clip pos="2" side="tl" part="lemq"/> 
	    </lu>
	  </chunk>
	</out>	
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
</rule>



<rule comment="REGLA: NUM + NOM + DET (hiru euskal herritarrak)">
      <pattern>
	<pattern-item n="num"/>
	<pattern-item n="adj"/>
	<pattern-item n="nom"/>
	<pattern-item n="det"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="tipo_det">
	  <with-param pos="4"/>
	</call-macro>
	<let>
	  <clip pos="2" side="tl" part="nbr"/>
	  <lit-tag v="pl"/>
	</let>
	<let>
	  <clip pos="3" side="tl" part="nbr"/>
	  <lit-tag v="pl"/>
	</let>
	<let>
	  <clip pos="4" side="tl" part="nbr"/>
	  <lit-tag v="pl"/>
	</let>
	<choose>
	  <when>
	    <test>
	      <equal>		
		<clip pos="1" side="tl" part="gen"/>
		<lit-tag v="GD"/>
	      </equal>
	    </test>
	    <choose>
	      <when>
		<test>
		  <not>
		    <equal>		      		
		      <clip pos="3" side="tl" part="gen"/>
		      <lit-tag v="mf"/>
		    </equal>
		  </not>
		</test>
		<let>
		  <clip pos="1" side="tl" part="gen"/>
		  <clip pos="3" side="tl" part="gen"/>
		</let>
	      </when>
	    </choose>
	  </when>
	</choose>	
	<call-macro n="concord_n3">
	  <with-param pos="3"/>
	  <with-param pos="4"/>
	  <with-param pos="2"/>
	</call-macro>
	<choose>
	  <when>
	    <test>
	      <or>
		<equal>		
		  <clip pos="2" side="tl" part="a_adj"/>
		  <lit-tag v="adjant"/>
		</equal>
		<equal>		
		  <clip pos="2" side="tl" part="a_adj"/>
		  <lit-tag v="det"/>
		</equal>
	      </or>
	    </test>
	    <out>
	      <chunk name="d_num_adj_n" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN"/></tag>
	      <tag><var n="tipusdet"/></tag>
	      <tag><clip pos="3" side="tl" part="gen"/></tag>
	      <tag><clip pos="3" side="tl" part="nbr"/></tag>
	    </tags>
	    <lu>
	      <clip pos="4" side="tl" part="lem"/> 
	      <clip pos="4" side="tl" part="a_det"/> 
	      <lit-tag v="2"/> 
	      <clip pos="4" side="tl" part="GD" link-to="3"/>
	      <clip pos="4" side="tl" part="mf"/>
	      <clip pos="4" side="tl" part="nbr"/>
	    </lu>
	    <b pos="1"/>
	    <lu>
	      <clip pos="1" side="tl" part="lem"/> 
	      <clip pos="1" side="tl" part="a_num"/> 
	      <clip pos="1" side="tl" part="GD" link-to="3"/>
	      <clip pos="1" side="tl" part="mf"/>
	      <clip pos="1" side="tl" part="nbr"/>
	    </lu>
	    <b pos="2"/>
	     <lu> 
	      <clip pos="2" side="tl" part="lem"/> 
	      <clip pos="2" side="tl" part="a_adj"/>
	      <clip pos="2" side="tl" part="GD" link-to="3"/>
	      <clip pos="2" side="tl" part="mf"/>
	      <clip pos="2" side="tl" part="nbr" link-to="4"/>
	    </lu>	    
	    <b/>
	    <lu> 
	      <clip pos="3" side="tl" part="lemh"/> 
	      <clip pos="3" side="tl" part="a_nom"/>
	      <clip pos="3" side="tl" part="GD" link-to="3"/>
	      <clip pos="3" side="tl" part="mf"/>
	      <clip pos="3" side="tl" part="nbr"/>
	      <clip pos="3" side="tl" part="lemq"/> 
	    </lu>
	  </chunk>
	    </out>
	  </when>
	  <otherwise>
	<out> 
	  <chunk name="d_num_n_adj" case="caseFirstWord"> 
	    <tags>
	      <tag><lit-tag v="SN"/></tag>
	      <tag><var n="tipusdet"/></tag>
	      <tag><clip pos="3" side="tl" part="gen"/></tag>
	      <tag><clip pos="3" side="tl" part="nbr"/></tag>
	    </tags>
	    <lu>
	      <clip pos="4" side="tl" part="lem"/> 
	      <clip pos="4" side="tl" part="a_det"/> 
	      <lit-tag v="2"/> 
	      <clip pos="4" side="tl" part="GD" link-to="3"/>
	      <clip pos="4" side="tl" part="mf"/>
	      <clip pos="4" side="tl" part="nbr"/>
	    </lu>
	    <b pos="1"/>
	    <lu>
	      <clip pos="1" side="tl" part="lem"/> 
	      <clip pos="1" side="tl" part="a_num"/> 
	      <clip pos="1" side="tl" part="GD" link-to="3"/>
	      <clip pos="1" side="tl" part="mf"/>
	      <clip pos="1" side="tl" part="nbr"/>
	    </lu>
	    <b pos="2"/>
	    <lu> 
	      <clip pos="3" side="tl" part="lemh"/> 
	      <clip pos="3" side="tl" part="a_nom"/>
	      <clip pos="3" side="tl" part="GD" link-to="3"/>
	      <clip pos="3" side="tl" part="mf"/>
	      <clip pos="3" side="tl" part="nbr"/>
	      <clip pos="3" side="tl" part="lemq"/> 
	    </lu>
	    <b/>
	     <lu> 
	      <clip pos="2" side="tl" part="lem"/> 
	      <clip pos="2" side="tl" part="a_adj"/>
	      <clip pos="2" side="tl" part="GD" link-to="3"/>
	      <clip pos="2" side="tl" part="mf"/>
	      <clip pos="2" side="tl" part="nbr" link-to="4"/>
	    </lu>
	  </chunk>
	</out>	
	  </otherwise>
	</choose>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
</rule>






<rule comment="REGLA: NUM + NOM + DET + POST (bi emakumeak - las dos mujeres (pl) (cuando tagger se equivoca y elige ergativo en vez de determinante plural)
                                  bost urtean - en () cinco años">
      <pattern>
	<pattern-item n="num"/>
	<pattern-item n="nom"/>
	<pattern-item n="det"/>
	<pattern-item n="post"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="tipo_det">
	  <with-param pos="3"/>
	</call-macro>
	<call-macro n="SPgenitivo">
	  <with-param pos="4"/>
	</call-macro>
	<let>
	  <clip pos="2" side="tl" part="nbr"/>
	  <lit-tag v="pl"/>
	</let>
	<let>
	  <clip pos="3" side="tl" part="nbr"/>
	  <lit-tag v="pl"/>
	</let>
	<choose>
	  <when>
	    <test>
	      <equal>		
		<clip pos="1" side="tl" part="gen"/>
		<lit-tag v="GD"/>
	      </equal>
	    </test>
	    <choose>
	      <when>
		<test>
		  <not>
		    <equal>		      		
		      <clip pos="2" side="tl" part="gen"/>
		      <lit-tag v="mf"/>
		    </equal>
		  </not>
		</test>
		<let>
		  <clip pos="1" side="tl" part="gen"/>
		  <clip pos="2" side="tl" part="gen"/>
		</let>
	      </when>
	    </choose>
	  </when>
	</choose>
	<choose>
	  <when>
	    <test>
	      <equal>
		<clip pos="4" side="sl" part="lem"/>
		<lit v="k"/>
	      </equal>
	    </test>
	    <out> 
	      <chunk name="d_num_n" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="SN"/></tag>
		  <tag><var n="tipusdet"/></tag>
		  <tag><clip pos="2" side="tl" part="gen"/></tag>
		  <tag><clip pos="2" side="tl" part="nbr"/></tag>
		</tags>
		<lu>
		  <clip pos="3" side="tl" part="lem"/> 
		  <clip pos="3" side="tl" part="a_det"/> 
		  <lit-tag v="2"/> 
		  <clip pos="3" side="tl" part="GD" link-to="3"/>
		  <clip pos="3" side="tl" part="mf"/>
		  <clip pos="3" side="tl" part="nbr"/>
		</lu>
		<b pos="1"/>
		<lu>
		  <clip pos="1" side="tl" part="lem"/> 
		  <clip pos="1" side="tl" part="a_num"/> 
		  <clip pos="1" side="tl" part="GD" link-to="3"/>
		  <clip pos="1" side="tl" part="mf"/>
		  <clip pos="1" side="tl" part="nbr"/>
		</lu>
		<b/>
		<lu> 
		  <clip pos="2" side="tl" part="lemh"/> 
		  <clip pos="2" side="tl" part="a_nom"/>
		  <clip pos="2" side="tl" part="GD" link-to="3"/>
		  <clip pos="2" side="tl" part="mf"/>
		  <clip pos="2" side="tl" part="nbr"/>
		  <clip pos="2" side="tl" part="lemq"/> 
		</lu>
	      </chunk>
	    </out>
	  </when>
	  <otherwise>
	    
	    <out> 
	      <chunk name="pr_d_num_n" case="caseFirstWord">
		<tags>
		  <tag><var n="chunk"/></tag>
		  <tag><var n="tipusdet"/></tag>
		  <tag><clip pos="2" side="tl" part="gen"/></tag>
		  <tag><clip pos="2" side="tl" part="nbr"/></tag>
		</tags>
		<lu>
		  <clip pos="4" side="tl" part="whole"/> 
		</lu>
		<b pos="1"/>
		<lu>
		  <clip pos="3" side="tl" part="lem"/> 
		  <clip pos="3" side="tl" part="a_det"/> 
		  <lit-tag v="2"/> 
		  <clip pos="3" side="tl" part="GD" link-to="3"/>
		  <clip pos="3" side="tl" part="mf"/>
		  <clip pos="3" side="tl" part="nbr"/>
		</lu>
		<b/>
		<lu>
		  <clip pos="1" side="tl" part="lem"/> 
		  <clip pos="1" side="tl" part="a_num"/> 
		  <clip pos="1" side="tl" part="GD" link-to="3"/>
		  <clip pos="1" side="tl" part="mf"/>
		  <clip pos="1" side="tl" part="nbr"/>
		</lu>
		<b/>
		<lu> 
		  <clip pos="2" side="tl" part="lemh"/> 
		  <clip pos="2" side="tl" part="a_nom"/>
		  <clip pos="2" side="tl" part="GD" link-to="3"/>
		  <clip pos="2" side="tl" part="mf"/>
		  <clip pos="2" side="tl" part="nbr"/>
		  <clip pos="2" side="tl" part="lemq"/> 
		</lu>
	      </chunk>
	    </out>
	  </otherwise>
	</choose>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
</rule>


<rule comment="REGLA: ADJ + NUM + NOM + DET + POST (azken lau urteetan)">
<pattern>
  <pattern-item n="adjizl"/>
  <pattern-item n="num"/>
  <pattern-item n="nom"/>
  <pattern-item n="det"/>
  <pattern-item n="post"/>
</pattern>
<action>
  <call-macro n="firstWord">
    <with-param pos="1"/>
  </call-macro>
  <call-macro n="tipo_det">
    <with-param pos="4"/>
  </call-macro>
  <call-macro n="SPgenitivo">
    <with-param pos="5"/>
  </call-macro>
  <let>
    <clip pos="1" side="tl" part="nbr"/>
    <lit-tag v="pl"/>
  </let>
  <let>
    <clip pos="3" side="tl" part="nbr"/>
    <lit-tag v="pl"/>
  </let>
  <let>
    <clip pos="4" side="tl" part="nbr"/>
    <lit-tag v="pl"/>
  </let>
  <choose>
    <when>
      <test>
	<equal>		
	  <clip pos="2" side="tl" part="gen"/>
	  <lit-tag v="GD"/>
	</equal>
      </test>
      <choose>
	<when>
	  <test>
	    <not>
	      <equal>		      		
		<clip pos="3" side="tl" part="gen"/>
		<lit-tag v="mf"/>
	      </equal>
	    </not>
	  </test>
	  <let>
	    <clip pos="2" side="tl" part="gen"/>
	    <clip pos="3" side="tl" part="gen"/>
	  </let>
	</when>
      </choose>
    </when>
  </choose>	
  <call-macro n="concord_n3">
    <with-param pos="3"/>
    <with-param pos="4"/>
    <with-param pos="1"/>
  </call-macro>
  <choose>
      <when>
	<test>
	  <equal>
	    <clip pos="5" side="sl" part="lem"/>
	    <lit v="k"/>
	  </equal>
	</test>
	<choose>
	  <when>
	    <test>
	      <or>
		<equal>		
		  <clip pos="1" side="tl" part="a_adj"/>
		  <lit-tag v="adjant"/>
		</equal>
		<equal>		
		  <clip pos="1" side="tl" part="a_adj"/>
		  <lit-tag v="det"/>
		</equal>
	      </or>
	    </test>
	    <out> 
	      <chunk name="d_a_num_n" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="SN"/></tag>
		  <tag><var n="tipusdet"/></tag>
		  <tag><clip pos="3" side="tl" part="gen"/></tag>
		  <tag><clip pos="3" side="tl" part="nbr"/></tag>
		</tags>
		<lu>
		  <clip pos="4" side="tl" part="lem"/> 
		  <clip pos="4" side="tl" part="a_det"/> 
		  <lit-tag v="2"/> 
		  <clip pos="4" side="tl" part="GD" link-to="3"/>
		  <clip pos="4" side="tl" part="mf"/>
		  <clip pos="4" side="tl" part="nbr"/>
		</lu>
		<b pos="1"/>
		<lu> 
		  <clip pos="1" side="tl" part="lem"/> 
		  <clip pos="1" side="tl" part="a_adj"/>
		  <clip pos="1" side="tl" part="tipus_det"/>
		  <clip pos="1" side="tl" part="GD" link-to="3"/>
		  <clip pos="1" side="tl" part="mf"/>
		  <clip pos="1" side="tl" part="nbr" link-to="4"/>
		</lu>
		<b pos="2"/>
		<lu>
		  <clip pos="2" side="tl" part="lem"/> 
		  <clip pos="2" side="tl" part="a_num"/> 
		  <clip pos="2" side="tl" part="GD" link-to="3"/>
		  <clip pos="2" side="tl" part="mf"/>
		  <clip pos="2" side="tl" part="nbr"/>
		</lu>
		<b/>
		<lu> 
		  <clip pos="3" side="tl" part="lemh"/> 
		  <clip pos="3" side="tl" part="a_nom"/>
		  <clip pos="3" side="tl" part="GD" link-to="3"/>
		  <clip pos="3" side="tl" part="mf"/>
		  <clip pos="3" side="tl" part="nbr"/>
		  <clip pos="3" side="tl" part="lemq"/> 
		</lu>
	      </chunk>
	    </out>
	  </when>
	  <otherwise>
	    <out> 
	      <chunk name="d_num_n_a" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="SN"/></tag>
		  <tag><var n="tipusdet"/></tag>
		  <tag><clip pos="3" side="tl" part="gen"/></tag>
		  <tag><clip pos="3" side="tl" part="nbr"/></tag>
		</tags>
		<lu>
		  <clip pos="4" side="tl" part="lem"/> 
		  <clip pos="4" side="tl" part="a_det"/> 
		  <lit-tag v="2"/> 
		  <clip pos="4" side="tl" part="GD" link-to="3"/>
		  <clip pos="4" side="tl" part="mf"/>
		  <clip pos="4" side="tl" part="nbr"/>
		</lu>		
		<b pos="1"/>
		<lu>
		  <clip pos="2" side="tl" part="lem"/> 
		  <clip pos="2" side="tl" part="a_num"/> 
		  <clip pos="2" side="tl" part="GD" link-to="3"/>
		  <clip pos="2" side="tl" part="mf"/>
		  <clip pos="2" side="tl" part="nbr"/>
		</lu>		
		<b pos="2"/>
		<lu> 
		  <clip pos="3" side="tl" part="lemh"/> 
		  <clip pos="3" side="tl" part="a_nom"/>
		  <clip pos="3" side="tl" part="GD" link-to="3"/>
		  <clip pos="3" side="tl" part="mf"/>
		  <clip pos="3" side="tl" part="nbr"/>
		  <clip pos="3" side="tl" part="lemq"/> 
		</lu>
		<b/>
		<lu> 
		  <clip pos="1" side="tl" part="lem"/> 
		  <clip pos="1" side="tl" part="a_adj"/>
		  <clip pos="1" side="tl" part="tipus_det"/>
		  <clip pos="1" side="tl" part="GD" link-to="3"/>
		  <clip pos="1" side="tl" part="mf"/>
		  <clip pos="1" side="tl" part="nbr" link-to="4"/>
		</lu>
	      </chunk>
	    </out>
	  </otherwise>
	</choose>
      </when>
      <otherwise>
	<choose>
	  <when>
	    <test>
	      <or>
		<equal>		
		  <clip pos="1" side="tl" part="a_adj"/>
		  <lit-tag v="adjant"/>
		</equal>
		<equal>		
		  <clip pos="1" side="tl" part="a_adj"/>
		  <lit-tag v="det"/>
		</equal>
	      </or>
	    </test>
	    <out> 
	      <chunk name="pr_d_a_num_n" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="SN"/></tag>
		  <tag><var n="tipusdet"/></tag>
		  <tag><clip pos="3" side="tl" part="gen"/></tag>
		  <tag><clip pos="3" side="tl" part="nbr"/></tag>
		</tags>
		<lu>		  
		  <clip pos="5" side="tl" part="whole"/> 
		</lu>
		<b pos="1"/>
		<lu>
		  <clip pos="4" side="tl" part="lem"/> 
		  <clip pos="4" side="tl" part="a_det"/> 
		  <lit-tag v="2"/> 
		  <clip pos="4" side="tl" part="GD" link-to="3"/>
		  <clip pos="4" side="tl" part="mf"/>
		  <clip pos="4" side="tl" part="nbr"/>
		</lu>
		<b pos="2"/>
		<lu> 
		  <clip pos="1" side="tl" part="lem"/> 
		  <clip pos="1" side="tl" part="a_adj"/>
		  <clip pos="1" side="tl" part="tipus_det"/>
		  <clip pos="1" side="tl" part="GD" link-to="3"/>
		  <clip pos="1" side="tl" part="mf"/>
		  <clip pos="1" side="tl" part="nbr" link-to="4"/>
		</lu>
		<b/>
		<lu>
		  <clip pos="2" side="tl" part="lem"/> 
		  <clip pos="2" side="tl" part="a_num"/> 
		  <clip pos="2" side="tl" part="GD" link-to="3"/>
		  <clip pos="2" side="tl" part="mf"/>
		  <clip pos="2" side="tl" part="nbr"/>
		</lu>
		<b/>
		<lu> 
		  <clip pos="3" side="tl" part="lemh"/> 
		  <clip pos="3" side="tl" part="a_nom"/>
		  <clip pos="3" side="tl" part="GD" link-to="3"/>
		  <clip pos="3" side="tl" part="mf"/>
		  <clip pos="3" side="tl" part="nbr"/>
		  <clip pos="3" side="tl" part="lemq"/> 
		</lu>
	      </chunk>
	    </out>
	  </when>
	  <otherwise>
	    <out> 
	      <chunk name="d_num_n_a" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="SN"/></tag>
		  <tag><var n="tipusdet"/></tag>
		  <tag><clip pos="3" side="tl" part="gen"/></tag>
		  <tag><clip pos="3" side="tl" part="nbr"/></tag>
		</tags>
		<lu>				  
		  <clip pos="5" side="tl" part="whole"/> 
		</lu>
		<b pos="1"/>
		<lu>
		  <clip pos="4" side="tl" part="lem"/> 
		  <clip pos="4" side="tl" part="a_det"/> 
		  <lit-tag v="2"/> 
		  <clip pos="4" side="tl" part="GD" link-to="3"/>
		  <clip pos="4" side="tl" part="mf"/>
		  <clip pos="4" side="tl" part="nbr"/>
		</lu>		
		<b pos="2"/>
		<lu>
		  <clip pos="2" side="tl" part="lem"/> 
		  <clip pos="2" side="tl" part="a_num"/> 
		  <clip pos="2" side="tl" part="GD" link-to="3"/>
		  <clip pos="2" side="tl" part="mf"/>
		  <clip pos="2" side="tl" part="nbr"/>
		</lu>		
		<b/>
		<lu> 
		  <clip pos="3" side="tl" part="lemh"/> 
		  <clip pos="3" side="tl" part="a_nom"/>
		  <clip pos="3" side="tl" part="GD" link-to="3"/>
		  <clip pos="3" side="tl" part="mf"/>
		  <clip pos="3" side="tl" part="nbr"/>
		  <clip pos="3" side="tl" part="lemq"/> 
		</lu>
		<b/>
		<lu> 
		  <clip pos="1" side="tl" part="lem"/> 
		  <clip pos="1" side="tl" part="a_adj"/>
		  <clip pos="1" side="tl" part="tipus_det"/>
		  <clip pos="1" side="tl" part="GD" link-to="3"/>
		  <clip pos="1" side="tl" part="mf"/>
		  <clip pos="1" side="tl" part="nbr" link-to="4"/>
		</lu>
	      </chunk>
	    </out>
	  </otherwise>
	</choose>
      </otherwise>
    </choose>
  <let>
    <var n="caseFirstWord"/>
    <lit v="aa"/>
  </let>
</action>
</rule>






<rule comment="REGLA: NUM + NOM + DET (hiru euskal herritarrak)">
      <pattern>
	<pattern-item n="num"/>
	<pattern-item n="adj"/>
	<pattern-item n="nom"/>
	<pattern-item n="det"/>
	<pattern-item n="post"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="tipo_det">
	  <with-param pos="4"/>
	</call-macro>
	<call-macro n="SPgenitivo">
	  <with-param pos="5"/>
	</call-macro>
	<let>
	  <clip pos="2" side="tl" part="nbr"/>
	  <lit-tag v="pl"/>
	</let>
	<let>
	  <clip pos="3" side="tl" part="nbr"/>
	  <lit-tag v="pl"/>
	</let>
	<let>
	  <clip pos="4" side="tl" part="nbr"/>
	  <lit-tag v="pl"/>
	</let>
	<choose>
	  <when>
	    <test>
	      <equal>		
		<clip pos="1" side="tl" part="gen"/>
		<lit-tag v="GD"/>
	      </equal>
	    </test>
	    <choose>
	      <when>
		<test>
		  <not>
		    <equal>		      		
		      <clip pos="3" side="tl" part="gen"/>
		      <lit-tag v="mf"/>
		    </equal>
		  </not>
		</test>
		<let>
		  <clip pos="1" side="tl" part="gen"/>
		  <clip pos="3" side="tl" part="gen"/>
		</let>
	      </when>
	    </choose>
	  </when>
	</choose>	
	<call-macro n="concord_n3">
	  <with-param pos="3"/>
	  <with-param pos="4"/>
	  <with-param pos="2"/>
	</call-macro>
	<choose>
	  <when>
	    <test>
	      <equal>
		<clip pos="5" side="sl" part="lem"/>
		<lit v="k"/>
	      </equal>
	    </test>
	<choose>
	  <when>
	    <test>
	      <or>
		<equal>		
		  <clip pos="2" side="tl" part="a_adj"/>
		  <lit-tag v="adjant"/>
		</equal>
		<equal>		
		  <clip pos="2" side="tl" part="a_adj"/>
		  <lit-tag v="det"/>
		</equal>
	      </or>
	    </test>
	    <out>
	      <chunk name="pr_d_num_adj_n" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN"/></tag>
	      <tag><var n="tipusdet"/></tag>
	      <tag><clip pos="3" side="tl" part="gen"/></tag>
	      <tag><clip pos="3" side="tl" part="nbr"/></tag>
	    </tags>
	    <lu>
	      <clip pos="4" side="tl" part="lem"/> 
	      <clip pos="4" side="tl" part="a_det"/> 
	      <lit-tag v="2"/> 
	      <clip pos="4" side="tl" part="GD" link-to="3"/>
	      <clip pos="4" side="tl" part="mf"/>
	      <clip pos="4" side="tl" part="nbr"/>
	    </lu>
	    <b pos="1"/>
	    <lu>
	      <clip pos="1" side="tl" part="lem"/> 
	      <clip pos="1" side="tl" part="a_num"/> 
	      <clip pos="1" side="tl" part="GD" link-to="3"/>
	      <clip pos="1" side="tl" part="mf"/>
	      <clip pos="1" side="tl" part="nbr"/>
	    </lu>
	    <b pos="2"/>
	     <lu> 
	      <clip pos="2" side="tl" part="lem"/> 
	      <clip pos="2" side="tl" part="a_adj"/>
	      <clip pos="2" side="tl" part="GD" link-to="3"/>
	      <clip pos="2" side="tl" part="mf"/>
	      <clip pos="2" side="tl" part="nbr" link-to="4"/>
	    </lu>	    
	    <b/>
	    <lu> 
	      <clip pos="3" side="tl" part="lemh"/> 
	      <clip pos="3" side="tl" part="a_nom"/>
	      <clip pos="3" side="tl" part="GD" link-to="3"/>
	      <clip pos="3" side="tl" part="mf"/>
	      <clip pos="3" side="tl" part="nbr"/>
	      <clip pos="3" side="tl" part="lemq"/> 
	    </lu>
	  </chunk>
	    </out>
	  </when>
	  <otherwise>
	<out> 
	  <chunk name="d_num_n_adj" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN"/></tag>
	      <tag><var n="tipusdet"/></tag>
	      <tag><clip pos="3" side="tl" part="gen"/></tag>
	      <tag><clip pos="3" side="tl" part="nbr"/></tag>
	    </tags>
	    <lu>
	      <clip pos="4" side="tl" part="lem"/> 
	      <clip pos="4" side="tl" part="a_det"/> 
	      <lit-tag v="2"/> 
	      <clip pos="4" side="tl" part="GD" link-to="3"/>
	      <clip pos="4" side="tl" part="mf"/>
	      <clip pos="4" side="tl" part="nbr"/>
	    </lu>
	    <b pos="1"/>
	    <lu>
	      <clip pos="1" side="tl" part="lem"/> 
	      <clip pos="1" side="tl" part="a_num"/> 
	      <clip pos="1" side="tl" part="GD" link-to="3"/>
	      <clip pos="1" side="tl" part="mf"/>
	      <clip pos="1" side="tl" part="nbr"/>
	    </lu>
	    <b pos="2"/>
	    <lu> 
	      <clip pos="3" side="tl" part="lemh"/> 
	      <clip pos="3" side="tl" part="a_nom"/>
	      <clip pos="3" side="tl" part="GD" link-to="3"/>
	      <clip pos="3" side="tl" part="mf"/>
	      <clip pos="3" side="tl" part="nbr"/>
	      <clip pos="3" side="tl" part="lemq"/> 
	    </lu>
	    <b/>
	     <lu> 
	      <clip pos="2" side="tl" part="lem"/> 
	      <clip pos="2" side="tl" part="a_adj"/>
	      <clip pos="2" side="tl" part="GD" link-to="3"/>
	      <clip pos="2" side="tl" part="mf"/>
	      <clip pos="2" side="tl" part="nbr" link-to="4"/>
	    </lu>
	  </chunk>
	</out>	
	  </otherwise>
	</choose>
	  </when>
	  <otherwise>
	    	<choose>
	  <when>
	    <test>
	      <or>
		<equal>		
		  <clip pos="2" side="tl" part="a_adj"/>
		  <lit-tag v="adjant"/>
		</equal>
		<equal>		
		  <clip pos="2" side="tl" part="a_adj"/>
		  <lit-tag v="det"/>
		</equal>
	      </or>
	    </test>
	    <out>
	      <chunk name="pr_d_num_adj_n" case="caseFirstWord">
	    <tags>
	      <tag><var n="chunk"/></tag>
	      <tag><var n="tipusdet"/></tag>
	      <tag><clip pos="3" side="tl" part="gen"/></tag>
	      <tag><clip pos="3" side="tl" part="nbr"/></tag>
	    </tags>
	    <lu>
	      <clip pos="5" side="tl" part="lem"/> 
	    </lu>
	    <b pos="1"/>
	    <lu>
	      <clip pos="4" side="tl" part="lem"/> 
	      <clip pos="4" side="tl" part="a_det"/> 
	      <lit-tag v="2"/> 
	      <clip pos="4" side="tl" part="GD" link-to="3"/>
	      <clip pos="4" side="tl" part="mf"/>
	      <clip pos="4" side="tl" part="nbr"/>
	    </lu>
	    <b pos="2"/>
	    <lu>
	      <clip pos="1" side="tl" part="lem"/> 
	      <clip pos="1" side="tl" part="a_num"/> 
	      <clip pos="1" side="tl" part="GD" link-to="3"/>
	      <clip pos="1" side="tl" part="mf"/>
	      <clip pos="1" side="tl" part="nbr"/>
	    </lu>
	    <b/>
	     <lu> 
	      <clip pos="2" side="tl" part="lem"/> 
	      <clip pos="2" side="tl" part="a_adj"/>
	      <clip pos="2" side="tl" part="GD" link-to="3"/>
	      <clip pos="2" side="tl" part="mf"/>
	      <clip pos="2" side="tl" part="nbr" link-to="4"/>
	    </lu>	    
	    <b/>
	    <lu> 
	      <clip pos="3" side="tl" part="lemh"/> 
	      <clip pos="3" side="tl" part="a_nom"/>
	      <clip pos="3" side="tl" part="GD" link-to="3"/>
	      <clip pos="3" side="tl" part="mf"/>
	      <clip pos="3" side="tl" part="nbr"/>
	      <clip pos="3" side="tl" part="lemq"/> 
	    </lu>
	  </chunk>
	    </out>
	  </when>
	  <otherwise>
	<out> 
	  <chunk name="pr_d_num_n_adj" case="caseFirstWord">
	    <tags>
	      <tag><var n="chunk"/></tag>
	      <tag><var n="tipusdet"/></tag>
	      <tag><clip pos="3" side="tl" part="gen"/></tag>
	      <tag><clip pos="3" side="tl" part="nbr"/></tag>
	    </tags>
	     <lu>
	      <clip pos="5" side="tl" part="lem"/> 
	    </lu>
	    <b pos="1"/>
	    <lu>
	      <clip pos="4" side="tl" part="lem"/> 
	      <clip pos="4" side="tl" part="a_det"/> 
	      <lit-tag v="2"/> 
	      <clip pos="4" side="tl" part="GD" link-to="3"/>
	      <clip pos="4" side="tl" part="mf"/>
	      <clip pos="4" side="tl" part="nbr"/>
	    </lu>
	    <b pos="1"/>
	    <lu>
	      <clip pos="1" side="tl" part="lem"/> 
	      <clip pos="1" side="tl" part="a_num"/> 
	      <clip pos="1" side="tl" part="GD" link-to="3"/>
	      <clip pos="1" side="tl" part="mf"/>
	      <clip pos="1" side="tl" part="nbr"/>
	    </lu>
	    <b/>
	    <lu> 
	      <clip pos="3" side="tl" part="lemh"/> 
	      <clip pos="3" side="tl" part="a_nom"/>
	      <clip pos="3" side="tl" part="GD" link-to="3"/>
	      <clip pos="3" side="tl" part="mf"/>
	      <clip pos="3" side="tl" part="nbr"/>
	      <clip pos="3" side="tl" part="lemq"/> 
	    </lu>
	    <b/>
	     <lu> 
	      <clip pos="2" side="tl" part="lem"/> 
	      <clip pos="2" side="tl" part="a_adj"/>
	      <clip pos="2" side="tl" part="GD" link-to="3"/>
	      <clip pos="2" side="tl" part="mf"/>
	      <clip pos="2" side="tl" part="nbr" link-to="4"/>
	    </lu>
	  </chunk>
	</out>	
	  </otherwise>
		</choose>
	  </otherwise>
	</choose>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
</rule>




<rule comment="REGLA: NUM + DET (zortziak - las ocho. Se pone en femenino porque casi siempre es indicación horaria)">
      <pattern>
	<pattern-item n="num"/>
	<pattern-item n="det"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="tipo_det">
	  <with-param pos="2"/>
	</call-macro>
	<out> 
	  <chunk name="d_num" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN"/></tag>
	      <tag><var n="tipusdet"/></tag>
	      <tag><lit-tag v="f"/></tag>
	      <tag><clip pos="2" side="tl" part="nbr"/></tag>
	    </tags>
	    <lu>
	      <clip pos="2" side="tl" part="lem"/> 
	      <clip pos="2" side="tl" part="a_det"/> 
	      <lit-tag v="2"/> 
	      <lit-tag v="3"/>
	      <clip pos="2" side="tl" part="nbr"/>
	    </lu>
	    <b/>
	    <lu>
	      <clip pos="1" side="tl" part="whole"/> 
	    </lu>
	  </chunk>
	</out>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
</rule>

<rule comment="REGLA: NOM + DET + ko/en NUM + DET (goizeko zortziak - las ocho de la mañana. Se pone en femenino porque casi siempre es indicación horaria)">
      <pattern>
	<pattern-item n="nom"/>
	<pattern-item n="det"/>
	<pattern-item n="ko_en"/>
	<pattern-item n="num"/>
	<pattern-item n="det"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="concord_n2">
	  <with-param pos="1"/>
	  <with-param pos="2"/>
	</call-macro>
	<call-macro n="tipo_det">
	  <with-param pos="5"/>
	</call-macro>
	<out> 
	  <chunk name="d_num_pr_d_n" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN"/></tag>
	      <tag><var n="tipusdet"/></tag>
	      <tag><lit-tag v="f"/></tag>
	      <tag><clip pos="5" side="tl" part="nbr"/></tag>
	    </tags>
	    <lu>
	      <clip pos="5" side="tl" part="lem"/> 
	      <clip pos="5" side="tl" part="a_det"/> 
	      <lit-tag v="2"/> 
	      <lit-tag v="3"/>
	      <clip pos="5" side="tl" part="nbr"/>
	    </lu>
	    <b/>
	    <lu>
	      <clip pos="4" side="tl" part="whole"/> 
	    </lu>
	    <b pos="1"/>
	    <lu> 
	      <clip pos="3" side="tl" part="whole"/> 
	    </lu>
	    <b/>
	    <lu>
	      <clip pos="2" side="tl" part="whole"/> 
	    </lu>
	    <b/>
	    <lu> 
	      <clip pos="1" side="tl" part="lemh"/> 
	      <clip pos="1" side="tl" part="a_nom"/>
	      <clip pos="1" side="tl" part="gen"/>
	      <clip pos="1" side="tl" part="nbr"/>
	      <clip pos="1" side="tl" part="lemq"/> 
	    </lu>	    
	  </chunk>
	</out>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
</rule>

<rule comment="REGLA: NOM + DET + ko/en NUM + DET + POST (goizeko bederatzietan - a las nueve de la mañana. Se pone en femenino porque casi siempre es indicación horaria)">
      <pattern>
	<pattern-item n="nom"/>
	<pattern-item n="det"/>
	<pattern-item n="ko_en"/>
	<pattern-item n="num"/>
	<pattern-item n="det"/>
	<pattern-item n="post"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="concord_n2">
	  <with-param pos="1"/>
	  <with-param pos="2"/>
	</call-macro>
	<call-macro n="tipo_det">
	  <with-param pos="5"/>
	</call-macro>
	<call-macro n="SPgenitivo">
	  <with-param pos="6"/>
	</call-macro>
	<out> 
	  <chunk name="pr_d_num_pr_d_n" case="caseFirstWord">
	    <tags>
	      <tag><var n="chunk"/></tag>
	      <tag><var n="tipusdet"/></tag>
	      <tag><lit-tag v="f"/></tag>
	      <tag><clip pos="5" side="tl" part="nbr"/></tag>
	    </tags>
	    <lu>	      
	      <clip pos="6" side="tl" part="whole"/> 
	    </lu>
	    <b pos="1"/>
	    <lu>
	      <clip pos="5" side="tl" part="lem"/> 
	      <clip pos="5" side="tl" part="a_det"/> 
	      <lit-tag v="2"/> 
	      <lit-tag v="3"/>
	      <clip pos="5" side="tl" part="nbr"/>
	    </lu>
	    <b/>
	    <lu>
	      <clip pos="4" side="tl" part="whole"/> 
	    </lu>
	    <b/>
	    <lu> 
	      <clip pos="3" side="tl" part="whole"/> 
	    </lu>
	    <b/>
	    <lu>
	      <clip pos="2" side="tl" part="whole"/> 
	    </lu>
	    <b/>
	    <lu> 
	      <clip pos="1" side="tl" part="lemh"/> 
	      <clip pos="1" side="tl" part="a_nom"/>
	      <clip pos="1" side="tl" part="gen"/>
	      <clip pos="1" side="tl" part="nbr"/>
	      <clip pos="1" side="tl" part="lemq"/> 
	    </lu>
	    
	  </chunk>
	</out>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
</rule>

<!-- POSESIVOS -->

<rule comment="REGLA: PRON + en + NOM + DET (nire etxea - mi casa)">
      <pattern>
	<pattern-item n="prnpos"/>
	<pattern-item n="en"/>
	<pattern-item n="nom"/>
	<pattern-item n="det"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="posesivo"><!--MG adequar funció a concord_n2 -->
	  <with-param pos="1"/>
	  <with-param pos="3"/>
	</call-macro>
	<out> 
	  <chunk name="pos_n" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN"/></tag>
	      <tag><lit-tag v="pos"/></tag>
	      <tag><clip pos="3" side="tl" part="gen"/></tag>
	      <tag><clip pos="4" side="tl" part="nbr"/></tag>
	    </tags>
	    <lu>
	      <clip pos="1" side="tl" part="lem"/>
	      <clip pos="1" side="tl" part="det_pos"/>
	      <clip pos="1" side="tl" part="GD" link-to="3"/>
	      <clip pos="1" side="tl" part="mf"/>
	      <clip pos="4" side="tl" part="nbr" link-to="4"/>
	    </lu>
	    <b pos="1"/>
	    <lu> 
	      <clip pos="3" side="tl" part="lemh"/> 
	      <clip pos="3" side="tl" part="a_nom"/>
	      <clip pos="3" side="tl" part="GD" link-to="3"/>
	      <clip pos="3" side="tl" part="mf"/>
	      <clip pos="4" side="tl" part="nbr" link-to="4"/>
	      <clip pos="3" side="tl" part="lemq"/> 
	    </lu>
	  </chunk>
	</out>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
 </rule>



<rule comment="REGLA: PRON + en + NOM + ADJ + DET (nire etxe gorria - mi casa roja)">
      <pattern>
	<pattern-item n="prnpos"/>
	<pattern-item n="en"/>
	<pattern-item n="nom"/>
	<pattern-item n="adj"/>
	<pattern-item n="det"/><!--MG: nire etxe handi hori falla, fer que sigui sols 'a'? -->
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="posesivo">
	  <with-param pos="1"/>
	  <with-param pos="3"/>
	</call-macro>
	<call-macro n="concord_n3">
	  <with-param pos="3"/>
	  <with-param pos="4"/>
	  <with-param pos="5"/>
	</call-macro>
	<choose>
	  <when>
	    <test>
	      <or>
	      <equal>		
		<clip pos="4" side="tl" part="a_adj"/>
		<lit-tag v="adjant"/>
	      </equal>
	      <equal>		
		<clip pos="4" side="tl" part="a_adj"/>
		<lit-tag v="det"/>
	      </equal>
	      </or>
	    </test>
	    <out> 
	  <chunk name="pos_adj_n_" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN"/></tag>
	      <tag><lit-tag v="pos"/></tag>
	      <tag><clip pos="3" side="tl" part="gen"/></tag>
	      <tag><clip pos="3" side="tl" part="nbr"/></tag>
	    </tags>
	    <lu>
	      <clip pos="1" side="tl" part="lem"/>
	      <clip pos="1" side="tl" part="det_pos"/>
	      <clip pos="1" side="tl" part="GD" link-to="3"/>
	      <clip pos="1" side="tl" part="mf"/>
	      <clip pos="5" side="tl" part="nbr" link-to="4"/>
	    </lu>
	    <b pos="1"/>
	    <lu> 
	      <clip pos="4" side="tl" part="lem"/> 
	      <clip pos="4" side="tl" part="a_adj"/>
	      <clip pos="4" side="tl" part="tipus_det"/>
	      <clip pos="4" side="tl" part="GD" link-to="3"/>
	      <clip pos="4" side="tl" part="mf"/>
	      <clip pos="4" side="tl" part="nbr" link-to="4"/>
	    </lu>
	    <b pos="2"/>
	    <lu> 
	      <clip pos="3" side="tl" part="lemh"/> 
	      <clip pos="3" side="tl" part="a_nom"/>
	      <clip pos="3" side="tl" part="GD" link-to="3"/>
	      <clip pos="3" side="tl" part="mf"/>
	      <clip pos="3" side="tl" part="nbr" link-to="4"/>
	      <clip pos="3" side="tl" part="lemq"/> 
	    </lu>
	  </chunk>
	</out>
	  </when>
	  <otherwise>
	<out> 
	  <chunk name="pos_n_adj" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN"/></tag>
	      <tag><lit-tag v="pos"/></tag>
	      <tag><clip pos="3" side="tl" part="gen"/></tag>
	      <tag><clip pos="3" side="tl" part="nbr"/></tag>
	    </tags>
	    <lu>
	      <clip pos="1" side="tl" part="lem"/>
	      <clip pos="1" side="tl" part="det_pos"/>
	      <clip pos="1" side="tl" part="GD" link-to="3"/>
	      <clip pos="1" side="tl" part="mf"/>
	      <clip pos="5" side="tl" part="nbr" link-to="4"/>
	    </lu>
	    <b pos="1"/>
	    <lu> 
	      <clip pos="3" side="tl" part="lemh"/> 
	      <clip pos="3" side="tl" part="a_nom"/>
	      <clip pos="3" side="tl" part="GD" link-to="3"/>
	      <clip pos="3" side="tl" part="mf"/>
	      <clip pos="3" side="tl" part="nbr" link-to="4"/>
	      <clip pos="3" side="tl" part="lemq"/> 
	    </lu>
	    <b pos="2"/>
	    <lu> 
	      <clip pos="4" side="tl" part="lem"/> 
	      <clip pos="4" side="tl" part="a_adj"/>
	      <clip pos="4" side="tl" part="GD" link-to="3"/>
	      <clip pos="4" side="tl" part="mf"/>
	      <clip pos="4" side="tl" part="nbr" link-to="4"/>
	    </lu>
	  </chunk>
	</out>
	  </otherwise>
	</choose>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
 </rule>

<rule comment="REGLA: PRON + en + NOM + ko/en+ NOM + DET (nire aitaren etxea - la casa de mi padre) (em sembla que no es dóna mai posesiu + nom mugagabe, treure?">
      <pattern>
	<pattern-item n="prnpos"/>
	<pattern-item n="en"/>
	<pattern-item n="nom"/>
	<pattern-item n="ko_en"/>
	<pattern-item n="nom"/>
	<pattern-item n="det"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="concord_n2">
	  <with-param pos="5"/>
	  <with-param pos="6"/>
	</call-macro>
	<call-macro n="posesivo">
	  <with-param pos="1"/>
	  <with-param pos="3"/>
	</call-macro>		
	<call-macro n="tipo_det">
	  <with-param pos="6"/>
	</call-macro>
	<out> 
	  <chunk name="d_n_pr_pos_n" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN"/></tag>
	      <tag><var n="tipusdet"/></tag>
	      <tag><clip pos="5" side="tl" part="gen"/></tag>
	      <tag><clip pos="5" side="tl" part="nbr"/></tag>
	    </tags>
	    <lu>
	      <clip pos="6" side="tl" part="lem"/> 
	      <clip pos="6" side="tl" part="a_det"/> 
	      <lit-tag v="2"/> 
	      <clip pos="6" side="tl" part="GD" link-to="3"/>
	      <clip pos="6" side="tl" part="mf"/>
	      <clip pos="6" side="tl" part="nbr"/>
	    </lu>
	    <b pos="1"/>
	    <lu> 
	      <clip pos="5" side="tl" part="lemh"/> 
	      <clip pos="5" side="tl" part="a_nom"/>
	      <clip pos="5" side="tl" part="GD" link-to="3"/>
	      <clip pos="5" side="tl" part="mf"/>
	      <clip pos="5" side="tl" part="nbr" link-to="4"/>
	      <clip pos="5" side="tl" part="lemq"/> 
	    </lu>
	    <b pos="2"/>
	    <lu>
	      <clip pos="4" side="tl" part="whole"/> 
	    </lu>
	    <b/>
	    <lu>
	      <clip pos="1" side="tl" part="lem"/>
	      <clip pos="1" side="tl" part="det_pos"/>
	      <clip pos="1" side="tl" part="gen"/>
	      <lit-tag v="sg"/>
	    </lu>
	    <b/>
	    <lu> 
	      <clip pos="3" side="tl" part="lemh"/> 
	      <clip pos="3" side="tl" part="a_nom"/>
	      <clip pos="3" side="tl" part="gen"/>
	      <lit-tag v="sg"/>
	      <clip pos="3" side="tl" part="lemq"/> 
	    </lu>
	    <b/>
	  </chunk>
	</out>	
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
 </rule>

<rule comment="REGLA: PRON + en + NOM + DET + ko/en+ NOM + DET (nire aitaren etxea - la casa de mi padre)">
      <pattern>
	<pattern-item n="prnpos"/>
	<pattern-item n="en"/>
	<pattern-item n="nom"/>
	<pattern-item n="det"/>
	<pattern-item n="ko_en"/>
	<pattern-item n="nom"/>
	<pattern-item n="det"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="concord_n2">
	  <with-param pos="6"/>
	  <with-param pos="7"/>
	</call-macro>
	<call-macro n="posesivo">
	  <with-param pos="1"/>
	  <with-param pos="3"/>
	</call-macro>	
	<call-macro n="tipo_det">
	  <with-param pos="7"/>
	</call-macro>	
	<out> 
	  <chunk name="d_n_pr_pos_n" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN"/></tag>
	      <tag><var n="tipusdet"/></tag>
	      <tag><clip pos="6" side="tl" part="gen"/></tag>
	      <tag><clip pos="6" side="tl" part="nbr"/></tag>
	    </tags>
	    <lu>
	      <clip pos="7" side="tl" part="lem"/> 
	      <clip pos="7" side="tl" part="a_det"/> 
	      <lit-tag v="2"/> 
	      <clip pos="7" side="tl" part="GD" link-to="3"/>
	      <clip pos="7" side="tl" part="mf"/>
	      <clip pos="7" side="tl" part="nbr"/>
	    </lu>
	    <b pos="1"/>
	    <lu> 
	      <clip pos="6" side="tl" part="lemh"/> 
	      <clip pos="6" side="tl" part="a_nom"/>
	      <clip pos="6" side="tl" part="GD" link-to="3"/>
	      <clip pos="6" side="tl" part="mf"/>
	      <clip pos="6" side="tl" part="nbr" link-to="4"/>
	      <clip pos="6" side="tl" part="lemq"/> 
	    </lu>
	    <b pos="2"/>
	    <lu>
	      <clip pos="5" side="tl" part="whole"/> 
	    </lu>
	    <b/>
	    <lu>
	      <clip pos="1" side="tl" part="lem"/>
	      <clip pos="1" side="tl" part="det_pos"/>
	      <clip pos="1" side="tl" part="gen"/>
	      <clip pos="4" side="tl" part="nbr"/>
	    </lu>
	    <b/>
	    <lu> 
	      <clip pos="3" side="tl" part="lemh"/> 
	      <clip pos="3" side="tl" part="a_nom"/>
	      <clip pos="3" side="tl" part="gen"/>
	      <clip pos="4" side="tl" part="nbr"/>
	      <clip pos="3" side="tl" part="lemq"/> 
	    </lu>
	    <b/>
	  </chunk>
	</out>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
 </rule>


<!--**** SN amb graus adjectiu (comparatiu, superlatiu, excessiu) -->



<rule comment="REGLA: N + ADJ + GRADO + DET (etxe handiagoa - una casa más grande, gauza txarrena - la cosa más mala)">
      <pattern>
	<pattern-item n="nom"/>
	<pattern-item n="adj"/>
	<pattern-item n="gra"/>
	<pattern-item n="det"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="concord_n3">
	  <with-param pos="1"/>
	  <with-param pos="2"/>
	  <with-param pos="4"/>
	</call-macro>
	<call-macro n="tipo_det">
	  <with-param pos="4"/>
	</call-macro>
	<choose>
	  <when>
	    <test>
	      <equal>
		<clip pos="3" side="sl" part="lem"/>
		<lit v="en"/>
	      </equal>
	    </test><!--en este caso se envía determinante 'def' i no 'art' ('la casa más roja') -->
	    <let>
	      <var n="tipusdet"/>
	      <lit-tag v="def"/>
	    </let>
	  </when>
	  <when>
	    <test>
	      <and>
		<not>
		  <equal>
		    <clip pos="3" side="sl" part="lem"/>
		    <lit v="en"/>
		  </equal>
		</not>
		<equal>
		  <clip pos="4" side="sl" part="lem"/>
		  <lit v="a"/>
		</equal>
	      </and>
	    </test>
	    <let>
	      <clip pos="4" side="tl" part="lem"/> 
	      <lit v="uno"/>
	    </let>
	    <let>
	      <var n="tipusdet"/>
	      <lit-tag v="ind"/>
	    </let>
	  </when>
	</choose>
	<out> 
	  <chunk name="d_nom_adv_adj" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN"/></tag>
	      <tag><var n="tipusdet"/></tag>
	      <tag><clip pos="1" side="tl" part="gen"/></tag>
	      <tag><clip pos="1" side="tl" part="nbr"/></tag>
	    </tags>
	    <lu>
	      <clip pos="4" side="tl" part="lem"/> 
	      <clip pos="4" side="tl" part="a_det"/> 
	      <lit-tag v="2"/> 
	      <clip pos="4" side="tl" part="GD" link-to="3"/>
	      <clip pos="4" side="tl" part="mf"/>
	      <clip pos="4" side="tl" part="nbr"/>
	    </lu>
	    <b pos="1"/>
	    <lu> 
	      <clip pos="1" side="tl" part="lemh"/> 
	      <clip pos="1" side="tl" part="a_nom"/>
	      <clip pos="1" side="tl" part="GD" link-to="3"/>
	      <clip pos="1" side="tl" part="mf"/>
	      <clip pos="1" side="tl" part="nbr" link-to="4"/>
	      <clip pos="1" side="tl" part="lemq"/> 
	    </lu>
	    <b/>
	    <lu>
	      <clip pos="3" side="tl" part="lem"/> 
	      <clip pos="3" side="tl" part="a_adv"/>
	    </lu>
	    <b/>
	    <lu> 
	      <clip pos="2" side="tl" part="lem"/> 
	      <clip pos="2" side="tl" part="a_adj"/>
	      <clip pos="2" side="tl" part="gen"/>
	      <clip pos="2" side="tl" part="nbr" link-to="4"/>
	    </lu>
	  </chunk>
	</out>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
 </rule>




<rule comment="REGLA: N + ik + ADJ + sup + a (gauzarik txarrena)">
      <pattern>
	<pattern-item n="nom"/>
	<pattern-item n="part"/>
	<pattern-item n="adj"/>
	<pattern-item n="sup"/>
	<pattern-item n="detart"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="concord_n3">
	  <with-param pos="1"/>
	  <with-param pos="3"/>
	  <with-param pos="5"/>
	</call-macro>
	<out> 
	  <chunk name="d_nom_adv_adj" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN"/></tag>
	      <tag><clip pos="5" side="tl" part="tipus_det"/></tag>
	      <tag><clip pos="1" side="tl" part="gen"/></tag>
	      <tag><clip pos="1" side="tl" part="nbr"/></tag>
	    </tags>
	    <lu>
	      <clip pos="5" side="tl" part="lem"/> 
	      <clip pos="5" side="tl" part="a_det"/> 
	      <lit-tag v="2"/> 
	      <clip pos="5" side="tl" part="GD" link-to="3"/>
	      <clip pos="5" side="tl" part="mf"/>
	      <clip pos="5" side="tl" part="nbr"/>
	    </lu>
	    <b pos="1"/>
	    <lu> 
	      <clip pos="1" side="tl" part="lemh"/> 
	      <clip pos="1" side="tl" part="a_nom"/>
	      <clip pos="1" side="tl" part="GD" link-to="3"/>
	      <clip pos="1" side="tl" part="mf"/>
	      <clip pos="1" side="tl" part="nbr" link-to="4"/>
	      <clip pos="1" side="tl" part="lemq"/> 
	    </lu>
	    <b/>
	    <lu>
	      <clip pos="4" side="tl" part="lem"/> 
	      <clip pos="4" side="tl" part="a_adv"/>
	    </lu>
	    <b/>
	    <lu> 
	      <clip pos="3" side="tl" part="lem"/> 
	      <clip pos="3" side="tl" part="a_adj"/>
	      <clip pos="3" side="tl" part="gen"/>
	      <clip pos="3" side="tl" part="nbr" link-to="4"/>
	    </lu>
	  </chunk>
	</out>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
 </rule>

 <rule comment="REGLA: PP + ko (egindako - hecho)">
      <pattern>
	<pattern-item n="pp_adv"/>
	<pattern-item n="ko"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<let>
	  <clip pos="1" side="tl" part="temps"/>
	  <lit-tag v="pp"/>
	</let>
	<out>
	  <chunk name="padv" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SPGEN"/></tag>
	      <tag><clip pos="1" side="tl" part="a_verb"/></tag>
	      <tag><clip pos="1" side="tl" part="temps"/></tag>
	      <tag><lit-tag v="GD"/></tag>
	      <tag><lit-tag v="ND"/></tag>
	    </tags>
	    <lu>
	      <clip pos="1" side="tl" part="lemh"/>
	      <clip pos="1" side="tl" part="a_verb"/>
	      <clip pos="1" side="tl" part="temps"/>
	      <lit-tag v="4"/>
	      <lit-tag v="5"/>
	      <clip pos="1" side="tl" part="lemq"/>
	    </lu>
	  </chunk>
	</out>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>





 <rule comment="REGLA: PP + KO NOM + DET (ezarritako alerta)">
      <pattern>
	<pattern-item n="pp_adv"/>
	<pattern-item n="ko"/>
	<pattern-item n="nom"/>
	<pattern-item n="det"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="concord_n2">
	  <with-param pos="3"/>
	  <with-param pos="4"/>
	</call-macro>
	<call-macro n="tipo_det">
	  <with-param pos="4"/>
	</call-macro>
	<let>
	  <clip pos="1" side="tl" part="temps"/>
	  <lit-tag v="pp"/>
	</let>
	<choose>
	  <when>
	    <test>
	      <equal>
		<clip pos="3" side="tl" part="gen"/>
		<lit-tag v="f"/>
	      </equal>
	    </test>
	    <let>
	      <var n="genere"/>
	      <lit-tag v="f"/>
	    </let>
	  </when>
	  <otherwise>
	    <let>
	       <var n="genere"/>
	       <lit-tag v="m"/>
	    </let>
	  </otherwise>
	</choose>
	<choose>
	  <when>
	    <test>
	      <equal>
		<clip pos="3" side="tl" part="nbr"/>
		<lit-tag v="pl"/>
	      </equal>
	    </test>
	    <let>
	      <var n="nombre"/>
	      <lit-tag v="pl"/>
	    </let>
	  </when>
	  <otherwise>
	    <let>
	       <var n="nombre"/>
	       <lit-tag v="sg"/>
	    </let>
	  </otherwise>
	</choose>
	<out> 
	  <chunk name="det_nom_pp" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN"/></tag>
	      <tag><var n="tipusdet"/></tag>
	      <tag><clip pos="3" side="tl" part="gen"/></tag>
	      <tag><clip pos="3" side="tl" part="nbr"/></tag>
	    </tags>
	    <lu>
	      <clip pos="4" side="tl" part="lem"/> 
	      <clip pos="4" side="tl" part="a_det"/> 
	      <lit-tag v="2"/> 
	      <clip pos="4" side="tl" part="GD" link-to="3"/>
	      <clip pos="4" side="tl" part="mf"/>
	      <clip pos="4" side="tl" part="nbr"/>
	    </lu>
	    <b/>
	    <lu> 
	      <clip pos="3" side="tl" part="lemh"/> 
	      <clip pos="3" side="tl" part="a_nom"/>
	      <clip pos="3" side="tl" part="GD" link-to="3"/>
	      <clip pos="3" side="tl" part="mf"/>
	      <clip pos="3" side="tl" part="nbr" link-to="4"/>
	      <clip pos="3" side="tl" part="lemq"/> 
	    </lu>
	    <b pos="1"/>
	     <lu>
	      <clip pos="1" side="tl" part="lemh"/>
	      <clip pos="1" side="tl" part="a_verb"/>
	      <clip pos="1" side="tl" part="temps"/>
	      <var n="genere"/>
	      <var n="nombre"/>
	      <clip pos="1" side="tl" part="lemq"/>
	    </lu>
	  </chunk>
	</out>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
 </rule>



    <!--********************************* REGLES DE SA ***************************************************** -->

<rule comment="REGLA: ADJ (gorri) Para los adjetivos que quedan solos (en teoría todos deberían formar parte de un SA)">
      <pattern>
	<pattern-item n="adj"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<out> 
	  <chunk name="adj" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SA.UNDET"/></tag>
	      <tag><clip pos="1" side="tl" part="gen"/></tag>
	      <tag><lit-tag v="ND"/></tag>
	    </tags>
	    <lu> 
	      <clip pos="1" side="tl" part="lem"/> 
	      <clip pos="1" side="tl" part="a_adj"/>
	      <clip pos="1" side="tl" part="tipus_det"/>
	      <clip pos="1" side="tl" part="GD" link-to="3"/>
	      <clip pos="1" side="tl" part="mf"/>
	      <lit-tag v="4"/>
	    </lu>
	    <b/>
	  </chunk>
	</out>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
 </rule>




 <rule comment="REGLA: ADJ + DET (gorria)">
      <pattern>
	<pattern-item n="adj"/>
	<pattern-item n="det"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>	
	<call-macro n="tipo_det">
	  <with-param pos="2"/>
	</call-macro>
	<out> 
	  <chunk name="det_adj" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SA"/></tag>
	      <tag><var n="tipusdet"/></tag>
	      <tag><clip pos="2" side="tl" part="gen"/></tag>
	      <tag><clip pos="2" side="tl" part="nbr"/></tag>
	    </tags>
	    <lu>
	      <clip pos="2" side="tl" part="lem"/> 
	      <clip pos="2" side="tl" part="a_det"/> 
	      <lit-tag v="2"/> 
	      <clip pos="2" side="tl" part="GD" link-to="3"/>
	      <clip pos="2" side="tl" part="mf"/>
	      <clip pos="2" side="tl" part="nbr"/>
	    </lu>
	    <b/>
	    <lu> 
	      <clip pos="1" side="tl" part="lem"/> 
	      <clip pos="1" side="tl" part="a_adj"/>
	      <clip pos="1" side="tl" part="tipus_det"/>
	      <clip pos="1" side="tl" part="GD" link-to="3"/>
	      <clip pos="1" side="tl" part="mf"/>
	      <clip pos="2" side="tl" part="nbr" link-to="4"/>
	    </lu>
	    <b/>
	  </chunk>
	</out>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
 </rule>

  <rule comment="REGLA: PP (irekia)">
      <pattern>
	<pattern-item n="pp"/>
	<pattern-item n="det"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>	
	<call-macro n="tipo_det">
	  <with-param pos="2"/>
	</call-macro>
	<out>
	  <chunk name="det_pp" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SA"/></tag>
	      <tag><var n="tipusdet"/></tag>
	      <tag><lit-tag v="GD"/></tag>
	      <tag><clip pos="2" side="tl" part="nbr"/></tag>
	    </tags>
	    <lu>
	      <clip pos="2" side="tl" part="lem"/> 
	      <clip pos="2" side="tl" part="a_det"/> 
	      <lit-tag v="2"/> 
	      <clip pos="2" side="tl" part="GD" link-to="3"/>
	      <clip pos="2" side="tl" part="mf"/>
	      <clip pos="2" side="tl" part="nbr"/>
	    </lu>
	    <b/>
	    <lu>
	      <clip pos="1" side="tl" part="lemh"/>
	      <clip pos="1" side="tl" part="a_verb"/>
	      <clip pos="1" side="tl" part="temps"/>
	      <lit-tag v="3"/>
	      <lit-tag v="4"/>
	      <clip pos="1" side="tl" part="lemq"/>
	    </lu>
	  </chunk>
	</out>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>


<rule comment="REGLA: ADJ + GRADO (gorriago, gorriegi, gorrien(a))">
      <pattern>
	<pattern-item n="adj"/>
	<pattern-item n="gra"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<out> 
	  <chunk name="adv_adj" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SA.UNDET"/></tag>
	      <tag><clip pos="1" side="tl" part="gen"/></tag>
	      <tag><lit-tag v="ND"/></tag>
	    </tags>
	    <lu>
	      <clip pos="2" side="tl" part="lem"/> 
	      <clip pos="2" side="tl" part="a_adv"/>
	    </lu>
	    <b/>
	    <lu> 
	      <clip pos="1" side="tl" part="lem"/>
	      <clip pos="1" side="tl" part="a_adj"/>
	      <clip pos="1" side="tl" part="GD" link-to="3"/>
	      <clip pos="1" side="tl" part="mf"/>
	      <lit-tag v="4"/>
	    </lu>
	    <b/>
	  </chunk>
	</out>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
 </rule>

<rule comment="REGLA: ADJ + GRADO + DET (gorriagoa, gorriegia, gorriena))">
      <pattern>
	<pattern-item n="adj"/>
	<pattern-item n="gra"/>
	<pattern-item n="det"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>	
	<call-macro n="tipo_det">
	  <with-param pos="3"/>
	</call-macro>
	<choose>
	  <when>
	    <test>
	      <equal>
		<clip pos="2" side="sl" part="lem"/>
		<lit v="en"/>
	      </equal>
	    </test><!--en este caso se envía determinante 'def' i no 'art' ('el más rojo') -->
	    <let>
	      <var n="tipusdet"/>
	      <lit-tag v="def"/>
	    </let>
	  </when>
	</choose>
	<out> 
	  <chunk name="d_adv_adj" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SA"/></tag>
	      <tag><var n="tipusdet"/></tag>
	      <tag><clip pos="1" side="tl" part="gen"/></tag>
	      <tag><clip pos="3" side="tl" part="nbr"/></tag>
	    </tags>
	    <lu>
	      <clip pos="3" side="tl" part="lem"/> 
	      <clip pos="3" side="tl" part="a_det"/> 
	      <lit-tag v="2"/> 
	      <clip pos="3" side="tl" part="GD" link-to="3"/>
	      <clip pos="3" side="tl" part="mf"/>
	      <clip pos="3" side="tl" part="nbr"/>
	    </lu>
	    <b/>
	    <lu>
	      <clip pos="2" side="tl" part="lem"/> 
	      <clip pos="2" side="tl" part="a_adv"/>
	    </lu>
	    <b/>
	    <lu> 
	      <clip pos="1" side="tl" part="lem"/>
	      <clip pos="1" side="tl" part="a_adj"/>
	      <clip pos="1" side="tl" part="GD" link-to="3"/>
	      <clip pos="1" side="tl" part="mf"/>
	      <clip pos="3" side="tl" part="nbr" link-to="4"/>
	    </lu>
	    <b/>
	  </chunk>
	</out>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
 </rule>




    <!--********************************* REGLES DE SV ***************************************************** -->


<rule comment="REGLA: VERBO SINTÉTICO (dut, nabil)">
      <pattern>
	<pattern-item n="vbsint"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="verbal_flex">
	  <with-param pos="1"/>
	</call-macro>
	<out>
	  <chunk name="vbconj" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SV"/></tag>
	      <tag><clip pos="1" side="tl" part="a_verb"/></tag>
	      <tag><clip pos="1" side="tl" part="persnbr"/></tag>
	      <tag><clip pos="1" side="sl" part="nor"/></tag>
	      <tag><clip pos="1" side="sl" part="nori"/></tag>
	      <tag><clip pos="1" side="sl" part="nork"/></tag>
	    </tags>
	    <lu>
	      <clip pos="1" side="tl" part="lemh"/>
	      <clip pos="1" side="tl" part="a_verb"/>
	      <clip pos="1" side="tl" part="temps"/>
	      <clip pos="1" side="tl" part="persnbr"/>
	      <clip pos="1" side="tl" part="lemq"/>
	    </lu>
	  </chunk>
	</out>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
</rule>





<rule comment="REGLA: PP + VERBO SINT (ikusi dut)">
      <pattern>
	<pattern-item n="pp"/>
	<pattern-item n="vbsint"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<let>
	  <clip pos="2" side="tl" part="lem"/>
	  <lit v="haber"/>
	</let>
	<let>
	  <clip pos="2" side="tl" part="a_verb"/>
	  <lit-tag v="vbhaver"/>
	</let>
	<call-macro n="verbal_flex">
	  <with-param pos="2"/>
	</call-macro>
	<choose>
	  <when>
	    <test>
	      <equal>
		 <clip pos="2" side="tl" part="temps"/>
		 <lit-tag v="pri"/>
	      </equal>
	    </test>
	    <out>
	      <chunk name="vbconj" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="SV"/></tag>
		  <tag><clip pos="2" side="tl" part="a_verb"/></tag>
		  <tag><clip pos="2" side="tl" part="persnbr"/></tag>
		  <tag><clip pos="2" side="sl" part="nor"/></tag>
		  <tag><clip pos="2" side="sl" part="nori"/></tag>
		  <tag><clip pos="2" side="sl" part="nork"/></tag>
		</tags>
		<lu>
		  <clip pos="2" side="tl" part="lemh"/>
		  <clip pos="2" side="tl" part="a_verb"/>
		  <clip pos="2" side="tl" part="temps"/>
		  <clip pos="2" side="tl" part="persnbr"/>
		  <clip pos="2" side="tl" part="lemq"/>
		</lu>
		<b pos="1"/>
		<lu>
		  <clip pos="1" side="tl" part="lemh"/>
		  <clip pos="1" side="tl" part="a_verb"/>
		  <clip pos="1" side="tl" part="temps"/>
		  <lit-tag v="m.sg"/>
		  <clip pos="1" side="tl" part="lemq"/>
		</lu>
	      </chunk>
	    </out>
	  </when>
	  <when>
	    <test>
	      <equal>
		<clip pos="2" side="tl" part="temps"/>
		<lit-tag v="pii"/>
	      </equal>
	    </test>
	    <let>	      
	      <clip pos="1" side="tl" part="temps"/>
	      <lit-tag v="ifi"/>
	    </let>
	    <out>
	      <chunk name="vbconj" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="SV"/></tag>
		  <tag><clip pos="1" side="tl" part="a_verb"/></tag>
		  <tag><clip pos="2" side="tl" part="persnbr"/></tag>
		  <tag><clip pos="2" side="sl" part="nor"/></tag>
		  <tag><clip pos="2" side="sl" part="nori"/></tag>
		  <tag><clip pos="2" side="sl" part="nork"/></tag>
		</tags>
		<lu>
		  <clip pos="1" side="tl" part="lemh"/>
		  <clip pos="1" side="tl" part="a_verb"/>
		  <clip pos="1" side="tl" part="temps"/>
		  <clip pos="2" side="tl" part="persnbr"/>
		  <clip pos="1" side="tl" part="lemq"/>
		</lu>
	      </chunk>
	    </out>
	    <call-macro n="f_bcond">
	      <with-param pos="1"/>
	    </call-macro>
	  </when>
	</choose>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
</rule>


<rule comment="REGLA: GER + VERBO SINT (etortzen naiz)">
      <pattern>
	<pattern-item n="ger"/>
	<pattern-item n="vbsint"/>
      </pattern>
      <action>	
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="verbal_flex">
	  <with-param pos="2"/>
	</call-macro>
	<choose>
	  <when>
	    <test>
	      <equal>
		 <clip pos="2" side="sl" part="temps"/>
		 <lit-tag v="pri"/>
	      </equal>
	    </test>
	    <let>
	      <clip pos="1" side="tl" part="temps"/>
	      <lit-tag v="pri"/>
	    </let>
	  </when>
	  <when>
	    <test>
	      <equal>
		 <clip pos="2" side="sl" part="temps"/>
		 <lit-tag v="pii"/>
	      </equal>
	    </test>
	    <let>
	      <clip pos="1" side="tl" part="temps"/>
	      <lit-tag v="pii"/>
	    </let>
	  </when>
	</choose>	    
	<out>
	  <chunk name="vbconj" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SV"/></tag>
	      <tag><clip pos="1" side="tl" part="a_verb"/></tag>
	      <tag><clip pos="2" side="tl" part="persnbr"/></tag>
	      <tag><clip pos="2" side="sl" part="nor"/></tag>
	      <tag><clip pos="2" side="sl" part="nori"/></tag>
	      <tag><clip pos="2" side="sl" part="nork"/></tag>
	    </tags>
	    <lu>
	      <clip pos="1" side="tl" part="lemh"/>
	      <clip pos="1" side="tl" part="a_verb"/>
	      <clip pos="1" side="tl" part="temps"/>
	      <clip pos="2" side="tl" part="persnbr"/>
	      <clip pos="1" side="tl" part="lemq"/>
	    </lu>
	  </chunk>
	</out>
	<call-macro n="f_bcond">
	  <with-param pos="1"/>
	</call-macro>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
</rule>



<rule comment="REGLA: PFUT + VERBO SINT (etorriko naiz)">
      <pattern>
	<pattern-item n="pfut"/>
	<pattern-item n="vbsint"/>
      </pattern>
      <action>	
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="verbal_flex">
	  <with-param pos="2"/>
	</call-macro>
	<choose>
	  <when>
	    <test>
	      <equal>
		 <clip pos="2" side="sl" part="temps"/>
		 <lit-tag v="pri"/>
	      </equal>
	    </test>
	    <let>
	      <clip pos="1" side="tl" part="temps"/>
	      <lit-tag v="fti"/>
	    </let>
	  </when>
	  <when>
	    <test>
	      <equal>
		 <clip pos="2" side="sl" part="temps"/>
		 <lit-tag v="pii"/>
	      </equal>
	    </test>
	    <let>
	      <clip pos="1" side="tl" part="temps"/>
	      <lit-tag v="cni"/>
	    </let>
	  </when>
	</choose>	    
	<out>
	  <chunk name="vbconj" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SV"/></tag>
	      <tag><clip pos="1" side="tl" part="a_verb"/></tag>
	      <tag><clip pos="2" side="tl" part="persnbr"/></tag>
	      <tag><clip pos="2" side="sl" part="nor"/></tag>
	      <tag><clip pos="2" side="sl" part="nori"/></tag>
	      <tag><clip pos="2" side="sl" part="nork"/></tag>
	    </tags>
	    <lu>
	      <clip pos="1" side="tl" part="lemh"/>
	      <clip pos="1" side="tl" part="a_verb"/>
	      <clip pos="1" side="tl" part="temps"/>
	      <clip pos="2" side="tl" part="persnbr"/>
	      <clip pos="1" side="tl" part="lemq"/>
	    </lu>
	  </chunk>
	</out>
	<call-macro n="f_bcond">
	  <with-param pos="1"/>
	</call-macro>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
</rule>





    <rule comment="REGLA: PP (por ahora se pasa a infinitivo, revisar si es adecuado)">
      <pattern>
	<pattern-item n="pp"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<let>
	  <clip pos="1" side="tl" part="temps"/>
	  <lit-tag v="inf"/>
	</let>
	<out>
	  <chunk name="pp" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SV"/></tag>
	      <tag><clip pos="1" side="tl" part="a_verb"/></tag>
	      <tag><clip pos="1" side="tl" part="temps"/></tag>
	    </tags>
	    <lu>
	      <clip pos="1" side="tl" part="lemh"/>
	      <clip pos="1" side="tl" part="a_verb"/>
	      <clip pos="1" side="tl" part="temps"/>
	   <!--   <lit-tag v="m.sg"/> -->
	      <clip pos="1" side="tl" part="lemq"/>
	    </lu>
	  </chunk>
	</out>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>


    <rule comment="REGLA: PADV">
      <pattern>
	<pattern-item n="padv"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<let>
	  <clip pos="1" side="tl" part="temps"/>
	  <lit-tag v="pp"/>
	</let>
	<out>
	  <chunk name="padv" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SV"/></tag>
	      <tag><clip pos="1" side="tl" part="a_verb"/></tag>
	      <tag><clip pos="1" side="tl" part="temps"/></tag>
	    </tags>
	    <lu>
	      <clip pos="1" side="tl" part="lemh"/>
	      <clip pos="1" side="tl" part="a_verb"/>
	      <clip pos="1" side="tl" part="temps"/>
	      <lit-tag v="m.sg"/>
	      <clip pos="1" side="tl" part="lemq"/>
	    </lu>
	  </chunk>
	</out>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
    </rule>


<!--Verbos perifrásticos (reglas exactamente idénticas a las de verbos normales, combinar en una?-->


<rule comment="REGLA: VERBO SINTÉTICO (nahi dut)">
      <pattern>
	<pattern-item n="vbper"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="verbal_flex">
	  <with-param pos="1"/>
	</call-macro>
	<out>
	  <chunk name="vbconj" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SV"/></tag>
	      <tag><clip pos="1" side="tl" part="a_verb"/></tag>
	      <tag><clip pos="1" side="tl" part="persnbr"/></tag>
	      <tag><clip pos="1" side="sl" part="nor"/></tag>
	      <tag><clip pos="1" side="sl" part="nori"/></tag>
	      <tag><clip pos="1" side="sl" part="nork"/></tag>
	    </tags>
	    <lu>
	      <clip pos="1" side="tl" part="lemh"/>
	      <clip pos="1" side="tl" part="a_verb"/>
	      <clip pos="1" side="tl" part="temps"/>
	      <clip pos="1" side="tl" part="persnbr"/>
	      <clip pos="1" side="tl" part="lemq"/>
	    </lu>
	  </chunk>
	</out>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
</rule>


<rule comment="REGLA: PP + VERBO SINT (nahi izan dut)">
      <pattern>
	<pattern-item n="perpp"/>
	<pattern-item n="vbsint"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<let>
	  <clip pos="2" side="tl" part="lem"/>
	  <lit v="haber"/>
	</let>
	<let>
	  <clip pos="2" side="tl" part="a_verb"/>
	  <lit-tag v="vbhaver"/>
	</let>
	<call-macro n="verbal_flex">
	  <with-param pos="2"/>
	</call-macro>
	<choose>
	  <when>
	    <test>
	      <equal>
		 <clip pos="2" side="tl" part="temps"/>
		 <lit-tag v="pri"/>
	      </equal>
	    </test>
	    <out>
	      <chunk name="vbconj" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="SV"/></tag>
		  <tag><clip pos="2" side="tl" part="a_verb"/></tag>
		  <tag><clip pos="2" side="tl" part="persnbr"/></tag>
		  <tag><clip pos="2" side="sl" part="nor"/></tag>
		  <tag><clip pos="2" side="sl" part="nori"/></tag>
		  <tag><clip pos="2" side="sl" part="nork"/></tag>
		</tags>
		<lu>
		  <clip pos="2" side="tl" part="lemh"/>
		  <clip pos="2" side="tl" part="a_verb"/>
		  <clip pos="2" side="tl" part="temps"/>
		  <clip pos="2" side="tl" part="persnbr"/>
		  <clip pos="2" side="tl" part="lemq"/>
		</lu>
		<b pos="1"/>
		<lu>
		  <clip pos="1" side="tl" part="lemh"/>
		  <clip pos="1" side="tl" part="a_verb"/>
		  <clip pos="1" side="tl" part="temps"/>
		  <lit-tag v="m.sg"/>
		  <clip pos="1" side="tl" part="lemq"/>
		</lu>
	      </chunk>
	    </out>
	  </when>
	  <when>
	    <test>
	      <equal>
		<clip pos="2" side="tl" part="temps"/>
		<lit-tag v="pii"/>
	      </equal>
	    </test>
	    <let>	      
	      <clip pos="1" side="tl" part="temps"/>
	      <lit-tag v="ifi"/>
	    </let>
	    <out>
	      <chunk name="vbconj" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="SV"/></tag>
		  <tag><clip pos="1" side="tl" part="a_verb"/></tag>
		  <tag><clip pos="2" side="tl" part="persnbr"/></tag>
		  <tag><clip pos="2" side="sl" part="nor"/></tag>
		  <tag><clip pos="2" side="sl" part="nori"/></tag>
		  <tag><clip pos="2" side="sl" part="nork"/></tag>
		</tags>
		<lu>
		  <clip pos="1" side="tl" part="lemh"/>
		  <clip pos="1" side="tl" part="a_verb"/>
		  <clip pos="1" side="tl" part="temps"/>
		  <clip pos="2" side="tl" part="persnbr"/>
		  <clip pos="1" side="tl" part="lemq"/>
		</lu>
	      </chunk>
	    </out>
	    <call-macro n="f_bcond">
	      <with-param pos="1"/>
	    </call-macro>
	  </when>
	</choose>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
</rule>


<rule comment="REGLA: GER + VERBO SINT (nahi izaten dut)">
      <pattern>
	<pattern-item n="perger"/>
	<pattern-item n="vbsint"/>
      </pattern>
      <action>	
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="verbal_flex">
	  <with-param pos="2"/>
	</call-macro>
	<choose>
	  <when>
	    <test>
	      <equal>
		 <clip pos="2" side="sl" part="temps"/>
		 <lit-tag v="pri"/>
	      </equal>
	    </test>
	    <let>
	      <clip pos="1" side="tl" part="temps"/>
	      <lit-tag v="pri"/>
	    </let>
	  </when>
	  <when>
	    <test>
	      <equal>
		 <clip pos="2" side="sl" part="temps"/>
		 <lit-tag v="pii"/>
	      </equal>
	    </test>
	    <let>
	      <clip pos="1" side="tl" part="temps"/>
	      <lit-tag v="pii"/>
	    </let>
	  </when>
	</choose>	    
	<out>
	  <chunk name="vbconj" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SV"/></tag>
	      <tag><clip pos="1" side="tl" part="a_verb"/></tag>
	      <tag><clip pos="2" side="tl" part="persnbr"/></tag>
	      <tag><clip pos="2" side="sl" part="nor"/></tag>
	      <tag><clip pos="2" side="sl" part="nori"/></tag>
	      <tag><clip pos="2" side="sl" part="nork"/></tag>
	    </tags>
	    <lu>
	      <clip pos="1" side="tl" part="lemh"/>
	      <clip pos="1" side="tl" part="a_verb"/>
	      <clip pos="1" side="tl" part="temps"/>
	      <clip pos="2" side="tl" part="persnbr"/>
	      <clip pos="1" side="tl" part="lemq"/>
	    </lu>
	  </chunk>
	</out>
	<call-macro n="f_bcond">
	  <with-param pos="1"/>
	</call-macro>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
</rule>



<rule comment="REGLA: PFUT + VERBO SINT (nahiko dut)">
      <pattern>
	<pattern-item n="perpfut"/>
	<pattern-item n="vbsint"/>
      </pattern>
      <action>	
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="verbal_flex">
	  <with-param pos="2"/>
	</call-macro>
	<choose>
	  <when>
	    <test>
	      <equal>
		 <clip pos="2" side="sl" part="temps"/>
		 <lit-tag v="pri"/>
	      </equal>
	    </test>
	    <let>
	      <clip pos="1" side="tl" part="temps"/>
	      <lit-tag v="fti"/>
	    </let>
	  </when>
	  <when>
	    <test>
	      <equal>
		 <clip pos="2" side="sl" part="temps"/>
		 <lit-tag v="pii"/>
	      </equal>
	    </test>
	    <let>
	      <clip pos="1" side="tl" part="temps"/>
	      <lit-tag v="cni"/>
	    </let>
	  </when>
	</choose>	    
	<out>
	  <chunk name="vbconj" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SV"/></tag>
	      <tag><clip pos="1" side="tl" part="a_verb"/></tag>
	      <tag><clip pos="2" side="tl" part="persnbr"/></tag>
	      <tag><clip pos="2" side="sl" part="nor"/></tag>
	      <tag><clip pos="2" side="sl" part="nori"/></tag>
	      <tag><clip pos="2" side="sl" part="nork"/></tag>
	    </tags>
	    <lu>
	      <clip pos="1" side="tl" part="lemh"/>
	      <clip pos="1" side="tl" part="a_verb"/>
	      <clip pos="1" side="tl" part="temps"/>
	      <clip pos="2" side="tl" part="persnbr"/>
	      <clip pos="1" side="tl" part="lemq"/>
	    </lu>
	  </chunk>
	</out>
	<call-macro n="f_bcond">
	  <with-param pos="1"/>
	</call-macro>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
</rule>


<rule comment="REGLA: GER + ARI IZAN (prestatzen ari gara - estamos preparando)">
      <pattern>
	<pattern-item n="ger"/>
	<pattern-item n="ari_izan"/>
      </pattern>
      <action>	
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="verbal_flex">
	  <with-param pos="2"/>
	</call-macro>
	<out> 
	  <chunk name="estar_ger" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SV"/></tag>
	      <tag><clip pos="1" side="tl" part="a_verb"/></tag>
	      <tag><clip pos="2" side="tl" part="persnbr"/></tag>
	      <tag><clip pos="2" side="sl" part="nor"/></tag>
	      <tag><clip pos="2" side="sl" part="nori"/></tag>
	      <tag><clip pos="2" side="sl" part="nork"/></tag>
	    </tags>
	    <lu>
	      <clip pos="2" side="tl" part="lemh"/>
	      <clip pos="2" side="tl" part="a_verb"/>
	      <clip pos="2" side="tl" part="temps"/>
	      <clip pos="2" side="tl" part="persnbr"/>
	      <clip pos="2" side="tl" part="lemq"/>
	    </lu>
	    <b pos="1"/>
	    <lu>
	      <clip pos="1" side="tl" part="lemh"/>
	      <clip pos="1" side="tl" part="a_verb"/>
	      <clip pos="1" side="tl" part="temps"/>
	      <clip pos="1" side="tl" part="lemq"/>
	    </lu>
	  </chunk>
	</out>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
</rule>









  <rule comment="ADITZ IZENA + KO (joateko - para ir) ">
    <pattern>
      <pattern-item n="vbizen"/>
      <pattern-item n="ko"/>	
    </pattern>
    <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
      <let>
	<clip pos="1" side="tl" part="temps"/>
	<lit-tag v="inf"/>
      </let>
      <out>
	<chunk name="tzeko" case="caseFirstWord">
	  <tags>
	    <tag><lit-tag v="SVsub"/></tag>
	    <tag><clip pos="1" side="tl" part="a_verb"/></tag>
	    <tag><clip pos="1" side="tl" part="temps"/></tag>
	    <tag><lit-tag v="PD"/></tag>
	    <tag><lit-tag v="ND"/></tag>
	  </tags>
	  <lu>
	    <lit v="para"/>
	    <lit-tag v="pr"/>
	  </lu>
	  <b/>
	  <lu>
	    <clip pos="1" side="tl" part="lemh"/>
	    <clip pos="1" side="tl" part="a_verb"/>
	    <clip pos="1" side="tl" part="temps"/>	    
	    <clip pos="1" side="tl" part="lemq"/>
	  </lu>
	</chunk>
      </out>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
    </action>
  </rule>

 <rule comment="ADITZ IZENA + ART (izatea = ser) (el artículo desaparece por ahora) ">
    <pattern>
      <pattern-item n="vbizen"/>
      <pattern-item n="detart"/>	
    </pattern>
    <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
      <let>
	<clip pos="1" side="tl" part="temps"/>
	<lit-tag v="inf"/>
      </let>
      <out>
	<chunk name="inf" case="caseFirstWord">
	  <tags>
	    <tag><lit-tag v="SV"/></tag>
	    <tag><clip pos="1" side="tl" part="a_verb"/></tag>
	    <tag><clip pos="1" side="tl" part="temps"/></tag>
	    <tag><lit-tag v="PD"/></tag>
	    <tag><lit-tag v="ND"/></tag>
	  </tags>
	  <lu>
	    <clip pos="1" side="tl" part="lemh"/>
	    <clip pos="1" side="tl" part="a_verb"/>
	    <clip pos="1" side="tl" part="temps"/>	    
	    <clip pos="1" side="tl" part="lemq"/>
	  </lu>
	</chunk>
      </out>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
    </action>
  </rule>

 <rule comment="ADITZ IZENA + KO (argitzeke - sin esclarecer) ">
    <pattern>
      <pattern-item n="vbizen"/>
      <pattern-item n="post"/>	
    </pattern>
    <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
      <let>
	<clip pos="1" side="tl" part="temps"/>
	<lit-tag v="inf"/>
      </let>
      <out>
	<chunk name="pr_inf" case="caseFirstWord">
	  <tags>
	    <tag><lit-tag v="SV"/></tag>
	    <tag><clip pos="1" side="tl" part="a_verb"/></tag>
	    <tag><clip pos="1" side="tl" part="temps"/></tag>
	  </tags>
	  <lu>
	    <clip pos="2" side="tl" part="whole"/>
	  </lu>
	  <b/>
	  <lu>
	    <clip pos="1" side="tl" part="lemh"/>
	    <clip pos="1" side="tl" part="a_verb"/>
	    <clip pos="1" side="tl" part="temps"/>	    
	    <clip pos="1" side="tl" part="lemq"/>
	  </lu>
	</chunk>
      </out>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
    </action>
  </rule>


 <rule comment="REGLA: PP + ezinda (saldu ezinda - sin poder vender">
      <pattern>
	<pattern-item n="pp"/>
	<pattern-item n="ezinda"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	 <let>
	   <clip pos="1" side="tl" part="temps"/>
	   <lit-tag v="inf"/>
	 </let>
	<out>
	  <chunk name="inf_inf" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SV"/></tag>
	      <tag><clip pos="1" side="tl" part="a_verb"/></tag>
	      <tag><clip pos="1" side="tl" part="temps"/></tag>
	    </tags>
	    <lu>
	      <clip pos="2" side="tl" part="whole"/>
	    </lu>
	    <b pos="1"/>
	    <lu>
	      <clip pos="1" side="tl" part="whole"/>
	    </lu>
	  </chunk>
	</out>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
 </rule>



 <rule comment="REGLA: (e)nez">
      <pattern>
	<pattern-item n="nez"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<out>
	  <chunk name="nez" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="cnjadv"/></tag>
	    </tags>
	    <lu>
	      <clip pos="1" side="tl" part="whole"/>
	    </lu>
	  </chunk>
	</out>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
 </rule>
	      

<rule comment="REGLA: adv">
      <pattern>
	<pattern-item n="adv"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<out>
	  <chunk name="adv" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SADV"/></tag>
	      <tag><clip pos="1" side="tl" part="a_adv"/></tag>
	    </tags>
	    <lu>
	      <clip pos="1" side="tl" part="whole"/>
	    </lu>
	  </chunk>
	</out>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
 </rule>


<rule comment="REGLA: SPOST (posposición separable, p. ex. 'arabera'">
      <pattern>
	<pattern-item n="spost"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<out>
	  <chunk name="spost" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="PR"/></tag>
	    <!--  <tag><clip pos="1" side="tl" part="a_adv"/></tag>-->
	    </tags>
	    <lu>
	      <clip pos="1" side="tl" part="whole"/>
	    </lu>
	  </chunk>
	</out>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
 </rule>


 <rule comment="REGLA: DET + POST (lehengo astekoan = lehengo asteko(SPGEN) + an (PR)). Se reordena en t2x">
      <pattern>
	<pattern-item n="det"/>
	<pattern-item n="post"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="tipo_det">
	  <with-param pos="1"/>
	</call-macro>	
	<out> 
	  <chunk name="pr_det" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SPR"/></tag>
	      <tag><var n="tipusdet"/></tag>
	      <tag><clip pos="1" side="tl" part="gen"/></tag>
	      <tag><clip pos="1" side="tl" part="nbr"/></tag>
	    </tags>
	    <lu>
	      <clip pos="2" side="tl" part="whole"/>
	    </lu>
	    <b/>
	    <lu>
	      <clip pos="1" side="tl" part="lem"/> 
	      <clip pos="1" side="tl" part="a_det"/> 
	      <lit-tag v="2"/> 
	      <clip pos="1" side="tl" part="GD" link-to="3"/>
	      <clip pos="1" side="tl" part="mf"/>
	      <clip pos="1" side="tl" part="nbr"/>
	    </lu>
	  </chunk>
	</out>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
 </rule>



<rule comment="REGLA: SPOST + KO (Autonomiari _buruzko_ erreferendumaren)">
      <pattern>
	<pattern-item n="spost"/>
	<pattern-item n="ko"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<out>
	  <chunk name="spost" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="PRGEN"/></tag>
	    <!--  <tag><clip pos="1" side="tl" part="a_adv"/></tag>-->
	    </tags>
	    <lu>
	      <clip pos="1" side="tl" part="whole"/>
	    </lu>
	  </chunk>
	</out>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
 </rule>

<!--***************************** VERBS AMB RELATIUS  **********************************-->


<rule comment="REGLA: VERBO SINTÉTICO (dut, nabil)">
      <pattern>
	<pattern-item n="vbsint"/>
	<pattern-item n="reladj"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="verbal_flex">
	  <with-param pos="1"/>
	</call-macro>
	<out>
	  <chunk name="q_vbconj" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="Orel"/></tag>
	      <tag><clip pos="1" side="tl" part="a_verb"/></tag>
	      <tag><clip pos="1" side="tl" part="persnbr"/></tag>
	      <tag><clip pos="1" side="sl" part="nor"/></tag>
	      <tag><clip pos="1" side="sl" part="nori"/></tag>
	      <tag><clip pos="1" side="sl" part="nork"/></tag>
	    </tags>
	    <lu>
	      <clip pos="2" side="tl" part="whole"/>
	    </lu>
	    <b/>
	    <lu>
	      <clip pos="1" side="tl" part="lemh"/>
	      <clip pos="1" side="tl" part="a_verb"/>
	      <clip pos="1" side="tl" part="temps"/>
	      <clip pos="1" side="tl" part="persnbr"/>
	      <clip pos="1" side="tl" part="lemq"/>
	    </lu>
	  </chunk>
	</out>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
</rule>



<rule comment="REGLA: PP + VERBO SINT (ikusi dut)">
      <pattern>
	<pattern-item n="pp"/>
	<pattern-item n="vbsint"/>
	<pattern-item n="reladj"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<let>
	  <clip pos="2" side="tl" part="lem"/>
	  <lit v="haber"/>
	</let>
	<let>
	  <clip pos="2" side="tl" part="a_verb"/>
	  <lit-tag v="vbhaver"/>
	</let>
	<call-macro n="verbal_flex">
	  <with-param pos="2"/>
	</call-macro>
	<choose>
	  <when>
	    <test>
	      <equal>
		 <clip pos="2" side="tl" part="temps"/>
		 <lit-tag v="pri"/>
	      </equal>
	    </test>
	    <out>
	      <chunk name="q_vbconj" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="Orel"/></tag>
		  <tag><clip pos="2" side="tl" part="a_verb"/></tag>
		  <tag><clip pos="2" side="tl" part="persnbr"/></tag>
		  <tag><clip pos="2" side="sl" part="nor"/></tag>
		  <tag><clip pos="2" side="sl" part="nori"/></tag>
		  <tag><clip pos="2" side="sl" part="nork"/></tag>
		</tags>
		<lu>
		  <clip pos="3" side="tl" part="whole"/>
		</lu>
		<b/>
		<lu>
		  <clip pos="2" side="tl" part="lemh"/>
		  <clip pos="2" side="tl" part="a_verb"/>
		  <clip pos="2" side="tl" part="temps"/>
		  <clip pos="2" side="tl" part="persnbr"/>
		  <clip pos="2" side="tl" part="lemq"/>
		</lu>
		<b pos="1"/>
		<lu>
		  <clip pos="1" side="tl" part="lemh"/>
		  <clip pos="1" side="tl" part="a_verb"/>
		  <clip pos="1" side="tl" part="temps"/>
		  <lit-tag v="m.sg"/>
		  <clip pos="1" side="tl" part="lemq"/>
		</lu>
	      </chunk>
	    </out>
	  </when>
	  <when>
	    <test>
	      <equal>
		<clip pos="2" side="tl" part="temps"/>
		<lit-tag v="pii"/>
	      </equal>
	    </test>
	    <let>	      
	      <clip pos="1" side="tl" part="temps"/>
	      <lit-tag v="ifi"/>
	    </let>
	    <out>
	      <chunk name="q_vbconj" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="Orel"/></tag>
		  <tag><clip pos="1" side="tl" part="a_verb"/></tag>
		  <tag><clip pos="2" side="tl" part="persnbr"/></tag>
		  <tag><clip pos="2" side="sl" part="nor"/></tag>
		  <tag><clip pos="2" side="sl" part="nori"/></tag>
		  <tag><clip pos="2" side="sl" part="nork"/></tag>
		</tags>
		<lu>
		  <clip pos="3" side="tl" part="whole"/>
		</lu>
		<b/>
		<lu>
		  <clip pos="1" side="tl" part="lemh"/>
		  <clip pos="1" side="tl" part="a_verb"/>
		  <clip pos="1" side="tl" part="temps"/>
		  <clip pos="2" side="tl" part="persnbr"/>
		  <clip pos="1" side="tl" part="lemq"/>
		</lu>
	      </chunk>
	    </out>
	    <call-macro n="f_bcond">
	      <with-param pos="1"/>
	    </call-macro>
	  </when>
	</choose>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
</rule>




<rule comment="REGLA: GER + VERBO SINT (etortzen naiz)">
      <pattern>
	<pattern-item n="ger"/>
	<pattern-item n="vbsint"/>
	<pattern-item n="reladj"/>
      </pattern>
      <action>	
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="verbal_flex">
	  <with-param pos="2"/>
	</call-macro>
	<choose>
	  <when>
	    <test>
	      <equal>
		 <clip pos="2" side="sl" part="temps"/>
		 <lit-tag v="pri"/>
	      </equal>
	    </test>
	    <let>
	      <clip pos="1" side="tl" part="temps"/>
	      <lit-tag v="pri"/>
	    </let>
	  </when>
	  <when>
	    <test>
	      <equal>
		 <clip pos="2" side="sl" part="temps"/>
		 <lit-tag v="pii"/>
	      </equal>
	    </test>
	    <let>
	      <clip pos="1" side="tl" part="temps"/>
	      <lit-tag v="pii"/>
	    </let>
	  </when>
	</choose>	    
	<out>
	  <chunk name="q_vbconj" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="Orel"/></tag>
	      <tag><clip pos="1" side="tl" part="a_verb"/></tag>
	      <tag><clip pos="2" side="tl" part="persnbr"/></tag>
	      <tag><clip pos="2" side="sl" part="nor"/></tag>
	      <tag><clip pos="2" side="sl" part="nori"/></tag>
	      <tag><clip pos="2" side="sl" part="nork"/></tag>
	    </tags>
	    <lu>
	      <clip pos="3" side="tl" part="whole"/>
	    </lu>
	    <b/>
	    <lu>
	      <clip pos="1" side="tl" part="lemh"/>
	      <clip pos="1" side="tl" part="a_verb"/>
	      <clip pos="1" side="tl" part="temps"/>
	      <clip pos="2" side="tl" part="persnbr"/>
	      <clip pos="1" side="tl" part="lemq"/>
	    </lu>
	  </chunk>
	</out>
	<call-macro n="f_bcond">
	  <with-param pos="1"/>
	</call-macro>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
</rule>


<rule comment="REGLA: PFUT + VERBO SINT (etorriko naiz)">
      <pattern>
	<pattern-item n="pfut"/>
	<pattern-item n="vbsint"/>
	<pattern-item n="reladj"/>
      </pattern>
      <action>	
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="verbal_flex">
	  <with-param pos="2"/>
	</call-macro>
	<choose>
	  <when>
	    <test>
	      <equal>
		 <clip pos="2" side="sl" part="temps"/>
		 <lit-tag v="pri"/>
	      </equal>
	    </test>
	    <let>
	      <clip pos="1" side="tl" part="temps"/>
	      <lit-tag v="fti"/>
	    </let>
	  </when>
	  <when>
	    <test>
	      <equal>
		 <clip pos="2" side="sl" part="temps"/>
		 <lit-tag v="pii"/>
	      </equal>
	    </test>
	    <let>
	      <clip pos="1" side="tl" part="temps"/>
	      <lit-tag v="cni"/>
	    </let>
	  </when>
	</choose>	    
	<out>
	  <chunk name="q_vbconj" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="Orel"/></tag>
	      <tag><clip pos="1" side="tl" part="a_verb"/></tag>
	      <tag><clip pos="2" side="tl" part="persnbr"/></tag>
	      <tag><clip pos="2" side="sl" part="nor"/></tag>
	      <tag><clip pos="2" side="sl" part="nori"/></tag>
	      <tag><clip pos="2" side="sl" part="nork"/></tag>
	    </tags>
	    <lu>
	      <clip pos="3" side="tl" part="whole"/>
	    </lu>
	    <b/>
	    <lu>
	      <clip pos="1" side="tl" part="lemh"/>
	      <clip pos="1" side="tl" part="a_verb"/>
	      <clip pos="1" side="tl" part="temps"/>
	      <clip pos="2" side="tl" part="persnbr"/>
	      <clip pos="1" side="tl" part="lemq"/>
	    </lu>
	  </chunk>
	</out>
	<call-macro n="f_bcond">
	  <with-param pos="1"/>
	</call-macro>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
</rule>


<rule comment="REGLA: VERBO SINTÉTICO (nahi dut)">
      <pattern>
	<pattern-item n="vbper"/>
	<pattern-item n="reladj"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="verbal_flex">
	  <with-param pos="1"/>
	</call-macro>
	<out>
	  <chunk name="q_vbconj" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="Orel"/></tag>
	      <tag><clip pos="1" side="tl" part="a_verb"/></tag>
	      <tag><clip pos="1" side="tl" part="persnbr"/></tag>
	      <tag><clip pos="1" side="sl" part="nor"/></tag>
	      <tag><clip pos="1" side="sl" part="nori"/></tag>
	      <tag><clip pos="1" side="sl" part="nork"/></tag>
	    </tags>
	    <lu>
	      <clip pos="2" side="tl" part="whole"/>
	    </lu>
	    <b/>
	    <lu>
	      <clip pos="1" side="tl" part="lemh"/>
	      <clip pos="1" side="tl" part="a_verb"/>
	      <clip pos="1" side="tl" part="temps"/>
	      <clip pos="1" side="tl" part="persnbr"/>
	      <clip pos="1" side="tl" part="lemq"/>
	    </lu>
	  </chunk>
	</out>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
</rule>


<rule comment="REGLA: PP + VERBO SINT (nahi izan dut)">
      <pattern>
	<pattern-item n="perpp"/>
	<pattern-item n="vbsint"/>
	<pattern-item n="reladj"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<let>
	  <clip pos="2" side="tl" part="lem"/>
	  <lit v="haber"/>
	</let>
	<let>
	  <clip pos="2" side="tl" part="a_verb"/>
	  <lit-tag v="vbhaver"/>
	</let>
	<call-macro n="verbal_flex">
	  <with-param pos="2"/>
	</call-macro>
	<choose>
	  <when>
	    <test>
	      <equal>
		 <clip pos="2" side="tl" part="temps"/>
		 <lit-tag v="pri"/>
	      </equal>
	    </test>
	    <out>
	      <chunk name="q_vbconj" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="Orel"/></tag>
		  <tag><clip pos="2" side="tl" part="a_verb"/></tag>
		  <tag><clip pos="2" side="tl" part="persnbr"/></tag>
		  <tag><clip pos="2" side="sl" part="nor"/></tag>
		  <tag><clip pos="2" side="sl" part="nori"/></tag>
		  <tag><clip pos="2" side="sl" part="nork"/></tag>
		</tags>
		<lu>
		  <clip pos="3" side="tl" part="whole"/>
		</lu>
		<b/>
		<lu>
		  <clip pos="2" side="tl" part="lemh"/>
		  <clip pos="2" side="tl" part="a_verb"/>
		  <clip pos="2" side="tl" part="temps"/>
		  <clip pos="2" side="tl" part="persnbr"/>
		  <clip pos="2" side="tl" part="lemq"/>
		</lu>
		<b pos="1"/>
		<lu>
		  <clip pos="1" side="tl" part="lemh"/>
		  <clip pos="1" side="tl" part="a_verb"/>
		  <clip pos="1" side="tl" part="temps"/>
		  <lit-tag v="m.sg"/>
		  <clip pos="1" side="tl" part="lemq"/>
		</lu>
	      </chunk>
	    </out>
	  </when>
	  <when>
	    <test>
	      <equal>
		<clip pos="2" side="tl" part="temps"/>
		<lit-tag v="pii"/>
	      </equal>
	    </test>
	    <let>	      
	      <clip pos="1" side="tl" part="temps"/>
	      <lit-tag v="ifi"/>
	    </let>
	    <out>
	      <chunk name="q_vbconj" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="Orel"/></tag>
		  <tag><clip pos="1" side="tl" part="a_verb"/></tag>
		  <tag><clip pos="2" side="tl" part="persnbr"/></tag>
		  <tag><clip pos="2" side="sl" part="nor"/></tag>
		  <tag><clip pos="2" side="sl" part="nori"/></tag>
		  <tag><clip pos="2" side="sl" part="nork"/></tag>
		</tags>
		<lu>
		  <clip pos="3" side="tl" part="whole"/>
		</lu>
		<b/>
		<lu>
		  <clip pos="1" side="tl" part="lemh"/>
		  <clip pos="1" side="tl" part="a_verb"/>
		  <clip pos="1" side="tl" part="temps"/>
		  <clip pos="2" side="tl" part="persnbr"/>
		  <clip pos="1" side="tl" part="lemq"/>
		</lu>
	      </chunk>
	    </out>
	    <call-macro n="f_bcond">
	      <with-param pos="1"/>
	    </call-macro>
	  </when>
	</choose>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
</rule>


<rule comment="REGLA: GER + VERBO SINT (nahi izaten dut)">
      <pattern>
	<pattern-item n="perger"/>
	<pattern-item n="vbsint"/>
	<pattern-item n="reladj"/>
      </pattern>
      <action>	
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="verbal_flex">
	  <with-param pos="2"/>
	</call-macro>
	<choose>
	  <when>
	    <test>
	      <equal>
		 <clip pos="2" side="sl" part="temps"/>
		 <lit-tag v="pri"/>
	      </equal>
	    </test>
	    <let>
	      <clip pos="1" side="tl" part="temps"/>
	      <lit-tag v="pri"/>
	    </let>
	  </when>
	  <when>
	    <test>
	      <equal>
		 <clip pos="2" side="sl" part="temps"/>
		 <lit-tag v="pii"/>
	      </equal>
	    </test>
	    <let>
	      <clip pos="1" side="tl" part="temps"/>
	      <lit-tag v="pii"/>
	    </let>
	  </when>
	</choose>	    
	<out>
	  <chunk name="q_vbconj" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="Orel"/></tag>
	      <tag><clip pos="1" side="tl" part="a_verb"/></tag>
	      <tag><clip pos="2" side="tl" part="persnbr"/></tag>
	      <tag><clip pos="2" side="sl" part="nor"/></tag>
	      <tag><clip pos="2" side="sl" part="nori"/></tag>
	      <tag><clip pos="2" side="sl" part="nork"/></tag>
	    </tags>
	    <lu>
	      <clip pos="3" side="tl" part="whole"/>
	    </lu>
	    <b/>
	    <lu>
	      <clip pos="1" side="tl" part="lemh"/>
	      <clip pos="1" side="tl" part="a_verb"/>
	      <clip pos="1" side="tl" part="temps"/>
	      <clip pos="2" side="tl" part="persnbr"/>
	      <clip pos="1" side="tl" part="lemq"/>
	    </lu>
	  </chunk>
	</out>
	<call-macro n="f_bcond">
	  <with-param pos="1"/>
	</call-macro>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
</rule>



<rule comment="REGLA: PFUT + VERBO SINT (nahiko dut)">
      <pattern>
	<pattern-item n="perpfut"/>
	<pattern-item n="vbsint"/>
	<pattern-item n="reladj"/>
      </pattern>
      <action>	
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="verbal_flex">
	  <with-param pos="2"/>
	</call-macro>
	<choose>
	  <when>
	    <test>
	      <equal>
		 <clip pos="2" side="sl" part="temps"/>
		 <lit-tag v="pri"/>
	      </equal>
	    </test>
	    <let>
	      <clip pos="1" side="tl" part="temps"/>
	      <lit-tag v="fti"/>
	    </let>
	  </when>
	  <when>
	    <test>
	      <equal>
		 <clip pos="2" side="sl" part="temps"/>
		 <lit-tag v="pii"/>
	      </equal>
	    </test>
	    <let>
	      <clip pos="1" side="tl" part="temps"/>
	      <lit-tag v="cni"/>
	    </let>
	  </when>
	</choose>	    
	<out>
	  <chunk name="q_vbconj" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="Orel"/></tag>
	      <tag><clip pos="1" side="tl" part="a_verb"/></tag>
	      <tag><clip pos="2" side="tl" part="persnbr"/></tag>
	      <tag><clip pos="2" side="sl" part="nor"/></tag>
	      <tag><clip pos="2" side="sl" part="nori"/></tag>
	      <tag><clip pos="2" side="sl" part="nork"/></tag>
	    </tags>
	    <lu>
	      <clip pos="3" side="tl" part="whole"/>
	    </lu>
	    <b/>
	    <lu>
	      <clip pos="1" side="tl" part="lemh"/>
	      <clip pos="1" side="tl" part="a_verb"/>
	      <clip pos="1" side="tl" part="temps"/>
	      <clip pos="2" side="tl" part="persnbr"/>
	      <clip pos="1" side="tl" part="lemq"/>
	    </lu>
	  </chunk>
	</out>
	<call-macro n="f_bcond">
	  <with-param pos="1"/>
	</call-macro>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
</rule>

<rule comment="REGLA: GER + ARI IZAN (prestatzen ari gara - estamos preparando)">
      <pattern>
	<pattern-item n="ger"/>
	<pattern-item n="ari_izan"/>
	<pattern-item n="reladj"/>
      </pattern>
      <action>	
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="verbal_flex">
	  <with-param pos="2"/>
	</call-macro>
	<out> 
	  <chunk name="q_estar_ger" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="Orel"/></tag>
	      <tag><clip pos="1" side="tl" part="a_verb"/></tag>
	      <tag><clip pos="2" side="tl" part="persnbr"/></tag>
	      <tag><clip pos="2" side="sl" part="nor"/></tag>
	      <tag><clip pos="2" side="sl" part="nori"/></tag>
	      <tag><clip pos="2" side="sl" part="nork"/></tag>
	    </tags>
	    <lu>
	      <clip pos="3" side="tl" part="whole"/>
	    </lu>
	    <b/>
	    <lu>
	      <clip pos="2" side="tl" part="lemh"/>
	      <clip pos="2" side="tl" part="a_verb"/>
	      <clip pos="2" side="tl" part="temps"/>
	      <clip pos="2" side="tl" part="persnbr"/>
	      <clip pos="2" side="tl" part="lemq"/>
	    </lu>
	    <b pos="1"/>
	    <lu>
	      <clip pos="1" side="tl" part="lemh"/>
	      <clip pos="1" side="tl" part="a_verb"/>
	      <clip pos="1" side="tl" part="temps"/>
	      <clip pos="1" side="tl" part="lemq"/>
	    </lu>
	  </chunk>
	</out>
	<let>
	  <var n="caseFirstWord"/>
	  <lit v="aa"/>
	</let>
      </action>
</rule>





    <rule comment="REGLA: reset variables">
      <pattern>
	<pattern-item n="sent"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<let>
	  <var n="nombre"/>
	  <lit-tag v="sg"/>
	</let>
	<let>
	  <var n="genere"/>
	  <lit-tag v="m"/>
	</let>
	<choose>
	  <when>
	    <test>
	      <not>
		<or>
		  <equal>
		    <clip pos="1" side="sl" part="lem"/>
		    <lit v=";"/>
		  </equal>
		  <equal>
		    <clip pos="1" side="sl" part="lem"/>
		    <lit v=":"/>
		  </equal>
		</or>
	      </not>
	    </test>	      
	    <let>
	      <var n="EOS"/>
	      <lit v="true"/>
	    </let>
	  </when>
	</choose>
	<out>
	  <chunk name="punt">
	    <tags>
	      <tag><lit-tag v="sent"/></tag>
	    </tags>
	    <lu>
	      <clip pos="1" side="tl" part="whole"/>
	    </lu>
	  </chunk>
	</out>
      </action>
    </rule>
    
    

  </section-rules>
</transfer>
