<?xml version="1.0" encoding="ISO-8859-1"?>
<!-- -*- nxml -*- -->
<transfer>
 <section-def-cats>
    <def-cat n="nom">
      <cat-item tags="n.*"/>
    </def-cat>
    <def-cat n="np">
      <cat-item tags="np.*"/>
    </def-cat>
    <def-cat n="npant">
      <cat-item tags="np.ant.*"/>
    </def-cat>
    <def-cat n="nploc">
      <cat-item tags="np.loc.*"/>
    </def-cat> 
    <def-cat n="npal">
      <cat-item tags="np.al.*"/>
    </def-cat>
    <def-cat n="det">
      <cat-item tags="det.*"/>
      <cat-item tags="predet.*"/>
    </def-cat>
    <def-cat n="detcel">
      <cat-item lemma="cel" tags="det.*"/>
    </def-cat>
    <def-cat n="deta">
      <cat-item lemma="al" tags="det.*"/>
    </def-cat>
    <def-cat n="detdem">
      <cat-item tags="det.dem.*"/>
    </def-cat>
    <def-cat n="detdef">
      <cat-item tags="det.def.*"/>
    </def-cat>
    <def-cat n="detind">
      <cat-item tags="det.ind.*"/>
    </def-cat>
    <def-cat n="predet">
      <cat-item tags="predet.*"/>
    </def-cat>
    <def-cat n="adjec">
      <cat-item tags="adj.*"/>
      <cat-item tags="vblex.pp.*"/>
    </def-cat>
    <def-cat n="adjlui">
      <cat-item lemma="lui" tags="adj.*"/>
    </def-cat>
    <def-cat n="adj">
      <cat-item tags="adj.*"/>
    </def-cat>
    <def-cat n="adjpos">
      <cat-item tags="adj.pos.*"/>
    </def-cat>
    <def-cat n="adv">
      <cat-item tags="adv"/>
      <cat-item tags="adv.itg"/>
      <cat-item tags="preadv"/>
    </def-cat>
    <def-cat n="advnespus">
      <cat-item lemma="nespus" tags="adv"/>
    </def-cat>
    <def-cat n="advmai">
      <cat-item lemma="mai" tags="adv"/>
    </def-cat>    
    <def-cat n="advca">
      <cat-item lemma="ca" tags="adv"/>
    </def-cat>
   <def-cat n="advfel">
      <cat-item lemma="la fel de" tags="adv"/>
    </def-cat>
    <def-cat n="advdecât">
      <cat-item lemma="decât" tags="adv"/>
    </def-cat>
    <def-cat n="advnu">
      <cat-item lemma="nu" tags="adv"/>
    </def-cat>
    <def-cat n="advnici-">
      <cat-item lemma="niciodatä" tags="adv"/>
      <cat-item lemma="nicicând" tags="adv"/>
      <cat-item lemma="niciunde" tags="adv"/>
      <cat-item lemma="nicicum" tags="adv"/>
    </def-cat>
     <def-cat n="advo">
      <cat-item lemma="o" tags="adv.*"/>
      <cat-item lemma="un" tags="det.ind.f.sg.nom"/>
    </def-cat>
    <def-cat n="prep">
      <cat-item tags="pr"/>
    </def-cat>
    <def-cat n="prepa">
      <cat-item lemma="a" tags="pr"/>
    </def-cat>
    <def-cat n="prepde">
      <cat-item lemma="de" tags="pr"/>
    </def-cat>
    <def-cat n="prepdintr-">
      <cat-item lemma="dintr-" tags="pr"/>
    </def-cat>
     <def-cat n="prepîntr-">
      <cat-item lemma="într-" tags="pr"/>
    </def-cat>
    <def-cat n="preppe">
      <cat-item lemma="pe" tags="pr"/>
    </def-cat>
    <def-cat n="prepprintr-">
      <cat-item lemma="printr-" tags="pr"/>
    </def-cat>
    <def-cat n="conjsub">
      <cat-item lemma="sä" tags="cnjsub"/>
    </def-cat>
    <def-cat n="conjnici">
      <cat-item lemma="nici" tags="cnjcoo"/>
    </def-cat>
    <def-cat n="relcärui">
      <cat-item lemma="cärui" tags="rel.*"/>
    </def-cat>
    <def-cat n="relat">
      <cat-item tags="rel.*"/>
    </def-cat>
    <def-cat n="prn">
      <cat-item tags="prn.*"/>
    </def-cat>
    <def-cat n="prnenc">
      <cat-item tags="prn.enc.*"/>
    </def-cat>
    <def-cat n="prnpro">
      <cat-item tags="prn.pro.*"/>
    </def-cat>
    <def-cat n="prnproref">
      <cat-item lemma="mä" tags="prn.pro.p1.mf.sg.*"/>
      <cat-item lemma="te" tags="prn.pro.p2.mf.sg.*"/>
      <cat-item lemma="se" tags="prn.pro.ref.p3.mfn.sp.*"/>
      <cat-item lemma="îçi" tags="prn.pro.ref.p3.mfn.sp.*"/>
      <cat-item lemma="ne" tags="prn.pro.p1.mf.pl.*"/>
      <cat-item lemma="vä" tags="prn.pro.p2.mf.pl.*"/>
    </def-cat>
    <def-cat n="prnpro3">
      <cat-item lemma="îl" tags="prn.pro.*"/>
<!-- eliminat EN pr adv -->
    </def-cat>
        <def-cat n="opronom">
      <cat-item lemma="o" tags="prn.pro.p3.f.sg"/>
    </def-cat>
    <def-cat n="avealex">
      <cat-item lemma="avea" tags="vblex.*"/>
    </def-cat>
    <def-cat n="verb">
      <cat-item tags="vblex.*"/>
<!-- eliminat vb SER-->
      <cat-item tags="vbavea.*"/>
      <cat-item tags="vbmod.*"/>
    </def-cat>
    
    <def-cat n="verbospron">
      <cat-item lemma="gândi" tags="vblex.*"/>
      <cat-item lemma="juca" tags="vblex.*"/>
    </def-cat>
    <def-cat n="verbfi">
      <cat-item lemma="fi" tags="vblex.*"/>
    </def-cat>
    <def-cat n="verbtrebui">
      <cat-item lemma="trebui" tags="vbmod.*"/>
    </def-cat>
    <def-cat n="vbaveapri">
      <cat-item tags="vbavea.pri.*"/>
      <cat-item lemma="avea" tags="vblex.prs.*"/>
<!-- el tagger no tria vbavea pri, afegim  vblex prs mentre el millorem-->
    </def-cat>
    <def-cat n="vbaveacni">
      <cat-item tags="vbavea.cni.*"/>
      <cat-item lemma="avea" tags="vblex.prs.*"/>
	<cat-item lemma="avea" tags="vblex.pri.*"/>
<!-- el tagger no tria vbavea pri, afegim  vblex prs mentre el millorem-->
    </def-cat>
    <def-cat n="verbind">
      <cat-item tags="vblex.pri.*"/>
      <cat-item tags="vblex.pii.*"/>
      <cat-item tags="vblex.pper.*"/>
      <cat-item tags="vblex.imp.*"/>
      <cat-item tags="vbmod.pri.*"/>
      <cat-item tags="vbmod.pii.*"/>
      <cat-item tags="vbmod.pper.*"/>
      <cat-item tags="vbmod.imp.*"/>
    </def-cat>
    <def-cat n="verbpper">
      <cat-item tags="vblex.pper.*"/>
      <cat-item tags="vbmod.pper.*"/>
    </def-cat>
    <def-cat n="verbprs">
      <cat-item tags="vblex.prs.*"/>
      <cat-item tags="vbmod.prs.*"/>
    </def-cat>
     <def-cat n="verbpis">
      <cat-item tags="vblex.pis.*"/>
      <cat-item tags="vbmod.pis.*"/>
    </def-cat>
    <def-cat n="vrea">
      <cat-item lemma="vrea" tags="vaux.*"/>
    </def-cat>
    <def-cat n="inf">
      <cat-item tags="vblex.inf"/>
<!--eliminat SER inf -->
      <cat-item tags="vbavea.inf"/>
      <cat-item tags="vbmod.inf"/>
    </def-cat>
    <def-cat n="infnm">
      <cat-item tags="vblex.inf"/>
<!-- eliminat SER inf -->
      <cat-item tags="vbavea.inf"/>
    </def-cat>
    <def-cat n="infnh">
      <cat-item tags="vblex.inf"/>
<!-- eliminat SER inf -->
      <cat-item tags="vbmod.inf"/>
    </def-cat>
    <def-cat n="pp">
      <cat-item tags="vblex.pp.*"/>
<!-- eliminat SER pp -->
      <cat-item tags="vbavea.pp.*"/>
      <cat-item tags="vbmod.pp.*"/>
    </def-cat>
    <def-cat n="ppf">
      <cat-item tags="vblex.pp.f.sg"/>
      <cat-item tags="vbavea.pp.f.sg"/>
      <cat-item tags="vbmod.pp.f.sg"/>
    </def-cat>
    <def-cat n="ppfmpl">
      <cat-item tags="vblex.pp.f.*"/>
<!-- eliminat AVEA pp m &f -->
      <cat-item tags="vbmod.pp.f.*"/>
      <cat-item tags="vblex.pp.m.pl"/>
      <cat-item tags="vbmod.pp.m.pl"/>
    </def-cat>
    <def-cat n="num">
      <cat-item tags="num.*"/>
      <cat-item tags="num"/>	
    </def-cat>
   <!-- <def-cat n="C">
      <cat-item tags="num"/>
    </def-cat> -->
    <def-cat n="anar">
      <cat-item lemma="anar" tags="vblex.pri.*"/>
    </def-cat>
    <def-cat n="molt">
      <cat-item lemma="molt" tags="preadv"/>
      <cat-item lemma="molt" tags="adv"/>
      <cat-item lemma="molt" tags="adj.m.sg"/>
    </def-cat>
<!-- introduiria tb. la prep.inf. a __ a vedea/to see__, pq apareix amb determinades prep.: sense saber-ho = färä a çti nimic. QQQ Es podria ficar una paraula en ro.ro que tingui una casella buida en espanyol, p.ex. que aq. prep.inf. A no es traduisqui? -->
    <def-cat n="in">
      <cat-item lemma="in" tags="pr"/>
    </def-cat>
    <def-cat n="la">
      <cat-item lemma="la" tags="pr"/>
    </def-cat>
    <def-cat n="pentru">
      <cat-item lemma="pentru" tags="pr"/>
    </def-cat>
<!-- s'ha de veure en romanès si fa falta aquesta categoria /// def-cat n="dir">
       <cat-item lemma="dir" tags="vblex.pri.*"/>
       <cat-item lemma="dir" tags="vblex.fti.*"/>
     </def-cat> -->
    <def-cat n="avea">
      <cat-item lemma="avea" tags="vbavea.*"/>
    </def-cat>
<def-cat n="meses">
      <cat-item lemma="ianuarie" tags="n.*"/>
      <cat-item lemma="februarie" tags="n.*"/>
      <cat-item lemma="martie" tags="n.*"/>
      <cat-item lemma="aprilie" tags="n.*"/>
      <cat-item lemma="mai" tags="n.*"/>
      <cat-item lemma="iunie" tags="n.*"/>
      <cat-item lemma="iulie" tags="n.*"/>
      <cat-item lemma="august" tags="n.*"/>
      <cat-item lemma="septembrie" tags="n.*"/>
      <cat-item lemma="octombrie" tags="n.*"/>
      <cat-item lemma="noiembrie" tags="n.*"/>
      <cat-item lemma="decembrie" tags="n.*"/>
    </def-cat>
    <def-cat n="sent">
      <cat-item tags="sent"/>
    </def-cat>
  </section-def-cats>
  <section-def-attrs>
     <def-attr n="a_nom">
      <attr-item tags="n"/>
      <attr-item tags="n.acr"/>
    </def-attr>
    <def-attr n="a_np">
      <attr-item tags="np"/>
    </def-attr>
    <def-attr n="a_npant">
      <attr-item tags="np.ant"/>
    </def-attr>
    <def-attr n="a_nploc">
      <attr-item tags="np.loc"/>
    </def-attr>
    <def-attr n="a_npal">
      <attr-item tags="np.al"/>
    </def-attr>
    <def-attr n="a_det">
      <attr-item tags="det.def"/>
      <attr-item tags="det.ind"/>
      <attr-item tags="det.dem"/>
      <attr-item tags="det.pos"/>
      <attr-item tags="predet"/>
    </def-attr>
    <def-attr n="a_detdef">
      <attr-item tags="det.def"/>
    </def-attr>
    <def-attr n="a_predet">
      <attr-item tags="predet"/>
    </def-attr>
    <def-attr n="a_adjec">
      <attr-item tags="adj.ind"/>
<!-- en romanès hi ha una funció analítica per a construir el superlatiu: molt bella = FOARTE (en ro.ro preadv) frumoasä, bellíssima = EXTREM DE FRUMOASÄ, EXTRAORDINAR DE FRUMOASÄ, NEMAIPOMENIT DE FRUMOASÄ /// attr-item tags="adj.sup"/> -->
      <attr-item tags="adj.itg"/>
      <attr-item tags="adj.pos"/>
      <attr-item tags="adj"/>
      <attr-item tags="vblex.pp"/>
    </def-attr>
    <def-attr n="a_adj">
      <attr-item tags="adj.ind"/>
<!-- ib. damunt /// <attr-item tags="adj.sup"/> -->
      <attr-item tags="adj.itg"/>
      <attr-item tags="adj.pos"/>
      <attr-item tags="adj"/>
    </def-attr>
    <def-attr n="a_adjpos">
      <attr-item tags="adj.pos"/>
    </def-attr>
    <def-attr n="a_adv">
      <attr-item tags="adv"/>
      <attr-item tags="preadv"/>
    </def-attr>
    <def-attr n="a_prep">
      <attr-item tags="pr"/>
    </def-attr>
    <def-attr n="a_relat">
      <attr-item tags="rel.adv"/>
      <attr-item tags="rel.nn"/>
      <attr-item tags="rel.aa"/>
      <attr-item tags="rel.an"/>
    </def-attr>
    <def-attr n="a_prn">
      <attr-item tags="prn.tn.p1"/>
      <attr-item tags="prn.tn.p2"/>
      <attr-item tags="prn.tn.p3"/>
      <attr-item tags="prn.tn"/>
      <attr-item tags="prn.tn.ref.p3"/>
      <attr-item tags="prn.tn.pos"/>
      <attr-item tags="prn.itg"/>
      <attr-item tags="prn.pro.p1"/>
      <attr-item tags="prn.pro.p2"/>
      <attr-item tags="prn.pro.p3"/>
      <attr-item tags="prn.pro.ref.p3"/>
    </def-attr>
    <def-attr n="a_prnenc">
      <attr-item tags="prn.enc"/>
      <attr-item tags="prn.enc.ref"/>
    </def-attr>
    <def-attr n="a_prnpro">
      <attr-item tags="prn.pro"/>
      <attr-item tags="prn.pro.ref"/>
    </def-attr>
    <def-attr n="a_verb">
      <attr-item tags="vblex"/>
      <attr-item tags="vbser"/>
      <attr-item tags="vbhaver"/>
      <attr-item tags="vbmod"/>
    </def-attr>
    <def-attr n="a_inf">
      <attr-item tags="vblex.inf"/>
      <attr-item tags="vbavea.inf"/>
      <attr-item tags="vbmod.inf"/>
    </def-attr>
    <def-attr n="a_infnm">
      <attr-item tags="vblex.inf"/>
      <attr-item tags="vbavea.inf"/>
    </def-attr>
    <def-attr n="a_infnh">
      <attr-item tags="vblex.inf"/>
<!-- eliminat SER -->
      <attr-item tags="vbmod.inf"/>
    </def-attr>
    <def-attr n="a_pp">
      <attr-item tags="vblex.pp"/>
<!-- VBAVEA no té més que pri i cni!!! així que eliminaria: attr-item tags="vbavea.pp"/> -->
      <attr-item tags="vbmod.pp"/>
    </def-attr>
    <def-attr n="a_num">
      <attr-item tags="num"/>
    </def-attr>
    <def-attr n="a_def">
      <attr-item tags="def"/>
      <attr-item tags="ind"/>
    </def-attr>
    <def-attr n="a_case">
      <attr-item tags="nom"/>
      <attr-item tags="dg"/>
    </def-attr>
    <def-attr n="gen">
      <attr-item tags="m"/>
      <attr-item tags="f"/>
      <attr-item tags="mf"/>
      <attr-item tags="mn"/>
      <attr-item tags="fn"/>
      <attr-item tags="mfn"/>
      <attr-item tags="GD"/>
      <attr-item tags="nt"/>
    </def-attr>
    <def-attr n="nbr">
      <attr-item tags="sg"/>
      <attr-item tags="pl"/>
      <attr-item tags="sp"/>
      <attr-item tags="ND"/>
    </def-attr>
    <def-attr n="persona">
      <attr-item tags="p1"/>
      <attr-item tags="p2"/>
      <attr-item tags="p3"/>
    </def-attr>
    <def-attr n="tipoadv">
      <attr-item tags="itg"/>
    </def-attr>
    <def-attr n="tipoenc_pro">
      <attr-item tags="ref.p3.mf.sp"/>
      <attr-item tags="p1.mf.sg"/>
      <attr-item tags="p1.mf.pl"/>
      <attr-item tags="p2.mf.sg"/>
      <attr-item tags="p2.mf.pl"/>
<!-- s'introduiria tb el neutre: Väd caietul(n.nt.sg.).Väzându-l (nt.sg.), i en pl. Väd caietele (n.nt.pl.) Väzându-le (nt.pl.)  <attr-item tags="p3.mfn.sg"/> -->
      <attr-item tags="p3.mfn.pl"/>
      <attr-item tags="p3.mf.sp"/>
<!--incorrecte, tradueix "li<prn><enc><p3><mf><sp>" per "se", cal canviar diccionari ja que és li-ho<sg> i los-ho<pl> (dárselo)-->
      <attr-item tags="p3.m.sg"/>
      <attr-item tags="p3.m.pl"/>
      <attr-item tags="p3.f.sg"/>
      <attr-item tags="p3.f.pl"/>
<!-- No crec que n'hi ha cap en romanès ///  attr-item tags="p3.nt"/> -->
    </def-attr>
    <def-attr n="temps">
      <attr-item tags="inf"/>
      <attr-item tags="ger"/>
      <attr-item tags="cni"/>
      <attr-item tags="fti"/>
      <attr-item tags="pp"/>
      <attr-item tags="pri"/>
      <attr-item tags="pii"/>
      <attr-item tags="pis"/>
      <attr-item tags="pper"/>
      <attr-item tags="prs"/>
      <attr-item tags="imp"/>
    </def-attr>
<!-- Eliminat ifi que es traduiria per un perfect compost: Fuimos al cine/Hemos ido al cine. = AM MERS la cinema. /// attr-item tags="ifi"/> 
	 
           s'afegeix en romanés el PPER: fäcusem (vblex, pper)= había hecho (vblex, plusquamperfect)
	  S'ha de fer funció: FTI romanès = VREA vaux + INF: Lo haré. = (O) voi face. <attr-item tags="fti"/> ///
	    ib. per a cond. CNI romanès = VBAVEAcni + INF. <attr-item tags="cni"/> /// 
	  
	  es deixa tan sols el subjuntiu present, sense <attr-item tags=pis/>
	  <attr-item tags=fts/> -->
  </section-def-attrs>
  <section-def-vars>
    <def-var n="uno"/>
    <def-var n="genero"/>
    <def-var n="numero"/>
    <def-var n="concDet"/>
    <def-var n="concAdj"/>
    <def-var n="concPrimero"/>
    <def-var n="concSegundo"/>
    <def-var n="concTercero"/>
    <def-var n="interrogativa"/>
    <def-var n="exclamativa"/>
  </section-def-vars>
  <section-def-lists>
    <def-list n="vb2vbref">
      <list-item v="sta"/>
      <list-item v="râde"/>
    </def-list>
    <def-list n="vbref2vb">
      <list-item v="pensar"/>     
    </def-list>
  </section-def-lists>
  <section-def-macros>
    <def-macro n="f_bcond" npar="1">
<!--Per mirar si el blanc conté o no format -->
      <choose>
        <when>
          <test>
            <not>
              <equal>
                <b pos="1"/>
                <lit v=" "/>
              </equal>
            </not>
          </test>
          <out>
            <b pos="1"/>
          </out>
        </when>
      </choose>
    </def-macro>
    <def-macro n="f_outverb2" npar="2">
<!--Comprueba si hay pronombres que se traducen por nada de catalán a español según el diccionario ("hi" y "en") y envía el verbo con o sin pronombres de acuerdo con esta comprobación. Esta función es para el caso de verbo + 1 enclítico. Función necesaria para el correcto colocamiento de la cola en multipalabras con flexión intercalada. -->
      <choose>
        <when>
          <test>
            <not>
              <equal>
                <clip pos="2" side="tl" part="lem"/>
                <lit v=""/>
              </equal>
            </not>
          </test>
          <out>
            <mlu>
              <lu>
                <clip pos="1" side="tl" part="lemh"/>
                <clip pos="1" side="tl" part="a_verb"/>
                <clip pos="1" side="tl" part="temps"/>
                <clip pos="1" side="tl" part="persona"/>
                <clip pos="1" side="tl" part="nbr"/>
              </lu>
              <lu>
                <clip pos="2" side="tl" part="lem"/>
                <clip pos="2" side="tl" part="a_prnenc"/>
                <clip pos="2" side="tl" part="persona"/>
                <clip pos="2" side="tl" part="gen"/>
                <clip pos="2" side="tl" part="nbr"/>
                <clip pos="1" side="tl" part="lemq"/>
              </lu>
            </mlu>
          </out>
        </when>
        <otherwise>
          <out>
            <lu>
              <clip pos="1" side="tl" part="lemh"/>
              <clip pos="1" side="tl" part="a_verb"/>
              <clip pos="1" side="tl" part="temps"/>
              <clip pos="1" side="tl" part="persona"/>
              <clip pos="1" side="tl" part="nbr"/>
              <clip pos="1" side="tl" part="lemq"/>
            </lu>
          </out>
        </otherwise>
      </choose>
    </def-macro>
    <def-macro n="f_outverb3" npar="3">
<!--Comprueba si hay pronombres que se traducen por nada de catalán a español según el diccionario ("hi" y "en") y envía el verbo con o sin pronombres de acuerdo con esta comprobación. Esta función es para el caso de verbo + 2 enclíticos.-->
      <choose>
        <when>
          <test>
            <not>
              <equal>
                <clip pos="2" side="tl" part="lem"/>
                <lit v=""/>
              </equal>
            </not>
          </test>
          <choose>
            <when>
              <test>
                <not>
                  <equal>
                    <clip pos="3" side="tl" part="lem"/>
                    <lit v=""/>
                  </equal>
                </not>
              </test>
              <out>
                <mlu>
                  <lu>
                    <clip pos="1" side="tl" part="lemh"/>
                    <clip pos="1" side="tl" part="a_verb"/>
                    <clip pos="1" side="tl" part="temps"/>
                    <clip pos="1" side="tl" part="persona"/>
                    <clip pos="1" side="tl" part="nbr"/>
                  </lu>
                  <lu>
                    <clip pos="2" side="tl" part="lem"/>
                    <clip pos="2" side="tl" part="a_prnenc"/>
                    <clip pos="2" side="tl" part="persona"/>
                    <clip pos="2" side="tl" part="gen"/>
                    <clip pos="2" side="tl" part="nbr"/>
                  </lu>
                  <lu>
                    <clip pos="3" side="tl" part="lem"/>
                    <clip pos="3" side="tl" part="a_prnenc"/>
                    <clip pos="3" side="tl" part="persona"/>
                    <clip pos="3" side="tl" part="gen"/>
                    <clip pos="3" side="tl" part="nbr"/>
                    <clip pos="1" side="tl" part="lemq"/>
                  </lu>
                </mlu>
              </out>
            </when>
            <otherwise>
              <out>
                <mlu>
                  <lu>
                    <clip pos="1" side="tl" part="lemh"/>
                    <clip pos="1" side="tl" part="a_verb"/>
                    <clip pos="1" side="tl" part="temps"/>
                    <clip pos="1" side="tl" part="persona"/>
                    <clip pos="1" side="tl" part="nbr"/>
                  </lu>
                  <lu>
                    <clip pos="2" side="tl" part="lem"/>
                    <clip pos="2" side="tl" part="a_prnenc"/>
                    <clip pos="2" side="tl" part="persona"/>
                    <clip pos="2" side="tl" part="gen"/>
                    <clip pos="2" side="tl" part="nbr"/>
                    <clip pos="1" side="tl" part="lemq"/>
                  </lu>
                </mlu>
              </out>
            </otherwise>
          </choose>
        </when>
        <otherwise>
          <out>
            <lu>
              <clip pos="1" side="tl" part="lemh"/>
              <clip pos="1" side="tl" part="a_verb"/>
              <clip pos="1" side="tl" part="temps"/>
              <clip pos="1" side="tl" part="persona"/>
              <clip pos="1" side="tl" part="nbr"/>
              <clip pos="1" side="tl" part="lemq"/>
            </lu>
          </out>
        </otherwise>
      </choose>
    </def-macro>
    
    
    <def-macro n="modcase" npar="1">
      <choose>
	  <when>
	    <test>
	      <equal>
		<case-of pos="1" side="sl" part="lemh"/>
		<lit v="Aa"/>
	      </equal>
	    </test>
	    <modify-case>
	      <clip pos="1" side="tl" part="lemh"/>
	      <lit v="aa"/>
	    </modify-case>
	  </when>
	</choose>
    </def-macro>
    
      <def-macro n="prn_verb" npar="1">
      <choose>
        <when>
          <test>
            <equal>
              <clip pos="1" side="tl" part="persona"/>
              <lit-tag v="p1"/>
            </equal>
          </test>
          <choose>
            <when>
              <test>
                <equal>
                  <clip pos="1" side="tl" part="nbr"/>
                  <lit-tag v="sg"/>
                </equal>
              </test>
              <out>
                <lu>
                  <get-case-from pos="1">
                    <lit v="me"/>
                  </get-case-from>
                  <lit-tag v="prn.pro.p1.mf.sg"/>
                </lu>
              </out>
            </when>
            <otherwise>
              <out>
                <lu>
                  <get-case-from pos="1">
                    <lit v="nos"/>
                  </get-case-from>
                  <lit-tag v="prn.pro.p1.mf.pl"/>
                </lu>
              </out>
            </otherwise>
          </choose>
        </when>
        <otherwise>
          <choose>
            <when>
              <test>
                <equal>
                  <clip pos="1" side="tl" part="persona"/>
                  <lit-tag v="p2"/>
                </equal>
              </test>
              <choose>
                <when>
                  <test>
                    <equal>
                      <clip pos="1" side="tl" part="nbr"/>
                      <lit-tag v="sg"/>
                    </equal>
                  </test>
                  <out>
                    <lu>
                      <get-case-from pos="1">
                        <lit v="te"/>
                      </get-case-from>
                      <lit-tag v="prn.pro.p2.mf.sg"/>
                    </lu>
                  </out>
                </when>
                <otherwise>
                  <out>
                    <lu>
                      <get-case-from pos="1">
                        <lit v="os"/>
                      </get-case-from>
                      <lit-tag v="prn.pro.p2.mf.pl"/>
                    </lu>
                  </out>
                </otherwise>
              </choose>
            </when>
            <otherwise>
              <out>
                <lu>
                  <get-case-from pos="1">
                    <lit v="se"/>
                  </get-case-from>
                  <lit-tag v="prn.pro.ref.p3.mf.sp"/>
                </lu>
              </out>
            </otherwise>
          </choose>
        </otherwise>
      </choose>
    </def-macro>
    
    
    <def-macro n="prn_verbp" npar="1">
      <choose>
        <when>
          <test>
            <equal>
              <clip pos="1" side="tl" part="persona"/>
              <lit-tag v="p1"/>
            </equal>
          </test>
          <choose>
            <when>
              <test>
                <equal>
                  <clip pos="1" side="tl" part="nbr"/>
                  <lit-tag v="sg"/>
                </equal>
              </test>
              <out>
                <lu>
                  <get-case-from pos="1">
                    <lit v="me"/>
                  </get-case-from>
                  <lit-tag v="prn.enc.p1.mf.sg"/>
                </lu>
              </out>
            </when>
            <otherwise>
              <out>
                <lu>
                  <get-case-from pos="1">
                    <lit v="nos"/>
                  </get-case-from>
                  <lit-tag v="prn.enc.p1.mf.pl"/>
                </lu>
              </out>
            </otherwise>
          </choose>
        </when>
        <otherwise>
          <choose>
            <when>
              <test>
                <equal>
                  <clip pos="1" side="tl" part="persona"/>
                  <lit-tag v="p2"/>
                </equal>
              </test>
              <choose>
                <when>
                  <test>
                    <equal>
                      <clip pos="1" side="tl" part="nbr"/>
                      <lit-tag v="sg"/>
                    </equal>
                  </test>
                  <out>
                    <lu>
                      <get-case-from pos="1">
                        <lit v="te"/>
                      </get-case-from>
                      <lit-tag v="prn.enc.p2.mf.sg"/>
                    </lu>
                  </out>
                </when>
                <otherwise>
                  <out>
                    <lu>
                      <get-case-from pos="1">
                        <lit v="os"/>
                      </get-case-from>
                      <lit-tag v="prn.enc.p2.mf.pl"/>
                    </lu>
                  </out>
                </otherwise>
              </choose>
            </when>
            <otherwise>
              <out>
                <lu>
                  <get-case-from pos="1">
                    <lit v="se"/>
                  </get-case-from>
                  <lit-tag v="prn.enc.ref.p3.mf.sp"/>
                </lu>
              </out>
            </otherwise>
          </choose>
        </otherwise>
      </choose>
    </def-macro>
    
   
    
    
    <def-macro n="prn_verbenc" npar="2">
      <choose>
        <when>
          <test>
            <equal>
              <clip pos="1" side="tl" part="temps"/>
              <lit-tag v="pmp"/>
            </equal>
          </test>
          <call-macro n="prn_verb">
            <with-param pos="1"/>
          </call-macro>
          <out>
            <b pos="1"/>
            <lu>
              <get-case-from pos="1">
                <lit v="haber"/>
              </get-case-from>
              <lit-tag v="vbhaver.ifi"/>
              <lit-tag v="p3"/>
              <clip pos="2" side="tl" part="nbr"/>
            </lu>
            <b/>
            <lu>
              <get-case-from pos="2">
                <clip pos="1" side="tl" part="lemh"/>
              </get-case-from>
              <clip pos="1" side="tl" part="a_verb"/>
              <lit-tag v="pp.m.sg"/>
            </lu>
          </out>
        </when>
        <otherwise>
          <choose>
            <when>
              <test>
                <or>
                  <equal>
                    <clip pos="1" side="tl" part="temps"/>
                    <lit-tag v="inf"/>
                  </equal>
                  <equal>
                    <clip pos="1" side="tl" part="temps"/>
                    <lit-tag v="ger"/>
                  </equal>
                </or>
              </test>
              <out>
                <lu>
                  <clip pos="1" side="tl" part="whole"/>
                </lu>
              </out>
            </when>
            <otherwise>
              <choose>
                <when>
                  <test>
                    <not>
                      <equal>
                        <clip pos="2" side="tl" part="nbr"/>
                        <lit-tag v="pl"/>
                      </equal>
                    </not>
                  </test>
                  <let>
                    <clip pos="2" side="tl" part="nbr"/>
                    <lit-tag v="sg"/>
                  </let>
                </when>
              </choose>
              <choose>
                <when>
                  <test>
                    <equal>
                      <clip pos="1" side="tl" part="persona"/>
                      <lit-tag v="p1"/>
                    </equal>
                  </test>
                  <choose>
                    <when>
                      <test>
                        <equal>
                          <clip pos="1" side="tl" part="nbr"/>
                          <lit-tag v="sg"/>
                        </equal>
                      </test>
                      <out>
                        <mlu>
                          <lu>
                            <clip pos="1" side="tl" part="lemh"/>
                            <clip pos="1" side="tl" part="a_verb"/>
                            <clip pos="1" side="tl" part="temps"/>
                            <lit-tag v="p3"/>
                            <clip pos="2" side="tl" part="nbr"/>
                          </lu>
                          <lu>
                            <lit v="me"/>
                            <lit-tag v="prn.enc.p1.mf.sg"/>
                          </lu>
                        </mlu>
                      </out>
                    </when>
                    <otherwise>
                      <out>
                        <mlu>
                          <lu>
                            <clip pos="1" side="tl" part="lemh"/>
                            <clip pos="1" side="tl" part="a_verb"/>
                            <clip pos="1" side="tl" part="temps"/>
                            <lit-tag v="p3"/>
                            <clip pos="2" side="tl" part="nbr"/>
                          </lu>
                          <lu>
                            <lit v="nos"/>
                            <lit-tag v="prn.enc.p1.mf.pl"/>
                          </lu>
                        </mlu>
                      </out>
                    </otherwise>
                  </choose>
                </when>
                <otherwise>
                  <choose>
                    <when>
                      <test>
                        <equal>
                          <clip pos="1" side="tl" part="persona"/>
                          <lit-tag v="p2"/>
                        </equal>
                      </test>
                      <choose>
                        <when>
                          <test>
                            <equal>
                              <clip pos="1" side="tl" part="nbr"/>
                              <lit-tag v="sg"/>
                            </equal>
                          </test>
                          <out>
                            <mlu>
                              <lu>
                                <clip pos="1" side="tl" part="lemh"/>
                                <clip pos="1" side="tl" part="a_verb"/>
                                <clip pos="1" side="tl" part="temps"/>
                                <lit-tag v="p3"/>
                                <clip pos="2" side="tl" part="nbr"/>
                              </lu>
                              <lu>
                                <lit v="te"/>
                                <lit-tag v="prn.enc.p2.mf.sg"/>
                              </lu>
                            </mlu>
                          </out>
                        </when>
                        <otherwise>
                          <out>
                            <mlu>
                              <lu>
                                <clip pos="1" side="tl" part="lemh"/>
                                <clip pos="1" side="tl" part="a_verb"/>
                                <clip pos="1" side="tl" part="temps"/>
                                <lit-tag v="p3"/>
                                <clip pos="2" side="tl" part="nbr"/>
                              </lu>
                              <lu>
                                <lit v="os"/>
                                <lit-tag v="prn.enc.p2.mf.pl"/>
                              </lu>
                            </mlu>
                          </out>
                        </otherwise>
                      </choose>
                    </when>
                    <otherwise>
                      <out>
                        <mlu>
                          <lu>
                            <clip pos="1" side="tl" part="lemh"/>
                            <clip pos="1" side="tl" part="a_verb"/>
                            <clip pos="1" side="tl" part="temps"/>
                            <lit-tag v="p3"/>
                            <clip pos="2" side="tl" part="nbr"/>
                          </lu>
                          <lu>
                            <lit v="le"/>
                            <lit-tag v="prn.enc.p3.mf"/>
                            <clip pos="1" side="tl" part="nbr"/>
                          </lu>
                        </mlu>
                      </out>
                    </otherwise>
                  </choose>
                </otherwise>
              </choose>
            </otherwise>
          </choose>
        </otherwise>
      </choose>
    </def-macro>    

    
 <def-macro n="f_modgen" npar="1"><!--modifica el gènere de la llengua origen quan no existeix equivalent en la llengua meta-->
      <choose>
        <when>
          <test>
            <equal>
              <clip pos="1" side="sl" part="gen"/>
              <lit-tag v="mfn"/>
            </equal>
          </test>
          <let>
            <clip pos="1" side="sl" part="gen"/>
            <lit-tag v="mf"/>
          </let>
          <let>
            <var n="genero"/>
            <lit-tag v="mf"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="1" side="sl" part="gen"/>
              <lit-tag v="fn"/>
            </equal>
          </test>
          <let>
            <clip pos="1" side="sl" part="gen"/>
            <lit-tag v="f"/>
          </let>
          <let>
            <var n="genero"/>
            <lit-tag v="f"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="1" side="sl" part="gen"/>
              <lit-tag v="mn"/>
            </equal>
          </test>
          <let>
            <clip pos="1" side="sl" part="gen"/>
            <lit-tag v="m"/>
          </let>
          <let>
            <var n="genero"/>
            <lit-tag v="m"/>
          </let>
        </when>
      </choose>
      <choose>
        <when>
          <test>
            <equal>
              <clip pos="1" side="tl" part="gen"/>
              <lit-tag v="mfn"/>
            </equal>
          </test>
          <let>
            <clip pos="1" side="tl" part="gen"/>
            <lit-tag v="mf"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="1" side="tl" part="gen"/>
              <lit-tag v="fn"/>
            </equal>
          </test>
          <let>
            <clip pos="1" side="tl" part="gen"/>
            <lit-tag v="f"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="1" side="tl" part="gen"/>
              <lit-tag v="mn"/>
            </equal>
          </test>
          <let>
            <clip pos="1" side="tl" part="gen"/>
            <lit-tag v="m"/>
          </let>
        </when>
      </choose>
    </def-macro>


    <def-macro n="f_concord1" npar="1">
      <choose>
<!--To determine value of variables of gender and
                 number and propagate to other rules.  Variables are
                 not used again in this rule -->
        <when>
          <test>
            <equal>
              <clip pos="1" side="tl" part="gen"/>
              <lit-tag v="m"/>
            </equal>
          </test>
          <let>
            <var n="genero"/>
            <lit-tag v="m"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="1" side="tl" part="gen"/>
              <lit-tag v="f"/>
            </equal>
          </test>
          <let>
            <var n="genero"/>
            <lit-tag v="f"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="1" side="tl" part="gen"/>
              <lit-tag v="mn"/>
            </equal>
          </test>
          <let>
            <clip pos="1" side="tl" part="gen"/>
            <lit-tag v="m"/>
          </let>
          <let>
            <var n="genero"/>
            <lit-tag v="m"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="1" side="tl" part="gen"/>
              <lit-tag v="fn"/>
            </equal>
          </test>
          <let>
            <clip pos="1" side="tl" part="gen"/>
            <lit-tag v="f"/>
          </let>
          <let>
            <var n="genero"/>
            <lit-tag v="f"/>
          </let>
        </when>
	  <when>
          <test>
            <equal>
              <clip pos="1" side="tl" part="gen"/>
              <lit-tag v="mfn"/>
            </equal>
          </test>
          <let>
            <clip pos="1" side="tl" part="gen"/>
            <lit-tag v="mf"/>
          </let>
          <let>
            <var n="genero"/>
            <lit-tag v="mf"/>
          </let>
        </when>
	<!--  <when>
          <test>
            <equal>
              <clip pos="1" side="tl" part="gen"/>
              <lit-tag v="nt"/>
            </equal>
          </test>
          <let>
            <clip pos="1" side="tl" part="gen"/>
            <lit-tag v="m"/>
          </let>
          <let>
            <var n="genero"/>
            <lit-tag v="m"/>
          </let>
        </when>-->
      </choose>
      <choose>
        <when>
          <test>
            <equal>
              <clip pos="1" side="tl" part="nbr"/>
              <lit-tag v="sg"/>
            </equal>
          </test>
          <let>
            <var n="numero"/>
            <lit-tag v="sg"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="1" side="tl" part="nbr"/>
              <lit-tag v="pl"/>
            </equal>
          </test>
          <let>
            <var n="numero"/>
            <lit-tag v="pl"/>
          </let>
        </when>
      </choose>
      <choose>
        <when>
          <test>
<!-- If word has GD or ND, we try to assign the
              gender or number of the previous rule. If there is no
              value for the gender or number variable from previous
              rules, gender will be masculine and number singular.-->
            <equal>
              <clip pos="1" side="tl" part="gen"/>
              <lit-tag v="GD"/>
            </equal>
          </test>
          <choose>
            <when>
              <test>
                <equal>
                  <var n="genero"/>
                  <lit-tag v="f"/>
                </equal>
              </test>
              <let>
                <clip pos="1" side="tl" part="gen"/>
                <lit-tag v="f"/>
              </let>
            </when>
            <otherwise>
              <let>
                <clip pos="1" side="tl" part="gen"/>
                <lit-tag v="m"/>
              </let>
            </otherwise>
          </choose>
        </when>
      </choose>
      <choose>
        <when>
          <test>
            <equal>
              <clip pos="1" side="tl" part="nbr"/>
              <lit-tag v="ND"/>
            </equal>
          </test>
          <choose>
            <when>
              <test>
                <equal>
                  <var n="numero"/>
                  <lit-tag v="pl"/>
                </equal>
              </test>
              <let>
                <clip pos="1" side="tl" part="nbr"/>
                <lit-tag v="pl"/>
              </let>
            </when>
            <otherwise>
              <let>
                <clip pos="1" side="tl" part="nbr"/>
                <lit-tag v="sg"/>
              </let>
            </otherwise>
          </choose>
        </when>
      </choose>
    </def-macro>
    
    <def-macro n="f_concord2" npar="2">
      <choose>
        <when>
          <test>
<!-- do the main and second parameter gender agree?-->
            <and>
              <or>
                <equal>
                  <clip pos="2" side="sl" part="gen"/>
                  <clip pos="1" side="sl" part="gen"/>
                </equal>
                <equal>
                  <clip pos="2" side="sl" part="gen"/>
                  <lit-tag v="mf"/>
                </equal>
                <equal>
                  <clip pos="1" side="sl" part="gen"/>
                  <lit-tag v="mf"/>
                </equal>
		<and><!--MG: los nombres neutros en sg concuerdan con adj m, y los nombres en pl con adj f -->
		  <equal>
		    <clip pos="1" side="sl" part="gen"/>
		    <lit-tag v="nt"/>
		  </equal>
		  <equal>
		    <clip pos="1" side="sl" part="nbr"/>
		    <lit-tag v="sg"/>
		  </equal>
		  <equal>
		    <clip pos="2" side="sl" part="gen"/>
		    <lit-tag v="m"/>
		  </equal>
		</and>
		<and>
		  <equal>
		    <clip pos="1" side="sl" part="gen"/>
		    <lit-tag v="nt"/>
		  </equal>
		  <equal>
		    <clip pos="1" side="sl" part="nbr"/>
		    <lit-tag v="pl"/>
		  </equal>
		  <equal>
		    <clip pos="2" side="sl" part="gen"/>
		    <lit-tag v="f"/>
		  </equal>
		</and>
              </or>
              <or>
                <equal>
<!-- do the main and second parameter number agree?-->
                  <clip pos="2" side="sl" part="nbr"/>
                  <clip pos="1" side="sl" part="nbr"/>
                </equal>
                <equal>
                  <clip pos="2" side="sl" part="nbr"/>
                  <lit-tag v="sp"/>
                </equal>
                <equal>
                  <clip pos="1" side="sl" part="nbr"/>
                  <lit-tag v="sp"/>
                </equal>
              </or>
            </and>
          </test>
          <let>
            <var n="concPrimero"/>
            <lit v="true"/>
          </let>
<!-- there is gender and number agreement-->
        </when>
        <otherwise>
          <let>
            <var n="concPrimero"/>
            <lit v="false"/>
          </let>
<!-- there isn't gender and number agreement-->
        </otherwise>
      </choose>
      <choose>
        <when>
          <test>
<!-- Propagate the main parameter gender if it has been modified during the translation  -->
            <and>
              <not>
                <equal>
                  <clip pos="1" side="tl" part="gen"/>
                  <clip pos="1" side="sl" part="gen"/>
                </equal>
              </not>
              <not>
                <equal>
                  <clip pos="1" side="tl" part="gen"/>
                  <lit-tag v="mf"/>
                </equal>
              </not>
              <not>
                <equal>
                  <clip pos="1" side="tl" part="gen"/>
                  <lit-tag v="GD"/>
                </equal>
              </not>
            </and>
          </test>
          <choose>
            <when>
              <test>
                <and>
                  <not>
                    <equal>
                      <clip pos="2" side="tl" part="gen"/>
                      <lit-tag v="mf"/>
                    </equal>
                  </not>
                  <not>
                    <and>
                      <equal>
                        <clip pos="2" side="sl" part="gen"/>
                        <lit-tag v="mf"/>
                      </equal>
                      <not>
                        <equal>
                          <clip pos="2" side="tl" part="gen"/>
                          <lit-tag v="GD"/>
                        </equal>
                      </not>
                    </and>
                  </not>
                  <equal>
                    <var n="concPrimero"/>
                    <lit v="true"/>
                  </equal>
                </and>
              </test>
              <let>
                <clip pos="2" side="tl" part="gen"/>
                <clip pos="1" side="tl" part="gen"/>
              </let>
            </when>
          </choose>
        </when>
      </choose>
      <choose>
        <when>
          <test>
<!-- Propagate the main parameter number if it has been modified during the translation  -->
            <and>
              <not>
                <equal>
                  <clip pos="1" side="tl" part="nbr"/>
                  <clip pos="1" side="sl" part="nbr"/>
                </equal>
              </not>
              <not>
                <equal>
                  <clip pos="1" side="tl" part="nbr"/>
                  <lit-tag v="sp"/>
                </equal>
              </not>
              <not>
                <equal>
                  <clip pos="1" side="tl" part="nbr"/>
                  <lit-tag v="ND"/>
                </equal>
              </not>
            </and>
          </test>
          <choose>
            <when>
              <test>
                <and>
                  <not>
                    <equal>
                      <clip pos="2" side="tl" part="nbr"/>
                      <lit-tag v="sp"/>
                    </equal>
                  </not>
                  <not>
                    <and>
                      <equal>
                        <clip pos="2" side="sl" part="nbr"/>
                        <lit-tag v="sp"/>
                      </equal>
                      <not>
                        <equal>
                          <clip pos="2" side="tl" part="nbr"/>
                          <lit-tag v="ND"/>
                        </equal>
                      </not>
                    </and>
                  </not>
                  <equal>
                    <var n="concPrimero"/>
                    <lit v="true"/>
                  </equal>
                </and>
              </test>
              <let>
                <clip pos="2" side="tl" part="nbr"/>
                <clip pos="1" side="tl" part="nbr"/>
              </let>
            </when>
          </choose>
        </when>
      </choose>
      <choose>
        <when>
          <test>
<!-- Which is the rule general gender? -->
            <equal>
              <clip pos="1" side="tl" part="gen"/>
              <lit-tag v="m"/>
            </equal>
          </test>
          <let>
            <var n="genero"/>
            <lit-tag v="m"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="1" side="tl" part="gen"/>
              <lit-tag v="f"/>
            </equal>
          </test>
          <let>
            <var n="genero"/>
            <lit-tag v="f"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="2" side="tl" part="gen"/>
              <lit-tag v="m"/>
            </equal>
          </test>
          <let>
            <var n="genero"/>
            <lit-tag v="m"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="2" side="tl" part="gen"/>
              <lit-tag v="f"/>
            </equal>
          </test>
          <let>
            <var n="genero"/>
            <lit-tag v="f"/>
          </let>
        </when>
        <when>
          <test>
            <and>
              <equal>
                <clip pos="1" side="tl" part="gen"/>
                <lit-tag v="mf"/>
              </equal>
              <not>
                <equal>
                  <clip pos="1" side="sl" part="gen"/>
                  <lit-tag v="mf"/>
                </equal>
              </not>
            </and>
          </test>
          <let>
            <var n="genero"/>
            <clip pos="1" side="sl" part="gen"/>
          </let>
        </when>
        <when>
          <test>
            <and>
              <equal>
                <clip pos="2" side="tl" part="gen"/>
                <lit-tag v="mf"/>
              </equal>
              <not>
                <equal>
                  <clip pos="2" side="sl" part="gen"/>
                  <lit-tag v="mf"/>
                </equal>
              </not>
            </and>
          </test>
          <let>
            <var n="genero"/>
            <clip pos="2" side="sl" part="gen"/>
          </let>
        </when>
        <otherwise>
          <let>
            <var n="genero"/>
            <lit-tag v="m"/>
          </let>
        </otherwise>
      </choose>
      <choose>
        <when>
<!-- Which is the rule general number? -->
          <test>
            <equal>
              <clip pos="1" side="tl" part="nbr"/>
              <lit-tag v="sg"/>
            </equal>
          </test>
          <let>
            <var n="numero"/>
            <lit-tag v="sg"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="1" side="tl" part="nbr"/>
              <lit-tag v="pl"/>
            </equal>
          </test>
          <let>
            <var n="numero"/>
            <lit-tag v="pl"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="2" side="tl" part="nbr"/>
              <lit-tag v="sg"/>
            </equal>
          </test>
          <let>
            <var n="numero"/>
            <lit-tag v="sg"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="2" side="tl" part="nbr"/>
              <lit-tag v="pl"/>
            </equal>
          </test>
          <let>
            <var n="numero"/>
            <lit-tag v="pl"/>
          </let>
        </when>
        <when>
          <test>
            <and>
              <equal>
                <clip pos="1" side="tl" part="nbr"/>
                <lit-tag v="sp"/>
              </equal>
              <not>
                <equal>
                  <clip pos="1" side="sl" part="nbr"/>
                  <lit-tag v="sp"/>
                </equal>
              </not>
            </and>
          </test>
          <let>
            <var n="numero"/>
            <clip pos="1" side="sl" part="nbr"/>
          </let>
        </when>
        <when>
          <test>
            <and>
              <equal>
                <clip pos="2" side="tl" part="nbr"/>
                <lit-tag v="sp"/>
              </equal>
              <not>
                <equal>
                  <clip pos="2" side="sl" part="nbr"/>
                  <lit-tag v="sp"/>
                </equal>
              </not>
            </and>
          </test>
          <let>
            <var n="numero"/>
            <clip pos="2" side="sl" part="nbr"/>
          </let>
        </when>
        <otherwise>
          <let>
            <var n="numero"/>
            <lit-tag v="sg"/>
          </let>
        </otherwise>
      </choose>
      <choose>
<!-- Determine gender and number value if they are undetermined -->
        <when>
          <test>
            <equal>
              <clip pos="1" side="tl" part="gen"/>
              <lit-tag v="GD"/>
            </equal>
          </test>
          <let>
            <clip pos="1" side="tl" part="gen"/>
            <var n="genero"/>
          </let>
        </when>
      </choose>
      <choose>
        <when>
          <test>
            <equal>
              <clip pos="2" side="tl" part="gen"/>
              <lit-tag v="GD"/>
            </equal>
          </test>
          <let>
            <clip pos="2" side="tl" part="gen"/>
            <var n="genero"/>
          </let>
        </when>
      </choose>
      <choose>
        <when>
          <test>
            <equal>
              <clip pos="1" side="tl" part="nbr"/>
              <lit-tag v="ND"/>
            </equal>
          </test>
          <let>
            <clip pos="1" side="tl" part="nbr"/>
            <var n="numero"/>
          </let>
        </when>
      </choose>
      <choose>
        <when>
          <test>
            <equal>
              <clip pos="2" side="tl" part="nbr"/>
              <lit-tag v="ND"/>
            </equal>
          </test>
          <let>
            <clip pos="2" side="tl" part="nbr"/>
            <var n="numero"/>
          </let>
        </when>
      </choose>
    </def-macro>
    
    
    <def-macro n="f_concord3" npar="3">
      <choose>
<!-- Look if in source language there is concordance between first and second element -->
        <when>
          <test>
            <and>
              <or>
                <equal>
                  <clip pos="2" side="sl" part="gen"/>
                  <clip pos="1" side="sl" part="gen"/>
                </equal>
                <equal>
                  <clip pos="2" side="sl" part="gen"/>
                  <lit-tag v="mf"/>
                </equal>
                <equal>
                  <clip pos="1" side="sl" part="gen"/>
                  <lit-tag v="mf"/>
                </equal>
		<and><!--MG: los nombres neutros en sg concuerdan con adj m, y los nombres en pl con adj f -->
		  <equal>
		    <clip pos="1" side="sl" part="gen"/>
		    <lit-tag v="nt"/>
		  </equal>
		  <equal>
		    <clip pos="1" side="sl" part="nbr"/>
		    <lit-tag v="sg"/>
		  </equal>
		  <equal>
		    <clip pos="2" side="sl" part="gen"/>
		    <lit-tag v="m"/>
		  </equal>
		</and>
		<and>
		  <equal>
		    <clip pos="1" side="sl" part="gen"/>
		    <lit-tag v="nt"/>
		  </equal>
		  <equal>
		    <clip pos="1" side="sl" part="nbr"/>
		    <lit-tag v="pl"/>
		  </equal>
		  <equal>
		    <clip pos="2" side="sl" part="gen"/>
		    <lit-tag v="f"/>
		  </equal>
		</and>
              </or>
              <or>
                <equal>
                  <clip pos="2" side="sl" part="nbr"/>
                  <clip pos="1" side="sl" part="nbr"/>
                </equal>
                <equal>
                  <clip pos="2" side="sl" part="nbr"/>
                  <lit-tag v="sp"/>
                </equal>
                <equal>
                  <clip pos="1" side="sl" part="nbr"/>
                  <lit-tag v="sp"/>
                </equal>
              </or>
            </and>
          </test>
          <let>
            <var n="concPrimero"/>
            <lit v="true"/>
          </let>
        </when>
        <otherwise>
          <let>
            <var n="concPrimero"/>
            <lit v="false"/>
          </let>
        </otherwise>
      </choose>
      <choose>
<!-- Look if in source language there is concordance between second and third element -->
        <when>
          <test>
            <and>
              <or>
                <equal>
                  <clip pos="3" side="sl" part="gen"/>
                  <clip pos="1" side="sl" part="gen"/>
                </equal>
                <equal>
                  <clip pos="3" side="sl" part="gen"/>
                  <lit-tag v="mf"/>
                </equal>
                <equal>
                  <clip pos="1" side="sl" part="gen"/>
                  <lit-tag v="mf"/>
                </equal>
		<and><!--MG: los nombres neutros en sg concuerdan con adj m, y los nombres en pl con adj f -->
		  <equal>
		    <clip pos="1" side="sl" part="gen"/>
		    <lit-tag v="nt"/>
		  </equal>
		  <equal>
		    <clip pos="1" side="sl" part="nbr"/>
		    <lit-tag v="sg"/>
		  </equal>
		  <equal>
		    <clip pos="3" side="sl" part="gen"/>
		    <lit-tag v="m"/>
		  </equal>
		</and>
		<and>
		  <equal>
		    <clip pos="1" side="sl" part="gen"/>
		    <lit-tag v="nt"/>
		  </equal>
		  <equal>
		    <clip pos="1" side="sl" part="nbr"/>
		    <lit-tag v="pl"/>
		  </equal>
		  <equal>
		    <clip pos="3" side="sl" part="gen"/>
		    <lit-tag v="f"/>
		  </equal>
		</and>
              </or>
              <or>
                <equal>
                  <clip pos="3" side="sl" part="nbr"/>
                  <clip pos="1" side="sl" part="nbr"/>
                </equal>
                <equal>
                  <clip pos="3" side="sl" part="nbr"/>
                  <lit-tag v="sp"/>
                </equal>
                <equal>
                  <clip pos="1" side="sl" part="nbr"/>
                  <lit-tag v="sp"/>
                </equal>
              </or>
            </and>
          </test>
          <let>
            <var n="concSegundo"/>
            <lit v="true"/>
          </let>
        </when>
        <otherwise>
          <let>
            <var n="concSegundo"/>
            <lit v="false"/>
          </let>
        </otherwise>
      </choose>
      <choose>
<!-- Propagate the main parameter gender if it has been modified during the translation -->
        <when>
          <test>
            <and>
              <not>
                <equal>
                  <clip pos="1" side="tl" part="gen"/>
                  <clip pos="1" side="sl" part="gen"/>
                </equal>
              </not>
              <not>
                <equal>
                  <clip pos="1" side="tl" part="gen"/>
                  <lit-tag v="mf"/>
                </equal>
              </not>
              <not>
                <equal>
                  <clip pos="1" side="tl" part="gen"/>
                  <lit-tag v="GD"/>
                </equal>
              </not>
            </and>
          </test>
          <choose>
            <when>
              <test>
                <and>
                  <not>
                    <equal>
                      <clip pos="2" side="tl" part="gen"/>
                      <lit-tag v="mf"/>
                    </equal>
                  </not>
                  <not>
                    <and>
                      <equal>
                        <clip pos="2" side="sl" part="gen"/>
                        <lit-tag v="mf"/>
                      </equal>
                      <not>
                        <equal>
                          <clip pos="2" side="tl" part="gen"/>
                          <lit-tag v="GD"/>
                        </equal>
                      </not>
                    </and>
                  </not>
                  <equal>
                    <var n="concPrimero"/>
                    <lit v="true"/>
                  </equal>
                </and>
              </test>
              <let>
                <clip pos="2" side="tl" part="gen"/>
                <clip pos="1" side="tl" part="gen"/>
              </let>
            </when>
          </choose>
          <choose>
            <when>
              <test>
                <and>
                  <not>
                    <equal>
                      <clip pos="3" side="tl" part="gen"/>
                      <lit-tag v="mf"/>
                    </equal>
                  </not>
                  <not>
                    <and>
                      <equal>
                        <clip pos="3" side="sl" part="gen"/>
                        <lit-tag v="mf"/>
                      </equal>
                      <not>
                        <equal>
                          <clip pos="3" side="tl" part="gen"/>
                          <lit-tag v="GD"/>
                        </equal>
                      </not>
                    </and>
                  </not>
                  <equal>
                    <var n="concSegundo"/>
                    <lit v="true"/>
                  </equal>
                </and>
              </test>
              <let>
                <clip pos="3" side="tl" part="gen"/>
                <clip pos="1" side="tl" part="gen"/>
              </let>
            </when>
          </choose>
        </when>
      </choose>
      <choose>
<!-- Propagate the main parameter number if it has been modified during the translation -->
        <when>
          <test>
            <and>
              <not>
                <equal>
                  <clip pos="1" side="tl" part="nbr"/>
                  <clip pos="1" side="sl" part="nbr"/>
                </equal>
              </not>
              <not>
                <equal>
                  <clip pos="1" side="tl" part="nbr"/>
                  <lit-tag v="sp"/>
                </equal>
              </not>
              <not>
                <equal>
                  <clip pos="1" side="tl" part="nbr"/>
                  <lit-tag v="ND"/>
                </equal>
              </not>
            </and>
          </test>
          <choose>
            <when>
              <test>
                <and>
                  <not>
                    <equal>
                      <clip pos="2" side="tl" part="nbr"/>
                      <lit-tag v="sp"/>
                    </equal>
                  </not>
                  <not>
                    <and>
                      <equal>
                        <clip pos="2" side="sl" part="nbr"/>
                        <lit-tag v="sp"/>
                      </equal>
                      <not>
                        <equal>
                          <clip pos="2" side="tl" part="nbr"/>
                          <lit-tag v="ND"/>
                        </equal>
                      </not>
                    </and>
                  </not>
                  <equal>
                    <var n="concPrimero"/>
                    <lit v="true"/>
                  </equal>
                </and>
              </test>
              <let>
                <clip pos="2" side="tl" part="nbr"/>
                <clip pos="1" side="tl" part="nbr"/>
              </let>
            </when>
          </choose>
          <choose>
            <when>
              <test>
                <and>
                  <not>
                    <equal>
                      <clip pos="3" side="tl" part="nbr"/>
                      <lit-tag v="sp"/>
                    </equal>
                  </not>
                  <not>
                    <and>
                      <equal>
                        <clip pos="3" side="sl" part="nbr"/>
                        <lit-tag v="sp"/>
                      </equal>
                      <not>
                        <equal>
                          <clip pos="3" side="tl" part="nbr"/>
                          <lit-tag v="ND"/>
                        </equal>
                      </not>
                    </and>
                  </not>
                  <equal>
                    <var n="concSegundo"/>
                    <lit v="true"/>
                  </equal>
                </and>
              </test>
              <let>
                <clip pos="3" side="tl" part="nbr"/>
                <clip pos="1" side="tl" part="nbr"/>
              </let>
            </when>
          </choose>
        </when>
      </choose>
      <choose>
<!-- Determine the rule general gender. Priority order: main, second and third element -->
        <when>
          <test>
            <equal>
              <clip pos="1" side="tl" part="gen"/>
              <lit-tag v="m"/>
            </equal>
          </test>
          <let>
            <var n="genero"/>
            <lit-tag v="m"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="1" side="tl" part="gen"/>
              <lit-tag v="f"/>
            </equal>
          </test>
          <let>
            <var n="genero"/>
            <lit-tag v="f"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="2" side="tl" part="gen"/>
              <lit-tag v="m"/>
            </equal>
          </test>
          <let>
            <var n="genero"/>
            <lit-tag v="m"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="2" side="tl" part="gen"/>
              <lit-tag v="f"/>
            </equal>
          </test>
          <let>
            <var n="genero"/>
            <lit-tag v="f"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="3" side="tl" part="gen"/>
              <lit-tag v="m"/>
            </equal>
          </test>
          <let>
            <var n="genero"/>
            <lit-tag v="m"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="3" side="tl" part="gen"/>
              <lit-tag v="f"/>
            </equal>
          </test>
          <let>
            <var n="genero"/>
            <lit-tag v="f"/>
          </let>
        </when>
        <when>
          <test>
            <and>
              <equal>
                <clip pos="1" side="tl" part="gen"/>
                <lit-tag v="mf"/>
              </equal>
              <not>
                <equal>
                  <clip pos="1" side="sl" part="gen"/>
                  <lit-tag v="mf"/>
                </equal>
              </not>
            </and>
          </test>
          <let>
            <var n="genero"/>
            <clip pos="1" side="sl" part="gen"/>
          </let>
        </when>
        <when>
          <test>
            <and>
              <equal>
                <clip pos="2" side="tl" part="gen"/>
                <lit-tag v="mf"/>
              </equal>
              <not>
                <equal>
                  <clip pos="2" side="sl" part="gen"/>
                  <lit-tag v="mf"/>
                </equal>
              </not>
            </and>
          </test>
          <let>
            <var n="genero"/>
            <clip pos="2" side="sl" part="gen"/>
          </let>
        </when>
        <when>
          <test>
            <and>
              <equal>
                <clip pos="3" side="tl" part="gen"/>
                <lit-tag v="mf"/>
              </equal>
              <not>
                <equal>
                  <clip pos="3" side="sl" part="gen"/>
                  <lit-tag v="mf"/>
                </equal>
              </not>
            </and>
          </test>
          <let>
            <var n="genero"/>
            <clip pos="3" side="sl" part="gen"/>
          </let>
        </when>
        <otherwise>
          <let>
            <var n="genero"/>
            <lit-tag v="m"/>
          </let>
        </otherwise>
      </choose>
      <choose>
<!-- Determine the rule general number. Priority order: main, second and third element -->
        <when>
          <test>
            <equal>
              <clip pos="1" side="tl" part="nbr"/>
              <lit-tag v="sg"/>
            </equal>
          </test>
          <let>
            <var n="numero"/>
            <lit-tag v="sg"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="1" side="tl" part="nbr"/>
              <lit-tag v="pl"/>
            </equal>
          </test>
          <let>
            <var n="numero"/>
            <lit-tag v="pl"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="2" side="tl" part="nbr"/>
              <lit-tag v="sg"/>
            </equal>
          </test>
          <let>
            <var n="numero"/>
            <lit-tag v="sg"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="2" side="tl" part="nbr"/>
              <lit-tag v="pl"/>
            </equal>
          </test>
          <let>
            <var n="numero"/>
            <lit-tag v="pl"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="3" side="tl" part="nbr"/>
              <lit-tag v="sg"/>
            </equal>
          </test>
          <let>
            <var n="numero"/>
            <lit-tag v="sg"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="3" side="tl" part="nbr"/>
              <lit-tag v="pl"/>
            </equal>
          </test>
          <let>
            <var n="numero"/>
            <lit-tag v="pl"/>
          </let>
        </when>
        <when>
          <test>
            <and>
              <equal>
                <clip pos="1" side="tl" part="nbr"/>
                <lit-tag v="sp"/>
              </equal>
              <not>
                <equal>
                  <clip pos="1" side="sl" part="nbr"/>
                  <lit-tag v="sp"/>
                </equal>
              </not>
            </and>
          </test>
          <let>
            <var n="numero"/>
            <clip pos="1" side="sl" part="nbr"/>
          </let>
        </when>
        <when>
          <test>
            <and>
              <equal>
                <clip pos="2" side="tl" part="nbr"/>
                <lit-tag v="sp"/>
              </equal>
              <not>
                <equal>
                  <clip pos="2" side="sl" part="nbr"/>
                  <lit-tag v="sp"/>
                </equal>
              </not>
            </and>
          </test>
          <let>
            <var n="numero"/>
            <clip pos="2" side="sl" part="nbr"/>
          </let>
        </when>
        <when>
          <test>
            <and>
              <equal>
                <clip pos="3" side="tl" part="nbr"/>
                <lit-tag v="sp"/>
              </equal>
              <not>
                <equal>
                  <clip pos="3" side="sl" part="nbr"/>
                  <lit-tag v="sp"/>
                </equal>
              </not>
            </and>
          </test>
          <let>
            <var n="numero"/>
            <clip pos="3" side="sl" part="nbr"/>
          </let>
        </when>
        <otherwise>
          <let>
            <var n="numero"/>
            <lit-tag v="sg"/>
          </let>
        </otherwise>
      </choose>
      <choose>
<!-- Assign values to GD and ND -->
        <when>
          <test>
            <equal>
              <clip pos="1" side="tl" part="gen"/>
              <lit-tag v="GD"/>
            </equal>
          </test>
          <let>
            <clip pos="1" side="tl" part="gen"/>
            <var n="genero"/>
          </let>
        </when>
      </choose>
      <choose>
        <when>
          <test>
            <equal>
              <clip pos="2" side="tl" part="gen"/>
              <lit-tag v="GD"/>
            </equal>
          </test>
          <let>
            <clip pos="2" side="tl" part="gen"/>
            <var n="genero"/>
          </let>
        </when>
      </choose>
      <choose>
        <when>
          <test>
            <equal>
              <clip pos="3" side="tl" part="gen"/>
              <lit-tag v="GD"/>
            </equal>
          </test>
          <let>
            <clip pos="3" side="tl" part="gen"/>
            <var n="genero"/>
          </let>
        </when>
      </choose>
      <choose>
        <when>
          <test>
            <equal>
              <clip pos="1" side="tl" part="nbr"/>
              <lit-tag v="ND"/>
            </equal>
          </test>
          <let>
            <clip pos="1" side="tl" part="nbr"/>
            <var n="numero"/>
          </let>
        </when>
      </choose>
      <choose>
        <when>
          <test>
            <equal>
              <clip pos="2" side="tl" part="nbr"/>
              <lit-tag v="ND"/>
            </equal>
          </test>
          <let>
            <clip pos="2" side="tl" part="nbr"/>
            <var n="numero"/>
          </let>
        </when>
      </choose>
      <choose>
        <when>
          <test>
            <equal>
              <clip pos="3" side="tl" part="nbr"/>
              <lit-tag v="ND"/>
            </equal>
          </test>
          <let>
            <clip pos="3" side="tl" part="nbr"/>
            <var n="numero"/>
          </let>
        </when>
      </choose>
    </def-macro>
    <def-macro n="f_concord4" npar="4">
      <choose>
        <when>
          <test>
            <and>
              <or>
                <equal>
                  <clip pos="2" side="sl" part="gen"/>
                  <clip pos="1" side="sl" part="gen"/>
                </equal>
                <equal>
                  <clip pos="2" side="sl" part="gen"/>
                  <lit-tag v="mf"/>
                </equal>
                <equal>
                  <clip pos="1" side="sl" part="gen"/>
                  <lit-tag v="mf"/>
                </equal>
              </or>
              <or>
                <equal>
                  <clip pos="2" side="sl" part="nbr"/>
                  <clip pos="1" side="sl" part="nbr"/>
                </equal>
                <equal>
                  <clip pos="2" side="sl" part="nbr"/>
                  <lit-tag v="sp"/>
                </equal>
                <equal>
                  <clip pos="1" side="sl" part="nbr"/>
                  <lit-tag v="sp"/>
                </equal>
              </or>
            </and>
          </test>
          <let>
            <var n="concPrimero"/>
            <lit v="true"/>
          </let>
        </when>
        <otherwise>
          <let>
            <var n="concPrimero"/>
            <lit v="false"/>
          </let>
        </otherwise>
      </choose>
      <choose>
        <when>
          <test>
            <and>
              <or>
                <equal>
                  <clip pos="3" side="sl" part="gen"/>
                  <clip pos="1" side="sl" part="gen"/>
                </equal>
                <equal>
                  <clip pos="3" side="sl" part="gen"/>
                  <lit-tag v="mf"/>
                </equal>
                <equal>
                  <clip pos="1" side="sl" part="gen"/>
                  <lit-tag v="mf"/>
                </equal>
              </or>
              <or>
                <equal>
                  <clip pos="3" side="sl" part="nbr"/>
                  <clip pos="1" side="sl" part="nbr"/>
                </equal>
                <equal>
                  <clip pos="3" side="sl" part="nbr"/>
                  <lit-tag v="sp"/>
                </equal>
                <equal>
                  <clip pos="1" side="sl" part="nbr"/>
                  <lit-tag v="sp"/>
                </equal>
              </or>
            </and>
          </test>
          <let>
            <var n="concSegundo"/>
            <lit v="true"/>
          </let>
        </when>
        <otherwise>
          <let>
            <var n="concSegundo"/>
            <lit v="false"/>
          </let>
        </otherwise>
      </choose>
      <choose>
        <when>
          <test>
            <and>
              <or>
                <equal>
                  <clip pos="4" side="sl" part="gen"/>
                  <clip pos="1" side="sl" part="gen"/>
                </equal>
                <equal>
                  <clip pos="4" side="sl" part="gen"/>
                  <lit-tag v="mf"/>
                </equal>
                <equal>
                  <clip pos="1" side="sl" part="gen"/>
                  <lit-tag v="mf"/>
                </equal>
              </or>
              <or>
                <equal>
                  <clip pos="4" side="sl" part="nbr"/>
                  <clip pos="1" side="sl" part="nbr"/>
                </equal>
                <equal>
                  <clip pos="4" side="sl" part="nbr"/>
                  <lit-tag v="sp"/>
                </equal>
                <equal>
                  <clip pos="1" side="sl" part="nbr"/>
                  <lit-tag v="sp"/>
                </equal>
              </or>
            </and>
          </test>
          <let>
            <var n="concTercero"/>
            <lit v="true"/>
          </let>
        </when>
        <otherwise>
          <let>
            <var n="concTercero"/>
            <lit v="false"/>
          </let>
        </otherwise>
      </choose>
      <choose>
        <when>
          <test>
            <and>
              <not>
                <equal>
                  <clip pos="1" side="tl" part="gen"/>
                  <clip pos="1" side="sl" part="gen"/>
                </equal>
              </not>
              <not>
                <equal>
                  <clip pos="1" side="tl" part="gen"/>
                  <lit-tag v="mf"/>
                </equal>
              </not>
              <not>
                <equal>
                  <clip pos="1" side="tl" part="gen"/>
                  <lit-tag v="GD"/>
                </equal>
              </not>
            </and>
          </test>
          <choose>
            <when>
              <test>
                <and>
                  <not>
                    <equal>
                      <clip pos="2" side="tl" part="gen"/>
                      <lit-tag v="mf"/>
                    </equal>
                  </not>
                  <not>
                    <and>
                      <equal>
                        <clip pos="2" side="sl" part="gen"/>
                        <lit-tag v="mf"/>
                      </equal>
                      <not>
                        <equal>
                          <clip pos="2" side="tl" part="gen"/>
                          <lit-tag v="GD"/>
                        </equal>
                      </not>
                    </and>
                  </not>
                  <equal>
                    <var n="concPrimero"/>
                    <lit v="true"/>
                  </equal>
                </and>
              </test>
              <let>
                <clip pos="2" side="tl" part="gen"/>
                <clip pos="1" side="tl" part="gen"/>
              </let>
            </when>
          </choose>
          <choose>
            <when>
              <test>
                <and>
                  <not>
                    <equal>
                      <clip pos="3" side="tl" part="gen"/>
                      <lit-tag v="mf"/>
                    </equal>
                  </not>
                  <not>
                    <and>
                      <equal>
                        <clip pos="3" side="sl" part="gen"/>
                        <lit-tag v="mf"/>
                      </equal>
                      <not>
                        <equal>
                          <clip pos="3" side="tl" part="gen"/>
                          <lit-tag v="GD"/>
                        </equal>
                      </not>
                    </and>
                  </not>
                  <equal>
                    <var n="concSegundo"/>
                    <lit v="true"/>
                  </equal>
                </and>
              </test>
              <let>
                <clip pos="3" side="tl" part="gen"/>
                <clip pos="1" side="tl" part="gen"/>
              </let>
            </when>
          </choose>
          <choose>
            <when>
              <test>
                <and>
                  <not>
                    <equal>
                      <clip pos="4" side="tl" part="gen"/>
                      <lit-tag v="mf"/>
                    </equal>
                  </not>
                  <not>
                    <and>
                      <equal>
                        <clip pos="4" side="sl" part="gen"/>
                        <lit-tag v="mf"/>
                      </equal>
                      <not>
                        <equal>
                          <clip pos="4" side="tl" part="gen"/>
                          <lit-tag v="GD"/>
                        </equal>
                      </not>
                    </and>
                  </not>
                  <equal>
                    <var n="concTercero"/>
                    <lit v="true"/>
                  </equal>
                </and>
              </test>
              <let>
                <clip pos="4" side="tl" part="gen"/>
                <clip pos="1" side="tl" part="gen"/>
              </let>
            </when>
          </choose>
        </when>
      </choose>
      <choose>
        <when>
          <test>
            <and>
              <not>
                <equal>
                  <clip pos="1" side="tl" part="nbr"/>
                  <clip pos="1" side="sl" part="nbr"/>
                </equal>
              </not>
              <not>
                <equal>
                  <clip pos="1" side="tl" part="nbr"/>
                  <lit-tag v="sp"/>
                </equal>
              </not>
              <not>
                <equal>
                  <clip pos="1" side="tl" part="nbr"/>
                  <lit-tag v="ND"/>
                </equal>
              </not>
            </and>
          </test>
          <choose>
            <when>
              <test>
                <and>
                  <not>
                    <equal>
                      <clip pos="2" side="tl" part="nbr"/>
                      <lit-tag v="sp"/>
                    </equal>
                  </not>
                  <not>
                    <and>
                      <equal>
                        <clip pos="2" side="sl" part="nbr"/>
                        <lit-tag v="sp"/>
                      </equal>
                      <not>
                        <equal>
                          <clip pos="2" side="tl" part="nbr"/>
                          <lit-tag v="ND"/>
                        </equal>
                      </not>
                    </and>
                  </not>
                  <equal>
                    <var n="concPrimero"/>
                    <lit v="true"/>
                  </equal>
                </and>
              </test>
              <let>
                <clip pos="2" side="tl" part="nbr"/>
                <clip pos="1" side="tl" part="nbr"/>
              </let>
            </when>
          </choose>
          <choose>
            <when>
              <test>
                <and>
                  <not>
                    <equal>
                      <clip pos="3" side="tl" part="nbr"/>
                      <lit-tag v="sp"/>
                    </equal>
                  </not>
                  <not>
                    <and>
                      <equal>
                        <clip pos="3" side="sl" part="nbr"/>
                        <lit-tag v="sp"/>
                      </equal>
                      <not>
                        <equal>
                          <clip pos="3" side="tl" part="nbr"/>
                          <lit-tag v="ND"/>
                        </equal>
                      </not>
                    </and>
                  </not>
                  <equal>
                    <var n="concSegundo"/>
                    <lit v="true"/>
                  </equal>
                </and>
              </test>
              <let>
                <clip pos="3" side="tl" part="nbr"/>
                <clip pos="1" side="tl" part="nbr"/>
              </let>
            </when>
          </choose>
          <choose>
            <when>
              <test>
                <and>
                  <not>
                    <equal>
                      <clip pos="4" side="tl" part="nbr"/>
                      <lit-tag v="sp"/>
                    </equal>
                  </not>
                  <not>
                    <and>
                      <equal>
                        <clip pos="4" side="sl" part="nbr"/>
                        <lit-tag v="sp"/>
                      </equal>
                      <not>
                        <equal>
                          <clip pos="4" side="tl" part="nbr"/>
                          <lit-tag v="ND"/>
                        </equal>
                      </not>
                    </and>
                  </not>
                  <equal>
                    <var n="concTercero"/>
                    <lit v="true"/>
                  </equal>
                </and>
              </test>
              <let>
                <clip pos="4" side="tl" part="nbr"/>
                <clip pos="1" side="tl" part="nbr"/>
              </let>
            </when>
          </choose>
        </when>
      </choose>
      <choose>
        <when>
          <test>
            <equal>
              <clip pos="1" side="tl" part="gen"/>
              <lit-tag v="m"/>
            </equal>
          </test>
          <let>
            <var n="genero"/>
            <lit-tag v="m"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="1" side="tl" part="gen"/>
              <lit-tag v="f"/>
            </equal>
          </test>
          <let>
            <var n="genero"/>
            <lit-tag v="f"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="2" side="tl" part="gen"/>
              <lit-tag v="m"/>
            </equal>
          </test>
          <let>
            <var n="genero"/>
            <lit-tag v="m"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="2" side="tl" part="gen"/>
              <lit-tag v="f"/>
            </equal>
          </test>
          <let>
            <var n="genero"/>
            <lit-tag v="f"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="3" side="tl" part="gen"/>
              <lit-tag v="m"/>
            </equal>
          </test>
          <let>
            <var n="genero"/>
            <lit-tag v="m"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="3" side="tl" part="gen"/>
              <lit-tag v="f"/>
            </equal>
          </test>
          <let>
            <var n="genero"/>
            <lit-tag v="f"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="4" side="tl" part="gen"/>
              <lit-tag v="m"/>
            </equal>
          </test>
          <let>
            <var n="genero"/>
            <lit-tag v="m"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="4" side="tl" part="gen"/>
              <lit-tag v="f"/>
            </equal>
          </test>
          <let>
            <var n="genero"/>
            <lit-tag v="f"/>
          </let>
        </when>
        <otherwise>
          <let>
            <var n="genero"/>
            <lit-tag v="m"/>
          </let>
        </otherwise>
      </choose>
      <choose>
        <when>
          <test>
            <equal>
              <clip pos="1" side="tl" part="nbr"/>
              <lit-tag v="sg"/>
            </equal>
          </test>
          <let>
            <var n="numero"/>
            <lit-tag v="sg"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="1" side="tl" part="nbr"/>
              <lit-tag v="pl"/>
            </equal>
          </test>
          <let>
            <var n="numero"/>
            <lit-tag v="pl"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="2" side="tl" part="nbr"/>
              <lit-tag v="sg"/>
            </equal>
          </test>
          <let>
            <var n="numero"/>
            <lit-tag v="sg"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="2" side="tl" part="nbr"/>
              <lit-tag v="pl"/>
            </equal>
          </test>
          <let>
            <var n="numero"/>
            <lit-tag v="pl"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="3" side="tl" part="nbr"/>
              <lit-tag v="sg"/>
            </equal>
          </test>
          <let>
            <var n="numero"/>
            <lit-tag v="sg"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="3" side="tl" part="nbr"/>
              <lit-tag v="pl"/>
            </equal>
          </test>
          <let>
            <var n="numero"/>
            <lit-tag v="pl"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="4" side="tl" part="nbr"/>
              <lit-tag v="sg"/>
            </equal>
          </test>
          <let>
            <var n="numero"/>
            <lit-tag v="sg"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="4" side="tl" part="nbr"/>
              <lit-tag v="pl"/>
            </equal>
          </test>
          <let>
            <var n="numero"/>
            <lit-tag v="pl"/>
          </let>
        </when>
        <otherwise>
          <let>
            <var n="numero"/>
            <lit-tag v="sg"/>
          </let>
        </otherwise>
      </choose>
      <choose>
        <when>
          <test>
            <equal>
              <clip pos="1" side="tl" part="gen"/>
              <lit-tag v="GD"/>
            </equal>
          </test>
          <let>
            <clip pos="1" side="tl" part="gen"/>
            <var n="genero"/>
          </let>
        </when>
      </choose>
      <choose>
        <when>
          <test>
            <equal>
              <clip pos="2" side="tl" part="gen"/>
              <lit-tag v="GD"/>
            </equal>
          </test>
          <let>
            <clip pos="2" side="tl" part="gen"/>
            <var n="genero"/>
          </let>
        </when>
      </choose>
      <choose>
        <when>
          <test>
            <equal>
              <clip pos="3" side="tl" part="gen"/>
              <lit-tag v="GD"/>
            </equal>
          </test>
          <let>
            <clip pos="3" side="tl" part="gen"/>
            <var n="genero"/>
          </let>
        </when>
      </choose>
      <choose>
        <when>
          <test>
            <equal>
              <clip pos="4" side="tl" part="gen"/>
              <lit-tag v="GD"/>
            </equal>
          </test>
          <let>
            <clip pos="4" side="tl" part="gen"/>
            <var n="genero"/>
          </let>
        </when>
      </choose>
      <choose>
        <when>
          <test>
            <equal>
              <clip pos="1" side="tl" part="nbr"/>
              <lit-tag v="ND"/>
            </equal>
          </test>
          <let>
            <clip pos="1" side="tl" part="nbr"/>
            <var n="numero"/>
          </let>
        </when>
      </choose>
      <choose>
        <when>
          <test>
            <equal>
              <clip pos="2" side="tl" part="nbr"/>
              <lit-tag v="ND"/>
            </equal>
          </test>
          <let>
            <clip pos="2" side="tl" part="nbr"/>
            <var n="numero"/>
          </let>
        </when>
      </choose>
      <choose>
        <when>
          <test>
            <equal>
              <clip pos="3" side="tl" part="nbr"/>
              <lit-tag v="ND"/>
            </equal>
          </test>
          <let>
            <clip pos="3" side="tl" part="nbr"/>
            <var n="numero"/>
          </let>
        </when>
      </choose>
      <choose>
        <when>
          <test>
            <equal>
              <clip pos="4" side="tl" part="nbr"/>
              <lit-tag v="ND"/>
            </equal>
          </test>
          <let>
            <clip pos="4" side="tl" part="nbr"/>
            <var n="numero"/>
          </let>
        </when>
      </choose>
    </def-macro>
    <def-macro n="f_lexicAdj" npar="1">
      <choose>
        <when>
          <test>
            <and>
              <equal caseless="yes">
                <clip pos="1" side="tl" part="lem"/>
                <lit v="bueno"/>
              </equal>
              <equal>
                <clip pos="1" side="tl" part="gen"/>
                <lit-tag v="m"/>
              </equal>
              <equal>
                <clip pos="1" side="tl" part="nbr"/>
                <lit-tag v="sg"/>
              </equal>
            </and>
          </test>
          <let>
            <clip pos="1" side="tl" part="lem"/>
            <get-case-from pos="1">
              <lit v="buen"/>
            </get-case-from>
          </let>
        </when>
        <when>
          <test>
            <and>
              <equal caseless="yes">
                <clip pos="1" side="tl" part="lem"/>
                <lit v="grande"/>
              </equal>
              <equal>
                <clip pos="1" side="tl" part="gen"/>
                <lit-tag v="mf"/>
              </equal>
              <equal>
                <clip pos="1" side="tl" part="nbr"/>
                <lit-tag v="sg"/>
              </equal>
            </and>
          </test>
          <let>
            <clip pos="1" side="tl" part="lem"/>
            <get-case-from pos="1">
              <lit v="gran"/>
            </get-case-from>
          </let>
        </when>
        <when>
          <test>
            <and>
              <equal caseless="yes">
                <clip pos="1" side="tl" part="lem"/>
                <lit v="primero"/>
              </equal>
              <equal>
                <clip pos="1" side="tl" part="gen"/>
                <lit-tag v="m"/>
              </equal>
              <equal>
                <clip pos="1" side="tl" part="nbr"/>
                <lit-tag v="sg"/>
              </equal>
            </and>
          </test>
          <let>
            <clip pos="1" side="tl" part="lem"/>
            <get-case-from pos="1">
              <lit v="primer"/>
            </get-case-from>
          </let>
        </when>
        <when>
          <test>
            <and>
              <equal caseless="yes">
                <clip pos="1" side="tl" part="lem"/>
                <lit v="tercero"/>
              </equal>
              <equal>
                <clip pos="1" side="tl" part="gen"/>
                <lit-tag v="m"/>
              </equal>
              <equal>
                <clip pos="1" side="tl" part="nbr"/>
                <lit-tag v="sg"/>
              </equal>
            </and>
          </test>
          <let>
            <clip pos="1" side="tl" part="lem"/>
            <get-case-from pos="1">
              <lit v="tercer"/>
            </get-case-from>
          </let>
        </when>
      </choose>
    </def-macro>
  </section-def-macros>
  <section-rules>


<!--REGLA UNU: NUMERAL NOM, o sigui la fecha 2 aprilie = 2 de abril -->
    <rule>
      <pattern>
        <pattern-item n="num"/>
        <pattern-item n="meses"/>
      </pattern>
      <action>
      <call-macro n="f_modgen">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_concord1">
          <with-param pos="1"/>
        </call-macro>
            <out> 
	     <lu>
	       <get-case-from pos="1">
	         <clip pos="1" side="tl" part="whole"/>
		</get-case-from>
              </lu>
	      <b/>
              <lu> 
	       <lit v="de"/>
	       <lit-tag v="pr"/>
              </lu>
              <b/>
	      <lu>
	        <clip pos="2" side="tl" part="lem"/>
	        <clip pos="2" side="tl" part="a_nom"/>
                <clip pos="2" side="tl" part="gen"/>
                <clip pos="2" side="tl" part="nbr"/>
              </lu>
            </out>
      </action>
    </rule> 
<rule>
<!-- REGLA 73BISBISBIS: VEU PASSIVA ADAPTADA: Nom + VbFI + adj = Nom + ser + part -->
<!-- Per a traduir  "Präjitura e(ste) fäcutä din fäinä" com a "el pastíss és fet de farina" -->
      <pattern>
        <pattern-item n="nom"/>
        <pattern-item n="verbfi"/>
        <pattern-item n="adj"/>
      </pattern>
      <action>
       <call-macro n="f_modgen">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_modgen">
          <with-param pos="3"/>
        </call-macro>
        <call-macro n="f_concord2">
          <with-param pos="1"/>
          <with-param pos="3"/> 
	</call-macro>
        <out>
          <lu>
	        <get-case-from pos="1">
	        <lit v="el"/>
                </get-case-from>
                <lit-tag v="det.def"/>
                <clip pos="1" side="tl" part="gen"/>
                <clip pos="1" side="tl" part="nbr"/>
           </lu>
           <b/>
           <lu>
              <clip pos="1" side="tl" part="lem"/>
              <clip pos="1" side="tl" part="a_nom"/>  
	      <clip pos="1" side="tl" part="gen"/>
              <clip pos="1" side="tl" part="nbr"/>
            </lu>
           <b/>
          <lu>
              <lit v="ser"/> 
                <clip pos="2" side="tl" part="a_verb"/>         
                <clip pos="2" side="tl" part="temps"/>
                <clip pos="2" side="tl" part="gen"/>
                <clip pos="2" side="tl" part="persona"/>
                <clip pos="2" side="tl" part="nbr"/>
          </lu>
          <b/>
          <lu>
            <clip pos="3" side="tl" part="lem"/>
            <clip pos="3" side="tl" part="a_adj"/>
            <clip pos="1" side="tl" part="gen"/>
            <clip pos="3" side="tl" part="nbr"/>
          </lu>
        </out>
      </action>
    </rule>

 <rule>
<!-- REGLA 73BISBIS: VEU PASSIVA SENZILLA: Nom + VbFI + participi = Nom + ser + part -->
<!-- Per a traduir  "Präjitura e(ste) fäcutä din fäinä" com a "el pastíss és fet de farina" -->
      <pattern>
        <pattern-item n="nom"/>
        <pattern-item n="verbfi"/>
        <pattern-item n="pp"/>
      </pattern>
      <action>
       <call-macro n="f_modgen">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_modgen">
          <with-param pos="3"/>
        </call-macro>
        <call-macro n="f_concord2">
          <with-param pos="1"/>
          <with-param pos="3"/> 
	</call-macro>
        <call-macro n="modcase">
               <with-param pos="1"/>
            </call-macro>
        <out>
          <lu>
               <get-case-from pos="1">
	        <lit v="el"/>
                </get-case-from>
                <lit-tag v="det.def"/>
                <clip pos="1" side="tl" part="gen"/>
                <clip pos="1" side="tl" part="nbr"/>
           </lu>
           <b/>
           <lu>
              <clip pos="1" side="tl" part="lem"/>
              <clip pos="1" side="tl" part="a_nom"/>  
	      <clip pos="1" side="tl" part="gen"/>
              <clip pos="1" side="tl" part="nbr"/>
            </lu>
           <b/>
           <lu>
              <lit v="ser"/> 
                <clip pos="2" side="tl" part="a_verb"/>         
                <clip pos="2" side="tl" part="temps"/>
                <clip pos="2" side="tl" part="gen"/>
                <clip pos="2" side="tl" part="persona"/>
                <clip pos="2" side="tl" part="nbr"/>
          </lu>
          <b/>
          <lu>
            <clip pos="3" side="tl" part="lem"/>
            <clip pos="3" side="tl" part="a_verb"/>
            <lit-tag v="pp"/>
            <clip pos="1" side="tl" part="gen"/>
            <clip pos="3" side="tl" part="nbr"/>
          </lu>
        </out>
      </action>
    </rule>

<rule>
<!-- REGLA 32bis DELIA: NOM (ind)+ DETA + NP politicä a României = política de Rumanía-->
      <pattern>        
        <pattern-item n="nom"/>
        <pattern-item n="deta"/>
        <pattern-item n="np"/>
      </pattern>
      <action>  
          <choose>
              <when>
                <test>
                  <equal>
                    <clip pos="1" side="tl" part="gen"/>
                    <lit-tag v="mf"/>
                  </equal>
                </test>
               <out>
                  <lu>
                    <clip pos="1" side="tl" part="lem"/>
                    <clip pos="1" side="tl" part="a_nom"/>
                    <clip pos="1" side="tl" part="gen"/>
                    <clip pos="1" side="tl" part="nbr"/>
                  </lu>
                  <b pos="1"/>
                  <lu>
		    <lit v="de"/>  
		    <lit-tag v="pr"/>
                  </lu>
                  <b pos="2"/>
                 <lu>
                    <clip pos="3" side="tl" part="lem"/>
                    <clip pos="3" side="tl" part="a_np"/>
                    <clip pos="3" side="tl" part="gen"/>
                    <clip pos="3" side="tl" part="nbr"/>
                  </lu>
                </out>
              </when>
	      <otherwise>
               <out>
                  <lu>
                    <clip pos="1" side="tl" part="lem"/>
                    <clip pos="1" side="tl" part="a_nom"/>
                    <clip pos="1" side="tl" part="gen"/>
                    <clip pos="1" side="tl" part="nbr"/>
                  </lu>
	           <b pos="1"/>
                  <lu>
		    <lit v="de"/>  
		    <lit-tag v="pr"/>
                  </lu>
                  <b pos="2"/>
                  <lu>
                    <clip pos="3" side="tl" part="lem"/>
                    <clip pos="3" side="tl" part="a_np"/>
                    <clip pos="3" side="tl" part="gen"/>
                    <clip pos="3" side="tl" part="nbr"/>
                  </lu>
                </out>
              </otherwise>
            </choose>
         </action>
    </rule> 

<rule>
<!-- REGLA 32abis DELIA: NOM + ADJ + DETA + NP oficiile consulare ale României = las oficinas consulares de Rumanía-->
      <pattern>        
        <pattern-item n="nom"/>
        <pattern-item n="adj"/>
        <pattern-item n="deta"/>
        <pattern-item n="np"/>
      </pattern>
      <action> 
        <call-macro n="f_modgen">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_modgen">
          <with-param pos="2"/>
        </call-macro>
        <call-macro n="f_modgen">
          <with-param pos="3"/>
        </call-macro>
        <call-macro n="f_concord2">
          <with-param pos="1"/>
          <with-param pos="2"/> 
	</call-macro> 
          <choose>
              <when>
                <test>
                  <equal>
                    <clip pos="1" side="tl" part="gen"/>
                    <lit-tag v="mf"/>
                  </equal>
                </test>
               <out>
                  <lu>
                    <lit v="el"/>
                    <lit-tag v="det.def"/>
                    <clip pos="1" side="tl" part="gen"/>
                    <clip pos="1" side="tl" part="nbr"/>
                  </lu>
                 <b/>
                  <lu>
                    <clip pos="1" side="tl" part="lem"/>
                    <clip pos="1" side="tl" part="a_nom"/>
                    <clip pos="1" side="tl" part="gen"/>
                    <clip pos="1" side="tl" part="nbr"/>
                  </lu>
                  <b/>
                  <lu>
                    <clip pos="2" side="tl" part="lem"/>
                    <clip pos="2" side="tl" part="a_adj"/>
                    <clip pos="2" side="tl" part="gen"/>
                    <clip pos="2" side="tl" part="nbr"/>
                  </lu>
                  <b/>
                  <lu>
		    <lit v="de"/>  
		    <lit-tag v="pr"/>
                  </lu>
                  <b/>
                 <lu>
                    <clip pos="4" side="tl" part="lem"/>
                    <clip pos="4" side="tl" part="a_np"/>
                    <clip pos="4" side="tl" part="gen"/>
                    <clip pos="4" side="tl" part="nbr"/>
                  </lu>
                </out>
              </when>
	      <otherwise>
               <out>
                  <lu>
                    <lit v="el"/>
                    <lit-tag v="det.def"/>
                    <clip pos="1" side="tl" part="gen"/>
                    <clip pos="1" side="tl" part="nbr"/>
                  </lu>
                 <b/>
                  <lu>
                    <clip pos="1" side="tl" part="lem"/>
                    <clip pos="1" side="tl" part="a_nom"/>
                    <clip pos="1" side="tl" part="gen"/>
                    <clip pos="1" side="tl" part="nbr"/>
                  </lu>
	           <b/>
                   <lu>
                    <clip pos="2" side="tl" part="lem"/>
                    <clip pos="2" side="tl" part="a_adj"/>
                    <clip pos="2" side="tl" part="gen"/>
                    <clip pos="2" side="tl" part="nbr"/>
                  </lu>
                  <b/>
                  <lu>
		    <lit v="de"/>  
		    <lit-tag v="pr"/>
                  </lu>
                  <b/>
                  <lu>
                    <clip pos="4" side="tl" part="lem"/>
                    <clip pos="4" side="tl" part="a_np"/>
                    <clip pos="4" side="tl" part="gen"/>
                    <clip pos="4" side="tl" part="nbr"/>
                  </lu>
                </out>
              </otherwise>
            </choose>
         </action>
    </rule> 


<rule>
<!-- REGLA 32bisbis DELIA: NOM (def)+ DETA + Rel Cärui + Nom /cartea a cärei copertä = libro cuya portada-->
      <pattern>        
        <pattern-item n="nom"/>
        <pattern-item n="deta"/>
        <pattern-item n="relcärui"/>
        <pattern-item n="nom"/>
      </pattern>
      <action> 
        <call-macro n="f_modgen">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_modgen">
          <with-param pos="2"/>
        </call-macro>
         <call-macro n="f_modgen">
          <with-param pos="3"/>
        </call-macro>
        <call-macro n="f_modgen">
          <with-param pos="4"/>
        </call-macro> 
          <choose>
              <when>
                <test>
                  <equal>
                    <clip pos="1" side="tl" part="gen"/>
                    <lit-tag v="mf"/>
                  </equal>
                </test>
               <out>
                  <lu>
                    <lit v="el"/>
                    <lit-tag v="det.def"/>
                    <clip pos="1" side="tl" part="gen"/>
                    <clip pos="1" side="tl" part="nbr"/>
                  </lu>
                 <b/>
                  <lu>
                    <clip pos="1" side="tl" part="lem"/>
                    <clip pos="1" side="tl" part="a_nom"/>
                    <clip pos="1" side="tl" part="gen"/>
                    <clip pos="1" side="tl" part="nbr"/>
                  </lu>
                  <b/>
                  <lu>
		    <lit v="cuyo"/>  
		    <lit-tag v="rel.aa"/>
                    <clip pos="4" side="tl" part="gen"/>
                    <clip pos="4" side="tl" part="nbr"/>
                  </lu>
                  <b/>
                 <lu>
                    <clip pos="4" side="tl" part="lem"/>
                    <clip pos="4" side="tl" part="a_nom"/>
                    <clip pos="4" side="tl" part="gen"/>
                    <clip pos="4" side="tl" part="nbr"/>
                  </lu>
                </out>
              </when>
	      <otherwise>
               <out>
                  <lu>
                    <lit v="el"/>
                    <lit-tag v="det.def"/>
                    <clip pos="1" side="tl" part="gen"/>
                    <clip pos="1" side="tl" part="nbr"/>
                  </lu>
                 <b/>
                  <lu>
                    <clip pos="1" side="tl" part="lem"/>
                    <clip pos="1" side="tl" part="a_nom"/>
                    <clip pos="1" side="tl" part="gen"/>
                    <clip pos="1" side="tl" part="nbr"/>
                  </lu>
	           <b/>
                  <lu>
		    <lit v="cuyo"/>  
		    <lit-tag v="rel.aa"/>
                    <clip pos="4" side="tl" part="gen"/>
                    <clip pos="4" side="tl" part="nbr"/>
                  </lu>
                  <b/>
                  <lu>
                    <clip pos="4" side="tl" part="lem"/>
                    <clip pos="4" side="tl" part="a_nom"/>
                    <clip pos="4" side="tl" part="gen"/>
                    <clip pos="4" side="tl" part="nbr"/>
                  </lu>
                </out>
              </otherwise>
            </choose>
         </action>
    </rule> 


<!--REGLA DOI: NUMERAL NOM NUMERAL, o sigui la fecha 2 aprilie 2007 = 2 de abril de 2007 -->
    <rule>
      <pattern>
        <pattern-item n="num"/>
        <pattern-item n="meses"/>
        <pattern-item n="num"/>
      </pattern>
      <action>
      <call-macro n="f_modgen">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_concord1">
          <with-param pos="1"/>
        </call-macro>
         <call-macro n="f_modgen">
          <with-param pos="3"/>
        </call-macro>
        <call-macro n="f_concord1">
          <with-param pos="3"/>
        </call-macro>
            <out> 
	     <lu>
	       <get-case-from pos="1">
	         <clip pos="1" side="tl" part="whole"/>
		</get-case-from>
              </lu>
	      <b/>
              <lu> 
	       <lit v="de"/>
	       <lit-tag v="pr"/>
              </lu>
              <b/>
	      <lu>
	        <clip pos="2" side="tl" part="lem"/>
	        <clip pos="2" side="tl" part="a_nom"/>
                <clip pos="2" side="tl" part="gen"/>
                <clip pos="2" side="tl" part="nbr"/>
              </lu>
              <b/>
	      <lu> 
	       <lit v="de"/>
	       <lit-tag v="pr"/>
              </lu>
              <b/>
              <lu>
                <clip pos="3" side="tl" part="whole"/>
              </lu>
              <b/>
            </out>
      </action>
    </rule> 

        
    <!-- REGLA 63 : VERB + NOM + ADJ= VERB + NOM + ADJ-->
    <rule>
      <pattern>
        <pattern-item n="verb"/>
        <pattern-item n="nom"/>
	<pattern-item n="adj"/>
      </pattern>
      <action>
        <call-macro n="f_modgen">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_modgen">
          <with-param pos="2"/>
        </call-macro>
        <call-macro n="f_modgen">
          <with-param pos="3"/>
        </call-macro>
        <call-macro n="f_concord2">
          <with-param pos="2"/>
          <with-param pos="3"/> 
	</call-macro>
        <choose>
          <when>
            <test>
              <and>
                <equal>
                  <clip pos="2" side="sl" part="a_case"/>
                  <lit-tag v="nom"/>
                </equal>
                <equal>
                  <clip pos="2" side="sl" part="a_def"/>
                  <lit-tag v="def"/>
                </equal>
              </and>
            </test>
            <out>
              <lu>
                <clip pos="1" side="tl" part="lemh"/>
                <clip pos="1" side="tl" part="a_verb"/>
                <clip pos="1" side="tl" part="temps"/>
                <clip pos="1" side="tl" part="persona"/>
                <clip pos="1" side="tl" part="gen"/>
                <clip pos="1" side="tl" part="nbr"/>
              </lu>
              <b/>
              <lu>
                <lit v="el"/>
                <lit-tag v="det.def"/>
                <clip pos="2" side="tl" part="gen"/>
                <clip pos="2" side="tl" part="nbr"/>
              </lu>
              <b pos="1"/>
              <lu>
                <clip pos="2" side="tl" part="lem"/>
                <clip pos="2" side="tl" part="a_nom"/>
                <clip pos="2" side="tl" part="gen"/>
                <clip pos="2" side="tl" part="nbr"/>
              </lu>
	       <b pos="2"/>
               <lu>
                <clip pos="3" side="tl" part="lem"/>
                <clip pos="3" side="tl" part="a_adj"/>
                <clip pos="3" side="tl" part="gen"/>
                <clip pos="3" side="tl" part="nbr"/>
              </lu>
            </out>
           </when>
          <otherwise>
            <out>
              <lu>
                <clip pos="1" side="tl" part="lemh"/>
                <clip pos="1" side="tl" part="a_verb"/>
                <clip pos="1" side="tl" part="temps"/>
                <clip pos="1" side="tl" part="persona"/>
                <clip pos="1" side="tl" part="gen"/>
                <clip pos="1" side="tl" part="nbr"/>
              </lu>
              <b pos="1"/>
              <lu>
                <clip pos="2" side="tl" part="lem"/>
                <clip pos="2" side="tl" part="a_nom"/>
                <clip pos="2" side="tl" part="gen"/>
                <clip pos="2" side="tl" part="nbr"/>
              </lu>
	      <b pos="2"/>
              <lu>
                <clip pos="3" side="tl" part="lem"/>
                <clip pos="3" side="tl" part="a_adj"/>
                <clip pos="3" side="tl" part="gen"/>
                <clip pos="3" side="tl" part="nbr"/>
              </lu>
            </out>
          </otherwise>
        </choose>
      </action>
    </rule>
  

  <rule>
<!-- REGLA TREI DELIA: VERB NOM (det)+ DETIND + NOMDG -->
      <pattern>
        <pattern-item n="verb"/>        
        <pattern-item n="nom"/>
        <pattern-item n="det"/>
        <pattern-item n="nom"/>
      </pattern>
      <action>
        <call-macro n="f_modgen">
        <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_modgen">
        <with-param pos="3"/>
        </call-macro>
         <choose>
              <when>
                <test>
                  <and>
                  <equal>
                    <clip pos="2" side="sl" part="case"/>
                    <lit-tag v="nom"/>
                  </equal>
                  <equal>
                    <clip pos="2" side="sl" part="case"/>
                    <lit-tag v="def"/>
                  </equal>
                  <equal>
                    <clip pos="3" side="sl" part="case"/>
                    <lit-tag v="dg"/>
                  </equal>
                  <equal>
                    <clip pos="4" side="sl" part="case"/>
                    <lit-tag v="dg"/>
                  </equal>
                  <equal>
                    <clip pos="4" side="sl" part="case"/>
                    <lit-tag v="ind"/>
                  </equal>
                 </and>
                </test> 
               <out>
                  <lu>
		   <get-case-from pos="1">
                    <clip pos="1" side="tl" part="lem"/>
		   </get-case-from>
                   <clip pos="1" side="tl" part="a_verb"/>
                   <clip pos="1" side="tl" part="temps"/>
                   <clip pos="1" side="tl" part="persona"/>
                   <clip pos="1" side="tl" part="gen"/>
                   <clip pos="1" side="tl" part="nbr"/>
	           </lu>
                 <b/>
                 <lu> 
                    <lit v="el"/>
                    <lit-tag v="det.def"/>
                    <clip pos="2" side="tl" part="gen"/>
                    <clip pos="2" side="tl" part="nbr"/>
                  </lu>
                  <b/>
                  <lu>
                    <clip pos="2" side="tl" part="lem"/>
                    <clip pos="2" side="tl" part="a_nom"/>
                    <clip pos="2" side="tl" part="gen"/>
                    <clip pos="2" side="tl" part="nbr"/>
                  </lu>
                  <b/>
                  <lu>
		    <lit v="de"/>  
		    <lit-tag v="pr"/>
                  </lu>
                  <b/>
                  <lu>
                    <clip pos="3" side="tl" part="lem"/>
                    <clip pos="3" side="tl" part="a_det"/>	
                    <clip pos="3" side="sl" part="gen"/>
                    <clip pos="3" side="tl" part="nbr"/>
                  </lu>
	          <b/>
                 <lu>
                    <clip pos="4" side="tl" part="lem"/>
                    <clip pos="4" side="tl" part="a_nom"/>
                    <clip pos="4" side="tl" part="gen"/>
                    <clip pos="4" side="tl" part="nbr"/>
                  </lu>
                </out>
              </when>
             
	      <otherwise>
               <out>
                  <lu>
		   <get-case-from pos="1">
                    <clip pos="1" side="tl" part="lem"/>
		   </get-case-from>
                   <clip pos="1" side="tl" part="a_verb"/>
                   <clip pos="1" side="tl" part="temps"/>
                   <clip pos="1" side="tl" part="persona"/>
                   <clip pos="1" side="tl" part="gen"/>
                   <clip pos="1" side="tl" part="nbr"/>
	           </lu>
                 <b/>
                   <lu>
                    <lit v="el"/>
                    <lit-tag v="det.def"/>
                    <clip pos="2" side="tl" part="gen"/>
                    <clip pos="2" side="tl" part="nbr"/>
                  </lu>
                  <b/>
                  <lu>
                    <clip pos="2" side="tl" part="lem"/>
                    <clip pos="2" side="tl" part="a_nom"/>
                    <clip pos="2" side="tl" part="gen"/>
                    <clip pos="2" side="tl" part="nbr"/>
                  </lu>
	           <b/>
               <lu>
		    <lit v="de"/>  
		    <lit-tag v="pr"/>
                  </lu> 
                  <b/> 
                  <lu>
                    <clip pos="3" side="tl" part="lem"/>
                    <clip pos="3" side="tl" part="a_det"/>	
                    <clip pos="4" side="tl" part="gen"/>
                    <clip pos="4" side="tl" part="nbr"/>
                  </lu>
	          <b/>
                  <lu>
                    <clip pos="4" side="tl" part="lem"/>
                    <clip pos="4" side="tl" part="a_nom"/>
                    <clip pos="4" side="tl" part="gen"/>
                    <clip pos="4" side="tl" part="nbr"/>
                  </lu>
                </out>
              </otherwise>
           </choose>
         </action>
    </rule>   
  
 <rule>
   <!--  REGLA PATRU: NOM PROPI LLOC -->
      <pattern>
        <pattern-item n="nploc"/>
      </pattern>
      <action>  
        <call-macro n="f_concord1">
          <with-param pos="1"/>
        </call-macro>
        <choose>
          <when>
            <test>
                <equal>
                  <clip pos="1" side="sl" part="a_case"/>
                  <lit-tag v="nom"/>
                </equal>
              </test>
              <out>
                <lu>
		  <get-case-from pos="1">
                    <clip pos="1" side="tl" part="lem"/>
		  </get-case-from>  
                    <clip pos="1" side="tl" part="a_nploc"/>
                    <clip pos="1" side="tl" part="gen"/>
                    <clip pos="1" side="tl" part="nbr"/>
                  </lu>
                </out>
	      </when>
	    </choose>
           <choose>
          <when>
            <test>
              <and>
                <equal>
                  <clip pos="1" side="sl" part="a_def"/>
                  <lit-tag v="def"/>
                </equal>
                <equal>
                  <clip pos="1" side="sl" part="a_case"/>
                  <lit-tag v="dg"/>
                </equal>
              </and>
            </test>
	       <out>
                  <lu>
		    <lit v="a"/>
                    <lit-tag v="pr"/>
                  </lu>
                  <b/>
                  <lu>
                    <clip pos="1" side="tl" part="lem"/>
                    <clip pos="1" side="tl" part="a_nploc"/>
                    <clip pos="1" side="tl" part="gen"/>
                    <clip pos="1" side="tl" part="nbr"/>
                  </lu>
                </out>
		</when>
               <otherwise>
	       <choose>
              <when>
                <test>
		  <and>
                  <equal>
                    <clip pos="1" side="sl" part="a_def"/>
                    <lit-tag v="ind"/>
                  </equal>
                  <equal>
                    <clip pos="1" side="sl" part="a_case"/>
                    <lit-tag v="dg"/>
                  </equal>
                </and>
                </test>
                <out>
                  <lu>
                    <clip pos="1" side="tl" part="lem"/>
                    <clip pos="1" side="tl" part="a_nploc"/>
                    <clip pos="1" side="tl" part="gen"/>
                    <clip pos="1" side="tl" part="nbr"/>
                  </lu>
                </out>
              </when>
            </choose>
	   </otherwise> 
	   </choose>
       </action>
    </rule>	
    
     <!--REGLA CINCI DELIA: PREP PE + NOM PROPI -->
      <rule>
      <pattern>
        <pattern-item n="preppe"/>
        <pattern-item n="npant"/>
      </pattern>
       <action>
        <out>
           <lu>
	     <get-case-from pos="1">
	      <lit v="a"/> 
	     </get-case-from> 
              <lit-tag v="pr"/>
           </lu>
	   <b/>
           <lu>
              <clip pos="2" side="tl" part="lem"/>
              <clip pos="2" side="tl" part="a_npant"/>  
	      <clip pos="2" side="tl" part="gen"/>
            </lu>
         </out>
      </action>
    </rule>

    <rule>
<!-- REGLA SASE: FUTUR II  Per a traduir  "am sä fac" com a "faré" -->
      <pattern>
        <pattern-item n="avealex"/>
        <pattern-item n="conjsub"/>
<!--<Gemma pattern-item n="inf"/> el tagger tria malament, quan trie inf canviar verb per inf-->
        <pattern-item n="verb"/>
      </pattern>
      <action>
         <out>
          <lu>
            <get-case-from pos="1">
              <clip pos="3" side="tl" part="lemh"/>
            </get-case-from>
            <clip pos="3" side="tl" part="a_verb"/>
            <lit-tag v="fti"/>
            <clip pos="1" side="tl" part="persona"/>
            <clip pos="1" side="tl" part="nbr"/>
            <clip pos="3" side="tl" part="lemq"/>
          </lu>
        </out>
        <call-macro n="f_bcond">
          <with-param pos="1"/>
        </call-macro>
      </action>
    </rule>

    <rule>
<!-- REGLA SAPTE: FUTUR III  Per a traduir  "o sä fac/i/ä" com a "faré/ás/á" No funciona: TRIA "O" = det.ind-->
      <pattern>
        <pattern-item n="advo"/>
        <pattern-item n="conjsub"/>
        <pattern-item n="verb"/>
      </pattern>
      <action>
         <out>
          <lu>
            <get-case-from pos="1">
              <clip pos="3" side="tl" part="lemh"/>
            </get-case-from>
            <clip pos="3" side="tl" part="a_verb"/>
            <lit-tag v="fti"/>
            <clip pos="3" side="tl" part="persona"/>
            <clip pos="3" side="tl" part="nbr"/>
            <clip pos="3" side="tl" part="lemq"/>
          </lu>
        </out>
        <call-macro n="f_bcond">
          <with-param pos="1"/>
        </call-macro>
      </action>
    </rule>
    
     <!-- REGLA OPT DATIU: VERB + NOM + DETpos = VERB + A + DETpos + NOM -->
    <rule>
      <pattern>
        <pattern-item n="verb"/>
        <pattern-item n="nom"/>
	<pattern-item n="adjpos"/>
      </pattern>
      <action>
        <call-macro n="f_modgen">
        <with-param pos="3"/>
      </call-macro>
       <call-macro n="f_concord2">
         <with-param pos="2"/>
         <with-param pos="3"/>
       </call-macro>
       <choose>
	      <when>
	        <test>
		  <equal>
		   <clip pos="3" side="tl" part="lem"/>
                  <lit v="mío"/>
		  </equal>
		</test>  
		<let>
		  <clip pos="3" side="tl" part="gen"/>
                  <lit-tag v="mf"/>
		</let>
	       </when>
	   </choose>  
	   <choose> 
	       <when>
	        <test>
		  <equal>
		   <clip pos="3" side="tl" part="lem"/>
                  <lit v="tuyo"/>
		  </equal>
		</test>  
		<let>
		  <clip pos="3" side="tl" part="gen"/>
                  <lit-tag v="mf"/>
		</let>
	       </when> 
	     </choose>
	     <choose> 
		 <when>
	        <test>
		  <equal>
		   <clip pos="3" side="tl" part="lem"/>
                  <lit v="suyo"/>
		  </equal>
		</test>  
		<let>
		  <clip pos="3" side="tl" part="gen"/>
                  <lit-tag v="mf"/>
		</let>
	       </when> 
	   </choose>    
        <choose>
          <when>
            <test>
                <equal>
                  <clip pos="2" side="sl" part="a_case"/>
                  <lit-tag v="dg"/>
                </equal>
                </test>
            <out>
              <lu>
                <clip pos="1" side="tl" part="lemh"/>
                <clip pos="1" side="tl" part="a_verb"/>
                <clip pos="1" side="tl" part="temps"/>
                <clip pos="1" side="tl" part="persona"/>
		<clip pos="1" side="tl" part="gen"/>
                <clip pos="1" side="tl" part="nbr"/>
              </lu>
              <b/>
              <lu>
                <lit v="a"/>
                <lit-tag v="pr"/>
              </lu>
              <b/>
              <lu>
                <clip pos="3" side="tl" part="lem"/>
                <lit-tag v="det.pos"/>
                <clip pos="3" side="tl" part="gen"/>
                <clip pos="2" side="tl" part="nbr"/><!-- correcció de la elecció del desambiguador-->
              </lu>
	       <b/>
              <lu>
                <clip pos="2" side="tl" part="lem"/>
                <clip pos="2" side="tl" part="a_nom"/>
                <clip pos="2" side="tl" part="gen"/>
                <clip pos="2" side="tl" part="nbr"/>
              </lu>
            </out>
           </when>
          <otherwise>
            <out>
              <lu>
                <clip pos="1" side="tl" part="lemh"/>
                <clip pos="1" side="tl" part="a_verb"/>
                <clip pos="1" side="tl" part="temps"/>
                <clip pos="1" side="tl" part="persona"/>
		<clip pos="1" side="tl" part="gen"/>
                <clip pos="1" side="tl" part="nbr"/>
              </lu>
              <b/>
              <lu>
                <clip pos="3" side="tl" part="lem"/>
                <lit-tag v="det.pos"/>
                <clip pos="3" side="tl" part="gen"/>
                <clip pos="2" side="tl" part="nbr"/><!-- correcció de la elecció del desambiguador-->
              </lu>
	       <b/>
              <lu>
                <clip pos="2" side="tl" part="lem"/>
                <clip pos="2" side="tl" part="a_nom"/>
                <clip pos="2" side="tl" part="gen"/>
                <clip pos="2" side="tl" part="nbr"/>
              </lu>
            </out>
          </otherwise>
        </choose>
      </action>
    </rule> 
    
<rule>
<!-- REGLA NOUÄ: PREP + NOM + ADJECTIU_POSESSIU-->
      <pattern>
        <pattern-item n="prep"/>
        <pattern-item n="nom"/>
        <pattern-item n="adjpos"/>
      </pattern>
       <action>  
        <call-macro n="f_modgen">
          <with-param pos="3"/>
        </call-macro>
        <call-macro n="f_concord2">
          <with-param pos="2"/>
          <with-param pos="3"/> 
	</call-macro>
	<call-macro n="modcase">
          <with-param pos="1"/>
        </call-macro>
           <choose>
	      <when>
	        <test>
		  <equal>
		   <clip pos="3" side="tl" part="lem"/>
                  <lit v="mío"/>
		  </equal>
		</test>  
		<let>
		  <clip pos="3" side="tl" part="gen"/>
                  <lit-tag v="mf"/>
		</let>
	       </when>
	   </choose>  
	   <choose> 
	       <when>
	        <test>
		  <equal>
		   <clip pos="3" side="tl" part="lem"/>
                  <lit v="tuyo"/>
		  </equal>
		</test>  
		<let>
		  <clip pos="3" side="tl" part="gen"/>
                  <lit-tag v="mf"/>
		</let>
	       </when> 
	     </choose>
	     <choose> 
		 <when>
	        <test>
		  <equal>
		   <clip pos="3" side="tl" part="lem"/>
                  <lit v="suyo"/>
		  </equal>
		</test>  
		<let>
		  <clip pos="3" side="tl" part="gen"/>
                  <lit-tag v="mf"/>
		</let>
	       </when>
               </choose> 
	   <!--  <choose>
          <when>
            <test>
               <equal>
                  <clip pos="2" side="sl" part="a_case"/>
                  <lit-tag v="nom"/>
                </equal>
             </test> -->
             <out>
	          <lu>
		  <get-case-from pos="1">
		    <clip pos="1" side="tl" part="lem"/>
		    </get-case-from>
                    <clip pos="1" side="tl" part="a_prep"/>
                  </lu>
		  <b/>
                  <lu>
		    <clip pos="3" side="tl" part="lem"/>
		    <lit-tag v="det.pos"/>
                    <clip pos="3" side="tl" part="gen"/>
                    <clip pos="2" side="tl" part="nbr"/><!-- correcció de la elecció del desambiguador-->
                  </lu>
		  <b/>
                  <lu>
                    <clip pos="2" side="tl" part="lem"/>
                    <clip pos="2" side="tl" part="a_nom"/>
                    <clip pos="2" side="tl" part="gen"/>
                    <clip pos="2" side="tl" part="nbr"/>
                  </lu>
             </out>    
       </action>
    </rule>


 <!--REGLA ZECE DELIA: PREP PE + PRONOM - PREP A + PRON-->
      <rule>
      <pattern>
        <pattern-item n="preppe"/>
        <pattern-item n="prn"/>
      </pattern>
       <action>
      <choose>
       <when>
         <test>
           <equal>
	      <clip pos="1" side="sl" part="lem"/>
		<lit v="pe"/>
	   </equal>                        
	</test> 
        <out>
           <lu>
	     <get-case-from pos="1">
	      <lit v="a"/> 
	     </get-case-from> 
              <lit-tag v="pr"/>
           </lu>
	   <b/>
           <lu>
              <clip pos="2" side="tl" part="lem"/>
              <clip pos="2" side="tl" part="a_prn"/>  
	      <clip pos="2" side="tl" part="gen"/>
              <clip pos="2" side="tl" part="nbr"/>
            </lu>
         </out>
         </when>
         <otherwise>
	     <out>
		<lu>
		  <get-case-from pos="1">
		    <clip pos="1" side="tl" part="lem"/>
		    </get-case-from>
                    <clip pos="1" side="tl" part="a_prep"/>
                  </lu>
		  <b/>
		  <lu>
                    <clip pos="2" side="tl" part="lem"/>
                    <clip pos="2" side="tl" part="a_prn"/>
                    <clip pos="2" side="tl" part="gen"/>
                    <clip pos="2" side="tl" part="nbr"/>
                  </lu>
                </out>
            </otherwise>
          </choose>
      </action>
    </rule>

  <!--REGLA 11 DELIA: PREP PE + DET - PREP A + DET-->
      <rule>
      <pattern>
        <pattern-item n="preppe"/>
        <pattern-item n="det"/>
      </pattern>
       <action>
      <choose>
       <when>
         <test>
           <equal>
	      <clip pos="1" side="sl" part="lem"/>
		<lit v="pe"/>
	   </equal>                        
	</test> 
        <out>
           <lu>
	     <get-case-from pos="1">
	      <lit v="a"/> 
	     </get-case-from> 
              <lit-tag v="pr"/>
           </lu>
	   <b/>
           <lu>
              <clip pos="2" side="tl" part="lem"/>
              <clip pos="2" side="tl" part="a_det"/>  
	      <clip pos="2" side="tl" part="gen"/>
              <clip pos="2" side="tl" part="nbr"/>
            </lu>
         </out>
         </when>
         <otherwise>
	     <out>
		<lu>
		  <get-case-from pos="1">
		    <clip pos="1" side="tl" part="lem"/>
		    </get-case-from>
                    <clip pos="1" side="tl" part="a_prep"/>
                  </lu>
		  <b/>
		  <lu>
                    <clip pos="2" side="tl" part="lem"/>
                    <clip pos="2" side="tl" part="a_det"/>
                    <clip pos="2" side="tl" part="gen"/>
                    <clip pos="2" side="tl" part="nbr"/>
                  </lu>
                </out>
            </otherwise>
          </choose>
      </action>
    </rule>

<!--REGLA 12 DELIA: VERB + PREP + NOM DEFINIT NOMINATIU + NOM DG = VERB + PREP + ART + NOM + DE +NOM pune pe coperta cärñii = pone en la portada del libro-->
      <rule>
      <pattern>
        <pattern-item n="verb"/>
        <pattern-item n="prep"/>
        <pattern-item n="nom"/>
        <pattern-item n="nom"/>
      </pattern>
       <action>
       <call-macro n="f_modgen">
        <with-param pos="1"/>
      </call-macro>
       <call-macro n="f_concord1">
          <with-param pos="3"/>
        </call-macro>
        <call-macro n="f_concord1">
          <with-param pos="4"/>
        </call-macro>
         <choose>
          <when>
            <test>
              <and>
                <equal>
                  <clip pos="3" side="sl" part="a_def"/>
                  <lit-tag v="def"/>
                </equal>
                <equal>
                  <clip pos="3" side="sl" part="a_case"/>
                  <lit-tag v="nom"/>
                </equal>
              </and>
              <and>
                <equal>
                  <clip pos="4" side="sl" part="a_def"/>
                  <lit-tag v="def"/>
                </equal>
                <equal>
                  <clip pos="4" side="sl" part="a_case"/>
                  <lit-tag v="dg"/>
                </equal>
              </and>
            </test>
	   <out>
                 <lu>
		  <get-case-from pos="1">
		    <clip pos="1" side="tl" part="lem"/>
		    </get-case-from>
                    <clip pos="1" side="tl" part="a_verb"/>
                    <clip pos="1" side="tl" part="temps"/>
                    <clip pos="1" side="tl" part="persona"/>
                    <clip pos="1" side="tl" part="gen"/>
                    <clip pos="1" side="tl" part="nbr"/>
	         </lu>
                 <b/>
                 <lu>
                    <clip pos="2" side="tl" part="lem"/>
                    <clip pos="2" side="tl" part="a_prep"/>
                 </lu>
		  <b/>
		  <lu>
                    <lit v="el"/>
		    <lit-tag v="det.def"/>
                    <clip pos="3" side="tl" part="gen"/>
                    <clip pos="3" side="tl" part="nbr"/>
                  </lu>
                  <b/>
                  <lu>
                    <clip pos="3" side="tl" part="lem"/>
                    <clip pos="3" side="tl" part="a_nom"/>
                    <clip pos="3" side="tl" part="gen"/>
                    <clip pos="3" side="tl" part="nbr"/>
                  </lu>
                  <b/>
                  <lu>
                   <lit v="de"/>		   
                    <lit-tag v="pr"/>
                   </lu>
                  <b/> 
                  <lu>
                   <lit v="el"/>		   
                    <lit-tag v="det.def"/>
                    <clip pos="4" side="tl" part="gen"/>
                    <clip pos="4" side="tl" part="nbr"/>
                  </lu>
                  <b/>
                  <lu>
                    <clip pos="4" side="tl" part="lem"/>
                    <clip pos="4" side="tl" part="a_nom"/>
                    <clip pos="4" side="tl" part="gen"/>
                    <clip pos="4" side="tl" part="nbr"/>
                  </lu> 
                </out>
              </when>
		<otherwise>
		<out>
                 <lu>
		    <clip pos="1" side="tl" part="lem"/>
                    <clip pos="1" side="tl" part="a_verb"/>
                    <clip pos="1" side="tl" part="temps"/>
                    <clip pos="1" side="tl" part="persona"/>
                    <clip pos="1" side="tl" part="gen"/>
                    <clip pos="1" side="tl" part="nbr"/>
	         </lu>
                 <b/>
                 <lu>
                    <clip pos="2" side="tl" part="lem"/>
                    <clip pos="2" side="tl" part="a_prep"/>
                 </lu>
                  <b/>
                  <lu>
                    <clip pos="3" side="tl" part="lem"/>
                    <clip pos="3" side="tl" part="a_nom"/>
                    <clip pos="3" side="tl" part="gen"/>
                    <clip pos="3" side="tl" part="nbr"/>
                  </lu>
                  <b/>
                  <lu>
                   <lit v="el"/>		   
                    <lit-tag v="det.def"/>
                    <clip pos="4" side="tl" part="gen"/>
                    <clip pos="4" side="tl" part="nbr"/>
                  </lu>
                  <b/>
                  <lu>
                    <clip pos="4" side="tl" part="lem"/>
                    <clip pos="4" side="tl" part="a_nom"/>
                    <clip pos="4" side="tl" part="gen"/>
                    <clip pos="4" side="tl" part="nbr"/>
                  </lu> 
                </out>
              </otherwise>
             </choose>
           </action>
    </rule>  

   <!--REGLA 13 DELIA: PREP + NOM DEFINIT NOMINATIU + NOM DG = PREP + ART + NOM + DE +NOM pe coperta cärñii = en la portada del libro-->
      <rule>
      <pattern>
        <pattern-item n="prep"/>
        <pattern-item n="nom"/>
        <pattern-item n="nom"/>
      </pattern>
       <action>
       <call-macro n="f_concord1">
          <with-param pos="2"/>
        </call-macro>
        <call-macro n="f_concord1">
          <with-param pos="3"/>
        </call-macro>
         <choose>
          <when>
            <test>
              <and>
                <equal>
                  <clip pos="2" side="sl" part="a_def"/>
                  <lit-tag v="def"/>
                </equal>
                <equal>
                  <clip pos="2" side="sl" part="a_case"/>
                  <lit-tag v="nom"/>
                </equal>
              </and>
              <and>
                <equal>
                  <clip pos="3" side="sl" part="a_def"/>
                  <lit-tag v="def"/>
                </equal>
                <equal>
                  <clip pos="3" side="sl" part="a_case"/>
                  <lit-tag v="dg"/>
                </equal>
              </and>
            </test>
	   <out>
                <lu>
		  <get-case-from pos="1">
		    <clip pos="1" side="tl" part="lem"/>
		    </get-case-from>
                    <clip pos="1" side="tl" part="a_prep"/>
                  </lu>
		  <b/>
		  <lu>
                    <lit v="el"/>
		    <lit-tag v="det.def"/>
                    <clip pos="2" side="tl" part="gen"/>
                    <clip pos="2" side="tl" part="nbr"/>
                  </lu>
                  <b/>
                  <lu>
                    <clip pos="2" side="tl" part="lem"/>
                    <clip pos="2" side="tl" part="a_nom"/>
                    <clip pos="2" side="tl" part="gen"/>
                    <clip pos="2" side="tl" part="nbr"/>
                  </lu>
                  <b/>
                  <lu>
                   <lit v="de"/>		   
                    <lit-tag v="pr"/>
                   </lu>
                  <b/> 
                  <lu>
                   <lit v="el"/>		   
                    <lit-tag v="det.def"/>
                    <clip pos="3" side="tl" part="gen"/>
                    <clip pos="3" side="tl" part="nbr"/>
                  </lu>
                  <b/>
                  <lu>
                    <clip pos="3" side="tl" part="lem"/>
                    <clip pos="3" side="tl" part="a_nom"/>
                    <clip pos="3" side="tl" part="gen"/>
                    <clip pos="3" side="tl" part="nbr"/>
                  </lu> 
                </out>
              </when>
             </choose>
           </action>
    </rule>

 <!--REGLA 14: PREP + NOM INDEFINIT = PREP + ART + NOM -->
      <rule>
      <pattern>
        <pattern-item n="prep"/>
        <pattern-item n="nom"/>
      </pattern>
       <action>
       <call-macro n="f_concord1">
          <with-param pos="2"/>
        </call-macro>
        <choose>
	     <when>
               <test>
		<not>
                 <or>
	          <equal>
	            <clip pos="1" side="sl" part="lem"/>
		    <lit v="de"/>
	          </equal>
                  <equal>
	            <clip pos="1" side="sl" part="lem"/>
		    <lit v="färä"/>
	          </equal>
		</or>
		</not>              
	     </test> 
             <out>
                <lu>
		  <get-case-from pos="1">
		    <clip pos="1" side="tl" part="lem"/>
		    </get-case-from>
                    <clip pos="1" side="tl" part="a_prep"/>
                  </lu>
		  <b/>
		  <lu>
                    <lit v="el"/>
		    <lit-tag v="det.def"/>
                    <clip pos="2" side="tl" part="gen"/>
                    <clip pos="2" side="tl" part="nbr"/>
                  </lu>
                  <b/>
                  <lu>
                    <clip pos="2" side="tl" part="lem"/>
                    <clip pos="2" side="tl" part="a_nom"/>
                    <clip pos="2" side="tl" part="gen"/>
                    <clip pos="2" side="tl" part="nbr"/>
                  </lu>
                </out>
</when>
<otherwise>
	     <out>
		<lu>
		  <get-case-from pos="1">
		    <clip pos="1" side="tl" part="lem"/>
		    </get-case-from>
                    <clip pos="1" side="tl" part="a_prep"/>
                  </lu>
		  <b/>
		  <lu>
                    <clip pos="2" side="tl" part="lem"/>
                    <clip pos="2" side="tl" part="a_nom"/>
                    <clip pos="2" side="tl" part="gen"/>
                    <clip pos="2" side="tl" part="nbr"/>
                  </lu>
                </out>
            </otherwise>
         </choose>
         
        </action>
    </rule>


 <!--REGLA 15 DELIA: PREP + NOM DEFINIT/INDEFINIT + ADJ = PREP + ART + NOM + ADJ în casa minunatä = en la casa maravillosa-->
      <rule>
      <pattern>
        <pattern-item n="prep"/>
        <pattern-item n="nom"/>
        <pattern-item n="adj"/>
      </pattern>
       <action>       
      <call-macro n="f_modgen">
        <with-param pos="3"/>
      </call-macro>       
       <call-macro n="f_concord2">
          <with-param pos="2"/>
          <with-param pos="3"/> 
	</call-macro> 
         <choose>
          <when>
            <test>
                <and>
                <equal>
                  <clip pos="2" side="sl" part="a_def"/>
                  <lit-tag v="def"/>
                </equal>
                <equal>
                  <clip pos="2" side="sl" part="a_case"/>
                  <lit-tag v="nom"/>
                </equal>
                </and>
            </test>
	   <out>
                <lu>
		  <get-case-from pos="1">
		    <clip pos="1" side="tl" part="lem"/>
		    </get-case-from>
                    <clip pos="1" side="tl" part="a_prep"/>
                  </lu>
		  <b/>
		  <lu>
                    <lit v="el"/>
		    <lit-tag v="det.def"/>
                    <clip pos="2" side="tl" part="gen"/>
                    <clip pos="2" side="tl" part="nbr"/>
                  </lu>
                  <b/>
                  <lu>
                    <clip pos="2" side="tl" part="lem"/>
                    <clip pos="2" side="tl" part="a_nom"/>
                    <clip pos="2" side="tl" part="gen"/>
                    <clip pos="2" side="tl" part="nbr"/>
                  </lu>
                  <b/>
                  <lu>
                    <clip pos="3" side="tl" part="lem"/>
                    <clip pos="3" side="tl" part="a_adj"/>
                    <clip pos="3" side="tl" part="gen"/>
                    <clip pos="3" side="tl" part="nbr"/>
                  </lu> 
                </out>
              </when>
             <when>
             <test>
               <and>
                <equal>
                  <clip pos="2" side="sl" part="a_def"/>
                  <lit-tag v="def"/>
                </equal>
                <equal>
                  <clip pos="2" side="sl" part="a_case"/>
                  <lit-tag v="dg"/>
                </equal>
               </and>
            </test>
	   <out>
                <lu>
		  <get-case-from pos="1">
		    <clip pos="1" side="tl" part="lem"/>
		    </get-case-from>
                    <clip pos="1" side="tl" part="a_prep"/>
                  </lu>
		  <b/>
                <!--  <lu>
                    <lit v="de"/>
		    <lit-tag v="prep"/>
                  </lu>
                  <b/> -->
		  <lu>
                    <lit v="el"/>
		    <lit-tag v="det.def"/>
                    <clip pos="2" side="tl" part="gen"/>
                    <clip pos="2" side="tl" part="nbr"/>
                  </lu>
                  <b/>
                  <lu>
                    <clip pos="2" side="tl" part="lem"/>
                    <clip pos="2" side="tl" part="a_nom"/>
                    <clip pos="2" side="tl" part="gen"/>
                    <clip pos="2" side="tl" part="nbr"/>
                  </lu>
                  <b/>
                  <lu>
                    <clip pos="3" side="tl" part="lem"/>
                    <clip pos="3" side="tl" part="a_adj"/>
                    <clip pos="3" side="tl" part="gen"/>
                    <clip pos="3" side="tl" part="nbr"/>
                  </lu> 
                </out>
              </when>           
             <otherwise>
            <choose>
              <when>
                <test>
                  <equal>
                    <clip pos="2" side="sl" part="a_def"/>
                    <lit-tag v="ind"/>
                  </equal>
                </test>
                <out>
                <lu>
		  <get-case-from pos="1">
		    <clip pos="1" side="tl" part="lem"/>
		    </get-case-from>
                    <clip pos="1" side="tl" part="a_prep"/>
                  </lu>
		  <b/>
                  <lu>
                    <clip pos="2" side="tl" part="lem"/>
                    <clip pos="2" side="tl" part="a_nom"/>
                    <clip pos="2" side="tl" part="gen"/>
                    <clip pos="2" side="tl" part="nbr"/>
                  </lu>
                  <b/>
                  <lu>
                    <clip pos="3" side="tl" part="lem"/>
                    <clip pos="3" side="tl" part="a_adj"/>
                    <clip pos="3" side="tl" part="gen"/>
                    <clip pos="3" side="tl" part="nbr"/>
                  </lu> 
                </out>                
              </when>
              </choose>            
            </otherwise>
          </choose>
         </action>
    </rule>

    
<!--REGLA 16 DELIA: PREP + NOM DEFINIT/INDEFINIT + ADJ1 + ADJ2 = PREP + ART + NOM + ADJ1 + ADJ 2  în casa micä minunatä  = en la casa pequeña maravillosa  SI NO; NO FA CONCORDANÇA MÚLTIPLE-->
      <rule>
      <pattern>
        <pattern-item n="prep"/>
        <pattern-item n="nom"/>
        <pattern-item n="adj"/>
        <pattern-item n="adj"/>
      </pattern>
       <action>
      <call-macro n="f_modgen">
        <with-param pos="3"/>
      </call-macro>
      <call-macro n="f_modgen">
        <with-param pos="4"/>
      </call-macro>       
       <call-macro n="f_concord3">
          <with-param pos="2"/>
          <with-param pos="3"/>
          <with-param pos="4"/>
	</call-macro> 
         <choose>
          <when>
            <test>
              <and>
                <equal>
                  <clip pos="2" side="sl" part="a_def"/>
                  <lit-tag v="def"/>
                </equal>
                <equal>
                  <clip pos="2" side="sl" part="a_case"/>
                  <lit-tag v="nom"/>
                </equal>
              </and>
              <and>
                <equal>
                  <clip pos="3" side="sl" part="a_def"/>
                  <lit-tag v="def"/>
                </equal>
                <equal>
                  <clip pos="3" side="sl" part="a_case"/>
                  <lit-tag v="dg"/>
                </equal>
              </and>
            </test>
	   <out>
                <lu>
		  <get-case-from pos="1">
		    <clip pos="1" side="tl" part="lem"/>
		    </get-case-from>
                    <clip pos="1" side="tl" part="a_prep"/>
                  </lu>
		  <b/>
		  <lu>
                    <lit v="el"/>
		    <lit-tag v="det.def"/>
                    <clip pos="2" side="tl" part="gen"/>
                    <clip pos="2" side="tl" part="nbr"/>
                  </lu>
                  <b/>
                  <lu>
                    <clip pos="2" side="tl" part="lem"/>
                    <clip pos="2" side="tl" part="a_nom"/>
                    <clip pos="2" side="tl" part="gen"/>
                    <clip pos="2" side="tl" part="nbr"/>
                  </lu>
                  <b/>
                  <lu>
                    <clip pos="3" side="tl" part="lem"/>
                    <clip pos="3" side="tl" part="a_adj"/>
                    <clip pos="3" side="tl" part="gen"/>
                    <clip pos="3" side="tl" part="nbr"/>
                  </lu>
                  <b/>
                  <lu>
                    <clip pos="4" side="tl" part="lem"/>
                    <clip pos="4" side="tl" part="a_adj"/>
                    <clip pos="4" side="tl" part="gen"/>
                    <clip pos="4" side="tl" part="nbr"/>
                  </lu>
                </out>
              </when>                         
             <otherwise>
            <choose>
              <when>
                <test>
                  <equal>
                    <clip pos="2" side="sl" part="a_def"/>
                    <lit-tag v="ind"/>
                  </equal>
                </test>
                <out>
                <lu>
		  <get-case-from pos="1">
		    <clip pos="1" side="tl" part="lem"/>
		    </get-case-from>
                    <clip pos="1" side="tl" part="a_prep"/>
                  </lu>
		  <b/>
                  <lu>
                    <clip pos="2" side="tl" part="lem"/>
                    <clip pos="2" side="tl" part="a_nom"/>
                    <clip pos="2" side="tl" part="gen"/>
                    <clip pos="2" side="tl" part="nbr"/>
                  </lu>
                  <b/>
                  <lu>
                    <clip pos="3" side="tl" part="lem"/>
                    <clip pos="3" side="tl" part="a_adj"/>
                    <clip pos="3" side="tl" part="gen"/>
                    <clip pos="3" side="tl" part="nbr"/>
                  </lu> 
                  <b/>
                  <lu>
                    <clip pos="4" side="tl" part="lem"/>
                    <clip pos="4" side="tl" part="a_adj"/>
                    <clip pos="4" side="tl" part="gen"/>
                    <clip pos="4" side="tl" part="nbr"/>
                  </lu>                   
                </out>                
              </when>
              </choose>            
            </otherwise>
          </choose>
         </action>
    </rule>
    
<!--REGLA 17 DELIA: PREP + NOM DEFINIT/INDEFINIT + ADJ1 + ADJ2 + ADJ3= PREP + ART + NOM + ADJ1 + ADJ 2 + ADJ 3 în casa micä minunatä ieftinä  = en la casa pequeña maravillosa barata SI NO; NO FA CONCORDANÇA MÚLTIPLE-->
      <rule>
      <pattern>
        <pattern-item n="prep"/>
        <pattern-item n="nom"/>
        <pattern-item n="adj"/>
        <pattern-item n="adj"/>
        <pattern-item n="adj"/>
      </pattern>
       <action>
      <call-macro n="f_modgen">
        <with-param pos="3"/>
      </call-macro>  
      <call-macro n="f_modgen">
        <with-param pos="4"/>
      </call-macro>
      <call-macro n="f_modgen">
        <with-param pos="5"/>
      </call-macro>          
       <call-macro n="f_concord4">
          <with-param pos="2"/>
          <with-param pos="3"/>
          <with-param pos="4"/>  
          <with-param pos="5"/>  
	</call-macro> 
         <choose>
          <when>
            <test>
              <and>
                <equal>
                  <clip pos="2" side="sl" part="a_def"/>
                  <lit-tag v="def"/>
                </equal>
                <equal>
                  <clip pos="2" side="sl" part="a_case"/>
                  <lit-tag v="nom"/>
                </equal>
              </and>
              <and>
                <equal>
                  <clip pos="3" side="sl" part="a_def"/>
                  <lit-tag v="def"/>
                </equal>
                <equal>
                  <clip pos="3" side="sl" part="a_case"/>
                  <lit-tag v="dg"/>
                </equal>
              </and>
            </test>
	   <out>
                <lu>
		  <get-case-from pos="1">
		    <clip pos="1" side="tl" part="lem"/>
		    </get-case-from>
                    <clip pos="1" side="tl" part="a_prep"/>
                  </lu>
		  <b/>
		  <lu>
                    <lit v="el"/>
		    <lit-tag v="det.def"/>
                    <clip pos="2" side="tl" part="gen"/>
                    <clip pos="2" side="tl" part="nbr"/>
                  </lu>
                  <b/>
                  <lu>
                    <clip pos="2" side="tl" part="lem"/>
                    <clip pos="2" side="tl" part="a_nom"/>
                    <clip pos="2" side="tl" part="gen"/>
                    <clip pos="2" side="tl" part="nbr"/>
                  </lu>
                  <b/>
                  <lu>
                    <clip pos="3" side="tl" part="lem"/>
                    <clip pos="3" side="tl" part="a_adj"/>
                    <clip pos="3" side="tl" part="gen"/>
                    <clip pos="3" side="tl" part="nbr"/>
                  </lu>
                  <b/>
                  <lu>
                    <clip pos="4" side="tl" part="lem"/>
                    <clip pos="4" side="tl" part="a_adj"/>
                    <clip pos="4" side="tl" part="gen"/>
                    <clip pos="4" side="tl" part="nbr"/>
                  </lu>  
                  <b/>
                  <lu>
                    <clip pos="5" side="tl" part="lem"/>
                    <clip pos="5" side="tl" part="a_adj"/>
                    <clip pos="5" side="tl" part="gen"/>
                    <clip pos="5" side="tl" part="nbr"/>
                  </lu>  
                </out>
              </when>                         
             <otherwise>
            <choose>
              <when>
                <test>
                  <equal>
                    <clip pos="2" side="sl" part="a_def"/>
                    <lit-tag v="ind"/>
                  </equal>
                </test>
                <out>
                <lu>
		  <get-case-from pos="1">
		    <clip pos="1" side="tl" part="lem"/>
		    </get-case-from>
                    <clip pos="1" side="tl" part="a_prep"/>
                  </lu>
		  <b/>
                  <lu>
                    <clip pos="2" side="tl" part="lem"/>
                    <clip pos="2" side="tl" part="a_nom"/>
                    <clip pos="2" side="tl" part="gen"/>
                    <clip pos="2" side="tl" part="nbr"/>
                  </lu>
                  <b/>
                  <lu>
                    <clip pos="3" side="tl" part="lem"/>
                    <clip pos="3" side="tl" part="a_adj"/>
                    <clip pos="3" side="tl" part="gen"/>
                    <clip pos="3" side="tl" part="nbr"/>
                  </lu> 
                  <b/>
                  <lu>
                    <clip pos="4" side="tl" part="lem"/>
                    <clip pos="4" side="tl" part="a_adj"/>
                    <clip pos="4" side="tl" part="gen"/>
                    <clip pos="4" side="tl" part="nbr"/>
                  </lu> 
                  <b/>
                  <lu>
                    <clip pos="5" side="tl" part="lem"/>
                    <clip pos="5" side="tl" part="a_adj"/>
                    <clip pos="5" side="tl" part="gen"/>
                    <clip pos="5" side="tl" part="nbr"/>
                  </lu> 
                </out>                
              </when>
              </choose>            
            </otherwise>
          </choose>
         </action>
    </rule>
	<!-- <rule>  
    <!-*- REGLA 4: NOM PROPI ALTRES-*->
      <pattern>
        <pattern-item n="npal"/>
      </pattern>
      <action>  
        <call-macro n="f_concord1">
          <with-param pos="1"/>
        </call-macro>
        <choose>
          <when>
            <test>
              <and>
                <equal>
                  <clip pos="1" side="sl" part="a_def"/>
                  <lit-tag v="def"/>
                </equal>
                <equal>
                  <clip pos="1" side="sl" part="a_case"/>
                  <lit-tag v="nom"/>
                </equal>
              </and>
            </test>
            <choose>
              <when>
                <test>
                  <equal>
                    <clip pos="1" side="tl" part="gen"/>
                    <lit-tag v="mf"/>
                  </equal>
                </test>
                <out>
                  <lu>
		  <get-case-from pos="1">
                    <lit v="el"/>
		   </get-case-from>   
                    <lit-tag v="det.def"/>
                    <clip pos="1" side="sl" part="gen"/>
                    <clip pos="1" side="sl" part="nbr"/>
                  </lu>
                  <b/>
                  <lu>
                    <clip pos="1" side="tl" part="lem"/>
                    <clip pos="1" side="tl" part="a_npal"/>
                    <clip pos="1" side="tl" part="gen"/>
                    <clip pos="1" side="tl" part="nbr"/>
                  </lu>
                </out>
              </when>
              <otherwise>
	      <out>
                  <lu>
		   <get-case-from pos="1"> 
                    <lit v="el"/>
		   </get-case-from> 
                    <lit-tag v="det.def"/>
                    <clip pos="1" side="tl" part="gen"/>
                    <clip pos="1" side="sl" part="nbr"/>
                  </lu>
                  <b/>
                  <lu>
                    <clip pos="1" side="tl" part="lem"/>
                    <clip pos="1" side="tl" part="a_npal"/>
                    <clip pos="1" side="tl" part="gen"/>
                    <clip pos="1" side="tl" part="nbr"/>
                  </lu>
                </out>
              </otherwise>
            </choose>
          </when>
          <otherwise>
            <choose>
              <when>
                <test>
		  <and>
                  <equal>
                    <clip pos="1" side="sl" part="a_def"/>
                    <lit-tag v="ind"/>
                  </equal>
                  <equal>
                    <clip pos="1" side="sl" part="a_case"/>
                    <lit-tag v="nom"/>
                  </equal>
                </and>
                </test>
                <out>
                  <lu>
                    <clip pos="1" side="tl" part="lem"/>
                    <clip pos="1" side="tl" part="a_npal"/>
                    <clip pos="1" side="tl" part="gen"/>
                    <clip pos="1" side="tl" part="nbr"/>
                  </lu>
                </out>
              </when>
            </choose>
          </otherwise>
        </choose>
	<choose>
          <when>
            <test>
              <and>
                <equal>
                  <clip pos="1" side="sl" part="a_def"/>
                  <lit-tag v="def"/>
                </equal>
                <equal>
                  <clip pos="1" side="sl" part="a_case"/>
                  <lit-tag v="dg"/>
                </equal>
              </and>
            </test>
	    <choose>
              <when>
                <test>
                  <equal>
                    <clip pos="1" side="tl" part="gen"/>
                    <lit-tag v="mf"/>
                  </equal>
                </test>
                <out>
                  <lu>
		  <get-case-from pos="1">
                    <lit v="de"/>
		  </get-case-from>  
                    <lit-tag v="pr"/>
                  </lu>
                  <b/>
                  <lu>
                    <lit v="el"/>
                    <lit-tag v="det.def"/>
                    <clip pos="1" side="sl" part="gen"/>
                    <clip pos="1" side="sl" part="nbr"/>
                  </lu>
                  <b/>
                  <lu>
                    <clip pos="1" side="tl" part="lem"/>
                    <clip pos="1" side="tl" part="a_npal"/>
                    <clip pos="1" side="tl" part="gen"/>
                    <clip pos="1" side="tl" part="nbr"/>
                  </lu>
                </out>
              </when>
	        <otherwise>
                <out>
                  <lu>
		  <get-case-from pos="1">
                    <lit v="de"/>
		  </get-case-from>  
                    <lit-tag v="pr"/>
                  </lu>
                  <b/>
                  <lu>
                    <lit v="el"/>
                    <lit-tag v="det.def"/>
                    <clip pos="1" side="tl" part="gen"/>
                    <clip pos="1" side="sl" part="nbr"/>
                  </lu>
                  <b/>
                  <lu>
                    <clip pos="1" side="tl" part="lem"/>
                    <clip pos="1" side="tl" part="a_npal"/>
                    <clip pos="1" side="tl" part="gen"/>
                    <clip pos="1" side="tl" part="nbr"/>
                  </lu>
                </out>
              </otherwise>
            </choose>
          </when>
          <otherwise>
	    <choose>
	      <when>
                <test>
		  <and>
                  <equal>
                    <clip pos="1" side="sl" part="a_def"/>
                    <lit-tag v="ind"/>
                  </equal>
                  <equal>
                    <clip pos="1" side="sl" part="a_case"/>
                    <lit-tag v="dg"/>
                  </equal>
                </and>
                </test>
                <out>  
                  <lu>
                    <clip pos="1" side="tl" part="lem"/>
                    <clip pos="1" side="tl" part="a_npal"/>
                    <clip pos="1" side="tl" part="gen"/>
                    <clip pos="1" side="tl" part="nbr"/>
                  </lu>
                </out>
              </when>
	    </choose>  
	  </otherwise> 
        </choose>
      </action>
    </rule> -->
     
     
     <rule>
 <!--    REGLA 18: DETERMINANT--> 
      <pattern>
        <pattern-item n="det"/>
      </pattern>
      <action>
       <call-macro n="f_modgen">
        <with-param pos="1"/>
       </call-macro>
       <call-macro n="f_concord1">
        <with-param pos="1"/>
        </call-macro>
	    <choose>
	     <when>
	      <test>
	       <equal>
	        <clip pos="1" side="tl" part="a_case"/>
		<lit-tag v="dg"/>
	       </equal>
	     </test> 
	     <call-macro n="modcase">
               <with-param pos="1"/>
              </call-macro>   
             <out>
	      <lu>
	       <get-case-from pos="1">
	       <lit v="de"/>
	       </get-case-from>
	       <lit-tag v="pr"/>
	      </lu>
	      <b/>
	      <lu>
                <clip pos="1" side="tl" part="lem"/>
                <clip pos="1" side="tl" part="a_det"/>
                <clip pos="1" side="tl" part="gen"/>
                <clip pos="1" side="tl" part="nbr"/>
              </lu>
             </out>
	    </when> 
	   <otherwise>
	    <choose>
	     <when>
	      <test>
	       <equal>
	        <clip pos="1" side="tl" part="a_case"/>
		<lit-tag v="nom"/>
	       </equal>
	     </test>  
             <out>
	      <lu>
                <clip pos="1" side="tl" part="lem"/>
                <clip pos="1" side="tl" part="a_det"/>
                <clip pos="1" side="tl" part="gen"/>
                <clip pos="1" side="tl" part="nbr"/>
              </lu>
             </out>
	    </when>
	   </choose> 
	 </otherwise>
	 </choose>
       </action>
  </rule> 
    
		
	
    
    <rule>
<!-- REGLA 19: PRONOM -->
<!--Special case, macro f_concord1 
is not applicable because gender and number can not be taken from previous rules -->
      <pattern>
        <pattern-item n="prn"/>
      </pattern>
      <action>
        <call-macro n="f_concord1">
          <with-param pos="1"/>
        </call-macro>
        <out>
          <lu>
            <clip pos="1" side="tl" part="lem"/>
            <clip pos="1" side="tl" part="a_prn"/>
            <clip pos="1" side="tl" part="gen"/>
            <clip pos="1" side="tl" part="nbr"/>
          </lu>
        </out>
      </action>
    </rule>

    <rule>
<!-- REGLA 20: NUMERAL -->
      <pattern>
        <pattern-item n="num"/>
      </pattern>
      <action>
        <call-macro n="f_modgen">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_concord1">
          <with-param pos="1"/>
        </call-macro>
        <out>
          <lu>
            <clip pos="1" side="tl" part="lem"/>
            <clip pos="1" side="tl" part="a_num"/>
            <clip pos="1" side="tl" part="gen"/>
            <clip pos="1" side="tl" part="nbr"/>          
          </lu>
        </out>
      </action>
    </rule> 
	    
     <rule>	
<!-- REGLA 21: NOM-->
      <pattern>
        <pattern-item n="nom"/>
      </pattern>
      <action>  
        <call-macro n="f_concord1">
          <with-param pos="1"/>
        </call-macro>
        <choose>
          <when>
            <test>
              <and>
                <equal>
                  <clip pos="1" side="sl" part="a_def"/>
                  <lit-tag v="def"/>
                </equal>
                <equal>
                  <clip pos="1" side="sl" part="a_case"/>
                  <lit-tag v="nom"/>
                </equal>
              </and>
            </test>
	      <call-macro n="modcase">
          	  <with-param pos="1"/>
              </call-macro>  
            <choose>
              <when>
                <test>
                  <equal>
                    <clip pos="1" side="tl" part="gen"/>
                    <lit-tag v="mf"/>
                  </equal>
                </test>
                <out>
                  <lu>
		  <get-case-from pos="1">
                    <lit v="el"/>
		  </get-case-from>  
                    <lit-tag v="det.def"/>
                    <clip pos="1" side="sl" part="gen"/>
                    <clip pos="1" side="tl" part="nbr"/>
                  </lu>
                  <b/>
                  <lu> 
                    <clip pos="1" side="tl" part="lem"/>
                    <clip pos="1" side="tl" part="a_nom"/>
                    <clip pos="1" side="tl" part="gen"/>
                    <clip pos="1" side="tl" part="nbr"/>
                  </lu>
                </out>
              </when>
              <otherwise>
                <out>
                  <lu>
		   <get-case-from pos="1">
                    <lit v="el"/>  
		   </get-case-from>  
                    <lit-tag v="det.def"/>
                    <clip pos="1" side="tl" part="gen"/>
                    <clip pos="1" side="tl" part="nbr"/>
                  </lu>
                  <b/>
                  <lu>
		 
                    <clip pos="1" side="tl" part="lem"/>

                    <clip pos="1" side="tl" part="a_nom"/>
                    <clip pos="1" side="tl" part="gen"/>
                    <clip pos="1" side="tl" part="nbr"/>
                  </lu>
                </out>
              </otherwise>
            </choose>
          </when>
          <otherwise>
            <choose>
              <when>
                <test>
		  <and>
                  <equal>
                    <clip pos="1" side="sl" part="a_def"/>
                    <lit-tag v="ind"/>
                  </equal>
                  <equal>
                    <clip pos="1" side="sl" part="a_case"/>
                    <lit-tag v="nom"/>
                  </equal>
                </and>
                </test>
                <out>
                  <lu>
                    <clip pos="1" side="tl" part="lem"/>
                    <clip pos="1" side="tl" part="a_nom"/>
                    <clip pos="1" side="tl" part="gen"/>
                    <clip pos="1" side="tl" part="nbr"/>
                  </lu>
                </out>
              </when>
            </choose>
          </otherwise>
        </choose>
        <choose>  
          <when>
            <test>
              <and>
                <equal>
                  <clip pos="1" side="sl" part="a_def"/>
                  <lit-tag v="def"/>
                </equal>
                <equal>
                  <clip pos="1" side="sl" part="a_case"/>
                  <lit-tag v="dg"/>
                </equal>
              </and>
            </test>
	    <call-macro n="modcase">
            <with-param pos="1"/>
          </call-macro>
            <choose>
              <when>
                <test>
                  <equal>
                    <clip pos="1" side="tl" part="gen"/>
                    <lit-tag v="mf"/>
                  </equal>
                </test>
                <out>
                  <lu>
		   <get-case-from pos="1">
                    <lit v="a"/>
		   </get-case-from> 
                    <lit-tag v="pr"/>
                  </lu>
                  <b/>
                  <lu>
                    <lit v="el"/>
                    <lit-tag v="det.def"/>
                    <clip pos="1" side="sl" part="gen"/>
                    <clip pos="1" side="tl" part="nbr"/>
                  </lu>
                  <b/>
                  <lu>
		 
                    <clip pos="1" side="tl" part="lem"/>

                    <clip pos="1" side="tl" part="a_nom"/>
                    <clip pos="1" side="tl" part="gen"/>
                    <clip pos="1" side="tl" part="nbr"/>
                  </lu>
                </out>
              </when>
              <otherwise>
                <out>
                  <lu>
		  <get-case-from pos="1">
                    <lit v="a"/>
		   </get-case-from> 
                    <lit-tag v="pr"/>
                  </lu>
                  <b/>
                  <lu>
                    <lit v="el"/>
                    <lit-tag v="det.def"/>
                    <clip pos="1" side="tl" part="gen"/>
                    <clip pos="1" side="tl" part="nbr"/>
                  </lu>
                  <b/>
                  <lu>
		    <clip pos="1" side="tl" part="lem"/>
                    <clip pos="1" side="tl" part="a_nom"/>
                    <clip pos="1" side="tl" part="gen"/>
                    <clip pos="1" side="tl" part="nbr"/>
                  </lu>
                </out>
              </otherwise>
            </choose>
          </when>
          <otherwise>
	    <choose>
	      <when>
                <test>
		  <and>
                  <equal>
                    <clip pos="1" side="sl" part="a_def"/>
                    <lit-tag v="ind"/>
                  </equal>
                  <equal>
                    <clip pos="1" side="sl" part="a_case"/>
                    <lit-tag v="dg"/>
                  </equal>
                </and>
                </test>
                <out>  
                  <lu>
                    <clip pos="1" side="tl" part="lem"/>
                    <clip pos="1" side="tl" part="a_nom"/>
                    <clip pos="1" side="tl" part="gen"/>
                    <clip pos="1" side="tl" part="nbr"/>
                  </lu>
                </out>
              </when>
	    </choose>  
	  </otherwise> 
        </choose>
      </action>
    </rule>
  
 
  <rule>  
   <!--  REGLA 22 DELIA: NOM + LUI + NOM PROPI DG  ex. mormântul lui Isus = la tumba de Jesús -->
      <pattern>
        <pattern-item n="nom"/>
        <pattern-item n="adjlui"/>
        <pattern-item n="npant"/>
      </pattern>
      <action> 
         <call-macro n="f_concord1">
          <with-param pos="1"/>
        </call-macro>   
	 <call-macro n="f_concord1">
          <with-param pos="3"/>
        </call-macro>    
         <choose>
          <when>
             <test>
               <equal>
                  <clip pos="1" side="sl" part="a_case"/>
                  <lit-tag v="nom"/>
              </equal>	      
              <equal>
	        <clip pos="1" side="sl" part="a_def"/>
		<lit-tag v="def"/>
	      </equal>
             </test>
             <call-macro n="modcase">
               <with-param pos="1"/>
            </call-macro>
	       <out>
                  <lu>		  
		    <lit v="el"/>
                    <lit-tag v="det.def"/>
                    <clip pos="1" side="tl" part="gen"/>
                    <clip pos="1" side="tl" part="nbr"/>
                  </lu>
                  <b/>
                  <lu>
                    <clip pos="1" side="tl" part="lem"/>
		    <clip pos="1" side="tl" part="a_nom"/>
                    <clip pos="1" side="tl" part="gen"/>
                    <clip pos="1" side="tl" part="nbr"/>
  		</lu>
		<b pos="1"/>
		  <lu>
                   <lit v="de"/>
		   <lit-tag v="pr"/>
                  </lu>
                 <b pos="2"/>
                  <lu>
                    <clip pos="3" side="tl" part="lem"/>
                    <clip pos="3" side="tl" part="a_npant"/>
                    <clip pos="3" side="tl" part="gen"/>
                    <clip pos="3" side="tl" part="nbr"/>
                  </lu>
                </out>
		</when>
               <otherwise>
                <out>
                  <lu>
                    <clip pos="1" side="tl" part="lem"/>
                    <clip pos="1" side="tl" part="a_nom"/>
                    <clip pos="1" side="tl" part="gen"/>
                    <clip pos="1" side="tl" part="nbr"/>
                  </lu>
		  <b pos="1"/>
                  <lu>
                    <clip pos="2" side="tl" part="lem"/>
                    <clip pos="2" side="tl" part="a_npant"/>
                    <clip pos="2" side="tl" part="gen"/>
                    <clip pos="2" side="tl" part="nbr"/>
                  </lu>
                </out>
              </otherwise>
	    </choose> 
       </action>
    </rule>
 
    
    <rule>
<!-- REGLA 23: rel -->
      <pattern>
        <pattern-item n="relat"/>
      </pattern>
      <action>
        <call-macro n="f_concord1">
          <with-param pos="1"/>
        </call-macro>
        <out>
          <lu>
            <clip pos="1" side="tl" part="lem"/>
	    <clip pos="1" side="tl" part="a_relat"/>
            <clip pos="1" side="tl" part="gen"/>
            <clip pos="1" side="tl" part="nbr"/>        
            
          </lu>
        </out>
      </action>
    </rule>
    
      <rule>
<!-- REGLA 24: ADJECTIU_POSESSIU-->
      <pattern>
        <pattern-item n="adjpos"/>
      </pattern>
      <action>  
        <call-macro n="f_modgen">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_concord1">
          <with-param pos="1"/>
	</call-macro>
          <out>
            <lu>
              <clip pos="1" side="tl" part="lem"/>
              <clip pos="1" side="tl" part="a_adjpos"/>
              <clip pos="1" side="tl" part="gen"/>
              <clip pos="1" side="tl" part="nbr"/>
            </lu>
          </out>
        </action>
      </rule>
  
    <rule>    
<!-- REGLA 25: ADJ-->
      <pattern>
        <pattern-item n="adj"/>
      </pattern>
      <action>
        <call-macro n="f_concord1">
          <with-param pos="1"/>
        </call-macro> 
	<call-macro n="f_modgen">
          <with-param pos="1"/>
        </call-macro> 
        <choose>
          <when>
            <test>
              <and>
                <equal>
                  <clip pos="1" side="sl" part="a_def"/>
                  <lit-tag v="def"/>
                </equal>
                <equal>
                  <clip pos="1" side="sl" part="a_case"/>
                  <lit-tag v="nom"/>
                </equal>
              </and>
            </test>
    	  <call-macro n="modcase">
            <with-param pos="1"/>
          </call-macro>  
            <choose>
              <when>
                <test>
                  <equal>
                    <clip pos="1" side="tl" part="gen"/>
                    <lit-tag v="mf"/>
                  </equal>
                </test>
                <out>
                  <lu>
		   <get-case-from pos="1">
                    <lit v="el"/> 
		   </get-case-from>
                    <lit-tag v="det.def"/>
                    <clip pos="1" side="sl" part="gen"/>
                    <clip pos="1" side="tl" part="nbr"/>
                  </lu>
                  <b/>
                  <lu>
		
                    <clip pos="1" side="tl" part="lem"/> 

                    <clip pos="1" side="tl" part="a_adj"/>
                    <clip pos="1" side="tl" part="gen"/>
                    <clip pos="1" side="tl" part="nbr"/>
                  </lu>
                </out>
              </when>
              <otherwise>
                <out>
                  <lu>
		   <get-case-from pos="1">
                    <lit v="el"/>
		   </get-case-from>
                    <lit-tag v="det.def"/>
                    <clip pos="1" side="tl" part="gen"/>
                    <clip pos="1" side="tl" part="nbr"/>
                  </lu>
                  <b/>
                  <lu>
		
                    <clip pos="1" side="tl" part="lem"/>

                    <clip pos="1" side="tl" part="a_adj"/>
                    <clip pos="1" side="tl" part="gen"/>
                    <clip pos="1" side="tl" part="nbr"/>
                  </lu>
                </out>
              </otherwise>
            </choose>
          </when>
          <otherwise>
            <choose>
              <when>
                <test>
		  <and>
                  <equal>
                    <clip pos="1" side="sl" part="a_def"/>
                    <lit-tag v="ind"/>
                  </equal>
                  <equal>
                    <clip pos="1" side="sl" part="a_case"/>
                    <lit-tag v="nom"/>
                  </equal>
                </and>
                </test>
                <out>
                  <lu>
                    <clip pos="1" side="tl" part="lem"/>
                    <clip pos="1" side="tl" part="a_adj"/>
                    <clip pos="1" side="tl" part="gen"/>
                    <clip pos="1" side="tl" part="nbr"/>
                  </lu>
                </out>
              </when>
            </choose>
          </otherwise>
        </choose>
        <choose>
          <when>
            <test>
              <and>
                <equal>
                  <clip pos="1" side="sl" part="a_def"/>
                  <lit-tag v="def"/>
                </equal>
                <equal>
                  <clip pos="1" side="sl" part="a_case"/>
                  <lit-tag v="dg"/>
                </equal>
              </and>
            </test>
	    <call-macro n="modcase">
              <with-param pos="1"/>
            </call-macro>
            <choose>
              <when>
                <test>
                  <equal>
                    <clip pos="1" side="tl" part="gen"/>
                    <lit-tag v="mf"/>
                  </equal>
                </test>
                <out>
                  <lu>
		   <get-case-from pos="1">
                    <lit v="a"/> 
		   </get-case-from>
                    <lit-tag v="pr"/>
                  </lu>
                  <b/>
                  <lu>
                    <lit v="el"/>
                    <lit-tag v="det.def"/>
                    <clip pos="1" side="sl" part="gen"/>
                    <clip pos="1" side="tl" part="nbr"/>
                  </lu>
                  <b/>
                  <lu>
		 
                    <clip pos="1" side="tl" part="lem"/>
 
                    <clip pos="1" side="tl" part="a_adj"/>
                    <clip pos="1" side="tl" part="gen"/>
                    <clip pos="1" side="tl" part="nbr"/>
                  </lu>
                </out>
              </when>
              <otherwise>
                <out>
                  <lu>
		   <get-case-from pos="1">
                    <lit v="a"/>  
		   </get-case-from>
                    <lit-tag v="pr"/>
                  </lu>
                  <b/>
                  <lu>
                    <lit v="el"/>
                    <lit-tag v="det.def"/>
                    <clip pos="1" side="tl" part="gen"/>
                    <clip pos="1" side="tl" part="nbr"/>
                  </lu>
                  <b/>
                  <lu>  
		 
                    <clip pos="1" side="tl" part="lem"/>
 
                    <clip pos="1" side="tl" part="a_adj"/>
                    <clip pos="1" side="tl" part="gen"/>
                    <clip pos="1" side="tl" part="nbr"/>
                  </lu>
                </out>
              </otherwise>
            </choose>
          </when>
          <otherwise>
	    <choose>
	      <when>
                <test>
		  <and>
                  <equal>
                    <clip pos="1" side="sl" part="a_def"/>
                    <lit-tag v="ind"/>
                  </equal>
                  <equal>
                    <clip pos="1" side="sl" part="a_case"/>
                    <lit-tag v="dg"/>
                  </equal>
                </and>
                </test>
                <out>  
                  <lu>
                    <clip pos="1" side="tl" part="lem"/>
                    <clip pos="1" side="tl" part="a_adj"/>
                    <clip pos="1" side="tl" part="gen"/>
                    <clip pos="1" side="tl" part="nbr"/>
                  </lu>
                </out>
              </when>
	    </choose>  
	  </otherwise> 
        </choose>
      </action>
    </rule>
 

      
<!--  REGLA 26: VERB NOM NOM per a traduir "am dat cartea fetei" com a "he dado el libro de la chica"  -->
    <rule>
      <pattern>
        <pattern-item n="verb"/>
        <pattern-item n="nom"/>
        <pattern-item n="nom"/>
      </pattern>
      <action>
         <call-macro n="f_concord1">
          <with-param pos="2"/>
        </call-macro>   
	 <call-macro n="f_concord1">
          <with-param pos="3"/>
        </call-macro>   
        <choose>
          <when>
            <test>
              <and>
                <equal>
                  <clip pos="2" side="sl" part="a_case"/>
                  <lit-tag v="nom"/>
                </equal>
                <equal>
                  <clip pos="2" side="sl" part="a_def"/>
                  <lit-tag v="def"/>
                </equal>
                <equal>
                  <clip pos="3" side="sl" part="a_case"/>
                  <lit-tag v="dg"/>
                </equal>
                <equal>
                  <clip pos="3" side="sl" part="a_def"/>
                  <lit-tag v="def"/>
                </equal>
              </and>
            </test>
	    <call-macro n="modcase">
               <with-param pos="1"/>
            </call-macro>
            <out>
              <lu> 
	      <get-case-from pos="1">
                <clip pos="1" side="tl" part="lem"/>
	      </get-case-from>
                <clip pos="1" side="tl" part="a_verb"/>
                <clip pos="1" side="tl" part="temps"/>
                <clip pos="1" side="tl" part="persona"/>
                <clip pos="1" side="tl" part="gen"/>
                <clip pos="1" side="tl" part="nbr"/>
	       </lu>
               <b/>
               <lu> 
                <lit v="el"/>
                <lit-tag v="det.def"/>
                <clip pos="2" side="tl" part="gen"/>
                <clip pos="2" side="tl" part="nbr"/>
              </lu>
              <b/>
              <lu>
                <clip pos="2" side="tl" part="lem"/>
                <clip pos="2" side="tl" part="a_nom"/>
                <clip pos="2" side="tl" part="gen"/>
                <clip pos="2" side="tl" part="nbr"/>
              </lu>
              <b/>
              <lu>
                <lit v="de"/>
                <lit-tag v="pr"/>
              </lu>
              <b/>
              <lu>
                <lit v="el"/>
                <lit-tag v="det.def"/>
                <clip pos="3" side="tl" part="gen"/>
                <clip pos="3" side="tl" part="nbr"/>
              </lu>
              <b/>
              <lu>
                <clip pos="3" side="tl" part="lem"/>
                <clip pos="3" side="tl" part="a_nom"/>
                <clip pos="3" side="tl" part="gen"/>
                <clip pos="3" side="tl" part="nbr"/>
              </lu>
            </out>
          </when>
          <otherwise>
            <out>
              <lu>
                <clip pos="1" side="tl" part="lem"/>
                <clip pos="1" side="tl" part="a_verb"/>
                <clip pos="1" side="tl" part="temps"/>
                <clip pos="1" side="tl" part="persona"/>
                <clip pos="1" side="tl" part="gen"/>
                <clip pos="1" side="tl" part="nbr"/>
               </lu>
               <b/>
               <lu>
                <clip pos="2" side="tl" part="lem"/>
                <clip pos="2" side="tl" part="a_nom"/>
                <clip pos="2" side="tl" part="gen"/>
                <clip pos="2" side="tl" part="nbr"/>
              </lu>
              <b/>
              <lu>
                <clip pos="3" side="tl" part="lem"/>
                <clip pos="3" side="tl" part="a_nom"/>
                <clip pos="3" side="tl" part="gen"/>
                <clip pos="3" side="tl" part="nbr"/>
              </lu>
            </out>
          </otherwise>
        </choose>
      </action>
    </rule>      
    <rule>
<!-- REGLA 27: ADJECTIU NOM -->
      <pattern>
        <pattern-item n="adj"/>
        <pattern-item n="nom"/>
      </pattern>
      <action>  
        <call-macro n="f_modgen">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_concord2">
          <with-param pos="2"/>
          <with-param pos="1"/> 
	</call-macro>  	
          <choose>
          <when>
            <test>
              <and>
                <equal>
                  <clip pos="1" side="sl" part="a_def"/>
                  <lit-tag v="def"/>
                </equal>
                <equal>
                  <clip pos="1" side="sl" part="a_case"/>
                  <lit-tag v="nom"/>
                </equal>
              </and>
            </test>
            <call-macro n="modcase">
              <with-param pos="1"/>
            </call-macro>
            <choose>
              <when>
                <test>
                  <equal>
                    <clip pos="2" side="tl" part="gen"/>
                    <lit-tag v="mf"/>
                  </equal>
                </test>
               <out>
                  <lu>
		   <get-case-from pos="1">
                    <lit v="el"/> 
		   </get-case-from>
                    <lit-tag v="det.def"/>
                    <clip pos="2" side="sl" part="gen"/>
                    <clip pos="2" side="tl" part="nbr"/>
                  </lu>
                  <b/>
                  <lu>  
		 
                    <clip pos="1" side="tl" part="lem"/>
 
                    <clip pos="1" side="tl" part="a_adj"/>
                    <clip pos="1" side="tl" part="gen"/>
                    <clip pos="1" side="tl" part="nbr"/>
                  </lu>
		  <b pos="1"/>
                  <lu>
                    <clip pos="2" side="tl" part="lem"/>
                    <clip pos="2" side="tl" part="a_nom"/>
                    <clip pos="2" side="tl" part="gen"/>
                    <clip pos="2" side="tl" part="nbr"/>
                  </lu>
                </out>
              </when>
              <otherwise>
               <out>
                  <lu>
		   <get-case-from pos="1">
                    <lit v="el"/> 
		   </get-case-from>
                    <lit-tag v="det.def"/>
                    <clip pos="2" side="tl" part="gen"/>
                    <clip pos="2" side="tl" part="nbr"/>
                  </lu>
                  <b/>
                  <lu>  
		 
                    <clip pos="1" side="tl" part="lem"/>
 
                    <clip pos="1" side="tl" part="a_adj"/>
                    <clip pos="1" side="tl" part="gen"/>
                    <clip pos="1" side="tl" part="nbr"/>
                  </lu>
		  <b pos="1"/>
                  <lu>
                    <clip pos="2" side="tl" part="lem"/>
                    <clip pos="2" side="tl" part="a_nom"/>
                    <clip pos="2" side="tl" part="gen"/>
                    <clip pos="2" side="tl" part="nbr"/>
                  </lu>
                </out>
              </otherwise>
            </choose>
          </when>
          <otherwise>
            <choose>
              <when>
                <test>
		  <and>
                  <equal>
                    <clip pos="1" side="sl" part="a_def"/>
                    <lit-tag v="ind"/>
                  </equal>
                  <equal>
                    <clip pos="1" side="sl" part="a_case"/>
                    <lit-tag v="nom"/>
                  </equal>
                </and>
                </test>
                <out>
                  <lu>
                    <clip pos="1" side="tl" part="lem"/>
                    <clip pos="1" side="tl" part="a_adj"/>
                    <clip pos="1" side="tl" part="gen"/>
                    <clip pos="1" side="tl" part="nbr"/>
                  </lu>
		  <b pos="1"/>
                  <lu>
                    <clip pos="2" side="tl" part="lem"/>
                    <clip pos="2" side="tl" part="a_nom"/>
                    <clip pos="2" side="tl" part="gen"/>
                    <clip pos="2" side="tl" part="nbr"/>
                  </lu>
                </out>
              </when>
            </choose>
          </otherwise>
        </choose>
        <choose>
          <when>
            <test>
              <and>
                <equal>
                  <clip pos="1" side="sl" part="a_def"/>
                  <lit-tag v="def"/>
                </equal>
                <equal>
                  <clip pos="1" side="sl" part="a_case"/>
                  <lit-tag v="dg"/>
                </equal>
              </and>
            </test>
	      <call-macro n="modcase">
              <with-param pos="1"/>
            </call-macro>
            <choose>
              <when>
                <test>
                  <equal>
                    <clip pos="2" side="tl" part="gen"/>
                    <lit-tag v="mf"/>
                  </equal>
                </test>
                <out>
                  <lu>
		   <get-case-from pos="1">
                    <lit v="a"/>  
		   </get-case-from>
                    <lit-tag v="pr"/>
                  </lu>
                  <b/>
                  <lu>
                    <lit v="el"/>
                    <lit-tag v="det.def"/>
                    <clip pos="2" side="sl" part="gen"/>
                    <clip pos="2" side="tl" part="nbr"/>
                  </lu>
                  <b/>
                  <lu>  
		 
                    <clip pos="1" side="tl" part="lem"/>
 
                    <clip pos="1" side="tl" part="a_adj"/>
                    <clip pos="1" side="tl" part="gen"/>
                    <clip pos="1" side="tl" part="nbr"/>
                  </lu>
		  <b pos="1"/>
                  <lu>
                    <clip pos="2" side="tl" part="lem"/>
                    <clip pos="2" side="tl" part="a_nom"/>
                    <clip pos="2" side="tl" part="gen"/>
                    <clip pos="2" side="tl" part="nbr"/>
                  </lu>
                </out>
              </when>
              <otherwise>
                <out>
                  <lu>
		   <get-case-from pos="1">
                    <lit v="a"/>  
		   </get-case-from>
                    <lit-tag v="pr"/>
                  </lu>
                  <b/>
                  <lu>
                    <lit v="el"/>
                    <lit-tag v="det.def"/>
                    <clip pos="2" side="tl" part="gen"/>
                    <clip pos="2" side="tl" part="nbr"/>
                  </lu>
                  <b/>
                  <lu>  
		 
                    <clip pos="1" side="tl" part="lem"/>
 
                    <clip pos="1" side="tl" part="a_adj"/>
                    <clip pos="1" side="tl" part="gen"/>
                    <clip pos="1" side="tl" part="nbr"/>
                  </lu>
		  <b pos="1"/>
                  <lu>
                    <clip pos="2" side="tl" part="lem"/>
                    <clip pos="2" side="tl" part="a_nom"/>
                    <clip pos="2" side="tl" part="gen"/>
                    <clip pos="2" side="tl" part="nbr"/>
                  </lu>
                </out>
              </otherwise>
            </choose>
          </when>
          <otherwise>
	    <choose>
	      <when>
                <test>
		  <and>
                  <equal>
                    <clip pos="1" side="sl" part="a_def"/>
                    <lit-tag v="ind"/>
                  </equal>
                  <equal>
                    <clip pos="1" side="sl" part="a_case"/>
                    <lit-tag v="dg"/>
                  </equal>
                </and>
                </test>
                <out>  
		  <lu>
                    <lit v="a"/>
                    <lit-tag v="pr"/>
                  </lu>
                  <b/>
                  <lu>  
		 
                    <clip pos="1" side="tl" part="lem"/>
 
                    <clip pos="1" side="tl" part="a_adj"/>
                    <clip pos="1" side="tl" part="gen"/>
                    <clip pos="1" side="tl" part="nbr"/>
                  </lu>
		  <b pos="1"/>
                  <lu>
                    <clip pos="2" side="tl" part="lem"/>
                    <clip pos="2" side="tl" part="a_nom"/>
                    <clip pos="2" side="tl" part="gen"/>
                    <clip pos="2" side="tl" part="nbr"/>
                  </lu>
                </out>
              </when>
	    </choose>  
	  </otherwise> 
        </choose>
      </action>
    </rule>
    
  <rule>
<!-- REGLA 28 DELIA: ADJECTIU NOM + DETA + NOMDG  frumoasa legendä a cinematografului = la bella leyenda del cine-->
      <pattern>
        <pattern-item n="adj"/>
        <pattern-item n="nom"/>
        <pattern-item n="deta"/>
        <pattern-item n="nom"/>
      </pattern>
      <action>  
        <call-macro n="f_modgen">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_concord2">
          <with-param pos="2"/>
          <with-param pos="1"/> 
	  </call-macro>  	
            <call-macro n="modcase">
              <with-param pos="1"/>
            </call-macro>
            <choose>
              <when>
                <test>
                  <equal>
                    <clip pos="2" side="tl" part="gen"/>
                    <lit-tag v="mf"/>
                  </equal>
                </test>
               <out>
                  <lu>
		   <get-case-from pos="1">
                    <lit v="el"/> 
		   </get-case-from>
                    <lit-tag v="det.def"/>
                    <clip pos="2" side="sl" part="gen"/>
                    <clip pos="2" side="tl" part="nbr"/>
                  </lu>
                  <b/>
                  <lu>  
		    <clip pos="1" side="tl" part="lem"/>
                    <clip pos="1" side="tl" part="a_adj"/>
                    <clip pos="1" side="tl" part="gen"/>
                    <clip pos="1" side="tl" part="nbr"/>
                  </lu>
		  <b pos="1"/>
                  <lu>
                    <clip pos="2" side="tl" part="lem"/>
                    <clip pos="2" side="tl" part="a_nom"/>
                    <clip pos="2" side="tl" part="gen"/>
                    <clip pos="2" side="tl" part="nbr"/>
                  </lu>
                  <b pos="2"/>
                  <lu>
		    <lit v="de"/>  
		    <lit-tag v="pr"/>
                  </lu>
                  <b pos="3"/>
                 <lu>
		    <lit v="el"/> 
		    <lit-tag v="det.def"/>
                    <clip pos="4" side="tl" part="gen"/>
                    <clip pos="4" side="tl" part="nbr"/>
                  </lu>
	          <b/>
                 <lu>
                    <clip pos="4" side="tl" part="lem"/>
                    <clip pos="4" side="tl" part="a_nom"/>
                    <clip pos="4" side="tl" part="gen"/>
                    <clip pos="4" side="tl" part="nbr"/>
                  </lu>
                </out>
              </when>
	      <otherwise>
               <out>
                  <lu>
		   <get-case-from pos="1">
                    <lit v="el"/> 
		   </get-case-from>
                    <lit-tag v="det.def"/>
                    <clip pos="2" side="tl" part="gen"/>
                    <clip pos="2" side="tl" part="nbr"/>
                  </lu>
                  <b/>
                  <lu>  
		 
                    <clip pos="1" side="tl" part="lem"/>
 
                    <clip pos="1" side="tl" part="a_adj"/>
                    <clip pos="1" side="tl" part="gen"/>
                    <clip pos="1" side="tl" part="nbr"/>
                  </lu>
		  <b pos="1"/>
                  <lu>
                    <clip pos="2" side="tl" part="lem"/>
                    <clip pos="2" side="tl" part="a_nom"/>
                    <clip pos="2" side="tl" part="gen"/>
                    <clip pos="2" side="tl" part="nbr"/>
                  </lu>
	           <b pos="2"/>
                  <lu>
		    <lit v="de"/>  
		    <lit-tag v="pr"/>
                  </lu>
                  <b pos="3"/>
                 <lu>
		    <lit v="el"/> 
		    <lit-tag v="det.def"/>
                    <clip pos="4" side="tl" part="gen"/>
                    <clip pos="4" side="tl" part="nbr"/>
                  </lu>
	           <b/>
                 <lu>
                    <clip pos="4" side="tl" part="lem"/>
                    <clip pos="4" side="tl" part="a_nom"/>
                    <clip pos="4" side="tl" part="gen"/>
                    <clip pos="4" side="tl" part="nbr"/>
                  </lu>
                </out>
              </otherwise>
            </choose>
         </action>
    </rule> 

<rule>
<!-- REGLA 29 DELIA: NOM ADJECTIU  + DETA + NOMDG  legenda frumoasä a cinematografului = la leyenda bella del cine-->
      <pattern>
        <pattern-item n="nom"/>
        <pattern-item n="adj"/>
        <pattern-item n="deta"/>
        <pattern-item n="nom"/>
      </pattern>
      <action>  
        <call-macro n="f_modgen">
          <with-param pos="2"/>
        </call-macro>
        <call-macro n="f_concord2">
          <with-param pos="1"/>
          <with-param pos="2"/> 
	  </call-macro>  	
            <call-macro n="modcase">
              <with-param pos="1"/>
            </call-macro>
            <choose>
              <when>
                <test>
                  <equal>
                    <clip pos="1" side="tl" part="gen"/>
                    <lit-tag v="mf"/>
                  </equal>
                </test>
               <out>
                  <lu>
		   <get-case-from pos="1">
                    <lit v="el"/> 
		   </get-case-from>
                    <lit-tag v="det.def"/>
                    <clip pos="1" side="sl" part="gen"/>
                    <clip pos="1" side="tl" part="nbr"/>
                  </lu>
                  <b/>
                  <lu>  
		    <clip pos="1" side="tl" part="lem"/>
                    <clip pos="1" side="tl" part="a_nom"/>
                    <clip pos="1" side="tl" part="gen"/>
                    <clip pos="1" side="tl" part="nbr"/>
                  </lu>
		  <b/>
                  <lu>
                    <clip pos="2" side="tl" part="lem"/>
                    <clip pos="2" side="tl" part="a_adj"/>
                    <clip pos="2" side="tl" part="gen"/>
                    <clip pos="2" side="tl" part="nbr"/>
                  </lu>
                  <b/>
                  <lu>
		    <lit v="de"/>  
		    <lit-tag v="pr"/>
                  </lu>
                  <b/>
                 <lu>
		    <lit v="el"/> 
		    <lit-tag v="det.def"/>
                    <clip pos="4" side="sl" part="gen"/>
                    <clip pos="4" side="tl" part="nbr"/>
                  </lu>
	          <b/>
                 <lu>
                    <clip pos="4" side="tl" part="lem"/>
                    <clip pos="4" side="tl" part="a_nom"/>
                    <clip pos="4" side="tl" part="gen"/>
                    <clip pos="4" side="tl" part="nbr"/>
                  </lu>
                </out>
              </when>
	      <otherwise>
               <out>
                  <lu>
		   <get-case-from pos="1">
                    <lit v="el"/> 
		   </get-case-from>
                    <lit-tag v="det.def"/>
                    <clip pos="1" side="tl" part="gen"/>
                    <clip pos="1" side="tl" part="nbr"/>
                  </lu>
                  <b/>
                  <lu> 
                    <clip pos="1" side="tl" part="lem"/>
                    <clip pos="1" side="tl" part="a_nom"/>
                    <clip pos="1" side="tl" part="gen"/>
                    <clip pos="1" side="tl" part="nbr"/>
                  </lu>
		  <b/>
                  <lu>
                    <clip pos="2" side="tl" part="lem"/>
                    <clip pos="2" side="tl" part="a_adj"/>
                    <clip pos="2" side="tl" part="gen"/>
                    <clip pos="2" side="tl" part="nbr"/>
                  </lu>
	           <b/>
                  <lu>
		    <lit v="de"/>  
		    <lit-tag v="pr"/>
                  </lu>
                  <b/>
                 <lu>
		    <lit v="el"/> 
		    <lit-tag v="det.def"/>
                    <clip pos="4" side="tl" part="gen"/>
                    <clip pos="4" side="tl" part="nbr"/>
                  </lu>
	           <b/>
                 <lu>
                    <clip pos="4" side="tl" part="lem"/>
                    <clip pos="4" side="tl" part="a_nom"/>
                    <clip pos="4" side="tl" part="gen"/>
                    <clip pos="4" side="tl" part="nbr"/>
                  </lu>
                </out>
              </otherwise>
            </choose>
         </action>
    </rule> 


<rule>
<!-- REGLA 30bis DELIA: PREP NOM ADJECTIU  + DETA + NOMPROPIODG  de politica externa a României = de la política externa de Rumanía-->
      <pattern>
        <pattern-item n="prep"/>
        <pattern-item n="nom"/>
        <pattern-item n="adj"/>
        <pattern-item n="deta"/>
        <pattern-item n="np"/>
      </pattern>
      <action>  
        <call-macro n="f_modgen">
          <with-param pos="3"/>
        </call-macro>
        <call-macro n="f_concord2">
          <with-param pos="2"/>
          <with-param pos="3"/> 
	  </call-macro>
            <choose>
              <when>
                <test>
                  <equal>
                    <clip pos="2" side="tl" part="gen"/>
                    <lit-tag v="mf"/>
                  </equal>
                </test>
               <out>
                  <lu>
		   <get-case-from pos="1">
                    <clip pos="1" side="tl" part="lem"/>
                    </get-case-from>
                    <clip pos="1" side="tl" part="a_prep"/>
                   </lu>
                  <b/>
                   <lu>
                    <lit v="el"/> 
                    <lit-tag v="det.def"/>
                    <clip pos="2" side="sl" part="gen"/>
                    <clip pos="2" side="tl" part="nbr"/>
                  </lu>
                  <b/>
                  <lu>  
		    <clip pos="2" side="tl" part="lem"/>
                    <clip pos="2" side="tl" part="a_nom"/>
                    <clip pos="2" side="tl" part="gen"/>
                    <clip pos="2" side="tl" part="nbr"/>
                  </lu>
		  <b/>
                  <lu>
                    <clip pos="3" side="tl" part="lem"/>
                    <clip pos="3" side="tl" part="a_adj"/>
                    <clip pos="3" side="tl" part="gen"/>
                    <clip pos="3" side="tl" part="nbr"/>
                  </lu>
                  <b/>
                  <lu>
		    <lit v="de"/>  
		    <lit-tag v="pr"/>
                  </lu>
                  <b/>
                 <lu>
                    <clip pos="5" side="tl" part="lem"/>
                    <clip pos="5" side="tl" part="a_np"/>
                    <clip pos="5" side="tl" part="gen"/>
                    <clip pos="5" side="tl" part="nbr"/>
                  </lu>
                </out>
              </when>
	      <otherwise>
               <out>
                  <lu>
		   <get-case-from pos="1">
                    <clip pos="1" side="tl" part="lem"/>
                    </get-case-from>
                    <clip pos="1" side="tl" part="a_prep"/>
                   </lu>
                  <b/>
                   <lu>
                    <lit v="el"/>
                    <lit-tag v="det.def"/>
                    <clip pos="2" side="tl" part="gen"/>
                    <clip pos="2" side="tl" part="nbr"/>
                  </lu>
                  <b/>
                  <lu> 
                    <clip pos="2" side="tl" part="lem"/>
                    <clip pos="2" side="tl" part="a_nom"/>
                    <clip pos="2" side="tl" part="gen"/>
                    <clip pos="2" side="tl" part="nbr"/>
                  </lu>
		  <b/>
                  <lu>
                    <clip pos="3" side="tl" part="lem"/>
                    <clip pos="3" side="tl" part="a_adj"/>
                    <clip pos="3" side="tl" part="gen"/>
                    <clip pos="3" side="tl" part="nbr"/>
                  </lu>
	           <b/>
                  <lu>
		    <lit v="de"/>  
		    <lit-tag v="pr"/>
                  </lu>
                  <b/>
                 <lu>
                    <clip pos="5" side="tl" part="lem"/>
                    <clip pos="5" side="tl" part="a_np"/>
                    <clip pos="5" side="tl" part="gen"/>
                    <clip pos="5" side="tl" part="nbr"/>
                  </lu>
                </out>
              </otherwise>
            </choose>
         </action>
    </rule> 


<rule>
<!-- REGLA 30 DELIA: PREP NOM ADJECTIU  + DETA + NOMDG  despre legenda frumoasä a cinematografului = acerca de la leyenda bella del cine-->
      <pattern>
        <pattern-item n="prep"/>
        <pattern-item n="nom"/>
        <pattern-item n="adj"/>
        <pattern-item n="deta"/>
        <pattern-item n="nom"/>
      </pattern>
      <action>  
        <call-macro n="f_modgen">
          <with-param pos="3"/>
        </call-macro>
        <call-macro n="f_concord2">
          <with-param pos="2"/>
          <with-param pos="3"/> 
	  </call-macro>  	
            <call-macro n="modcase">
              <with-param pos="1"/>
            </call-macro>
            <choose>
              <when>
                <test>
                  <equal>
                    <clip pos="2" side="tl" part="gen"/>
                    <lit-tag v="mf"/>
                  </equal>
                </test>
               <out>
                  <lu>
		   <get-case-from pos="1">
                    <clip pos="1" side="tl" part="lem"/>
                    </get-case-from>
                    <clip pos="1" side="tl" part="a_prep"/>
                   </lu>
                  <b/>
                   <lu>
                    <lit v="el"/> 
                    <lit-tag v="det.def"/>
                    <clip pos="2" side="sl" part="gen"/>
                    <clip pos="2" side="tl" part="nbr"/>
                  </lu>
                  <b/>
                  <lu>  
		    <clip pos="2" side="tl" part="lem"/>
                    <clip pos="2" side="tl" part="a_nom"/>
                    <clip pos="2" side="tl" part="gen"/>
                    <clip pos="2" side="tl" part="nbr"/>
                  </lu>
		  <b/>
                  <lu>
                    <clip pos="3" side="tl" part="lem"/>
                    <clip pos="3" side="tl" part="a_adj"/>
                    <clip pos="3" side="tl" part="gen"/>
                    <clip pos="3" side="tl" part="nbr"/>
                  </lu>
                  <b/>
                  <lu>
		    <lit v="de"/>  
		    <lit-tag v="pr"/>
                  </lu>
                  <b/>
                 <lu>
		    <lit v="el"/> 
		    <lit-tag v="det.def"/>
                    <clip pos="5" side="sl" part="gen"/>
                    <clip pos="5" side="tl" part="nbr"/>
                  </lu>
	          <b/>
                 <lu>
                    <clip pos="5" side="tl" part="lem"/>
                    <clip pos="5" side="tl" part="a_nom"/>
                    <clip pos="5" side="tl" part="gen"/>
                    <clip pos="5" side="tl" part="nbr"/>
                  </lu>
                </out>
              </when>
	      <otherwise>
               <out>
                  <lu>
		   <get-case-from pos="1">
                    <clip pos="1" side="tl" part="lem"/>
                    </get-case-from>
                    <clip pos="1" side="tl" part="a_prep"/>
                   </lu>
                  <b/>
                   <lu>
                    <lit v="el"/>
                    <lit-tag v="det.def"/>
                    <clip pos="2" side="tl" part="gen"/>
                    <clip pos="2" side="tl" part="nbr"/>
                  </lu>
                  <b/>
                  <lu> 
                    <clip pos="2" side="tl" part="lem"/>
                    <clip pos="2" side="tl" part="a_nom"/>
                    <clip pos="2" side="tl" part="gen"/>
                    <clip pos="2" side="tl" part="nbr"/>
                  </lu>
		  <b/>
                  <lu>
                    <clip pos="3" side="tl" part="lem"/>
                    <clip pos="3" side="tl" part="a_adj"/>
                    <clip pos="3" side="tl" part="gen"/>
                    <clip pos="3" side="tl" part="nbr"/>
                  </lu>
	           <b/>
                  <lu>
		    <lit v="de"/>  
		    <lit-tag v="pr"/>
                  </lu>
                  <b/>
                 <lu>
		    <lit v="el"/> 
		    <lit-tag v="det.def"/>
                    <clip pos="5" side="tl" part="gen"/>
                    <clip pos="5" side="tl" part="nbr"/>
                  </lu>
	           <b/>
                 <lu>
                    <clip pos="5" side="tl" part="lem"/>
                    <clip pos="5" side="tl" part="a_nom"/>
                    <clip pos="5" side="tl" part="gen"/>
                    <clip pos="5" side="tl" part="nbr"/>
                  </lu>
                </out>
              </otherwise>
            </choose>
         </action>
    </rule> 


<rule>
<!-- REGLA 31 DELIA: VERB NOM ADJECTIU  + DETA + NOMDG  väzând legenda frumoasä a cinematografului = viendo la leyenda bella del cine-->
      <pattern>
        <pattern-item n="verb"/>
        <pattern-item n="nom"/>
        <pattern-item n="adj"/>
        <pattern-item n="deta"/>
        <pattern-item n="nom"/>
      </pattern>
      <action> 
         <call-macro n="f_modgen">
          <with-param pos="1"/>
        </call-macro> 
        <call-macro n="f_modgen">
          <with-param pos="3"/>
        </call-macro>
        <call-macro n="f_concord2">
          <with-param pos="2"/>
          <with-param pos="3"/> 
	  </call-macro>  	
            <call-macro n="modcase">
              <with-param pos="1"/>
            </call-macro>
            <choose>
              <when>
                <test>
                  <equal>
                    <clip pos="2" side="tl" part="gen"/>
                    <lit-tag v="mf"/>
                  </equal>
                </test>
               <out>
                  <lu>
		   <get-case-from pos="1">
                    <clip pos="1" side="tl" part="lem"/>
                    </get-case-from>
                    <clip pos="1" side="tl" part="a_verb"/>
                    <clip pos="1" side="tl" part="temps"/>
                    <clip pos="1" side="tl" part="persona"/>
                    <clip pos="1" side="tl" part="gen"/>
                    <clip pos="1" side="tl" part="nbr"/>
                    </lu>
                  <b/>
                   <lu>
                    <lit v="el"/> 
                    <lit-tag v="det.def"/>
                    <clip pos="2" side="sl" part="gen"/>
                    <clip pos="2" side="tl" part="nbr"/>
                  </lu>
                  <b/>
                  <lu>  
		    <clip pos="2" side="tl" part="lem"/>
                    <clip pos="2" side="tl" part="a_nom"/>
                    <clip pos="2" side="tl" part="gen"/>
                    <clip pos="2" side="tl" part="nbr"/>
                  </lu>
		  <b/>
                  <lu>
                    <clip pos="3" side="tl" part="lem"/>
                    <clip pos="3" side="tl" part="a_adj"/>
                    <clip pos="3" side="tl" part="gen"/>
                    <clip pos="3" side="tl" part="nbr"/>
                  </lu>
                  <b/>
                  <lu>
		    <lit v="de"/>  
		    <lit-tag v="pr"/>
                  </lu>
                  <b/>
                 <lu>
		    <lit v="el"/> 
		    <lit-tag v="det.def"/>
                    <clip pos="5" side="sl" part="gen"/>
                    <clip pos="5" side="tl" part="nbr"/>
                  </lu>
	          <b/>
                 <lu>
                    <clip pos="5" side="tl" part="lem"/>
                    <clip pos="5" side="tl" part="a_nom"/>
                    <clip pos="5" side="tl" part="gen"/>
                    <clip pos="5" side="tl" part="nbr"/>
                  </lu>
                </out>
              </when>
	      <otherwise>
               <out>
                  <lu>
		   <get-case-from pos="1">
                    <clip pos="1" side="tl" part="lem"/>
                    </get-case-from>
                    <clip pos="1" side="tl" part="a_verb"/>
                    <clip pos="1" side="tl" part="temps"/>
                    <clip pos="1" side="tl" part="persona"/>
                    <clip pos="1" side="tl" part="gen"/>
                    <clip pos="1" side="tl" part="nbr"/>
                   </lu>
                  <b/>
                   <lu>
                    <lit v="el"/>
                    <lit-tag v="det.def"/>
                    <clip pos="2" side="tl" part="gen"/>
                    <clip pos="2" side="tl" part="nbr"/>
                  </lu>
                  <b/>
                  <lu> 
                    <clip pos="2" side="tl" part="lem"/>
                    <clip pos="2" side="tl" part="a_nom"/>
                    <clip pos="2" side="tl" part="gen"/>
                    <clip pos="2" side="tl" part="nbr"/>
                  </lu>
		  <b/>
                  <lu>
                    <clip pos="3" side="tl" part="lem"/>
                    <clip pos="3" side="tl" part="a_adj"/>
                    <clip pos="3" side="tl" part="gen"/>
                    <clip pos="3" side="tl" part="nbr"/>
                  </lu>
	           <b/>
                  <lu>
		    <lit v="de"/>  
		    <lit-tag v="pr"/>
                  </lu>
                  <b/>
                 <lu>
		    <lit v="el"/> 
		    <lit-tag v="det.def"/>
                    <clip pos="5" side="tl" part="gen"/>
                    <clip pos="5" side="tl" part="nbr"/>
                  </lu>
	           <b/>
                 <lu>
                    <clip pos="5" side="tl" part="lem"/>
                    <clip pos="5" side="tl" part="a_nom"/>
                    <clip pos="5" side="tl" part="gen"/>
                    <clip pos="5" side="tl" part="nbr"/>
                  </lu>
                </out>
              </otherwise>
            </choose>
         </action>
    </rule> 

<rule>
<!-- REGLA 32 DELIA: NOM (ind)+ DETA + NOMDG -->
      <pattern>        
        <pattern-item n="nom"/>
        <pattern-item n="deta"/>
        <pattern-item n="nom"/>
      </pattern>
      <action>  
          <choose>
              <when>
                <test>
                  <equal>
                    <clip pos="1" side="tl" part="gen"/>
                    <lit-tag v="mf"/>
                  </equal>
                </test>
               <out>
                  <lu>
                    <clip pos="1" side="tl" part="lem"/>
                    <clip pos="1" side="tl" part="a_nom"/>
                    <clip pos="1" side="tl" part="gen"/>
                    <clip pos="1" side="tl" part="nbr"/>
                  </lu>
                  <b pos="1"/>
                  <lu>
		    <lit v="de"/>  
		    <lit-tag v="pr"/>
                  </lu>
                  <b pos="2"/>
                 <lu>
		    <lit v="el"/> 
		    <lit-tag v="det.def"/>
                    <clip pos="3" side="sl" part="gen"/>
                    <clip pos="3" side="tl" part="nbr"/>
                  </lu>
	          <b/>
                 <lu>
                    <clip pos="3" side="tl" part="lem"/>
                    <clip pos="3" side="tl" part="a_nom"/>
                    <clip pos="3" side="tl" part="gen"/>
                    <clip pos="3" side="tl" part="nbr"/>
                  </lu>
                </out>
              </when>
	      <otherwise>
               <out>
                  <lu>
                    <clip pos="1" side="tl" part="lem"/>
                    <clip pos="1" side="tl" part="a_nom"/>
                    <clip pos="1" side="tl" part="gen"/>
                    <clip pos="1" side="tl" part="nbr"/>
                  </lu>
	           <b pos="1"/>
                  <lu>
		    <lit v="de"/>  
		    <lit-tag v="pr"/>
                  </lu>
                  <b pos="2"/>
                 <lu>
		    <lit v="el"/> 
		    <lit-tag v="det.def"/>
                    <clip pos="3" side="tl" part="gen"/>
                    <clip pos="3" side="tl" part="nbr"/>
                  </lu>
	           <b/>
                 <lu>
                    <clip pos="3" side="tl" part="lem"/>
                    <clip pos="3" side="tl" part="a_nom"/>
                    <clip pos="3" side="tl" part="gen"/>
                    <clip pos="3" side="tl" part="nbr"/>
                  </lu>
                </out>
              </otherwise>
            </choose>
         </action>
    </rule> 


<rule>
<!-- REGLA 33 DELIA: NOM (det)+ DETIND + NOMDG -->
      <pattern>        
        <pattern-item n="nom"/>
        <pattern-item n="det"/>
        <pattern-item n="nom"/>
      </pattern>
      <action>  
          <choose>
              <when>
                <test>
                  <equal>
                    <clip pos="1" side="tl" part="gen"/>
                    <lit-tag v="mf"/>
                  </equal>
                </test>
               <out>
                  <lu>
		   <get-case-from pos="1">
                    <lit v="el"/> 
		   </get-case-from>
                    <lit-tag v="det.def"/>
                    <clip pos="1" side="sl" part="gen"/>
                    <clip pos="1" side="tl" part="nbr"/>
                  </lu>
                  <b/>
                  <lu>
                    <clip pos="1" side="tl" part="lem"/>
                    <clip pos="1" side="tl" part="a_nom"/>
                    <clip pos="1" side="tl" part="gen"/>
                    <clip pos="1" side="tl" part="nbr"/>
                  </lu>
                  <b/>
                  <lu>
		    <lit v="de"/>  
		    <lit-tag v="pr"/>
                  </lu>
                  <b/>
                  <lu>
                    <clip pos="2" side="tl" part="lem"/>
                    	<lit-tag v="det.ind"/>
                    <clip pos="3" side="sl" part="gen"/>
                    <clip pos="3" side="tl" part="nbr"/>
                  </lu>
	          <b/>
                 <lu>
                    <clip pos="3" side="tl" part="lem"/>
                    <clip pos="3" side="tl" part="a_nom"/>
                    <clip pos="3" side="tl" part="gen"/>
                    <clip pos="3" side="tl" part="nbr"/>
                  </lu>
                </out>
              </when>
	      <otherwise>
               <out>
                  <lu>
		   <get-case-from pos="1">
                    <lit v="el"/> 
		   </get-case-from>
                    <lit-tag v="det.def"/>
                    <clip pos="1" side="sl" part="gen"/>
                    <clip pos="1" side="tl" part="nbr"/>
                  </lu>
                  <b/>
                  <lu>
                    <clip pos="1" side="tl" part="lem"/>
                    <clip pos="1" side="tl" part="a_nom"/>
                    <clip pos="1" side="tl" part="gen"/>
                    <clip pos="1" side="tl" part="nbr"/>
                  </lu>
	           <b pos="1"/>
                  <lu>
		    <lit v="de"/>  
		    <lit-tag v="pr"/>
                  </lu>
                  <b/>
                  <lu>
                    <clip pos="2" side="tl" part="lem"/>
                    	<lit-tag v="det.ind"/>
                    <clip pos="3" side="tl" part="gen"/>
                    <clip pos="3" side="tl" part="nbr"/>
                  </lu>
	          <b/>
                  <lu>
                    <clip pos="3" side="tl" part="lem"/>
                    <clip pos="3" side="tl" part="a_nom"/>
                    <clip pos="3" side="tl" part="gen"/>
                    <clip pos="3" side="tl" part="nbr"/>
                  </lu>
                </out>
              </otherwise>
            </choose>
         </action>
    </rule> 
 

<rule>
<!-- REGLA 34 DELIA: NOM (ind)+ DETA + DETIND + NOMDG -->
      <pattern>        
        <pattern-item n="nom"/>
        <pattern-item n="deta"/>
        <pattern-item n="detind"/>
        <pattern-item n="nom"/>
      </pattern>
      <action>  	
          <call-macro n="f_concord2">
          <with-param pos="4"/>
          <with-param pos="3"/> 
	  </call-macro>    
            <choose>
              <when>
                <test>
                  <equal>
                    <clip pos="1" side="tl" part="gen"/>
                    <lit-tag v="mf"/>
                  </equal>
                </test>
               <out>
                  <lu>
                    <clip pos="1" side="tl" part="lem"/>
                    <clip pos="1" side="tl" part="a_nom"/>
                    <clip pos="1" side="tl" part="gen"/>
                    <clip pos="1" side="tl" part="nbr"/>
                  </lu>
                  <b pos="1"/>
                  <lu>
		    <lit v="de"/>  
		    <lit-tag v="pr"/>
                  </lu>
                  <b pos="2"/>
                  <lu>
		<clip pos="3" side="tl" part="lem"/>
                    <lit-tag v="det.ind"/>
                    <clip pos="4" side="tl" part="gen"/>
                    <clip pos="4" side="tl" part="nbr"/>
                  </lu>
	          <b/>
                  <lu>
                    <clip pos="4" side="tl" part="lem"/>
                    <clip pos="4" side="tl" part="a_nom"/>
                    <clip pos="4" side="tl" part="gen"/>
                    <clip pos="4" side="tl" part="nbr"/>
                  </lu>
                </out>
              </when>
	      <otherwise>
               <out>
                  <lu>
                    <clip pos="1" side="tl" part="lem"/>
                    <clip pos="1" side="tl" part="a_nom"/>
                    <clip pos="1" side="tl" part="gen"/>
                    <clip pos="1" side="tl" part="nbr"/>
                  </lu>
	           <b pos="1"/>
                  <lu>
		    <lit v="de"/>  
		    <lit-tag v="pr"/>
                  </lu>
                  <b pos="2"/>
                 <lu>
		<clip pos="3" side="tl" part="lem"/>
                    <lit-tag v="det.ind"/>
                    <clip pos="4" side="tl" part="gen"/>
                    <clip pos="4" side="tl" part="nbr"/>
                 </lu>
	         <b/>
                 <lu>
                    <clip pos="4" side="tl" part="lem"/>
                    <clip pos="4" side="tl" part="a_nom"/>
                    <clip pos="4" side="tl" part="gen"/>
                    <clip pos="4" side="tl" part="nbr"/>
                  </lu>
                </out>
              </otherwise>
            </choose>
         </action>
    </rule> 



<rule>
<!-- REGLA 35 DELIA: DET NOM + DETA + NOMDG -->
      <pattern>
        <pattern-item n="det"/>
        <pattern-item n="nom"/>
        <pattern-item n="deta"/>
        <pattern-item n="nom"/>
      </pattern>
      <action>  
        <call-macro n="f_modgen">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_concord2">
          <with-param pos="2"/>
          <with-param pos="1"/>  
	</call-macro>  
        <call-macro n="modcase">
              <with-param pos="1"/>
        </call-macro>
            <choose>
              <when>
                <test>
                  <equal>
                    <clip pos="2" side="tl" part="gen"/>
                    <lit-tag v="mf"/>
                  </equal>
                </test>
               <out>
                  <lu>  
		    <clip pos="1" side="tl" part="lem"/>
                    <clip pos="1" side="tl" part="a_det"/>
                    <clip pos="1" side="tl" part="gen"/>
                    <clip pos="1" side="tl" part="nbr"/>
                  </lu>
		  <b pos="1"/>
                  <lu>
                    <clip pos="2" side="tl" part="lem"/>
                    <clip pos="2" side="tl" part="a_nom"/>
                    <clip pos="2" side="tl" part="gen"/>
                    <clip pos="2" side="tl" part="nbr"/>
                  </lu>
                  <b pos="2"/>
                  <lu>
		    <lit v="de"/>  
		    <lit-tag v="pr"/>
                  </lu>
                  <b pos="3"/>
                 <lu>
		    <lit v="el"/> 
		    <lit-tag v="det.def"/>
                    <clip pos="4" side="sl" part="gen"/>
                    <clip pos="4" side="tl" part="nbr"/>
                  </lu>
	          <b/>
                 <lu>
                    <clip pos="4" side="tl" part="lem"/>
                    <clip pos="4" side="tl" part="a_nom"/>
                    <clip pos="4" side="tl" part="gen"/>
                    <clip pos="4" side="tl" part="nbr"/>
                  </lu>
                </out>
              </when>
	      <otherwise>
               <out>
                  <lu>  
		    <clip pos="1" side="tl" part="lem"/> 
                    <clip pos="1" side="tl" part="a_det"/>
                    <clip pos="1" side="tl" part="gen"/>
                    <clip pos="1" side="tl" part="nbr"/>
                  </lu>
		  <b pos="1"/>
                  <lu>
                    <clip pos="2" side="tl" part="lem"/>
                    <clip pos="2" side="tl" part="a_nom"/>
                    <clip pos="2" side="tl" part="gen"/>
                    <clip pos="2" side="tl" part="nbr"/>
                  </lu>
	           <b pos="2"/>
                  <lu>
		    <lit v="de"/>  
		    <lit-tag v="pr"/>
                  </lu>
                  <b pos="3"/>
                 <lu>
		    <lit v="el"/> 
		    <lit-tag v="det.def"/>
                    <clip pos="4" side="tl" part="gen"/>
                    <clip pos="4" side="tl" part="nbr"/>
                  </lu>
	           <b/>
                 <lu>
                    <clip pos="4" side="tl" part="lem"/>
                    <clip pos="4" side="tl" part="a_nom"/>
                    <clip pos="4" side="tl" part="gen"/>
                    <clip pos="4" side="tl" part="nbr"/>
                  </lu>
                </out>
              </otherwise>
            </choose>
         </action>
    </rule> 

<rule>
<!-- REGLA 36 DELIA: DET ADJ NOM + DETA + NOMDG -->
      <pattern>
        <pattern-item n="det"/>
        <pattern-item n="adj"/>
        <pattern-item n="nom"/>
        <pattern-item n="deta"/>
        <pattern-item n="nom"/>
      </pattern>
      <action>  
        <call-macro n="f_modgen">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_modgen">
          <with-param pos="2"/>
        </call-macro>
        <call-macro n="f_concord2">
          <with-param pos="3"/>
          <with-param pos="2"/>
          <with-param pos="1"/>  
	</call-macro>  	
        <call-macro n="modcase">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="modcase">
          <with-param pos="2"/>
        </call-macro>
            <choose>
              <when>
                <test>
                  <equal>
                    <clip pos="3" side="tl" part="gen"/>
                    <lit-tag v="mf"/>
                  </equal>
                </test>
               <out>
                  <lu>  
		    <clip pos="1" side="tl" part="lem"/>
                    <clip pos="1" side="tl" part="a_det"/>
                    <clip pos="1" side="tl" part="gen"/>
                    <clip pos="1" side="tl" part="nbr"/>
                  </lu>
		  <b pos="1"/>
                  <lu>  
		    <clip pos="2" side="tl" part="lem"/>
                    <clip pos="2" side="tl" part="a_adj"/>
                    <clip pos="2" side="tl" part="gen"/>
                    <clip pos="2" side="tl" part="nbr"/>
                  </lu>
		  <b pos="2"/>
                  <lu>
                    <clip pos="3" side="tl" part="lem"/>
                    <clip pos="3" side="tl" part="a_nom"/>
                    <clip pos="3" side="tl" part="gen"/>
                    <clip pos="3" side="tl" part="nbr"/>
                  </lu>
                  <b pos="3"/>
                  <lu>
		    <lit v="de"/>  
		    <lit-tag v="pr"/>
                  </lu>
                  <b pos="4"/>
                 <lu>
		    <lit v="el"/> 
		    <lit-tag v="det.def"/>
                    <clip pos="5" side="sl" part="gen"/>
                    <clip pos="5" side="tl" part="nbr"/>
                  </lu>
	          <b/>
                 <lu>
                    <clip pos="5" side="tl" part="lem"/>
                    <clip pos="5" side="tl" part="a_nom"/>
                    <clip pos="5" side="tl" part="gen"/>
                    <clip pos="5" side="tl" part="nbr"/>
                  </lu>
                </out>
              </when>
	      <otherwise>
               <out>
                  <lu>  
		    <clip pos="1" side="tl" part="lem"/> 
                    <clip pos="1" side="tl" part="a_det"/>
                    <clip pos="1" side="tl" part="gen"/>
                    <clip pos="1" side="tl" part="nbr"/>
                  </lu>
		  <b pos="1"/>
                  <lu>  
		    <clip pos="2" side="tl" part="lem"/> 
                    <clip pos="2" side="tl" part="a_adj"/>
                    <clip pos="2" side="tl" part="gen"/>
                    <clip pos="2" side="tl" part="nbr"/>
                  </lu>
		  <b pos="2"/>
                  <lu>
                    <clip pos="3" side="tl" part="lem"/>
                    <clip pos="3" side="tl" part="a_nom"/>
                    <clip pos="3" side="tl" part="gen"/>
                    <clip pos="3" side="tl" part="nbr"/>
                  </lu>
	           <b pos="3"/>
                  <lu>
		    <lit v="de"/>  
		    <lit-tag v="pr"/>
                  </lu>
                  <b pos="4"/>
                 <lu>
		    <lit v="el"/> 
		    <lit-tag v="det.def"/>
                    <clip pos="5" side="tl" part="gen"/>
                    <clip pos="5" side="tl" part="nbr"/>
                  </lu>
	           <b/>
                 <lu>
                    <clip pos="5" side="tl" part="lem"/>
                    <clip pos="5" side="tl" part="a_nom"/>
                    <clip pos="5" side="tl" part="gen"/>
                    <clip pos="5" side="tl" part="nbr"/>
                  </lu>
                </out>
              </otherwise>
            </choose>
         </action>
    </rule> 



<!-- <rule> REGLA DELIA: DET NOM ADJ + DETA + NOMDG 
      <pattern>
        <pattern-item n="det"/>        
        <pattern-item n="nom"/>
        <pattern-item n="adj"/>
        <pattern-item n="deta"/>
        <pattern-item n="nom"/>
      </pattern>
      <action>  
        <call-macro n="f_modgen">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_modgen">
          <with-param pos="2"/>
        </call-macro>
        <call-macro n="f_concord2">
          <with-param pos="3"/>
          <with-param pos="2"/>
          <with-param pos="1"/>  
	</call-macro>  	
        <call-macro n="modcase">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="modcase">
          <with-param pos="2"/>
        </call-macro>
            <choose>
              <when>
                <test>
                  <equal>
                    <clip pos="3" side="tl" part="gen"/>
                    <lit-tag v="mf"/>
                  </equal>
                </test>
               <out>
                  <lu>  
		    <clip pos="1" side="tl" part="lem"/>
                    <clip pos="1" side="tl" part="a_det"/>
                    <clip pos="1" side="tl" part="gen"/>
                    <clip pos="1" side="tl" part="nbr"/>
                  </lu>
		  <b pos="1"/>
                  <lu>  
		    <clip pos="2" side="tl" part="lem"/>
                    <clip pos="2" side="tl" part="a_adj"/>
                    <clip pos="2" side="tl" part="gen"/>
                    <clip pos="2" side="tl" part="nbr"/>
                  </lu>
		  <b pos="2"/>
                  <lu>
                    <clip pos="3" side="tl" part="lem"/>
                    <clip pos="3" side="tl" part="a_nom"/>
                    <clip pos="3" side="tl" part="gen"/>
                    <clip pos="3" side="tl" part="nbr"/>
                  </lu>
                  <b pos="3"/>
                  <lu>
		    <lit v="de"/>  
		    <lit-tag v="pr"/>
                  </lu>
                  <b pos="4"/>
                 <lu>
		    <lit v="el"/> 
		    <lit-tag v="det.def"/>
                    <clip pos="5" side="sl" part="gen"/>
                    <clip pos="5" side="tl" part="nbr"/>
                  </lu>
	          <b/>
                 <lu>
                    <clip pos="5" side="tl" part="lem"/>
                    <clip pos="5" side="tl" part="a_nom"/>
                    <clip pos="5" side="tl" part="gen"/>
                    <clip pos="5" side="tl" part="nbr"/>
                  </lu>
                </out>
              </when>
	      <otherwise>
               <out>
                  <lu>  
		    <clip pos="1" side="tl" part="lem"/> 
                    <clip pos="1" side="tl" part="a_det"/>
                    <clip pos="1" side="tl" part="gen"/>
                    <clip pos="1" side="tl" part="nbr"/>
                  </lu>
		  <b pos="1"/>
                  <lu>  
		    <clip pos="2" side="tl" part="lem"/> 
                    <clip pos="2" side="tl" part="a_adj"/>
                    <clip pos="2" side="tl" part="gen"/>
                    <clip pos="2" side="tl" part="nbr"/>
                  </lu>
		  <b pos="2"/>
                  <lu>
                    <clip pos="3" side="tl" part="lem"/>
                    <clip pos="3" side="tl" part="a_nom"/>
                    <clip pos="3" side="tl" part="gen"/>
                    <clip pos="3" side="tl" part="nbr"/>
                  </lu>
	           <b pos="3"/>
                  <lu>
		    <lit v="de"/>  
		    <lit-tag v="pr"/>
                  </lu>
                  <b pos="4"/>
                 <lu>
		    <lit v="el"/> 
		    <lit-tag v="det.def"/>
                    <clip pos="5" side="sl" part="gen"/>
                    <clip pos="5" side="tl" part="nbr"/>
                  </lu>
	           <b/>
                 <lu>
                    <clip pos="5" side="tl" part="lem"/>
                    <clip pos="5" side="tl" part="a_nom"/>
                    <clip pos="5" side="tl" part="gen"/>
                    <clip pos="5" side="tl" part="nbr"/>
                  </lu>
                </out>
              </otherwise>
            </choose>
         </action>
    </rule> -->
 
<!--Encara no funciona: Dóna per a NOUÁ FETE = NUEVE #CHICA i no NUEVE CHICAS com hauria de fer-ho -->
    <rule>
<!-- REGLA 36: NUMERAL NOM-->
      <pattern>
        <pattern-item n="num"/>
        <pattern-item n="nom"/>
      </pattern>
      <action>
        <call-macro n="f_modgen">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_concord2">
          <with-param pos="2"/>
          <with-param pos="1"/>
        </call-macro>
	<choose>
	  <when>
	    <test>
	      <not>
	        <equal>
		  <clip pos="1" side="sl" part="lem"/>
		  <lit v="1"/>

	</equal>
	</not>
	</test>
	<let>
	<clip pos="2" side="tl" part="nbr"/>
	<lit-tag v="pl"/>
</let>
</when>
</choose>


          <out>
            <lu>
              <clip pos="1" side="tl" part="lem"/>
              <clip pos="1" side="tl" part="a_num"/>
              <clip pos="1" side="tl" part="gen"/>
              <clip pos="1" side="tl" part="nbr"/>            
            </lu>
            <b/>
            <lu>
              <clip pos="2" side="tl" part="lem"/>
              <clip pos="2" side="tl" part="a_nom"/>
              <clip pos="2" side="tl" part="gen"/>
              <clip pos="2" side="tl" part="nbr"/> 
           </lu>
          </out>
    </action>
  </rule>


 
  <rule>  
 <!-- REGLA 37 DELIA: NUMERAL (>20) + de + NOM pl - NUMERAL + NOM pl.)-->
      <pattern>
        <pattern-item n="num"/>
        <pattern-item n="prep"/>
        <pattern-item n="nom"/>
      </pattern>
      <action>
        <call-macro n="f_modgen">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_concord2">
          <with-param pos="3"/>
          <with-param pos="1"/>
        </call-macro>
        <choose>
	  <when>
	    <test>
              <equal>
	        <clip pos="2" side="sl" part="lem"/>
		<lit v="de"/>
	      </equal>
	    </test>
          <out>
            <lu>
              <clip pos="1" side="tl" part="lem"/>
              <clip pos="1" side="tl" part="a_num"/>
              <clip pos="1" side="tl" part="gen"/>
              <clip pos="1" side="tl" part="nbr"/>     
            </lu>
            <b/>
            <lu>
              <clip pos="3" side="tl" part="lem"/>
              <clip pos="3" side="tl" part="a_nom"/>
              <clip pos="3" side="tl" part="gen"/>             
              <lit-tag v="pl"/>
            </lu>
          </out>
        </when>
         <otherwise>
               <out>
                  <lu>  
		    <clip pos="1" side="tl" part="lem"/> 
                    <clip pos="1" side="tl" part="a_num"/>
                    <clip pos="1" side="tl" part="gen"/>
                    <clip pos="1" side="tl" part="nbr"/>     
                  </lu>
		  <b pos="1"/>
                  <lu>
                    <clip pos="2" side="tl" part="lem"/>
                    <clip pos="2" side="tl" part="a_prep"/> 		    
                  </lu>
		  <b pos="2"/>
                  <lu>
                    <clip pos="3" side="tl" part="lem"/>
                    <clip pos="3" side="tl" part="a_nom"/>
                    <clip pos="3" side="tl" part="gen"/>
                    <clip pos="3" side="tl" part="nbr"/>
                  </lu>	        
                </out>
              </otherwise>        
      </choose>
    </action>
  </rule> 
 
      <rule>
<!-- REGLA 38: NOM ADJECTIU_POSESSIU-->
      <pattern>
        <pattern-item n="nom"/>
        <pattern-item n="adjpos"/>
      </pattern>
       <action>  
        <call-macro n="f_modgen">
          <with-param pos="2"/>
        </call-macro>
        <call-macro n="f_concord2">
          <with-param pos="1"/>
          <with-param pos="2"/> 
	</call-macro>
	<call-macro n="modcase">
          <with-param pos="1"/>
        </call-macro>
	 <choose>
	      <when>
	        <test>
		  <equal>
		   <clip pos="2" side="tl" part="lem"/>
                  <lit v="mío"/>
		  </equal>
		</test>  
		<let>
		  <clip pos="2" side="tl" part="gen"/>
                  <lit-tag v="mf"/>
		</let>
	       </when>
	   </choose>  
	   <choose> 
	       <when>
	        <test>
		  <equal>
		   <clip pos="2" side="tl" part="lem"/>
                  <lit v="tuyo"/>
		  </equal>
		</test>  
		<let>
		  <clip pos="2" side="tl" part="gen"/>
                  <lit-tag v="mf"/>
		</let>
	       </when> 
	     </choose>
	     <choose> 
		 <when>
	        <test>
		  <equal>
		   <clip pos="2" side="tl" part="lem"/>
                  <lit v="suyo"/>
		  </equal>
		</test>  
		<let>
		  <clip pos="2" side="tl" part="gen"/>
                  <lit-tag v="mf"/>
		</let>
	       </when> 
	   </choose>    
	     <choose>
          <when>
            <test>
               <equal>
                  <clip pos="1" side="sl" part="a_case"/>
                  <lit-tag v="nom"/>
                </equal>
             </test>
             <out>
	      
                  <lu>
		  <get-case-from pos="1">
                    <clip pos="2" side="tl" part="lem"/>
                  </get-case-from>
		    <lit-tag v="det.pos"/>
                    <clip pos="2" side="tl" part="gen"/>
                    <clip pos="1" side="tl" part="nbr"/><!-- correcció de la elecció del desambiguador-->
                  </lu>
		  <b pos="1"/>
                  <lu>
                    <clip pos="1" side="tl" part="lem"/>
                    <clip pos="1" side="tl" part="a_nom"/>
                    <clip pos="1" side="tl" part="gen"/>
                    <clip pos="1" side="tl" part="nbr"/>
                  </lu>
             </out>
          </when>
          <when>
            <test>
               <equal>
                  <clip pos="1" side="sl" part="a_case"/>
                  <lit-tag v="dg"/>
                </equal>
             </test>
                <out>
                  <lu>
		   <get-case-from pos="1">
                    <lit v="a"/>  
		   </get-case-from>
                    <lit-tag v="pr"/>
                  </lu>
		  <b/>
                  <lu>
                    <clip pos="2" side="tl" part="lem"/>
                    <lit-tag v="det.pos"/>
                    <clip pos="2" side="tl" part="gen"/>
                    <clip pos="1" side="tl" part="nbr"/><!-- correcció de la elecció del desambiguador-->
                  </lu>
		  <b pos="1"/>
                  <lu>
                    <clip pos="1" side="tl" part="lem"/>
                    <clip pos="1" side="tl" part="a_nom"/>
                    <clip pos="1" side="tl" part="gen"/>
                    <clip pos="1" side="tl" part="nbr"/>
                  </lu>
	        </out>
              </when>            
           </choose>    
       </action>
    </rule>
 
  
    <rule>
<!-- REGLA 39: NOM ADJECTIU -->
      <pattern>
        <pattern-item n="nom"/>
        <pattern-item n="adj"/>
      </pattern>
       <action>  
        <call-macro n="f_modgen">
          <with-param pos="2"/>
        </call-macro>
        <call-macro n="f_concord2">
          <with-param pos="1"/>
          <with-param pos="2"/> 
	</call-macro>  	
          <choose>
          <when>
            <test>
              <and>
                <equal>
                  <clip pos="1" side="sl" part="a_def"/>
                  <lit-tag v="def"/>
                </equal>
                <equal>
                  <clip pos="1" side="sl" part="a_case"/>
                  <lit-tag v="nom"/>
                </equal>
              </and>
            </test>
	    <call-macro n="modcase">
             <with-param pos="1"/>
           </call-macro>
            <choose>
              <when>
                <test>
                  <equal>
                    <clip pos="1" side="tl" part="gen"/>
                    <lit-tag v="mf"/>
                  </equal>
                </test>
               <out>
                  <lu>
		   <get-case-from pos="1">
                    <lit v="el"/> 
		   </get-case-from>
                    <lit-tag v="det.def"/>
                    <clip pos="1" side="sl" part="gen"/>
                    <clip pos="1" side="tl" part="nbr"/>
                  </lu>
                  <b/>
                  <lu>  
		 
                    <clip pos="1" side="tl" part="lem"/>

                    <clip pos="1" side="tl" part="a_nom"/>
                    <clip pos="1" side="tl" part="gen"/>
                    <clip pos="1" side="tl" part="nbr"/>
                  </lu>
		  <b pos="1"/>
                  <lu>
                    <clip pos="2" side="tl" part="lem"/>
                    <clip pos="2" side="tl" part="a_adj"/>
                    <clip pos="2" side="tl" part="gen"/>
                    <clip pos="2" side="tl" part="nbr"/>
                  </lu>
                </out>
              </when>
              <otherwise>
               <out>
                  <lu>
		   <get-case-from pos="1">
                    <lit v="el"/> 
		   </get-case-from>
                    <lit-tag v="det.def"/>
                    <clip pos="1" side="tl" part="gen"/>
                    <clip pos="1" side="tl" part="nbr"/>
                  </lu>
                  <b/>
                  <lu>  
		 
                    <clip pos="1" side="tl" part="lem"/>
 
                    <clip pos="1" side="tl" part="a_nom"/>
                    <clip pos="1" side="tl" part="gen"/>
                    <clip pos="1" side="tl" part="nbr"/>
                  </lu>
		  <b pos="1"/>
                  <lu>
                    <clip pos="2" side="tl" part="lem"/>
                    <clip pos="2" side="tl" part="a_adj"/>
                    <clip pos="2" side="tl" part="gen"/>
                    <clip pos="2" side="tl" part="nbr"/>
                  </lu>
                </out>
              </otherwise>
            </choose>
          </when>
          <otherwise>
            <choose>
              <when>
                <test>
		  <and>
                  <equal>
                    <clip pos="1" side="sl" part="a_def"/>
                    <lit-tag v="ind"/>
                  </equal>
                  <equal>
                    <clip pos="1" side="sl" part="a_case"/>
                    <lit-tag v="nom"/>
                  </equal>
                </and>
                </test>
                <out>
                  <lu>
                    <clip pos="1" side="tl" part="lem"/>
                    <clip pos="1" side="tl" part="a_nom"/>
                    <clip pos="1" side="tl" part="gen"/>
                    <clip pos="1" side="tl" part="nbr"/>
                  </lu>
		  <b pos="1"/>
                  <lu>
                    <clip pos="2" side="tl" part="lem"/>
                    <clip pos="2" side="tl" part="a_adj"/>
                    <clip pos="2" side="tl" part="gen"/>
                    <clip pos="2" side="tl" part="nbr"/>
                  </lu>
                </out>
              </when>
            </choose>
          </otherwise>
        </choose>
        <choose>
          <when>
            <test>
              <and>
                <equal>
                  <clip pos="1" side="sl" part="a_def"/>
                  <lit-tag v="def"/>
                </equal>
                <equal>
                  <clip pos="1" side="sl" part="a_case"/>
                  <lit-tag v="dg"/>
                </equal>
              </and>
            </test>
	    <call-macro n="modcase">
              <with-param pos="1"/>
            </call-macro>
            <choose>
              <when>
                <test>
                  <equal>
                    <clip pos="1" side="tl" part="gen"/>
                    <lit-tag v="mf"/>
                  </equal>
                </test>
                <out>
                  <lu>
		   <get-case-from pos="1">
                    <lit v="a"/>  
		   </get-case-from>
                    <lit-tag v="pr"/>
                  </lu>
                  <b/>
                  <lu>
                    <lit v="el"/>
                    <lit-tag v="det.def"/>
                    <clip pos="1" side="sl" part="gen"/>
                    <clip pos="1" side="tl" part="nbr"/>
                  </lu>
                  <b/>
                  <lu>  
		 
                    <clip pos="1" side="tl" part="lem"/>
 
                    <clip pos="1" side="tl" part="a_nom"/>
                    <clip pos="1" side="tl" part="gen"/>
                    <clip pos="1" side="tl" part="nbr"/>
                  </lu>
		  <b pos="1"/>
                  <lu>
                    <clip pos="2" side="tl" part="lem"/>
                    <clip pos="2" side="tl" part="a_adj"/>
                    <clip pos="2" side="tl" part="gen"/>
                    <clip pos="2" side="tl" part="nbr"/>
                  </lu>
                </out>
              </when>
              <otherwise>
                <out>
                  <lu>
		   <get-case-from pos="1">
                    <lit v="a"/>  
		   </get-case-from>
                    <lit-tag v="pr"/>
                  </lu>
                  <b/>
                  <lu>
                    <lit v="el"/>
                    <lit-tag v="det.def"/>
                    <clip pos="1" side="tl" part="gen"/>
                    <clip pos="1" side="tl" part="nbr"/>
                  </lu>
                  <b/>
                  <lu>  
		 
                    <clip pos="1" side="tl" part="lem"/>
 
                    <clip pos="1" side="tl" part="a_nom"/>
                    <clip pos="1" side="tl" part="gen"/>
                    <clip pos="1" side="tl" part="nbr"/>
                  </lu>
		  <b pos="1"/>
                  <lu>
                    <clip pos="2" side="tl" part="lem"/>
                    <clip pos="2" side="tl" part="a_adj"/>
                    <clip pos="2" side="tl" part="gen"/>
                    <clip pos="2" side="tl" part="nbr"/>
                  </lu>
                </out>
              </otherwise>
            </choose>
          </when>
          <otherwise>
	    <choose>
	      <when>
                <test>
		  <and>
                  <equal>
                    <clip pos="1" side="sl" part="a_def"/>
                    <lit-tag v="ind"/>
                  </equal>
                  <equal>
                    <clip pos="1" side="sl" part="a_case"/>
                    <lit-tag v="dg"/>
                  </equal>
                </and>
                </test>
		<call-macro n="modcase">
                  <with-param pos="1"/>
                </call-macro>
                <out>  
		  <lu>
		   <get-case-from pos="1">
                    <lit v="a"/>
		   </get-case-from> 
                    <lit-tag v="pr"/>
                  </lu>
                  <b/>
                  <lu>  
		 
                    <clip pos="1" side="tl" part="lem"/>
 
                    <clip pos="1" side="tl" part="a_nom"/>
                    <clip pos="1" side="tl" part="gen"/>
                    <clip pos="1" side="tl" part="nbr"/>
                  </lu>
		  <b pos="1"/>
                  <lu>
                    <clip pos="2" side="tl" part="lem"/>
                    <clip pos="2" side="tl" part="a_adj"/>
                    <clip pos="2" side="tl" part="gen"/>
                    <clip pos="2" side="tl" part="nbr"/>
                  </lu>
                </out>
              </when>
	    </choose>  
	  </otherwise> 
        </choose>
      </action>
    </rule>
    
  
  
  
    <rule>
<!-- REGLA 40: NOM ADVERBI ADJECTIU -->
      <pattern>
        <pattern-item n="nom"/>
        <pattern-item n="adv"/>
        <pattern-item n="adj"/>
      </pattern>
      <action>
        <call-macro n="f_modgen">
          <with-param pos="3"/>
         </call-macro>
         <call-macro n="f_concord2">
          <with-param pos="1"/>
          <with-param pos="3"/> 
	 </call-macro>  	
         <choose>
          <when>
            <test>
              <and>
                <equal>
                  <clip pos="1" side="sl" part="a_def"/>
                  <lit-tag v="def"/>
                </equal>
                <equal>
                  <clip pos="1" side="sl" part="a_case"/>
                  <lit-tag v="nom"/>
                </equal>
              </and>
            </test>
	    <call-macro n="modcase">
              <with-param pos="1"/>
            </call-macro>
            <choose>
              <when>
                <test>
                  <equal>
                    <clip pos="1" side="tl" part="gen"/>
                    <lit-tag v="mf"/>
                  </equal>
                </test>
               <out>
                  <lu>
		   <get-case-from pos="1">
                    <lit v="el"/> 
		   </get-case-from>
                    <lit-tag v="det.def"/>
                    <clip pos="1" side="sl" part="gen"/>
                    <clip pos="1" side="tl" part="nbr"/>
                  </lu>
                  <b/>
                  <lu>  
		 
                    <clip pos="1" side="tl" part="lem"/>
 
                    <clip pos="1" side="tl" part="a_nom"/>
                    <clip pos="1" side="tl" part="gen"/>
                    <clip pos="1" side="tl" part="nbr"/>
                  </lu>
		  <b pos="1"/>
		  <lu>
		    <clip pos="2" side="tl" part="lem"/>
                    <clip pos="2" side="tl" part="a_adv"/>
		  </lu>
		  <b pos="2"/>
                  <lu>
                    <clip pos="3" side="tl" part="lem"/>
                    <clip pos="3" side="tl" part="a_adj"/>
                    <clip pos="3" side="tl" part="gen"/>
                    <clip pos="3" side="tl" part="nbr"/>
                  </lu>
                </out>
              </when>
              <otherwise>
               <out>
                  <lu>
		   <get-case-from pos="1">
                    <lit v="el"/> 
		   </get-case-from>
                    <lit-tag v="det.def"/>
                    <clip pos="1" side="tl" part="gen"/>
                    <clip pos="1" side="tl" part="nbr"/>
                  </lu>
                  <b/>
                  <lu>  
		 
                    <clip pos="1" side="tl" part="lem"/>
 
                    <clip pos="1" side="tl" part="a_nom"/>
                    <clip pos="1" side="tl" part="gen"/>
                    <clip pos="1" side="tl" part="nbr"/>
                  </lu>
		  <b pos="1"/>
		  <lu>
		    <clip pos="2" side="tl" part="lem"/>
                    <clip pos="2" side="tl" part="a_adv"/>
		  </lu>
		  <b pos="2"/>
                  <lu>
                    <clip pos="3" side="tl" part="lem"/>
                    <clip pos="3" side="tl" part="a_adj"/>
                    <clip pos="3" side="tl" part="gen"/>
                    <clip pos="3" side="tl" part="nbr"/>
                  </lu>
                </out>
              </otherwise>
            </choose>
          </when>
          <otherwise>
            <choose>
              <when>
                <test>
		  <and>
                  <equal>
                    <clip pos="1" side="sl" part="a_def"/>
                    <lit-tag v="ind"/>
                  </equal>
                  <equal>
                    <clip pos="1" side="sl" part="a_case"/>
                    <lit-tag v="nom"/>
                  </equal>
                </and>
                </test>
                <out>
                  <lu>
                    <clip pos="1" side="tl" part="lem"/>
                    <clip pos="1" side="tl" part="a_nom"/>
                    <clip pos="1" side="tl" part="gen"/>
                    <clip pos="1" side="tl" part="nbr"/>
                  </lu>
		  <b pos="1"/>
                   <lu>
		    <clip pos="2" side="tl" part="lem"/>
                    <clip pos="2" side="tl" part="a_adv"/>
		  </lu>
		  <b pos="2"/>
                  <lu>
                    <clip pos="3" side="tl" part="lem"/>
                    <clip pos="3" side="tl" part="a_adj"/>
                    <clip pos="3" side="tl" part="gen"/>
                    <clip pos="3" side="tl" part="nbr"/>
                  </lu>
                </out>
              </when>
            </choose>
          </otherwise>
        </choose>
        <choose>
          <when>
            <test>
              <and>
                <equal>
                  <clip pos="1" side="sl" part="a_def"/>
                  <lit-tag v="def"/>
                </equal>
                <equal>
                  <clip pos="1" side="sl" part="a_case"/>
                  <lit-tag v="dg"/>
                </equal>
              </and>
            </test>
	    <call-macro n="modcase">
              <with-param pos="1"/>
            </call-macro>
            <choose>
              <when>
                <test>
                  <equal>
                    <clip pos="1" side="tl" part="gen"/>
                    <lit-tag v="mf"/>
                  </equal>
                </test>
                <out>
                  <lu>
		   <get-case-from pos="1">
                    <lit v="a"/>  
		   </get-case-from>
                    <lit-tag v="pr"/>
                  </lu>
                  <b/>
                  <lu>
                    <lit v="el"/>
                    <lit-tag v="det.def"/>
                    <clip pos="1" side="sl" part="gen"/>
                    <clip pos="1" side="tl" part="nbr"/>
                  </lu>
                  <b/>
                  <lu>  
		 
                    <clip pos="1" side="tl" part="lem"/>
 
                    <clip pos="1" side="tl" part="a_nom"/>
                    <clip pos="1" side="tl" part="gen"/>
                    <clip pos="1" side="tl" part="nbr"/>
                  </lu>
		  <b pos="1"/>
		  <lu>
		    <clip pos="2" side="tl" part="lem"/>
                    <clip pos="2" side="tl" part="a_adv"/>
		  </lu>
		  <b pos="2"/>
                  <lu>
                    <clip pos="3" side="tl" part="lem"/>
                    <clip pos="3" side="tl" part="a_adj"/>
                    <clip pos="3" side="tl" part="gen"/>
                    <clip pos="3" side="tl" part="nbr"/>
                  </lu>
                </out>
              </when>
              <otherwise>
                <out>
                  <lu>
		   <get-case-from pos="1">
                    <lit v="a"/>  
		   </get-case-from>
                    <lit-tag v="pr"/>
                  </lu>
                  <b/>
                  <lu>
                    <lit v="el"/>
                    <lit-tag v="det.def"/>
                    <clip pos="1" side="tl" part="gen"/>
                    <clip pos="1" side="tl" part="nbr"/>
                  </lu>
                  <b/>
                  <lu>  
		 
                    <clip pos="1" side="tl" part="lem"/>
 
                    <clip pos="1" side="tl" part="a_nom"/>
                    <clip pos="1" side="tl" part="gen"/>
                    <clip pos="1" side="tl" part="nbr"/>
                  </lu>
		  <b pos="1"/>
                   <lu>
		    <clip pos="2" side="tl" part="lem"/>
                    <clip pos="2" side="tl" part="a_adv"/>
		  </lu>
		  <b pos="2"/>
                  <lu>
                    <clip pos="3" side="tl" part="lem"/>
                    <clip pos="3" side="tl" part="a_adj"/>
                    <clip pos="3" side="tl" part="gen"/>
                    <clip pos="3" side="tl" part="nbr"/>
                  </lu>
                </out>
              </otherwise>
            </choose>
          </when>
          <otherwise>
	    <choose>
	      <when>
                <test>
		  <and>
                  <equal>
                    <clip pos="1" side="sl" part="a_def"/>
                    <lit-tag v="ind"/>
                  </equal>
                  <equal>
                    <clip pos="1" side="sl" part="a_case"/>
                    <lit-tag v="dg"/>
                  </equal>
                </and>
                </test>
		<call-macro n="modcase">
                  <with-param pos="1"/>
                </call-macro>
                <out>  
		  <lu>
		   <get-case-from pos="1">
                    <lit v="a"/>
		   </get-case-from>
                    <lit-tag v="pr"/>
                  </lu>
                  <b/>
                  <lu>  
		 
                    <clip pos="1" side="tl" part="lem"/>
 
                    <clip pos="1" side="tl" part="a_nom"/>
                    <clip pos="1" side="tl" part="gen"/>
                    <clip pos="1" side="tl" part="nbr"/>
                  </lu>
		  <b pos="1"/>
                  <lu>
		    <clip pos="2" side="tl" part="lem"/>
                    <clip pos="2" side="tl" part="a_adv"/>
		  </lu>
		  <b pos="2"/>
                  <lu>
                    <clip pos="3" side="tl" part="lem"/>
                    <clip pos="3" side="tl" part="a_adj"/>
                    <clip pos="3" side="tl" part="gen"/>
                    <clip pos="3" side="tl" part="nbr"/>
                  </lu>
                </out>
              </when>
	    </choose>  
	  </otherwise> 
        </choose>
      </action>
    </rule>
    
         
            

	    
    
	    
	    
<!-- cel mai frumos/cei mai frumoçi/cea mai frumoasä/cele mai frumoase - el más bello/los más bellos/la más bella/las más bellas-->
    <rule>
<!--REGLA 41: SUPERLATIU RELATIU-->
      <pattern>
        <pattern-item n="detcel"/>
        <pattern-item n="advmai"/>
        <pattern-item n="adj"/>
      </pattern>
      <action>
        <call-macro n="f_modgen">
          <with-param pos="3"/>
        </call-macro>
        <call-macro n="f_concord2">
          <with-param pos="1"/>
          <with-param pos="3"/>
         </call-macro>
        <choose>
          <when>
            <test>
              <equal>
                <clip pos="1" side="sl" part="a_case"/>
                <lit-tag v="nom"/>
              </equal>
            </test>
            <choose>
              <when>
                <test>
                  <equal>
                    <clip pos="3" side="tl" part="gen"/>
                    <lit-tag v="mf"/>
                  </equal>
                </test>
               <out>
                  <lu>
		   <get-case-from pos="1">
                    <lit v="el"/> 
		   </get-case-from>
                    <lit-tag v="det.def"/>
                    <clip pos="3" side="sl" part="gen"/>
                    <clip pos="3" side="tl" part="nbr"/>
                  </lu>
                  <b/>
                  <lu>
                    <clip pos="2" side="tl" part="lem"/>
                    <clip pos="2" side="tl" part="a_adv"/>
                  </lu>
                  <b/>
                  <lu>
                    <clip pos="3" side="tl" part="lem"/>
                    <clip pos="3" side="tl" part="a_adj"/>
                    <clip pos="3" side="tl" part="gen"/>
                    <clip pos="3" side="tl" part="nbr"/>
                  </lu>
                </out>
              </when>
              <otherwise>
               <out>
                  <lu>
		   <get-case-from pos="1">
                    <lit v="el"/> 
		   </get-case-from>
                    <lit-tag v="det.def"/>
                    <clip pos="3" side="tl" part="gen"/>
                    <clip pos="3" side="tl" part="nbr"/>
                  </lu>
                  <b/>
                  <lu>
                    <clip pos="2" side="tl" part="lem"/>
                    <clip pos="2" side="tl" part="a_adv"/>
                  </lu>
                  <b/>
                  <lu>
                    <clip pos="3" side="tl" part="lem"/>
                    <clip pos="3" side="tl" part="a_adj"/>
                    <clip pos="3" side="tl" part="gen"/>
                    <clip pos="3" side="tl" part="nbr"/>
                  </lu>
                </out>
              </otherwise>
            </choose>
          </when>
	 </choose>
	 <choose> 
          <when>
            <test>
              <equal>
                <clip pos="1" side="sl" part="a_case"/>
                <lit-tag v="dg"/>
              </equal>
            </test>
            <choose>
              <when>
                <test>
                  <equal>
                    <clip pos="3" side="tl" part="gen"/>
                    <lit-tag v="mf"/>
                  </equal>
                </test>
                <out>
                  <lu>
		   <get-case-from pos="1">
                    <lit v="a"/>  
		   </get-case-from>
                    <lit-tag v="pr"/>
                  </lu>
                  <b/>
                  <lu>
                    <lit v="el"/>
                    <lit-tag v="det.def"/>
                    <clip pos="3" side="sl" part="gen"/>
                    <clip pos="3" side="tl" part="nbr"/>
                  </lu>
                  <b/>
                  <lu>
                    <clip pos="2" side="tl" part="lem"/>
                    <clip pos="2" side="tl" part="a_adv"/>
                  </lu>
                  <b/>
                  <lu>
                    <clip pos="3" side="tl" part="lem"/>
                    <clip pos="3" side="tl" part="a_adj"/>
                    <clip pos="3" side="sl" part="gen"/>
                    <clip pos="3" side="tl" part="nbr"/>
                  </lu>
                </out>
              </when>
                <otherwise>
                  <out>
                    <lu> 
		    <get-case-from pos="1">
                      <lit v="a"/>
		    </get-case-from> 
                      <lit-tag v="pr"/>
                    </lu>
                    <b/>
                    <lu>
                      <lit v="el"/>
                      <lit-tag v="det.def"/>
                      <clip pos="3" side="tl" part="gen"/>
                      <clip pos="3" side="tl" part="nbr"/>
                    </lu>
                    <b/>
                      <lu>
                        <clip pos="2" side="tl" part="lem"/>
                        <clip pos="2" side="tl" part="a_adv"/>
                      </lu>
                      <b/>
                      <lu>
                        <clip pos="3" side="tl" part="lem"/>
                        <clip pos="3" side="tl" part="a_adj"/>
                        <clip pos="3" side="tl" part="gen"/>
                        <clip pos="3" side="tl" part="nbr"/>
                      </lu>
                    </out>
              </otherwise>
            </choose>
	  </when>    
	</choose>  
      </action>
    </rule>
    
    	        

<!-- nespus de frumos/nespus de frumoçi/nespus de frumoasä/nespus de frumoase - bellíssimo/bellíssimos/bellíssima/bellíssimas-->
    <rule>
<!-- REGLA 42: SUPERLATIU ABSOLUT -->
      <pattern>
        <pattern-item n="advnespus"/>
        <pattern-item n="prepde"/>
        <pattern-item n="adj"/>
      </pattern>
      <action>  
        <call-macro n="f_concord1">
          <with-param pos="3"/>
        </call-macro>
        <call-macro n="f_modgen">
          <with-param pos="3"/>
        </call-macro>
        <choose>
          <when>
            <test>
              <equal>
                <clip pos="3" side="sl" part="a_case"/>
                <lit-tag v="nom"/>
              </equal>
             </test>
                <out>
                  <lu>
		   <get-case-from pos="1">
                    <clip pos="3" side="tl" part="lem"/>
		   </get-case-from>
                    <clip pos="3" side="tl" part="a_adj"/>
                    <lit-tag v="sup"/>
                    <clip pos="3" side="tl" part="gen"/>
                    <clip pos="3" side="tl" part="nbr"/>
                  </lu>
                </out>
              </when>
              <otherwise>
                <out>
                  <lu>
                    <clip pos="3" side="tl" part="lem"/>
                    <clip pos="3" side="tl" part="a_adj"/>
                    <lit-tag v="sup"/>
                    <clip pos="3" side="tl" part="gen"/>
                    <clip pos="3" side="tl" part="nbr"/>
                  </lu>
                </out>
              </otherwise>
            </choose>
      </action>
    </rule>

     <rule>
<!-- REGLA 43bis: PREP + PREPA + PRN REFLEXIU + INF -->
      <pattern>
        <pattern-item n="prep"/>
        <pattern-item n="prepa"/>
        <pattern-item n="prnpro"/>
        <pattern-item n="verb"/>
      </pattern>
      <action> 
          <out>
               <lu>
	          <get-case-from pos="1">
                  <clip pos="1" side="tl" part="lem"/>
		  </get-case-from>
                  <clip pos="1" side="tl" part="a_prep"/>
		</lu>
		<b pos="1"/>
                <mlu>
                 <lu>
                   <clip pos="4" side="tl" part="lemh"/>
                   <clip pos="4" side="tl" part="a_verb"/>
                   <lit-tag v="inf"/>
                 </lu>
               <lu>
                   <clip pos="3" side="tl" part="lem"/>
                   <clip pos="3" side="tl" part="a_prnenc"/>
                   <clip pos="3" side="tl" part="persona"/>
                   <clip pos="3" side="tl" part="gen"/>
                   <clip pos="3" side="tl" part="nbr"/>
                   <clip pos="4" side="tl" part="lemq"/>
                </lu>
               </mlu>
                </out>
      </action>
    </rule>
    
      

     <rule>
<!-- REGLA 43: PREP + PREPA + INF -->
      <pattern>
        <pattern-item n="prep"/>
        <pattern-item n="prepa"/>
        <pattern-item n="verb"/>
      </pattern>
      <action>  
          <out>
               <lu>
	          <get-case-from pos="1">
                  <clip pos="1" side="tl" part="lem"/>
		  </get-case-from>
                  <clip pos="1" side="tl" part="a_prep"/>
		</lu>
		<b pos="1"/>
		<lu>
		  <clip pos="3" side="tl" part="lem"/>
		  <clip pos="3" side="tl" part="a_verb"/>
		  <lit-tag v="inf"/>
                 </lu>
                </out>
      </action>
    </rule>
    
    
    <rule>
<!--REGLA 44: NOM DETERMINANT ADJECTIU -->
      <pattern>
        <pattern-item n="nom"/>
        <pattern-item n="detcel"/>
        <pattern-item n="adj"/>
      </pattern>
      <action>
       <call-macro n="f_modgen">
              <with-param pos="3"/>
            </call-macro>
	    <call-macro n="f_modgen">
              <with-param pos="2"/>
            </call-macro>
            <call-macro n="f_concord3">
              <with-param pos="1"/>
              <with-param pos="2"/>
              <with-param pos="3"/>
            </call-macro>
        <choose>
          <when>
            <test>
              <and>
                <equal>
                  <clip pos="1" side="sl" part="a_case"/>
                  <lit-tag v="nom"/>
                </equal>
                <equal>
                  <clip pos="1" side="sl" part="a_def"/>
                  <lit-tag v="def"/>
                </equal>
              </and>
            </test>
	    <call-macro n="modcase">
               <with-param pos="1"/>
            </call-macro>
            <out>
              <lu> 
	       <get-case-from pos="1">
                <lit v="el"/>
	       </get-case-from>
                <lit-tag v="det.def"/>
                <clip pos="1" side="tl" part="gen"/>
                <clip pos="1" side="tl" part="nbr"/>
              </lu>
              <b pos="1"/>
              <lu>
                <clip pos="1" side="tl" part="lem"/>
                <clip pos="1" side="tl" part="a_nom"/>
                <clip pos="1" side="tl" part="gen"/>
                <clip pos="1" side="tl" part="nbr"/>
              </lu>
              <b pos="2"/>
              <lu>
                <clip pos="3" side="tl" part="lem"/>
                <clip pos="3" side="tl" part="a_adj"/>
                <clip pos="3" side="tl" part="gen"/>
                <clip pos="3" side="tl" part="nbr"/>
              </lu>
            </out>
          </when>
          <when>
            <test>
              <and>
                <equal>
                  <clip pos="1" side="sl" part="a_def"/>
                  <lit-tag v="def"/>
                </equal>
                <equal>
                  <clip pos="1" side="sl" part="a_case"/>
                  <lit-tag v="dg"/>
                </equal>
              </and>
            </test>
	    <call-macro n="modcase">
               <with-param pos="1"/>
            </call-macro>
            <out>
              <lu>
	      <get-case-from pos="1">
                <lit v="a"/>
		</get-case-from>
                <lit-tag v="pr"/>
              </lu>
              <b/>
              <lu>
                <lit v="el"/>
                <lit-tag v="det.def"/>
                <clip pos="1" side="tl" part="gen"/>
                <clip pos="1" side="tl" part="nbr"/>
              </lu>
              <b pos="1"/>
              <lu>
                <clip pos="1" side="tl" part="lem"/>
                <clip pos="1" side="tl" part="a_nom"/>
                <clip pos="1" side="tl" part="gen"/>
                <clip pos="1" side="tl" part="nbr"/>
              </lu>
              <b/>
              <lu>
                <clip pos="2" side="tl" part="lem"/>
                <clip pos="2" side="tl" part="a_adj"/>
                <clip pos="1" side="tl" part="gen"/>
                <clip pos="1" side="tl" part="nbr"/>
              </lu>
            </out>
          </when>
          <otherwise>
            <out>
              <lu>
                <clip pos="1" side="tl" part="lem"/>
                <clip pos="1" side="tl" part="a_nom"/>
                <clip pos="1" side="tl" part="gen"/>
                <clip pos="1" side="tl" part="nbr"/>
              </lu>
              <b pos="1"/>
              <lu>
                <clip pos="3" side="tl" part="lem"/>
                <clip pos="3" side="tl" part="a_adj"/>
                <clip pos="3" side="tl" part="gen"/>
                <clip pos="3" side="tl" part="nbr"/>
              </lu>
            </out>
          </otherwise>
        </choose>
      </action>
    </rule>
    
    <rule>
<!-- REGLA 45: DETERMINANT  NOM ADJECTIU -->
      <pattern>
        <pattern-item n="det"/>
        <pattern-item n="nom"/>
        <pattern-item n="adj"/>
      </pattern>
      <action>
         <call-macro n="f_modgen">
              <with-param pos="1"/>
            </call-macro>
            <call-macro n="f_modgen">
              <with-param pos="3"/>
            </call-macro>
            <call-macro n="f_concord3">
              <with-param pos="2"/>
              <with-param pos="3"/>
              <with-param pos="1"/>
            </call-macro>
        <choose>          
          <when>
            <test>
              <equal>
                <clip pos="1" side="sl" part="a_case"/>
                <lit-tag v="dg"/>
              </equal>
            </test>
	    <call-macro n="modcase">
               <with-param pos="1"/>
            </call-macro>
            <out>
              <lu>
	       <get-case-from pos="1">
                <lit v="a"/> 
	       </get-case-from>
                <lit-tag v="pr"/>
              </lu>
              <b/>
              <lu>
                <clip pos="1" side="tl" part="lem"/>
                <clip pos="1" side="tl" part="a_det"/>
                <clip pos="1" side="tl" part="gen"/>
                <clip pos="1" side="tl" part="nbr"/>
              </lu>
              <b pos="1"/>
              <lu>
                <clip pos="2" side="tl" part="lem"/>
                <clip pos="2" side="tl" part="a_nom"/>
                <clip pos="2" side="tl" part="gen"/>
                <clip pos="2" side="tl" part="nbr"/>
              </lu>
              <b pos="2"/>
              <lu>
                <clip pos="3" side="tl" part="lem"/>
                <clip pos="3" side="tl" part="a_adj"/>
                <clip pos="3" side="tl" part="gen"/>
                <clip pos="3" side="tl" part="nbr"/>
              </lu>
            </out>
          </when>
	<otherwise>
	<out>
              <lu>
                <clip pos="1" side="tl" part="lem"/>
                <clip pos="1" side="tl" part="a_det"/>
                <clip pos="1" side="tl" part="gen"/>
                <clip pos="1" side="tl" part="nbr"/>
              </lu>
              <b pos="1"/>
              <lu>
                <clip pos="2" side="tl" part="lem"/>
                <clip pos="2" side="tl" part="a_nom"/>
                <clip pos="2" side="tl" part="gen"/>
                <clip pos="2" side="tl" part="nbr"/>
              </lu>
              <b pos="2"/>
              <lu>
                <clip pos="3" side="tl" part="lem"/>
                <clip pos="3" side="tl" part="a_adj"/>
                <clip pos="3" side="tl" part="gen"/>
                <clip pos="3" side="tl" part="nbr"/>
              </lu>
            </out>
	</otherwise>
        </choose>
      </action>
     </rule>
     
     
      <rule>
<!-- REGLA 46: DETERMINANT ADJECTIU  NOM-->
      <pattern>
        <pattern-item n="det"/>
	<pattern-item n="adj"/>
        <pattern-item n="nom"/>
      </pattern>
      <action> 
       <call-macro n="f_modgen">
              <with-param pos="1"/>
            </call-macro>
         <call-macro n="f_modgen">
              <with-param pos="2"/>
            </call-macro>
            <call-macro n="f_concord3">
              <with-param pos="3"/>
              <with-param pos="2"/>
              <with-param pos="1"/>
            </call-macro>
        <choose>          
          <when>
            <test>
              <equal>
                <clip pos="1" side="sl" part="a_case"/>
                <lit-tag v="dg"/>
              </equal>
            </test>
	    <call-macro n="modcase">
               <with-param pos="1"/>
            </call-macro>
            <out>
              <lu>
	       <get-case-from pos="1">
                <lit v="a"/> 
	       </get-case-from>
                <lit-tag v="pr"/>
              </lu>
              <b/>
              <lu>
                <clip pos="1" side="tl" part="lem"/>
                <clip pos="1" side="tl" part="a_det"/>
                <clip pos="1" side="tl" part="gen"/>
                <clip pos="1" side="tl" part="nbr"/>
              </lu>
              <b pos="1"/>
              <lu>
                <clip pos="2" side="tl" part="lem"/>
                <clip pos="2" side="tl" part="a_adj"/>
                <clip pos="2" side="tl" part="gen"/>
                <clip pos="2" side="tl" part="nbr"/>
              </lu>
              <b pos="2"/>
              <lu>
                <clip pos="3" side="tl" part="lem"/>
                <clip pos="3" side="tl" part="a_nom"/>
                <clip pos="3" side="tl" part="gen"/>
                <clip pos="3" side="tl" part="nbr"/>
              </lu>
            </out>
          </when>
	<otherwise>
	<out>
              <lu>
                <clip pos="1" side="tl" part="lem"/>
                <clip pos="1" side="tl" part="a_det"/>
                <clip pos="1" side="tl" part="gen"/>
                <clip pos="1" side="tl" part="nbr"/>
              </lu>
              <b pos="1"/>
              <lu>
                <clip pos="2" side="tl" part="lem"/>
                <clip pos="2" side="tl" part="a_adj"/>
                <clip pos="2" side="tl" part="gen"/>
                <clip pos="2" side="tl" part="nbr"/>
              </lu>
              <b pos="2"/>
              <lu>
                <clip pos="3" side="tl" part="lem"/>
                <clip pos="3" side="tl" part="a_nom"/>
                <clip pos="3" side="tl" part="gen"/>
                <clip pos="3" side="tl" part="nbr"/>
              </lu>
            </out>
	</otherwise>
        </choose>
      </action>
     </rule>
     
     
  
<rule>
     <!-- REGLA 47: DETERMINANT  NOM -->
      <pattern>
        <pattern-item n="det"/>
        <pattern-item n="nom"/>
      </pattern>
      <action>
        <call-macro n="f_modgen">
           <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_concord2">
          <with-param pos="2"/>
          <with-param pos="1"/>
        </call-macro>      
        <choose>	
          
          <when>
            <test>
              <equal>
                <clip pos="1" side="sl" part="a_case"/>
                <lit-tag v="dg"/>
              </equal>
            </test>
	    <call-macro n="modcase">
               <with-param pos="1"/>
            </call-macro>
             <out>
              <lu>
	      <get-case-from pos="1">
                <lit v="a"/> 
	       </get-case-from> 
                <lit-tag v="pr"/>
              </lu>
              <b/>
              <lu>
                <clip pos="1" side="tl" part="lem"/>
                <clip pos="1" side="tl" part="a_det"/>
                <clip pos="1" side="tl" part="gen"/>
                <clip pos="1" side="tl" part="nbr"/>
              </lu>
              <b pos="1"/>
              <lu>
                <clip pos="2" side="tl" part="lem"/>
                <clip pos="2" side="tl" part="a_nom"/>
                <clip pos="2" side="tl" part="gen"/>
                <clip pos="2" side="tl" part="nbr"/>
              </lu>
              </out>
          </when>
	<otherwise>
	<out>
              <lu>
                <clip pos="1" side="tl" part="lem"/>
                <clip pos="1" side="tl" part="a_det"/>
                <clip pos="1" side="tl" part="gen"/>
                <clip pos="1" side="tl" part="nbr"/>
              </lu>
              <b pos="1"/>
              <lu>
                <clip pos="2" side="tl" part="lem"/>
                <clip pos="2" side="tl" part="a_nom"/>
                <clip pos="2" side="tl" part="gen"/>
                <clip pos="2" side="tl" part="nbr"/>
              </lu>
              </out>
	</otherwise>
        </choose>
      </action>
     </rule>
     
     
<!--  REGLA 48: NOM NOM per a traduir "cartea fetei" com a "el libro de la chica" o sigui el cas Genitiu  -->
    <rule>
      <pattern>
        <pattern-item n="nom"/>
        <pattern-item n="nom"/>
      </pattern>
      <action>
         <call-macro n="f_concord1">
          <with-param pos="1"/>
        </call-macro>   
	 <call-macro n="f_concord1">
          <with-param pos="2"/>
        </call-macro>   
        <choose>
          <when>
            <test>
              <and>
                <equal>
                  <clip pos="1" side="sl" part="a_case"/>
                  <lit-tag v="nom"/>
                </equal>
                <equal>
                  <clip pos="1" side="sl" part="a_def"/>
                  <lit-tag v="def"/>
                </equal>
                <equal>
                  <clip pos="2" side="sl" part="a_case"/>
                  <lit-tag v="dg"/>
                </equal>
                <equal>
                  <clip pos="2" side="sl" part="a_def"/>
                  <lit-tag v="def"/>
                </equal>
              </and>
            </test>
	    <call-macro n="modcase">
               <with-param pos="1"/>
            </call-macro>
            <out>
              <lu> 
	      <get-case-from pos="1">
                <lit v="el"/>
	      </get-case-from> 
                <lit-tag v="det.def"/>
                <clip pos="1" side="tl" part="gen"/>
                <clip pos="1" side="tl" part="nbr"/>
              </lu>
              <b/>
              <lu>
                <clip pos="1" side="tl" part="lem"/>
                <clip pos="1" side="tl" part="a_nom"/>
                <clip pos="1" side="tl" part="gen"/>
                <clip pos="1" side="tl" part="nbr"/>
              </lu>
              <b/>
              <lu>
                <lit v="de"/>
                <lit-tag v="pr"/>
              </lu>
              <b/>
              <lu>
                <lit v="el"/>
                <lit-tag v="det.def"/>
                <clip pos="2" side="tl" part="gen"/>
                <clip pos="2" side="tl" part="nbr"/>
              </lu>
              <b/>
              <lu>
                <clip pos="2" side="tl" part="lem"/>
                <clip pos="2" side="tl" part="a_nom"/>
                <clip pos="2" side="tl" part="gen"/>
                <clip pos="2" side="tl" part="nbr"/>
              </lu>
            </out>
          </when>
          <otherwise>
            <out>
              <lu>
                <clip pos="1" side="tl" part="lem"/>
                <clip pos="1" side="tl" part="a_nom"/>
                <clip pos="1" side="tl" part="gen"/>
                <clip pos="1" side="tl" part="nbr"/>
              </lu>
              <b pos="1"/>
              <lu>
                <clip pos="2" side="tl" part="lem"/>
                <clip pos="2" side="tl" part="a_nom"/>
                <clip pos="2" side="tl" part="gen"/>
                <clip pos="2" side="tl" part="nbr"/>
              </lu>
            </out>
          </otherwise>
        </choose>
      </action>
    </rule>
    
    
    
<rule> <!-- REGLA 49 VBTREBUI+ SÄ + VERB : TENER + INF -->
  <pattern>
      <pattern-item n="verbtrebui"/>
      <pattern-item n="conjsub"/>
      <pattern-item n="verb"/>
    </pattern>
    <action>
     <call-macro n="f_modgen">
          <with-param pos="1"/>
        </call-macro> 
    <choose>
	<when>
	  <test>
	    <equal>
	      <clip pos="1" side="tl" part="temps"/>
	      <lit-tag v="ger"/>
	    </equal>
	  </test>
	  <out>
          <lu>
            <clip pos="1" side="tl" part="lemh"/>
            <clip pos="1" side="tl" part="a_verb"/>
            <clip pos="1" side="tl" part="temps"/>
	    <clip pos="1" side="tl" part="lemq"/>
          </lu>
	   <b pos="1"/>
	    <lu>
            <lit v="que"/>
            <lit-tag v="cnjsub"/>
          </lu>
	  <b pos="2"/>
	  <lu>
            <clip pos="3" side="tl" part="lemh"/>
            <clip pos="3" side="tl" part="a_verb"/>
            <lit-tag v="inf"/>
            <clip pos="3" side="tl" part="lemq"/>
          </lu>
        </out> 
	</when>
	<otherwise>
        <out>
          <lu>
            <clip pos="1" side="tl" part="lemh"/>
            <clip pos="1" side="tl" part="a_verb"/>
            <clip pos="1" side="tl" part="temps"/>
            <clip pos="3" side="tl" part="persona"/>
            <clip pos="1" side="tl" part="gen"/>
            <clip pos="3" side="tl" part="nbr"/>
	    <clip pos="1" side="tl" part="lemq"/>
          </lu>
	  <b pos="1"/>
	    <lu>
            <lit v="que"/>
            <lit-tag v="cnjsub"/>
          </lu>
	  <b pos="2"/>
	  <lu>
            <clip pos="3" side="tl" part="lemh"/>
            <clip pos="3" side="tl" part="a_verb"/>
            <lit-tag v="inf"/>
            <clip pos="3" side="tl" part="lemq"/>
          </lu>
        </out>
       </otherwise>
      </choose>
    </action>
</rule> 

    
<rule> <!-- REGLA 50 DELIA ADVNU + ADVMAI + VB : YA NO + VB -->
  <pattern>
      <pattern-item n="advnu"/>
      <pattern-item n="advmai"/>
      <pattern-item n="verb"/>
    </pattern>
    <action> 
      <out>
          <lu>
            <lit v="ya"/>
            <lit-tag v="adv"/>
          </lu> 
          <b pos="1"/>
          <lu>
            <lit v="no"/>
            <lit-tag v="adv"/>
          </lu> 
          <b pos="2"/>
          <lu>
            <clip pos="3" side="tl" part="lem"/>
            <clip pos="3" side="tl" part="a_verb"/>
            <clip pos="3" side="tl" part="temps"/>
            <clip pos="3" side="tl" part="gen"/>
	    <clip pos="3" side="tl" part="persona"/>
            <clip pos="3" side="tl" part="nbr"/>
          </lu>                                
        </out>	
    </action>
</rule> 
    
<rule> <!-- REGLA 51 Futur TREBUI VBMOD - Tendré que inf-->
  <pattern>
      <pattern-item n="vrea"/>
      <pattern-item n="verbtrebui"/>
      <pattern-item n="conjsub"/>
      <pattern-item n="verb"/>
    </pattern>
    <action> 
        <out>
          <lu>
	  <get-case-from pos="1">
            <clip pos="2" side="tl" part="lemh"/>
          </get-case-from>
            <clip pos="2" side="tl" part="a_verb"/>
            <lit-tag v="fti"/>
            <clip pos="4" side="tl" part="persona"/>
            <clip pos="2" side="tl" part="gen"/>
            <clip pos="4" side="tl" part="nbr"/>
	    <clip pos="2" side="tl" part="lemq"/>
          </lu>
	  <b pos="1"/>
	    <lu>
            <lit v="que"/>
            <lit-tag v="cnjsub"/>
          </lu>
	  <b pos="2"/>
	  <lu>
            <clip pos="4" side="tl" part="lemh"/>
            <clip pos="4" side="tl" part="a_verb"/>
            <lit-tag v="inf"/>
            <clip pos="4" side="tl" part="lemq"/>
          </lu>
        </out>
    </action>
</rule> 
 
<rule> <!-- REGLA 52 DELIA CNJNICI + ADVNU + VB : NI + VB: nici nu plânge, nici nu râde = ni llora, ni ríe -->
  <pattern>
      <pattern-item n="conjnici"/>
      <pattern-item n="advnu"/>
      <pattern-item n="verb"/>
    </pattern>
    <action> 
      <out>
          <lu>
            <lit v="ni"/>
            <lit-tag v="cnjcoo"/>
          </lu> 
          <b pos="1"/>
          <lu>
            <clip pos="3" side="tl" part="lem"/>
            <clip pos="3" side="tl" part="a_verb"/>
            <clip pos="3" side="tl" part="temps"/>
            <clip pos="3" side="tl" part="gen"/>
	    <clip pos="3" side="tl" part="persona"/>
            <clip pos="3" side="tl" part="nbr"/>
           </lu>                                
        </out>	
    </action>
</rule> 

<rule> <!-- REGLA 53 DELIA ADVNICIODATÄ + ADVNU + VB : NUNCA + VB: niciodatä nu plânge = nunca llora -->
  <pattern>
      <pattern-item n="advnici-"/>
      <pattern-item n="advnu"/>
      <pattern-item n="verb"/>
    </pattern>
    <action> 
      <out>
          <lu>
            <clip pos="1" side="tl" part="lem"/>
            <clip pos="1" side="tl" part="a_adv"/>            
          </lu> 
          <b pos="1"/>
          <lu>
            <clip pos="3" side="tl" part="lem"/>
            <clip pos="3" side="tl" part="a_verb"/>
            <clip pos="3" side="tl" part="temps"/>
            <clip pos="3" side="tl" part="gen"/>
	    <clip pos="3" side="tl" part="persona"/>
            <clip pos="3" side="tl" part="nbr"/>
           </lu>                                
        </out>	
    </action>
</rule> 


<rule> <!-- REGLA 54 DELIA ADVNU + VB + ADVDECÂT : NO + VB + MÁS + QUE -->
  <pattern>
      <pattern-item n="advnu"/>
      <pattern-item n="verb"/>
       <pattern-item n="advdecât"/>
    </pattern>
    <action> 
       <call-macro n="f_modgen">
          <with-param pos="2"/>
        </call-macro>
      <out>
          <lu>
            <clip pos="1" side="tl" part="lem"/>
            <clip pos="1" side="tl" part="a_adv"/>            
          </lu> 
          <b pos="1"/>
          <lu>
            <clip pos="2" side="tl" part="lem"/>
            <clip pos="2" side="tl" part="a_verb"/>
            <clip pos="2" side="tl" part="temps"/>
            <clip pos="2" side="tl" part="gen"/>
	    <clip pos="2" side="tl" part="persona"/>
            <clip pos="2" side="tl" part="nbr"/>
          </lu>
          <b pos="2"/>
          <lu>
            <lit v="más"/>
            <lit-tag v="adv"/>
          </lu> 
          <b/>                                               
        </out>	
    </action>
</rule>        



<rule> <!-- REGLA 55 DELIA ADVNU + VB + ADVDECÂT + NOM: NO + VB + MÁS + QUE + NOM-->
  <pattern>
      <pattern-item n="advnu"/>
      <pattern-item n="verb"/>
      <pattern-item n="advdecât"/>
      <pattern-item n="nom"/>
    </pattern>
    <action>
      <call-macro n="f_modgen">
        <with-param pos="4"/>
      </call-macro> 
      <choose>
          <when>
            <test>
                 <equal>
                  <clip pos="4" side="sl" part="a_def"/>
                  <lit-tag v="ind"/>
                </equal>                
            </test>
          <out>
          <lu>
            <clip pos="1" side="tl" part="lem"/>
            <clip pos="1" side="tl" part="a_adv"/>            
          </lu> 
          <b pos="1"/>
          <lu>
            <clip pos="2" side="tl" part="lem"/>
            <clip pos="2" side="tl" part="a_verb"/>
            <clip pos="2" side="tl" part="temps"/>
            <clip pos="2" side="tl" part="gen"/>
	    <clip pos="2" side="tl" part="persona"/>
            <clip pos="2" side="tl" part="nbr"/>
          </lu>
          <b pos="2"/>
          <lu>
            <lit v="más"/>
            <lit-tag v="adv"/>
          </lu>
          <b pos="3"/> 
          <lu>
            <lit v="que"/>
            <lit-tag v="adv"/>
          </lu> 
          <b/>
          <lu>
          <clip pos="4" side="tl" part="lem"/>
                <clip pos="4" side="tl" part="a_det"/>
                <clip pos="4" side="tl" part="gen"/>
               <clip pos="4" side="tl" part="nbr"/>
          </lu>
          <b/>
          <lu>
                <clip pos="4" side="tl" part="lem"/>
                <clip pos="4" side="tl" part="a_nom"/>
                <clip pos="4" side="tl" part="gen"/>
                <clip pos="4" side="tl" part="nbr"/>
          </lu>                                     
        </out>
        </when>
        <otherwise>
        <out>
          <lu>
            <clip pos="1" side="tl" part="lem"/>
            <clip pos="1" side="tl" part="a_adv"/>            
          </lu> 
          <b pos="1"/>
          <lu>
            <clip pos="2" side="tl" part="lem"/>
            <clip pos="2" side="tl" part="a_verb"/>
            <clip pos="2" side="tl" part="temps"/>
            <clip pos="2" side="tl" part="gen"/>
	    <clip pos="2" side="tl" part="persona"/>
            <clip pos="2" side="tl" part="nbr"/>
          </lu>
          <b pos="2"/>
          <lu>
            <lit v="más"/>
            <lit-tag v="adv"/>
          </lu>
          <b pos="3"/> 
          <lu>
            <lit v="que"/>
            <lit-tag v="adv"/>
          </lu> 
          <b/>
          <lu>
            <lit v="el"/>
            <lit-tag v="det.def"/>
            <clip pos="4" side="tl" part="gen"/>
            <clip pos="4" side="tl" part="nbr"/>
          </lu>
          <b/>          
          <lu>
                <clip pos="4" side="tl" part="lem"/>
                <clip pos="4" side="tl" part="a_nom"/>
                <clip pos="4" side="tl" part="gen"/>
                <clip pos="4" side="tl" part="nbr"/>
          </lu>                                     
        </out>
      </otherwise>
     </choose>	
    </action>
</rule>        
 

<rule> <!-- REGLA 56 Condicional TREBUI VBMOD - Tendría que inf-->
  <pattern>
      <pattern-item n="vbaveacni"/>
      <pattern-item n="verbtrebui"/>
      <pattern-item n="conjsub"/>
      <pattern-item n="verb"/>
    </pattern>
    <action> 
        <out>
          <lu>
	  <get-case-from pos="1">
            <clip pos="2" side="tl" part="lemh"/>
          </get-case-from>
            <clip pos="2" side="tl" part="a_verb"/>
            <lit-tag v="cni"/>
            <clip pos="4" side="tl" part="persona"/>
            <clip pos="2" side="tl" part="gen"/>
            <clip pos="4" side="tl" part="nbr"/>
	    <clip pos="2" side="tl" part="lemq"/>
          </lu>
	  <b pos="1"/>
	    <lu>
            <lit v="que"/>
            <lit-tag v="cnjsub"/>
          </lu>
	  <b pos="2"/>
	  <lu>
            <clip pos="4" side="tl" part="lemh"/>
            <clip pos="4" side="tl" part="a_verb"/>
            <lit-tag v="inf"/>
            <clip pos="4" side="tl" part="lemq"/>
          </lu>
        </out>
    </action>
</rule> 

<rule> <!-- REGLA 57 Perfecte compost  A TREBUIT VBMOD - Tuvo que inf-->
  <pattern>
      <pattern-item n="vbaveapri"/>
      <pattern-item n="verbtrebui"/>
      <pattern-item n="conjsub"/>
      <pattern-item n="verb"/>
    </pattern>
    <action> 
        <out>
          <lu>
	  <get-case-from pos="1">
            <clip pos="2" side="tl" part="lemh"/>
          </get-case-from>
            <clip pos="2" side="tl" part="a_verb"/>
            <lit-tag v="ifi"/>
            <clip pos="4" side="tl" part="persona"/>
            <clip pos="2" side="tl" part="gen"/>
            <clip pos="4" side="tl" part="nbr"/>
	    <clip pos="2" side="tl" part="lemq"/>
          </lu>
	  <b pos="1"/>
	    <lu>
            <lit v="que"/>
            <lit-tag v="cnjsub"/>
          </lu>
	  <b pos="2"/>
	  <lu>
            <clip pos="4" side="tl" part="lemh"/>
            <clip pos="4" side="tl" part="a_verb"/>
            <lit-tag v="inf"/>
            <clip pos="4" side="tl" part="lemq"/>
          </lu>
        </out>
    </action>
</rule>     
    
    
<!-- REGLA 58 DATIU: VERB + NOM = VERB + A + NOM -->
    <rule>
      <pattern>
        <pattern-item n="verb"/>
        <pattern-item n="nom"/>
      </pattern>
      <action>
      <call-macro n="f_modgen">
        <with-param pos="1"/>
      </call-macro>
        <choose>
          <when>
            <test>
              <and>
                <equal>
                  <clip pos="2" side="sl" part="a_case"/>
                  <lit-tag v="dg"/>
                </equal>
                <equal>
                  <clip pos="2" side="sl" part="a_def"/>
                  <lit-tag v="def"/>
                </equal>
              </and>
            </test>
            <out>
              <lu>
                <clip pos="1" side="tl" part="lemh"/>
                <clip pos="1" side="tl" part="a_verb"/>
                <clip pos="1" side="tl" part="temps"/>
                <clip pos="1" side="tl" part="persona"/>
                <clip pos="1" side="tl" part="gen"/>
                <clip pos="1" side="tl" part="nbr"/>
              </lu>
              <b/>
              <lu>
                <lit v="a"/>
                <lit-tag v="pr"/>
              </lu>
              <b/>
              <lu>
                <lit v="el"/>
                <lit-tag v="det.def"/>
                <clip pos="2" side="tl" part="gen"/>
                <clip pos="2" side="tl" part="nbr"/>
              </lu>
              <b pos="1"/>
              <lu>
                <clip pos="2" side="tl" part="lem"/>
                <clip pos="2" side="tl" part="a_nom"/>
                <clip pos="2" side="tl" part="gen"/>
                <clip pos="2" side="tl" part="nbr"/>
              </lu>
            </out>
          </when>
          <when>
            <test>
              <and>
                <equal>
                  <clip pos="2" side="sl" part="a_case"/>
                  <lit-tag v="nom"/>
                </equal>
                <equal>
                  <clip pos="2" side="sl" part="a_def"/>
                  <lit-tag v="def"/>
                </equal>
              </and>
            </test>
            <out>
              <lu>
                <clip pos="1" side="tl" part="lemh"/>
                <clip pos="1" side="tl" part="a_verb"/>
                <clip pos="1" side="tl" part="temps"/>
                <clip pos="1" side="tl" part="persona"/>          
		<clip pos="1" side="tl" part="gen"/>
                <clip pos="1" side="tl" part="nbr"/>
              </lu>
              <b/>
              <lu>
                <lit v="el"/>
                <lit-tag v="det.def"/>
                <clip pos="2" side="tl" part="gen"/>
                <clip pos="2" side="tl" part="nbr"/>
              </lu>
              <b/>
              <lu>
                <clip pos="2" side="tl" part="lem"/>
                <clip pos="2" side="tl" part="a_nom"/>
                <clip pos="2" side="tl" part="gen"/>
                <clip pos="2" side="tl" part="nbr"/>
              </lu>
            </out>
            </when>
          <otherwise>
            <out>
              <lu>
                <clip pos="1" side="tl" part="lemh"/>
                <clip pos="1" side="tl" part="a_verb"/>
                <clip pos="1" side="tl" part="temps"/>
                <clip pos="1" side="tl" part="persona"/>          
		<clip pos="1" side="tl" part="gen"/>
                <clip pos="1" side="tl" part="nbr"/>
              </lu>
              <b/>
              <lu>
                <clip pos="2" side="tl" part="lem"/>
                <clip pos="2" side="tl" part="a_nom"/>
                <clip pos="2" side="tl" part="gen"/>
                <clip pos="2" side="tl" part="nbr"/>
              </lu>
            </out>
          </otherwise>
        </choose>
      </action>
    </rule>

   <!-- REGLA 59 DATIU: VERB + NOM + ADJ= VERB + A + NOM + ADJ-->
    <rule>
      <pattern>
        <pattern-item n="verb"/>
        <pattern-item n="nom"/>
        <pattern-item n="adj"/>
      </pattern>
      <action>
      <call-macro n="f_modgen">
        <with-param pos="1"/>
      </call-macro>
      <call-macro n="f_modgen">
        <with-param pos="2"/>
      </call-macro>
      <call-macro n="f_modgen">
        <with-param pos="3"/>
      </call-macro>
      <call-macro n="f_concord2">
          <with-param pos="2"/>
          <with-param pos="3"/> 
	</call-macro> 
        <choose>
          <when>
            <test>
              <and>
                <equal>
                  <clip pos="2" side="sl" part="a_case"/>
                  <lit-tag v="dg"/>
                </equal>
                <equal>
                  <clip pos="2" side="sl" part="a_def"/>
                  <lit-tag v="def"/>
                </equal>
              </and>
            </test>
            <out>
              <lu>
                <clip pos="1" side="tl" part="lemh"/>
                <clip pos="1" side="tl" part="a_verb"/>
                <clip pos="1" side="tl" part="temps"/>
                <clip pos="1" side="tl" part="persona"/>
                <clip pos="1" side="tl" part="gen"/>
                <clip pos="1" side="tl" part="nbr"/>
              </lu>
              <b/>
              <lu>
                <lit v="a"/>
                <lit-tag v="pr"/>
              </lu>
              <b/>
              <lu>
                <lit v="el"/>
                <lit-tag v="det.def"/>
                <clip pos="2" side="tl" part="gen"/>
                <clip pos="2" side="tl" part="nbr"/>
              </lu>
              <b pos="1"/>
              <lu>
                <clip pos="2" side="tl" part="lem"/>
                <clip pos="2" side="tl" part="a_nom"/>
                <clip pos="2" side="tl" part="gen"/>
                <clip pos="2" side="tl" part="nbr"/>
              </lu>
              <b pos="2"/>
              <lu>
                <clip pos="3" side="tl" part="lem"/>
                <clip pos="3" side="tl" part="a_adj"/>
                <clip pos="3" side="tl" part="gen"/>
                <clip pos="3" side="tl" part="nbr"/>
              </lu>
            </out>
          </when>
          <otherwise>
            <out>
              <lu>
                <clip pos="1" side="tl" part="lemh"/>
                <clip pos="1" side="tl" part="a_verb"/>
                <clip pos="1" side="tl" part="temps"/>
                <clip pos="1" side="tl" part="persona"/>          
		<clip pos="1" side="tl" part="gen"/>
                <clip pos="1" side="tl" part="nbr"/>
              </lu>
              <b pos="1"/>
              <lu>
                <clip pos="2" side="tl" part="lem"/>
                <clip pos="2" side="tl" part="a_nom"/>
                <clip pos="2" side="tl" part="gen"/>
                <clip pos="2" side="tl" part="nbr"/>
              </lu>
              <b pos="2"/>
              <lu>
                <clip pos="3" side="tl" part="lem"/>
                <clip pos="3" side="tl" part="a_adj"/>
                <clip pos="3" side="tl" part="gen"/>
                <clip pos="3" side="tl" part="nbr"/>
              </lu>
            </out>
          </otherwise>
        </choose>
      </action>
    </rule>
    
        
<!--  REGLA 60: NOM NOM ADJ POS per a traduir "cartea prietenei mele" com a "el libro de mi amiga" o sigui el cas Genitiu  -->
    <rule>
      <pattern>
        <pattern-item n="nom"/>
        <pattern-item n="nom"/>
        <pattern-item n="adjpos"/>
      </pattern>
      <action>
         <call-macro n="f_concord1">
          <with-param pos="1"/>
        </call-macro>   
	<!-- <call-macro n="f_concord1">
          <with-param pos="2"/>
        </call-macro> -->
        <call-macro n="f_concord2">
         <with-param pos="2"/>
         <with-param pos="3"/>
       </call-macro>   
        <choose>
          <when>
            <test>
              <and>
                <equal>
                  <clip pos="1" side="sl" part="a_case"/>
                  <lit-tag v="nom"/>
                </equal>
                <equal>
                  <clip pos="1" side="sl" part="a_def"/>
                  <lit-tag v="def"/>
                </equal>
                <equal>
                  <clip pos="2" side="sl" part="a_case"/>
                  <lit-tag v="dg"/>
                </equal>
                <equal>
                  <clip pos="2" side="sl" part="a_def"/>
                  <lit-tag v="def"/>
                </equal>
              </and>
            </test>
            <choose>
	      <when>
	        <test>
		  <equal>
		   <clip pos="3" side="tl" part="lem"/>
                  <lit v="mío"/>
		  </equal>
		</test>  
		<let>
		  <clip pos="3" side="tl" part="gen"/>
                  <lit-tag v="mf"/>
		</let>
	       </when>
	   </choose>  
	   <choose> 
	       <when>
	        <test>
		  <equal>
		   <clip pos="3" side="tl" part="lem"/>
                  <lit v="tuyo"/>
		  </equal>
		</test>  
		<let>
		  <clip pos="3" side="tl" part="gen"/>
                  <lit-tag v="mf"/>
		</let>
	       </when> 
	     </choose>
	     <choose> 
		 <when>
	        <test>
		  <equal>
		   <clip pos="3" side="tl" part="lem"/>
                  <lit v="suyo"/>
		  </equal>
		</test>  
		<let>
		  <clip pos="3" side="tl" part="gen"/>
                  <lit-tag v="mf"/>
		</let>
	       </when> 
	   </choose>    
	    <call-macro n="modcase">
               <with-param pos="1"/>
            </call-macro>
            <out>
              <lu> 
	      <get-case-from pos="1">
                <lit v="el"/>
	      </get-case-from> 
                <lit-tag v="det.def"/>
                <clip pos="1" side="tl" part="gen"/>
                <clip pos="1" side="tl" part="nbr"/>
              </lu>
              <b/>
              <lu>
                <clip pos="1" side="tl" part="lem"/>
                <clip pos="1" side="tl" part="a_nom"/>
                <clip pos="1" side="tl" part="gen"/>
                <clip pos="1" side="tl" part="nbr"/>
              </lu>
              <b/>
              <lu>
                <lit v="de"/>
                <lit-tag v="pr"/>
              </lu>
              <b/>
               <lu>
                <clip pos="3" side="tl" part="lem"/>
                <lit-tag v="det.pos"/>
                <clip pos="3" side="tl" part="gen"/>
                <clip pos="2" side="tl" part="nbr"/><!-- correcció de la elecció del desambiguador-->
              </lu>
	       <b/>
              <lu>
                <clip pos="2" side="tl" part="lem"/>
                <clip pos="2" side="tl" part="a_nom"/>
                <clip pos="2" side="tl" part="gen"/>
                <clip pos="2" side="tl" part="nbr"/>
              </lu>
            </out>
          </when>
          <otherwise>
            <out>
              <lu>
                <clip pos="1" side="tl" part="lem"/>
                <clip pos="1" side="tl" part="a_nom"/>
                <clip pos="1" side="tl" part="gen"/>
                <clip pos="1" side="tl" part="nbr"/>
              </lu>
              <b/>
              <lu>
                <clip pos="3" side="tl" part="lem"/>
                <lit-tag v="det.pos"/>
                <clip pos="3" side="tl" part="gen"/>
                <clip pos="2" side="tl" part="nbr"/><!-- correcció de la elecció del desambiguador-->
              </lu>
	       <b/>
              <lu>
                <clip pos="2" side="tl" part="lem"/>
                <clip pos="2" side="tl" part="a_nom"/>
                <clip pos="2" side="tl" part="gen"/>
                <clip pos="2" side="tl" part="nbr"/>
              </lu>
            </out>
          </otherwise>
        </choose>
      </action>
    </rule> 


   
   
     <!-- REGLA 21 VERB + SÄ + NU + VERB = NO + VERB + INF /o/ VERB + QUE + NO + SUBJ 
    <rule>
      <pattern>
        <pattern-item n="verb"/>
        <pattern-item n="conjsub"/>
	<pattern-item n="advnu"/>
	<pattern-item n="verb"/>
      </pattern>
      <action>
        <choose>
	      <when>
	         <test>
		  <and>
		    <equal>
                      <clip pos="1" side="sl" part="persona"/>
		      <lit-tag v="p1"/>
                    </equal>
		    <equal>
                      <clip pos="1" side="sl" part="nbr"/>
		      <lit-tag v="sg"/>
                    </equal>
		    <equal>
                      <clip pos="4" side="sl" part="persona"/> 
                      <lit-tag v="p1"/>
                    </equal>
		    <equal>
                      <clip pos="4" side="sl" part="nbr"/>
                     <lit-tag v="sg"/>
                    </equal>
		    </and>
                  </test>
		  <out>
		     <lu>
		       <get-case-from pos="1">
		       <lit v="no"/>
		       </get-case-from>
                       <lit-tag v="adv"/>
                     </lu>
		       <b/>
		     <lu>
	               <clip pos="1" side="tl" part="lem"/>
		       <clip pos="1" side="tl" part="a_verb"/>
                       <clip pos="1" side="tl" part="temps"/>
                       <clip pos="1" side="tl" part="persona"/>
                       <clip pos="1" side="tl" part="gen"/>
                       <clip pos="1" side="tl" part="nbr"/>
	             </lu>
			<b/>
		     <lu>
                       <clip pos="3" side="tl" part="lem"/>
                       <clip pos="3" side="tl" part="a_verb"/>
                       <lit-tag v="inf"/>
                     </lu>
                   </out>
		 </when>
		 <when>
	          <test>
		    <and>
                    <equal>
                      <clip pos="1" side="sl" part="persona"/> 
		      <lit-tag v="p2"/>
                    </equal>
		    <equal>
                      <clip pos="1" side="sl" part="nbr"/>
		      <lit-tag v="sg"/>
                    </equal>
		    <equal>
                      <clip pos="4" side="sl" part="persona"/>
                      <lit-tag v="p2"/>
                    </equal>
		    <equal>
                      <clip pos="4" side="sl" part="nbr"/>
                     <lit-tag v="sg"/>
                    </equal>
		    </and>
                  </test>
		  <out>
		     <lu>
		       <get-case-from pos="1">
		       <lit v="no"/>
		       </get-case-from>
                       <lit-tag v="adv"/>
                     </lu>
		       <b/>
		     <lu>
	               <clip pos="1" side="tl" part="lem"/>
		       <clip pos="1" side="tl" part="a_verb"/>
                       <clip pos="1" side="tl" part="temps"/>
                       <clip pos="1" side="tl" part="persona"/>
                       <clip pos="1" side="tl" part="gen"/>
                       <clip pos="1" side="tl" part="nbr"/>
	             </lu>
			 <b/>
		     <lu>
                       <clip pos="3" side="tl" part="lem"/>
                       <clip pos="3" side="tl" part="a_verb"/>
                       <lit-tag v="inf"/>
                     </lu>
                 </out>
		 </when>
		 <when>
	         <test>
		    <and>
                    <equal>
                      <clip pos="1" side="sl" part="persona"/>
		      <lit-tag v="p3"/>
                    </equal>
		    <equal>
                      <clip pos="1" side="sl" part="nbr"/>
		      <lit-tag v="sg"/>
                    </equal>
		    <equal>
                      <clip pos="4" side="sl" part="persona"/>
		      <lit-tag v="p3"/>
                    </equal>
		    <equal>
                      <clip pos="4" side="sl" part="nbr"/>
                     <lit-tag v="sg"/>
                    </equal>
		    </and>
                  </test>
		  <out>
		     <lu>
		       <get-case-from pos="1">
		       <lit v="no"/>
		       </get-case-from>
                       <lit-tag v="adv"/>
                     </lu>
		       <b/>
		     <lu>
	               <clip pos="1" side="tl" part="lem"/>
		       <clip pos="1" side="tl" part="a_verb"/>
                       <clip pos="1" side="tl" part="temps"/>
                       <clip pos="1" side="tl" part="persona"/>
                       <clip pos="1" side="tl" part="gen"/>
                       <clip pos="1" side="tl" part="nbr"/>
	             </lu>
			 <b/>
		     <lu>
                       <clip pos="3" side="tl" part="lem"/>
                       <clip pos="3" side="tl" part="a_verb"/>
                       <lit-tag v="inf"/>
                     </lu>
                 </out>
		 </when>
		 
		 
		  <when>
	         <test>
		    <and>
                    <equal>
                      <clip pos="1" side="sl" part="persona"/>
		      <lit-tag v="p1"/>
                    </equal>
		    <equal>
                      <clip pos="1" side="sl" part="nbr"/>
		      <lit-tag v="pl"/>
                    </equal>
		    <equal>
                      <clip pos="4" side="sl" part="persona"/> 
                      <lit-tag v="p1"/>
                    </equal>
		    <equal>
                      <clip pos="4" side="sl" part="nbr"/>
                     <lit-tag v="pl"/>
                    </equal>
		    </and>
                  </test>
		  <out>
		     <lu>
		       <get-case-from pos="1">
		       <lit v="no"/>
		       </get-case-from>
                       <lit-tag v="adv"/>
                     </lu>
		       <b/>
		     <lu>
	               <clip pos="1" side="tl" part="lem"/>
		       <clip pos="1" side="tl" part="a_verb"/>
                       <clip pos="1" side="tl" part="temps"/>
                       <clip pos="1" side="tl" part="persona"/>
                       <clip pos="1" side="tl" part="gen"/>
                       <clip pos="1" side="tl" part="nbr"/>
	             </lu>
			 <b/>
		     <lu>
                       <clip pos="3" side="tl" part="lem"/>
                       <clip pos="3" side="tl" part="a_verb"/>
                       <lit-tag v="inf"/>
                     </lu>
                 </out>
		 </when>
		  <when>
	         <test>
		    <and>
                    <equal>
                      <clip pos="1" side="sl" part="persona"/>
		      <lit-tag v="p2"/>
                    </equal>
		    <equal>
                      <clip pos="1" side="sl" part="nbr"/>
		      <lit-tag v="pl"/>
                    </equal>
		    <equal>
                      <clip pos="4" side="sl" part="persona"/> 
                      <lit-tag v="p2"/>
                    </equal>
		    <equal>
                      <clip pos="4" side="sl" part="nbr"/>
                     <lit-tag v="pl"/>
                    </equal>
		    </and>
                  </test>
		  <out>
		     <lu>
		       <get-case-from pos="1">
		       <lit v="no"/>
		       </get-case-from>
                       <lit-tag v="adv"/>
                     </lu>
		       <b/>
		       <lu>
	               <clip pos="1" side="tl" part="lem"/>
		       <clip pos="1" side="tl" part="a_verb"/>
                       <clip pos="1" side="tl" part="temps"/>
                       <clip pos="1" side="tl" part="persona"/>
                       <clip pos="1" side="tl" part="gen"/>
                       <clip pos="1" side="tl" part="nbr"/>
	             </lu>
			 <b/>
		     <lu>
                       <clip pos="3" side="tl" part="lem"/>
                       <clip pos="3" side="tl" part="a_verb"/>
                       <lit-tag v="inf"/>
                     </lu>
                 </out>
		 </when>
		  <when>
	         <test>
		    <and>
                    <equal>
                      <clip pos="1" side="sl" part="persona"/>
		      <lit-tag v="p3"/>
                    </equal>
		    <equal>
                      <clip pos="1" side="sl" part="nbr"/>
		      <lit-tag v="pl"/>
                    </equal>
		    <equal>
                      <clip pos="4" side="sl" part="persona"/> 
                      <lit-tag v="p3"/>
                    </equal>
		    <equal>
                      <clip pos="4" side="sl" part="nbr"/>
                     <lit-tag v="pl"/>
                    </equal>
		    </and>
                  </test>
		  <out>
		     <lu>
		       <get-case-from pos="1">
		       <lit v="no"/>
		       </get-case-from>
                       <lit-tag v="adv"/>
                     </lu>
		       <b/>
		     <lu>
	               <clip pos="1" side="tl" part="lem"/>
		       <clip pos="1" side="tl" part="a_verb"/>
                       <clip pos="1" side="tl" part="temps"/>
                       <clip pos="1" side="tl" part="persona"/>
                       <clip pos="1" side="tl" part="gen"/>
                       <clip pos="1" side="tl" part="nbr"/>
	             </lu>
			 <b/>
		     <lu>
                       <clip pos="3" side="tl" part="lem"/>
                       <clip pos="3" side="tl" part="a_verb"/>
                       <lit-tag v="inf"/>
                     </lu>
                 </out>
		 </when>
		 <otherwise>
                <out>
		     <lu>
		       <get-case-from pos="1">
		       <lit v="no"/>
		       </get-case-from>
                       <lit-tag v="adv"/>
                     </lu>
		       <b/>
		     <lu>
	               <clip pos="1" side="tl" part="lem"/>
		       <clip pos="1" side="tl" part="a_verb"/>
                       <clip pos="1" side="tl" part="temps"/>
                       <clip pos="1" side="tl" part="persona"/>
                       <clip pos="1" side="tl" part="gen"/>
                       <clip pos="1" side="tl" part="nbr"/>
	             </lu>
			 <b/>
		     <lu>
		       <clip pos="2" side="tl" part="lem"/>
                        <lit-tag v="cnjsub"/>
                     </lu>
	              <b/>
	             <lu>
                       <clip pos="3" side="tl" part="lem"/>
                       <clip pos="3" side="tl" part="a_verb"/>
		       <clip pos="3" side="tl" part="temps"/>
		       <clip pos="3" side="tl" part="persona"/>
		       <clip pos="3" side="tl" part="nbr"/>
		     </lu>
		</out> 	
             </otherwise>
        </choose>
      </action>
    </rule>    --> 
		 
       
<!--  REGLA 61: PREP NOM NOM ADJ POS per a traduir "pentru cartea prietenei mele" com a "para el libro de mi amiga"  -->
    <rule>
      <pattern>
        <pattern-item n="prep"/>
        <pattern-item n="nom"/>
        <pattern-item n="nom"/>
        <pattern-item n="adjpos"/>
      </pattern>
      <action>
         <call-macro n="f_concord1">
          <with-param pos="2"/>
        </call-macro> 
        <call-macro n="f_concord2">
         <with-param pos="3"/>
         <with-param pos="4"/>
       </call-macro>   
        <choose>
          <when>
            <test>
              <and>
                <equal>
                  <clip pos="2" side="sl" part="a_case"/>
                  <lit-tag v="nom"/>
                </equal>
                <equal>
                  <clip pos="2" side="sl" part="a_def"/>
                  <lit-tag v="def"/>
                </equal>
                <equal>
                  <clip pos="3" side="sl" part="a_case"/>
                  <lit-tag v="dg"/>
                </equal>
                <equal>
                  <clip pos="3" side="sl" part="a_def"/>
                  <lit-tag v="def"/>
                </equal>
              </and>
            </test>
            <choose>
	      <when>
	        <test>
		  <equal>
		   <clip pos="4" side="tl" part="lem"/>
                  <lit v="mío"/>
		  </equal>
		</test>  
		<let>
		  <clip pos="4" side="tl" part="gen"/>
                  <lit-tag v="mf"/>
		</let>
	       </when>
	   </choose>  
	   <choose> 
	       <when>
	        <test>
		  <equal>
		   <clip pos="4" side="tl" part="lem"/>
                  <lit v="tuyo"/>
		  </equal>
		</test>  
		<let>
		  <clip pos="4" side="tl" part="gen"/>
                  <lit-tag v="mf"/>
		</let>
	       </when> 
	     </choose>
	     <choose> 
		 <when>
	        <test>
		  <equal>
		   <clip pos="4" side="tl" part="lem"/>
                  <lit v="suyo"/>
		  </equal>
		</test>  
		<let>
		  <clip pos="4" side="tl" part="gen"/>
                  <lit-tag v="mf"/>
		</let>
	       </when> 
	   </choose>    
	    <call-macro n="modcase">
               <with-param pos="1"/>
            </call-macro>
            <out>
              <lu> 
	      <get-case-from pos="1">
                <clip pos="1" side="tl" part="lem"/>
               </get-case-from>
                <clip pos="1" side="tl" part="a_prep"/>
              </lu>
              <b/>
               <lu> 
                <lit v="el"/>
                <lit-tag v="det.def"/>
                <clip pos="2" side="tl" part="gen"/>
                <clip pos="2" side="tl" part="nbr"/>
              </lu>
              <b/>
              <lu>
                <clip pos="2" side="tl" part="lem"/>
                <clip pos="2" side="tl" part="a_nom"/>
                <clip pos="2" side="tl" part="gen"/>
                <clip pos="2" side="tl" part="nbr"/>
              </lu>
              <b/>
              <lu>
                <lit v="de"/>
                <lit-tag v="pr"/>
              </lu>
              <b/>
               <lu>
                <clip pos="4" side="tl" part="lem"/>
                <lit-tag v="det.pos"/>
                <clip pos="4" side="tl" part="gen"/>
                <clip pos="3" side="tl" part="nbr"/><!-- correcció de la elecció del desambiguador-->
              </lu>
	       <b/>
              <lu>
                <clip pos="3" side="tl" part="lem"/>
                <clip pos="3" side="tl" part="a_nom"/>
                <clip pos="3" side="tl" part="gen"/>
                <clip pos="3" side="tl" part="nbr"/>
              </lu>
            </out>
          </when>
          <otherwise>
            <out>
              <lu>
                <clip pos="1" side="tl" part="lem"/>
                <clip pos="1" side="tl" part="a_prep"/>
              </lu>
              <b/>
              <lu>
                <clip pos="2" side="tl" part="lem"/>
                <clip pos="2" side="tl" part="a_nom"/>
                <clip pos="2" side="tl" part="gen"/>
                <clip pos="2" side="tl" part="nbr"/>
              </lu>
              <b/>
              <lu>
                <clip pos="4" side="tl" part="lem"/>
                <lit-tag v="det.pos"/>
                <clip pos="4" side="tl" part="gen"/>
                <clip pos="3" side="tl" part="nbr"/><!-- correcció de la elecció del desambiguador-->
              </lu>
	       <b/>
              <lu>
                <clip pos="3" side="tl" part="lem"/>
                <clip pos="3" side="tl" part="a_nom"/>
                <clip pos="3" side="tl" part="gen"/>
                <clip pos="3" side="tl" part="nbr"/>
              </lu>
            </out>
          </otherwise>
        </choose>
      </action>
    </rule> 
		 
		 
    <!-- REGLA 62 VERB + SÄ + VERB = VERB + INF /o/ VERB + QUE +SUBJ -->
    <rule>
      <pattern>
        <pattern-item n="verb"/>
        <pattern-item n="conjsub"/>
	<pattern-item n="verb"/>
      </pattern>
      <action>
      
       <call-macro n="f_modgen">
           <with-param pos="1"/>
         </call-macro>
      
        <choose>
	
	
	
	
	<!--      <when>
	         <test>
		    <and>
                    <equal>
                      <clip pos="1" side="sl" part="persona"/> 
		      <clip pos="3" side="sl" part="persona"/>
                      <lit-tag v="p1"/>
                    </equal>
		    <equal>
                      <clip pos="1" side="sl" part="nbr"/>
		      <clip pos="3" side="sl" part="nbr"/>
                     <lit-tag v="sg"/>
                    </equal>
		    </and>
                  </test>
		  <out>
		       <lu>
	               <get-case-from pos="1">
	               <clip pos="1" side="tl" part="lem"/>
		       </get-case-from>
                       <clip pos="1" side="tl" part="a_verb"/>
                       <clip pos="1" side="tl" part="temps"/>
                       <clip pos="1" side="tl" part="persona"/>
                       <clip pos="1" side="tl" part="gen"/>
                       <clip pos="1" side="tl" part="nbr"/>
	               </lu>
			 <b/>
		       <lu>
                       <clip pos="3" side="tl" part="lem"/>
                       <clip pos="3" side="tl" part="a_verb"/>
                       <lit-tag v="inf"/>
                       </lu>
                 </out>
		 </when>
		 <when>
	         <test>
		    <and>
                    <equal>
                      <clip pos="1" side="sl" part="persona"/>
		      <clip pos="3" side="sl" part="persona"/>
                     <lit-tag v="p2"/>
                    </equal>
		    <equal>
                      <clip pos="1" side="sl" part="nbr"/>
		      <clip pos="3" side="sl" part="nbr"/>
                     <lit-tag v="sg"/>
                    </equal>
		    </and>
                  </test>
		  <out>
		       <lu>
	               <get-case-from pos="1">
	               <clip pos="1" side="tl" part="lem"/>
		       </get-case-from>
                       <clip pos="1" side="tl" part="a_verb"/>
                       <clip pos="1" side="tl" part="temps"/>
                       <clip pos="1" side="tl" part="persona"/>
                       <clip pos="1" side="tl" part="gen"/>
                       <clip pos="1" side="tl" part="nbr"/>
	               </lu>
			 <b/>
		       <lu>
                       <clip pos="3" side="tl" part="lem"/>
                       <clip pos="3" side="tl" part="a_verb"/>
                       <lit-tag v="inf"/>
                       </lu>
                 </out>
		 </when>
		 <when>
	         <test>
		    <and>
                    <equal>suerte
                      <clip pos="1" side="sl" part="persona"/>
		      <clip pos="3" side="sl" part="persona"/>
                     <lit-tag v="p3"/>
                    </equal>
		    <equal>
                      <clip pos="1" side="sl" part="nbr"/>
		      <clip pos="3" side="sl" part="nbr"/>
                     <lit-tag v="sg"/>
                    </equal>
		    </and>suerte
                  </test>
		  <out>
		       <lu>
	               <get-case-from pos="1">
	               <clip pos="1" side="tl" part="lem"/>
		       </get-case-from>
                       <clip pos="1" side="tl" part="a_verb"/>
                       <clip pos="1" side="tl" part="temps"/>
                       <clip pos="1" side="tl" part="persona"/>
                       <clip pos="1" side="tl" part="gen"/>
                       <clip pos="1" side="tl" part="nbr"/>
	               </lu>
			 <b/>
		       <lu>
                       <clip pos="3" side="tl" part="lem"/>
                       <clip pos="3" side="tl" part="a_verb"/>
                       <lit-tag v="inf"/>
                       </lu>
                 </out>  
		 </when>
		 <when>
	         <test>
		    <and>
                    <equal>
                      <clip pos="1" side="sl" part="persona"/>
		      <clip pos="3" side="sl" part="persona"/>
                     <lit-tag v="p1"/>
                    </equal>
		    <equal>
                      <clip pos="1" side="sl" part="nbr"/>
		      <clip pos="3" side="sl" part="nbr"/>
                     <lit-tag v="pl"/>
                    </equal>
		    </and>
                  </test>
		  <out>
		       <lu>
	               <get-case-from pos="1">
	               <clip pos="1" side="tl" part="lem"/>
		       </get-case-from>
                       <clip pos="1" side="tl" part="a_verb"/>
                       <clip pos="1" side="tl" part="temps"/>
                       <clip pos="1" side="tl" part="persona"/>
                       <clip pos="1" side="tl" part="gen"/>
                       <clip pos="1" side="tl" part="nbr"/>
	               </lu>
			 <b/>
		       <lu>
                       <clip pos="3" side="tl" part="lem"/>
                       <clip pos="3" side="tl" part="a_verb"/>
                       <lit-tag v="inf"/>
                       </lu>
                 </out>
		 </when>
		 <when>
	         <test>
		    <and>
                    <equal>
                      <clip pos="1" side="sl" part="persona"/>
		      <clip pos="3" side="sl" part="persona"/>
                     <lit-tag v="p2"/>
                    </equal>
		    <equal>
                      <clip pos="1" side="sl" part="nbr"/>
		      <clip pos="3" side="sl" part="nbr"/>
                     <lit-tag v="pl"/>
                    </equal>
		    </and>
                  </test>
		  <out>
		       <lu>
	               <get-case-from pos="1">
	               <clip pos="1" side="tl" part="lem"/>
		       </get-case-from>
                       <clip pos="1" side="tl" part="a_verb"/>
                       <clip pos="1" side="tl" part="temps"/>
                       <clip pos="1" side="tl" part="persona"/>
                       <clip pos="1" side="tl" part="gen"/>
                       <clip pos="1" side="tl" part="nbr"/>
	               </lu>
			 <b/>
		       <lu>
                       <clip pos="3" side="tl" part="lem"/>
                       <clip pos="3" side="tl" part="a_verb"/>
                       <lit-tag v="inf"/>
                       </lu>
                 </out>
		 </when>
		 <when>
	         <test>
		    <and>
                    <equal>
                      <clip pos="1" side="sl" part="persona"/>
		      <clip pos="3" side="sl" part="persona"/>
                     <lit-tag v="p3"/>
                    </equal>
		    <equal>
                      <clip pos="1" side="sl" part="nbr"/>
		      <clip pos="3" side="sl" part="nbr"/>
                     <lit-tag v="pl"/>
                    </equal>
		    </and>
                  </test>
		  <out>
		       <lu>
	               <get-case-from pos="1">
	               <clip pos="1" side="tl" part="lem"/>
		       </get-case-from>
                       <clip pos="1" side="tl" part="a_verb"/>
                       <clip pos="1" side="tl" part="temps"/>
                       <clip pos="1" side="tl" part="persona"/>
                       <clip pos="1" side="tl" part="gen"/>
                       <clip pos="1" side="tl" part="nbr"/>
	               </lu>
			 <b/>
		       <lu>
                       <clip pos="3" side="tl" part="lem"/>
                       <clip pos="3" side="tl" part="a_verb"/>
                       <lit-tag v="inf"/>
                       </lu>
                 </out>
		 </when>  -->
		
	     <when>
	         <test>
		    <and>
                    <equal>
                      <clip pos="1" side="sl" part="persona"/> 
		      <clip pos="3" side="sl" part="persona"/>
                    </equal>
		    <equal>
                      <clip pos="1" side="sl" part="nbr"/>
		      <clip pos="3" side="sl" part="nbr"/>
                    </equal>
		    </and>
                  </test>
		  <out>
		       <lu>
	               <get-case-from pos="1">
	               <clip pos="1" side="tl" part="lem"/>
		       </get-case-from>
                       <clip pos="1" side="tl" part="a_verb"/>
                       <clip pos="1" side="tl" part="temps"/>
                       <clip pos="1" side="tl" part="persona"/>
                       <clip pos="1" side="tl" part="gen"/>
                       <clip pos="1" side="tl" part="nbr"/>
	               </lu>
			 <b/>
		       <lu>
                       <clip pos="3" side="tl" part="lem"/>
                       <clip pos="3" side="tl" part="a_verb"/>
                       <lit-tag v="inf"/>
                       </lu>
                 </out>
	      </when>
		 
	      <otherwise>
               <out>
            	  <lu>
                       <clip pos="1" side="tl" part="lemh"/>
                       <clip pos="1" side="tl" part="a_verb"/>
                       <clip pos="1" side="tl" part="temps"/>
                       <clip pos="1" side="tl" part="persona"/>     
		       <clip pos="1" side="tl" part="gen"/>
                       <clip pos="1" side="tl" part="nbr"/>
                 </lu>
                 <b pos="1"/>	
		 <lu>
		       <clip pos="2" side="tl" part="lem"/>
                        <lit-tag v="cnjsub"/>
                 </lu>
	         <b pos="2"/>
	         <lu>
                       <clip pos="3" side="tl" part="lem"/>
                       <clip pos="3" side="tl" part="a_verb"/>
		       <clip pos="3" side="tl" part="temps"/>
		       <clip pos="3" side="tl" part="persona"/>	       
		       <clip pos="3" side="tl" part="gen"/>
		       <clip pos="3" side="tl" part="nbr"/>
		</lu>
		</out> 	
             </otherwise>
        </choose>
      </action>
    </rule>     
       
       
    <rule>
<!-- REGLA 64: ADVERBI ADJECTIU NOM -->
      <pattern>
        <pattern-item n="adv"/>
        <pattern-item n="adj"/>
        <pattern-item n="nom"/>
      </pattern>
      <action>
       <call-macro n="f_modgen">
              <with-param pos="2"/>
            </call-macro>
            <call-macro n="f_concord2">
              <with-param pos="3"/>
              <with-param pos="2"/>
            </call-macro>
        <choose>
          <when>
            <test>
              <equal>
                <clip pos="2" side="sl" part="a_def"/>
                <lit-tag v="def"/>
              </equal>
            </test>
	      <call-macro n="modcase">
              <with-param pos="1"/>
            </call-macro>
            <out>
              <lu>
	       <get-case-from pos="1">
                <lit v="el"/>
		</get-case-from>
                <lit-tag v="det.def"/>
                <clip pos="2" side="tl" part="gen"/>
                <clip pos="2" side="tl" part="nbr"/>
              </lu>
              <b pos="1"/>
              <lu>
                <clip pos="1" side="tl" part="lem"/>
                <clip pos="1" side="tl" part="a_adv"/>
              </lu>
              <b pos="2"/>
              <lu>
                <clip pos="2" side="tl" part="lem"/>
                <clip pos="2" side="tl" part="a_adj"/>
                <clip pos="2" side="tl" part="gen"/>
                <clip pos="2" side="tl" part="nbr"/>
              </lu>
              <b/>
              <lu>
                <clip pos="3" side="tl" part="lem"/>
                <clip pos="3" side="tl" part="a_nom"/>
                <clip pos="3" side="tl" part="gen"/>
                <clip pos="3" side="tl" part="nbr"/>
              </lu>
            </out>
          </when>
          <otherwise>
            <out>
              <lu>
                <clip pos="1" side="tl" part="lem"/>
                <clip pos="1" side="tl" part="a_adv"/>
              </lu>
              <b pos="1"/>
              <lu>
                <clip pos="2" side="tl" part="lem"/>
                <clip pos="2" side="tl" part="a_adj"/>
                <clip pos="2" side="tl" part="gen"/>
                <clip pos="2" side="tl" part="nbr"/>
              </lu>
              <b pos="2"/>
              <lu>
                <clip pos="3" side="tl" part="lem"/>
                <clip pos="3" side="tl" part="a_nom"/>
                <clip pos="3" side="tl" part="gen"/>
                <clip pos="3" side="tl" part="nbr"/>
              </lu>
            </out>
          </otherwise>
        </choose>
      </action>
    </rule>
    
    <rule>
<!-- REGLA 65: NUMERAL ADJECTIU NOM -->
      <pattern>
        <pattern-item n="num"/>
        <pattern-item n="adj"/>
        <pattern-item n="nom"/>
      </pattern>
      <action>
        <call-macro n="f_modgen">
              <with-param pos="3"/>
        </call-macro>
        <call-macro n="f_concord3">
              <with-param pos="3"/>
              <with-param pos="2"/>
              <with-param pos="1"/>
        </call-macro>
        <choose>
	  <when>
	    <test>
	      <not>
	        <equal>
		  <clip pos="1" side="sl" part="lem"/>
		  <lit v="1"/>
	        </equal>
	      </not>
	    </test>
	<let>
	<clip pos="3" side="tl" part="nbr"/>
	<lit-tag v="pl"/>
        </let>
     </when>
   </choose>
            <out>
              <lu>
                <clip pos="1" side="tl" part="lem"/>
                <clip pos="1" side="tl" part="a_num"/>
                <clip pos="1" side="tl" part="gen"/>
                <clip pos="1" side="tl" part="nbr"/>
              </lu>
              <b pos="1"/>
              <lu>
                <clip pos="2" side="tl" part="lem"/>
                <clip pos="2" side="tl" part="a_adj"/>
                <clip pos="2" side="tl" part="gen"/>
                <clip pos="2" side="tl" part="nbr"/>            
              </lu>
              <b pos="2"/>
              <lu>
                <clip pos="3" side="tl" part="lem"/>
                <clip pos="3" side="tl" part="a_nom"/>
                <clip pos="3" side="tl" part="gen"/>
                <clip pos="3" side="tl" part="nbr"/>
              </lu>
            </out>
      </action>
    </rule>
    
    <rule>
<!-- REGLA 66: NUMERAL  NOM ADJECTIU-->
      <pattern>
        <pattern-item n="num"/>
        <pattern-item n="nom"/>
        <pattern-item n="adj"/>
      </pattern>
      <action>
	<call-macro n="f_modgen">
              <with-param pos="3"/>
        </call-macro>
        <call-macro n="f_concord3">
              <with-param pos="2"/>
              <with-param pos="1"/>
              <with-param pos="3"/>
        </call-macro>
        <choose>
	  <when>
	    <test>
	      <not>
	        <equal>
		  <clip pos="1" side="sl" part="lem"/>
		  <lit v="1"/>
	        </equal>
	      </not>
	    </test>
	<let>
	<clip pos="2" side="tl" part="nbr"/>
	<lit-tag v="pl"/>
        </let>
     </when>
   </choose>
            <out>
              <lu>
                <clip pos="1" side="tl" part="lem"/>
                <clip pos="1" side="tl" part="a_num"/>
                <clip pos="1" side="tl" part="gen"/>
                <clip pos="1" side="tl" part="nbr"/>
              </lu>
              <b pos="1"/>
              <lu>
                <clip pos="2" side="tl" part="lem"/>
                <clip pos="2" side="tl" part="a_nom"/>
                <clip pos="2" side="tl" part="gen"/>
                <clip pos="2" side="tl" part="nbr"/>
              </lu>
              <b pos="2"/>
              <lu>
                <clip pos="3" side="tl" part="lem"/>
                <clip pos="3" side="tl" part="a_adj"/>
                <clip pos="3" side="tl" part="gen"/>
                <clip pos="3" side="tl" part="nbr"/>
              </lu>
            </out>
      </action>
    </rule>
    
     
<!--REGLA: NOM DET NUMERAL NOM 
    <rule>
      <pattern>
        <pattern-item n="nom"/>
        <pattern-item n="detcel"/>
        <pattern-item n="num"/>
        <pattern-item n="nom"/>
      </pattern>
      <action>
        <call-macro n="f_modgen">
              <with-param pos="2"/>
            </call-macro>
            <call-macro n="f_concord3">
              <with-param pos="4"/>
              <with-param pos="3"/>
              <with-param pos="2"/>
            </call-macro>
        <choose>
          <when>
            <test>
              <equal>
	        <and>
                <clip pos="1" side="sl" part="a_case"/>
                <lit-tag v="nom"/>
              </equal>
	      <equal>
                  <clip pos="1" side="sl" part="a_def"/>
                  <lit-tag v="def"/>
                </equal>
		</and>
              </test>
            <out> 
	     <lu>
	       <get-case-from pos="1">
	         <lit v="el"/>
		 </get-case-from>
	        <lit-tag v="det.def"/>
	        <clip pos="1" side="tl" part="gen"/>
                <clip pos="1" side="tl" part="nbr"/>
              </lu>
	      <b/>
	      <lu>
	        <clip pos="1" side="tl" part="nom"/>
	        <clip pos="1" side="tl" part="a_nom"/>
                <clip pos="1" side="tl" part="gen"/>
                <clip pos="1" side="tl" part="nbr"/>
              </lu>
              <b/>
	      <lu> 
	       <lit v="de"/>
	       <lit-tag v="pr"/>
              </lu>
              <b/>
	       <lu>
                <lit v="el"/>
                <lit-tag v="det.def"/>
                <clip pos="4" side="tl" part="gen"/>
                <clip pos="3" side="tl" part="nbr"/>
              </lu>
              <b/>
              <lu>
                <clip pos="3" side="tl" part="whole"/>
              </lu>
              <b/>
	       <lu>
                <clip pos="4" side="tl" part="lem"/>
                <clip pos="4" side="tl" part="a_nom"/>
                <clip pos="4" side="tl" part="gen"/>
                <clip pos="3" side="tl" part="nbr"/>
              </lu>
            </out>
          </when>
	  <when>
            <test>
	      <and>
              <equal>
                <clip pos="1" side="sl" part="a_case"/>
                <lit-tag v="dg"/>
              </equal>
	      <equal>
                  <clip pos="1" side="sl" part="a_def"/>
                  <lit-tag v="def"/>
                </equal>
		</and>
              </test>
	      <out>
	      <lu>
	       <get-case-from pos="1">
	       <lit v="de"/>
	       </get-case-from>
	       <lit-tag v="pr"/>
              </lu>
              <b/>
	      <lu>
                <lit v="el"/>
                <lit-tag v="det.def"/>
                <clip pos="2" side="tl" part="gen"/>
                <clip pos="2" side="tl" part="nbr"/>
              </lu>
	      <b/>
	      <lu>
	        <clip pos="2" side="tl" part="nom"/>
	        <clip pos="2" side="tl" part="a_nom"/>
                <clip pos="2" side="tl" part="gen"/>
                <clip pos="2" side="tl" part="nbr"/>
              </lu>
              <b/>
	      <lu> 
	       <lit v="de"/>
	       <lit-tag v="pr"/>
              </lu>
              <b/>
	      <lu>
                <lit v="el"/>
                <lit-tag v="det.def"/>
                <clip pos="4" side="tl" part="gen"/>
                <clip pos="3" side="tl" part="nbr"/>
              </lu>
              <b/>
	      <lu>
                <clip pos="3" side="tl" part="whole"/>
              </lu>
	      <b/>
	      <lu>
                <clip pos="4" side="tl" part="lem"/>
                <clip pos="4" side="tl" part="a_nom"/>
                <clip pos="4" side="tl" part="gen"/>
                <clip pos="3" side="tl" part="nbr"/>
              </lu>
	    </out>
          </when>
	 </choose> 
      </action>
    </rule> -->
	  
    <rule>
<!--REGLA 67: VERB DET NUMERAL NOM -->
      <pattern>
        <pattern-item n="verb"/>
        <pattern-item n="detcel"/>
        <pattern-item n="num"/>
        <pattern-item n="nom"/>
      </pattern>
      <action>
        <call-macro n="f_modgen">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_modgen">
          <with-param pos="2"/>
        </call-macro>
        <call-macro n="f_concord3">
          <with-param pos="4"/>
          <with-param pos="3"/>
          <with-param pos="2"/>
        </call-macro>
        <choose>
          <when>
            <test>
              <equal>
                <clip pos="2" side="sl" part="a_case"/>
                <lit-tag v="nom"/>
              </equal>
            </test>
            <out>
	       <lu>
	       <get-case-from pos="1">
                <clip pos="1" side="tl" part="lemh"/>
		</get-case-from>
                <clip pos="1" side="tl" part="a_verb"/>
                <clip pos="1" side="tl" part="temps"/>
                <clip pos="1" side="tl" part="persona"/>
                <clip pos="1" side="tl" part="gen"/>
                <clip pos="1" side="tl" part="nbr"/>
              </lu>
              <b pos="1"/>
              <lu>
	        <lit v="el"/>
	        <lit-tag v="det.def"/>
                <clip pos="4" side="tl" part="gen"/>
                <clip pos="3" side="tl" part="nbr"/>
              </lu>
              <b pos="2"/>
              <lu>                
                <clip pos="3" side="tl" part="lem"/>
                <clip pos="3" side="tl" part="a_num"/>
                <clip pos="3" side="tl" part="gen"/>
                <clip pos="3" side="tl" part="nbr"/>
              </lu>               
              <b pos="3"/>
              <lu>
                <clip pos="4" side="tl" part="lem"/>
                <clip pos="4" side="tl" part="a_nom"/>
                <clip pos="4" side="tl" part="gen"/>
                <lit-tag v="pl"/>
              </lu>
            </out>
          </when>
          <when>
            <test>
              <equal>
                <clip pos="2" side="sl" part="a_case"/>
                <lit-tag v="dg"/>
              </equal>
            </test>
	 <call-macro n="modcase">
              <with-param pos="1"/>
            </call-macro>
            <out>
	      <lu>
	       <get-case-from pos="1">
                <clip pos="1" side="tl" part="lemh"/>
		</get-case-from>
                <clip pos="1" side="tl" part="a_verb"/>
                <clip pos="1" side="tl" part="temps"/>
                <clip pos="1" side="tl" part="persona"/>
                <clip pos="1" side="tl" part="gen"/>
                <clip pos="1" side="tl" part="nbr"/>
              </lu>
              <b pos="1"/>
              <lu> 
	       <lit v="a"/>
	       <lit-tag v="pr"/>
              </lu>
              <b/>
              <lu>
                <lit v="el"/>
                <lit-tag v="det.def"/>
                <clip pos="4" side="tl" part="gen"/>
                <clip pos="3" side="tl" part="nbr"/>
              </lu>
              <b pos="2"/>
              <lu>
                <clip pos="3" side="tl" part="lem"/>
                <clip pos="3" side="tl" part="a_num"/>
                <clip pos="3" side="tl" part="gen"/>
                <clip pos="3" side="tl" part="nbr"/>
              </lu>                
              <b pos="3"/>
              <lu>
                <clip pos="4" side="tl" part="lem"/>
                <clip pos="4" side="tl" part="a_nom"/>
                <clip pos="4" side="tl" part="gen"/>
                <lit-tag v="pl"/>
              </lu>
            </out>
          </when>
        </choose> 
      </action>
    </rule>
    
    <rule>
<!--REGLA 68: DET NUMERAL NOM -->
      <pattern>
        <pattern-item n="detcel"/>
        <pattern-item n="num"/>
        <pattern-item n="nom"/>
      </pattern>
      <action>
        <call-macro n="f_modgen">
              <with-param pos="1"/>
            </call-macro>
            <call-macro n="f_concord3">
              <with-param pos="3"/>
              <with-param pos="2"/>
              <with-param pos="1"/>
            </call-macro>
        <choose>
          <when>
            <test>
              <equal>
                <clip pos="1" side="sl" part="a_case"/>
                <lit-tag v="nom"/>
              </equal>
            </test>
            <out>
              <lu>
	       <get-case-from pos="1">
                <lit v="el"/>
	       </get-case-from>
                <lit-tag v="det.def"/>
                <clip pos="3" side="tl" part="gen"/>
                <clip pos="2" side="tl" part="nbr"/>
              </lu>
              <b pos="1"/>
              <lu>
                <clip pos="2" side="tl" part="lem"/>
                <clip pos="2" side="tl" part="a_num"/>
                <clip pos="2" side="tl" part="gen"/>
                <clip pos="2" side="tl" part="nbr"/>
              </lu>
              <b pos="2"/>
              <lu>
                <clip pos="3" side="tl" part="lem"/>
                <clip pos="3" side="tl" part="a_nom"/>
                <clip pos="3" side="tl" part="gen"/>
                <lit-tag v="pl"/>
              </lu>
            </out>
          </when>
          <when>
            <test>
              <equal>
                <clip pos="1" side="sl" part="a_case"/>
                <lit-tag v="dg"/>
              </equal>
            </test>
	     <call-macro n="modcase">
              <with-param pos="1"/>
            </call-macro>
            <out>
              <lu> 
	       <get-case-from pos="1">
                <lit v="a"/>
	       </get-case-from>
                <lit-tag v="pr"/>
              </lu>
              <b/>
              <lu>
                <lit v="el"/>
                <lit-tag v="det.def"/>
                <clip pos="3" side="tl" part="gen"/>
                <clip pos="2" side="tl" part="nbr"/>
              </lu>
              <b pos="1"/>
              <lu>
                <clip pos="2" side="tl" part="lem"/>
                <clip pos="2" side="tl" part="a_num"/>
                <clip pos="2" side="tl" part="gen"/>
                <clip pos="2" side="tl" part="nbr"/>
              </lu>
              <b pos="2"/>
              <lu>
                <clip pos="3" side="tl" part="lem"/>
                <clip pos="3" side="tl" part="a_nom"/>
                <clip pos="3" side="tl" part="gen"/>
                <lit-tag v="pl"/>
              </lu>
            </out>
          </when>
        </choose> 
      </action>
    </rule>

 
    <rule>
<!--REGLA 69 DELIA: DET NOM -->
      <pattern>
        <pattern-item n="det"/>
        <pattern-item n="nom"/>
      </pattern>
      <action>
        <call-macro n="f_modgen">
              <with-param pos="1"/>
            </call-macro>
            <call-macro n="f_concord3">
              <with-param pos="2"/>
              <with-param pos="1"/>
            </call-macro>
        <choose>
          <when>
            <test>
              <and>
              <equal>
                <clip pos="1" side="sl" part="a_case"/>
                <lit-tag v="nom"/>
              </equal>
              <equal>
                <clip pos="1" side="sl" part="a_def"/>
                <lit-tag v="def"/>
              </equal>
             </and>
            </test>
            <out>
              <lu>
	        <clip pos="1" side="tl" part="lem"/>
                <clip pos="1" side="tl" part="a_det"/>
                <clip pos="2" side="tl" part="nbr"/>
              </lu>
              <b pos="1"/>
              <lu>
                <clip pos="2" side="tl" part="lem"/>
                <clip pos="2" side="tl" part="a_nom"/>
                <clip pos="2" side="tl" part="gen"/>
                <clip pos="2" side="tl" part="nbr"/>
              </lu>
            </out>
          </when>
          <when>
            <test>
              <and>
              <equal>
                <clip pos="1" side="sl" part="a_case"/>
                <lit-tag v="dg"/>
              </equal>
             <equal>
                <clip pos="1" side="sl" part="a_def"/>
                <lit-tag v="def"/>
              </equal>
             </and>
            </test>
	     <call-macro n="modcase">
              <with-param pos="1"/>
            </call-macro>
            <out>
              <lu> 
	       <get-case-from pos="1">
                <lit v="a"/>
	       </get-case-from>
                <lit-tag v="pr"/>
              </lu>
              <b/>
              <lu>
                <clip pos="1" side="tl" part="lem"/>
                <clip pos="1" side="tl" part="a_det"/>
                <clip pos="2" side="tl" part="nbr"/>
              </lu>
              <b pos="1"/>
              <lu>
                <clip pos="2" side="tl" part="lem"/>
                <clip pos="2" side="tl" part="a_nom"/>
                <clip pos="2" side="tl" part="gen"/>
                <clip pos="2" side="tl" part="nbr"/>
              </lu>
            </out>
          </when>
          
          <otherwise>
          <!--<choose>
          <when>
            <test>
               <equal>
                <clip pos="1" side="sl" part="a_def"/>
                <lit-tag v="ind"/>
              </equal>
             </test> -->
            <out>
              <lu>
	        <clip pos="1" side="tl" part="lem"/>
                <clip pos="1" side="tl" part="a_det"/>
                <clip pos="2" side="tl" part="nbr"/>
              </lu>
              <b pos="1"/>
              <lu>
                <clip pos="2" side="tl" part="lem"/>
                <clip pos="2" side="tl" part="a_nom"/>
                <clip pos="2" side="tl" part="gen"/>
                <clip pos="2" side="tl" part="nbr"/>
              </lu>
            </out>
       
   </otherwise>          
        </choose> 
      </action>
    </rule> 

<rule>
<!--REGLA 70 DELIA: DETTOT NOM NOM toate culorile curcubeului = todos los colores del arco iris -->
      <pattern>
        <pattern-item n="det"/>
        <pattern-item n="nom"/>
        <pattern-item n="nom"/>
      </pattern>
      <action>
        <call-macro n="f_modgen">
              <with-param pos="1"/>
            </call-macro>
            <call-macro n="f_concord2">
              <with-param pos="2"/>
              <with-param pos="1"/>
            </call-macro>
            <call-macro n="f_concord1">
              <with-param pos="3"/>
            </call-macro>
        <choose>
          <when>
            <test>
              <and>
              <equal>
                <clip pos="1" side="sl" part="lem"/>
                <lit v="tot"/>
              </equal>
              <equal>
                <clip pos="2" side="sl" part="a_case"/>
                <lit-tag v="nom"/>
              </equal>
              <equal>
                <clip pos="2" side="sl" part="a_def"/>
                <lit-tag v="def"/>
              </equal>
              <equal>
                <clip pos="2" side="sl" part="a_case"/>
                <lit-tag v="nom"/>
              </equal>
              <equal>
                <clip pos="2" side="sl" part="a_def"/>
                <lit-tag v="def"/>
              </equal>
             </and>
            </test>
            <out>
              <lu>
	        <clip pos="1" side="tl" part="lem"/>
                <clip pos="1" side="tl" part="a_det"/>
                <clip pos="2" side="tl" part="nbr"/>
              </lu>
              <b pos="1"/>
              <lu>
                <lit v="el"/>
                <lit-tag v="det.def"/>
                <clip pos="2" side="tl" part="gen"/>
                <clip pos="2" side="tl" part="nbr"/>
              </lu>
              <b/>
              <lu>
                <clip pos="2" side="tl" part="lem"/>
                <clip pos="2" side="tl" part="a_nom"/>
                <clip pos="2" side="tl" part="gen"/>
                <clip pos="2" side="tl" part="nbr"/>
              </lu>
              <b pos="2"/>
              <lu> 
                <lit v="de"/>
                <lit-tag v="pr"/>
              </lu>
              <b/>
              <lu>
                <lit v="el"/>
                <lit-tag v="det.def"/>
                <clip pos="3" side="tl" part="gen"/>
                <clip pos="3" side="tl" part="nbr"/>
              </lu>
              <b/>
              <lu>
                <clip pos="3" side="tl" part="lem"/>
                <clip pos="3" side="tl" part="a_nom"/>
                <clip pos="3" side="tl" part="gen"/>
                <clip pos="3" side="tl" part="nbr"/>
              </lu>
            </out>
          </when>
          <when>
            <test>
              <and>
              <equal>
                <clip pos="1" side="sl" part="a_case"/>
                <lit-tag v="dg"/>
              </equal>
             <equal>
                <clip pos="1" side="sl" part="a_def"/>
                <lit-tag v="def"/>
              </equal>
             </and>
            </test>
	     <call-macro n="modcase">
              <with-param pos="1"/>
            </call-macro>
            <out>
              <lu> 
	       <get-case-from pos="1">
                <lit v="a"/>
	       </get-case-from>
                <lit-tag v="pr"/>
              </lu>
              <b/>
              <lu>
                <clip pos="1" side="tl" part="lem"/>
                <clip pos="1" side="tl" part="a_det"/>
                <clip pos="2" side="tl" part="nbr"/>
              </lu>
              <b pos="1"/>
              <lu>
                <lit v="el"/>
                <lit-tag v="det.def"/>
                <clip pos="2" side="tl" part="gen"/>
                <clip pos="2" side="tl" part="nbr"/>
              </lu>
              <b/>
              <lu>
                <clip pos="2" side="tl" part="lem"/>
                <clip pos="2" side="tl" part="a_nom"/>
                <clip pos="2" side="tl" part="gen"/>
                <clip pos="2" side="tl" part="nbr"/>
              </lu>
              <b pos="2"/>
              <lu> 
                <lit v="de"/>
                <lit-tag v="pr"/>
              </lu>
              <b/>
              <lu>
                <lit v="el"/>
                <lit-tag v="det.def"/>
                <clip pos="3" side="tl" part="gen"/>
                <clip pos="3" side="tl" part="nbr"/>
              </lu>
              <b/>
              <lu>
                <clip pos="3" side="tl" part="lem"/>
                <clip pos="3" side="tl" part="a_nom"/>
                <clip pos="3" side="tl" part="gen"/>
                <clip pos="3" side="tl" part="nbr"/>
              </lu>
            </out>
          </when>
          
          <otherwise>
          <!--<choose>
          <when>
            <test>
               <equal>
                <clip pos="1" side="sl" part="a_def"/>
                <lit-tag v="ind"/>
              </equal>
             </test> -->
            <out>
              <lu>
	        <clip pos="1" side="tl" part="lem"/>
                <clip pos="1" side="tl" part="a_det"/>
                <clip pos="2" side="tl" part="nbr"/>
              </lu>
              <b pos="1"/>
              <lu>
                <clip pos="2" side="tl" part="lem"/>
                <clip pos="2" side="tl" part="a_nom"/>
                <clip pos="2" side="tl" part="gen"/>
                <clip pos="2" side="tl" part="nbr"/>
              </lu>
               <b pos="2"/>
              <lu>
                <clip pos="3" side="tl" part="lem"/>
                <clip pos="3" side="tl" part="a_nom"/>
                <clip pos="3" side="tl" part="gen"/>
                <clip pos="3" side="tl" part="nbr"/>
              </lu>
            </out>
       
   </otherwise>          
        </choose> 
      </action>
    </rule> 
   
    <rule>
<!-- REGLA 71: PRETÈRIT INDEFINIT -->
<!-- Para traducir "vaig fer"/"am fäcut" por "hice" -->
      <pattern>
        <pattern-item n="vbaveapri"/>
        <pattern-item n="pp"/>
      </pattern>
      <action>
        <out>
          <lu>
            <get-case-from pos="1">
              <clip pos="2" side="tl" part="lemh"/>
            </get-case-from>
            <clip pos="2" side="tl" part="a_verb"/>
            <lit-tag v="ifi"/>
            <clip pos="1" side="tl" part="persona"/>
            <clip pos="1" side="tl" part="nbr"/>
            <clip pos="2" side="tl" part="lemq"/>
          </lu>
        </out>
        <call-macro n="f_bcond">
          <with-param pos="1"/>
        </call-macro>
      </action>
    </rule>
    
    <rule>
    <!-- REGLA 72: PRETÈRIT INDEFINIT + ENC-->
<!-- Para traducir "la vaig fer"/"am fäcut-o" por "la hice" -->
      <pattern>
        <pattern-item n="vbaveapri"/>
        <pattern-item n="pp"/>
	<pattern-item n="prnenc"/>
      </pattern>
      <action>
        <out>
	  <lu>
	  <get-case-from pos="1">
	    <clip pos="3" side="tl" part="lem"/> 
	  </get-case-from>  
	    <lit-tag v="prn.pro"/>
	    <clip pos="3" side="tl" part="persona"/>
	    <clip pos="3" side="tl" part="gen"/>
	    <clip pos="3" side="tl" part="nbr"/>
	  </lu>
	  <b/>
          <lu>
            <clip pos="2" side="tl" part="lemh"/>
            <clip pos="2" side="tl" part="a_verb"/>
            <lit-tag v="ifi"/>
            <clip pos="1" side="tl" part="persona"/>
            <clip pos="1" side="tl" part="nbr"/>
            <clip pos="2" side="tl" part="lemq"/>
          </lu>
        </out>
        <call-macro n="f_bcond">
          <with-param pos="1"/>
        </call-macro>
      </action>
    </rule>

<rule>
<!-- REGLA 73: CONDICIONAL PASSAT -->
<!-- Per a traduir  "aç fi fäcut" com a "hubiera hecho" que se usa en vez de "habría hecho" -->
      <pattern>
        <pattern-item n="vbaveacni"/>
<!--Gemma <pattern-item n="inf"/> el tagger tria malament, quan trie inf canviar verb per inf-->
        <pattern-item n="verb"/>
        <pattern-item n="pp"/>
      </pattern>
      <action>
       <choose>
        <when>
         <test>
           <equal>
	      <clip pos="2" side="sl" part="lem"/>
		<lit v="fi"/>
	   </equal>                    
	</test> 
        <out>
          <lu>
            <get-case-from pos="1">
              <lit v="haber"/>
            </get-case-from>           
            <lit-tag v="vbhaver.pis"/>
            <clip pos="1" side="tl" part="persona"/>
            <clip pos="1" side="tl" part="nbr"/>
           <!-- <clip pos="1" side="tl" part="lemq"/>-->
          </lu>
          <b/>
          <lu>
            <clip pos="3" side="tl" part="lemh"/>
            <clip pos="3" side="tl" part="a_verb"/>
            <lit-tag v="pp.m.sg"/>
            <clip pos="3" side="tl" part="lemq"/>
          </lu>
        </out>
       </when>
       </choose>
        <call-macro n="f_bcond">
          <with-param pos="1"/>
        </call-macro>
       
      </action>
    </rule>
    
    <rule>
<!-- REGLA 74: CONDICIONAL PRESENT -->
<!-- Per a traduir  "aç face" com a "faria" -->
      <pattern>
        <pattern-item n="vbaveacni"/>
<!--<pattern-item n="inf"/> el tagger tria malament, quan trie inf canviar verb per inf-->
        <pattern-item n="verb"/>
      </pattern>
      <action>
        <out>
          <lu>
            <get-case-from pos="1">
              <clip pos="2" side="tl" part="lemh"/>
            </get-case-from>
            <clip pos="2" side="tl" part="a_verb"/>
            <lit-tag v="cni"/>
            <clip pos="1" side="tl" part="persona"/>
            <clip pos="1" side="tl" part="nbr"/>
            <clip pos="2" side="tl" part="lemq"/>
          </lu>
        </out>
        <call-macro n="f_bcond">
          <with-param pos="1"/>
        </call-macro>
      </action>
    </rule>

 
    
    <rule>
<!-- REGLA 75: FUTUR -->
<!-- Per a traduir "voi face" com a  "faré" -->
      <pattern>
        <pattern-item n="vrea"/>
<!--<pattern-item n="inf"/>el tagger tria malament, quan trie inf canviar verb per inf-->
        <pattern-item n="verb"/>
      </pattern>
      <action>
        <out>
          <lu>
            <get-case-from pos="1">
              <clip pos="2" side="tl" part="lemh"/>
            </get-case-from>
            <clip pos="2" side="tl" part="a_verb"/>
            <lit-tag v="fti"/>
            <clip pos="1" side="tl" part="persona"/>
            <clip pos="1" side="tl" part="nbr"/>
            <clip pos="2" side="tl" part="lemq"/>
          </lu>
        </out>
        <call-macro n="f_bcond">
          <with-param pos="1"/>
        </call-macro>
      </action>
    </rule>
 
<!--REGLA 76 DELIA: VERB Acusativo + PREP PE + NOM - VERB + PREP A + NOM-->
      <rule>
      <pattern>
        <pattern-item n="verb"/>
        <pattern-item n="prep"/>
        <pattern-item n="nom"/>
      </pattern>
       <action>
        <call-macro n="f_modgen">
          <with-param pos="1"/>
        </call-macro>
      <choose>
       <when>
         <test>
           <equal>
	      <clip pos="2" side="sl" part="lem"/>
		<lit v="pe"/>
	   </equal>                        
	</test> 
        <out>
	      <lu>
	       <get-case-from pos="1">
                <clip pos="1" side="tl" part="lem"/>
		</get-case-from>
                <clip pos="1" side="tl" part="a_verb"/>
                <clip pos="1" side="tl" part="temps"/>
                <clip pos="1" side="tl" part="gen"/>
                <clip pos="1" side="tl" part="persona"/>
                <clip pos="1" side="tl" part="nbr"/>
              </lu>
          <b/>
           <lu>
	      <lit v="a"/>
              <lit-tag v="pr"/>
           </lu>
	   <b/>
           <lu>
	        <lit v="el"/>
                <lit-tag v="det.def"/>
                <clip pos="3" side="tl" part="gen"/>
                <clip pos="3" side="tl" part="nbr"/>
           </lu>
           <b/>
           <lu>
              <clip pos="3" side="tl" part="lem"/>
              <clip pos="3" side="tl" part="a_nom"/>  
	      <clip pos="3" side="tl" part="gen"/>
              <clip pos="3" side="tl" part="nbr"/>
            </lu>
         </out>
         </when>
         <otherwise>
	     <out>
             <lu>
	       <get-case-from pos="1">
                <clip pos="1" side="tl" part="lem"/>
		</get-case-from>
                <clip pos="1" side="tl" part="a_verb"/>
                <clip pos="1" side="tl" part="temps"/>
                <clip pos="1" side="tl" part="gen"/>
                <clip pos="1" side="tl" part="persona"/>
                <clip pos="1" side="tl" part="nbr"/>
              </lu>
             <b/>
		<lu>
		    <clip pos="2" side="tl" part="lem"/>
		    <clip pos="2" side="tl" part="a_prep"/>
                  </lu>
		  <b/>
		  <lu>
                    <clip pos="3" side="tl" part="lem"/>
                    <clip pos="3" side="tl" part="a_nom"/>
                    <clip pos="3" side="tl" part="gen"/>
                    <clip pos="3" side="tl" part="nbr"/>
                  </lu>
                </out>
            </otherwise>
          </choose>
        <!--<call-macro n="f_bcond">
          <with-param pos="1"/>
        </call-macro> -->
      </action>
    </rule>



 <!--REGLA 77 DELIA: VERB FUTUR + PREP PE + PRONOM - FUTUR PREP A + PRON-->
      <rule>
      <pattern>
        <pattern-item n="vrea"/>
<!--GEMA <pattern-item n="inf"/>el tagger tria malament, quan trie inf canviar verb per inf-->
        <pattern-item n="verb"/>
        <pattern-item n="prep"/>
        <pattern-item n="prn"/>
      </pattern>
       <action>
      <choose>
       <when>
         <test>
           <equal>
	      <clip pos="3" side="sl" part="lem"/>
		<lit v="pe"/>
	   </equal>                        
	</test> 
        <out>
            <lu>
            <get-case-from pos="1">
              <clip pos="2" side="tl" part="lemh"/>
            </get-case-from>
            <clip pos="2" side="tl" part="a_verb"/>
            <lit-tag v="fti"/>
            <clip pos="1" side="tl" part="persona"/>
            <clip pos="1" side="tl" part="nbr"/>
            <clip pos="2" side="tl" part="lemq"/>
          </lu>
          <b/>
           <lu>
	      <lit v="a"/>
              <lit-tag v="pr"/>
           </lu>
	   <b/>
           <lu>
              <clip pos="4" side="tl" part="lem"/>
              <clip pos="4" side="tl" part="a_prn"/>  
	      <clip pos="4" side="tl" part="gen"/>
              <clip pos="4" side="tl" part="nbr"/>
            </lu>
         </out>
         </when>
         <otherwise>
	     <out>
                 <lu>
            <get-case-from pos="1">
              <clip pos="2" side="tl" part="lemh"/>
            </get-case-from>
            <clip pos="2" side="tl" part="a_verb"/>
            <lit-tag v="fti"/>
            <clip pos="1" side="tl" part="persona"/>
            <clip pos="1" side="tl" part="nbr"/>
            <clip pos="2" side="tl" part="lemq"/>
            </lu>
            <b/>
		<lu>
		    <clip pos="3" side="tl" part="lem"/>
		    <clip pos="3" side="tl" part="a_prep"/>
                  </lu>
		  <b/>
		  <lu>
                    <clip pos="4" side="tl" part="lem"/>
                    <clip pos="4" side="tl" part="a_prn"/>
                    <clip pos="4" side="tl" part="gen"/>
                    <clip pos="4" side="tl" part="nbr"/>
                  </lu>
                </out>
            </otherwise>
          </choose>
        <call-macro n="f_bcond">
          <with-param pos="1"/>
        </call-macro>
      </action>
    </rule>

<!--REGLA 78 DELIA: VERB FUTUR + PREP PE + NOM - FUTUR PREP A + NOM-->
      <rule>
      <pattern>
        <pattern-item n="vrea"/>
<!--GEMA <pattern-item n="inf"/>el tagger tria malament, quan trie inf canviar verb per inf-->
        <pattern-item n="verb"/>
        <pattern-item n="prep"/>
        <pattern-item n="nom"/>
      </pattern>
       <action>
      <choose>
       <when>
         <test>
           <equal>
	      <clip pos="3" side="sl" part="lem"/>
		<lit v="pe"/>
	   </equal>                        
	</test> 
        <out>
            <lu>
            <get-case-from pos="1">
              <clip pos="2" side="tl" part="lemh"/>
            </get-case-from>
            <clip pos="2" side="tl" part="a_verb"/>
            <lit-tag v="fti"/>
            <clip pos="1" side="tl" part="persona"/>
            <clip pos="1" side="tl" part="nbr"/>
            <clip pos="2" side="tl" part="lemq"/>
          </lu>
          <b/>
           <lu>
	      <lit v="a"/>
              <lit-tag v="pr"/>
           </lu>
	   <b/>
           <lu>
	        <lit v="el"/>
                <lit-tag v="det.def"/>
                <clip pos="4" side="tl" part="gen"/>
                <clip pos="4" side="tl" part="nbr"/>
           </lu>
           <b/>
           <lu>
              <clip pos="4" side="tl" part="lem"/>
              <clip pos="4" side="tl" part="a_nom"/>  
	      <clip pos="4" side="tl" part="gen"/>
              <clip pos="4" side="tl" part="nbr"/>
            </lu>
         </out>
         </when>
         <otherwise>
	     <out>
                 <lu>
            <get-case-from pos="1">
              <clip pos="2" side="tl" part="lemh"/>
            </get-case-from>
            <clip pos="2" side="tl" part="a_verb"/>
            <lit-tag v="fti"/>
            <clip pos="1" side="tl" part="persona"/>
            <clip pos="1" side="tl" part="nbr"/>
            <clip pos="2" side="tl" part="lemq"/>
            </lu>
            <b/>
		<lu>
		    <clip pos="3" side="tl" part="lem"/>
		    <clip pos="3" side="tl" part="a_prep"/>
                  </lu>
		  <b/>
		  <lu>
                    <clip pos="4" side="tl" part="lem"/>
                    <clip pos="4" side="tl" part="a_nom"/>
                    <clip pos="4" side="tl" part="gen"/>
                    <clip pos="4" side="tl" part="nbr"/>
                  </lu>
                </out>
            </otherwise>
          </choose>
        <call-macro n="f_bcond">
          <with-param pos="1"/>
        </call-macro>
      </action>
    </rule>

<!--REGLA 79 DELIA: VERB COND + PREP PE + NOM - COND + PREP A + NOM-->
      <rule>
       <pattern>
        <pattern-item n="vbaveacni"/>
<!--GEMA<pattern-item n="inf"/> el tagger tria malament, quan trie inf canviar verb per inf-->
        <pattern-item n="verb"/>
        <pattern-item n="prep"/>
        <pattern-item n="nom"/>
      </pattern>
       <action>
      <choose>
       <when>
         <test>
           <equal>
	      <clip pos="3" side="sl" part="lem"/>
		<lit v="pe"/>
	   </equal>                        
	</test> 
        <out>
             <lu>
            <get-case-from pos="1">
              <clip pos="2" side="tl" part="lemh"/>
            </get-case-from>
            <clip pos="2" side="tl" part="a_verb"/>
            <lit-tag v="cni"/>
            <clip pos="1" side="tl" part="persona"/>
            <clip pos="1" side="tl" part="nbr"/>
            <clip pos="2" side="tl" part="lemq"/>
          </lu>            
          <b/>
           <lu>
	      <lit v="a"/>
              <lit-tag v="pr"/>
           </lu>
	   <b/>
           <lu>
	        <lit v="el"/>
                <lit-tag v="det.def"/>
                <clip pos="4" side="tl" part="gen"/>
                <clip pos="4" side="tl" part="nbr"/>
           </lu>
           <b/>
           <lu>
              <clip pos="4" side="tl" part="lem"/>
              <clip pos="4" side="tl" part="a_nom"/>  
	      <clip pos="4" side="tl" part="gen"/>
              <clip pos="4" side="tl" part="nbr"/>
            </lu>
         </out>
         </when>
         <otherwise>
	     <out>
              <lu>
            <get-case-from pos="1">
              <clip pos="2" side="tl" part="lemh"/>
            </get-case-from>
            <clip pos="2" side="tl" part="a_verb"/>
            <lit-tag v="cni"/>
            <clip pos="1" side="tl" part="persona"/>
            <clip pos="1" side="tl" part="nbr"/>
            <clip pos="2" side="tl" part="lemq"/>
          </lu>
            <b/>
		<lu>
		    <clip pos="3" side="tl" part="lem"/>
		    <clip pos="3" side="tl" part="a_prep"/>
                  </lu>
		  <b/>
		  <lu>
                    <clip pos="4" side="tl" part="lem"/>
                    <clip pos="4" side="tl" part="a_nom"/>
                    <clip pos="4" side="tl" part="gen"/>
                    <clip pos="4" side="tl" part="nbr"/>
                  </lu>
                </out>
            </otherwise>
          </choose>
        <call-macro n="f_bcond">
          <with-param pos="1"/>
        </call-macro>
      </action>
    </rule>
   
    <rule>
<!-- REGLA 80: PLUSQUAMPERFECTE -->
<!-- Para traducir "fäcusem" por "había hecho" -->
      <pattern>
        <pattern-item n="verbpper"/>
      </pattern>
      <action>
        <out>
          <lu>
           <get-case-from pos="1">
              <lit v="haber"/>
            </get-case-from>
            <lit-tag v="vbhaver"/>
            <lit-tag v="pii"/>
            <clip pos="1" side="sl" part="persona"/>
            <clip pos="1" side="sl" part="nbr"/>
          </lu>
          <b/>
          <lu>
            <clip pos="1" side="tl" part="lemh"/>
            <clip pos="1" side="tl" part="a_verb"/>
            <lit-tag v="pp.m.sg"/>
            <clip pos="1" side="tl" part="lemq"/>
          </lu>
        </out>
      </action>
    </rule>
    
    <rule>
<!-- REGLA 81: SUPIN  per a traduir "de fäcut" per "que hacer" /de + prep > que + inf -->
      <pattern>
        <pattern-item n="prepde"/>
        <pattern-item n="pp"/>
      </pattern>
      <action>
        <out>
          <lu>
            <lit v="que"/>
            <lit-tag v="cnjsub"/>
          </lu>
          <b/>
          <lu>
            <clip pos="2" side="tl" part="lem"/>
            <clip pos="2" side="sl" part="a_verb"/>
            <lit-tag v="inf"/>
          </lu>
        </out>
      </action>
    </rule>

    <rule>
<!--REGLA 82: VERB + ENCLÍTIC -->
      <pattern>
        <pattern-item n="verb"/>
        <pattern-item n="prnenc"/>
      </pattern>
      <action>
        <call-macro n="f_modgen">
          <with-param pos="2"/>
        </call-macro>
        <out>
          <mlu>
            <lu>
              <clip pos="1" side="tl" part="lemh"/>
              <clip pos="1" side="tl" part="a_verb"/>
              <clip pos="1" side="tl" part="temps"/>
              <clip pos="1" side="tl" part="persona"/>
              <clip pos="1" side="tl" part="nbr"/>
            </lu>
            <lu>
              <clip pos="2" side="tl" part="lem"/>
              <clip pos="2" side="tl" part="a_prnenc"/>
              <clip pos="2" side="tl" part="persona"/>
              <clip pos="2" side="tl" part="gen"/>
              <clip pos="2" side="tl" part="nbr"/>
              <clip pos="1" side="tl" part="lemq"/>
            </lu>
          </mlu>
        </out>
      </action>
    </rule>
    
    
    <rule>
<!--REGLA 83: VERB + ENCLÍTIC + ENCLÍTIC-->
      <pattern>
        <pattern-item n="verb"/>
        <pattern-item n="prnenc"/>
        <pattern-item n="prnenc"/>
      </pattern>
      <action>
        <call-macro n="f_modgen">
          <with-param pos="2"/>
        </call-macro>
        <call-macro n="f_modgen">
          <with-param pos="3"/>
        </call-macro>
        <out>
          <mlu>
            <lu>
              <clip pos="1" side="tl" part="lemh"/>
              <clip pos="1" side="tl" part="a_verb"/>
              <clip pos="1" side="tl" part="temps"/>
              <clip pos="1" side="tl" part="persona"/>
              <clip pos="1" side="tl" part="nbr"/>
            </lu>
            <lu>
              <clip pos="2" side="tl" part="lem"/>
              <clip pos="2" side="tl" part="a_prnenc"/>
              <clip pos="2" side="tl" part="persona"/>
              <clip pos="2" side="tl" part="gen"/>
              <clip pos="2" side="tl" part="nbr"/>
            </lu>
            <lu>
              <clip pos="3" side="tl" part="lem"/>
              <clip pos="3" side="tl" part="a_prnenc"/>
              <clip pos="3" side="tl" part="persona"/>
              <clip pos="3" side="tl" part="gen"/>
              <clip pos="3" side="tl" part="nbr"/>
              <clip pos="1" side="tl" part="lemq"/>
            </lu>
          </mlu>
        </out>
      </action>
    </rule>
    
    <rule>
<!--REGLA 84: VERB (per a multiparaules sense enclítics)-->
      <pattern>
        <pattern-item n="verb"/>
      </pattern>
      <action>
        <call-macro n="f_modgen">
           <with-param pos="1"/>
        </call-macro>
	<choose>
	  <when>
	    <test> 
	      <in caseless="yes">
	        <clip pos="1" side="sl" part="lem"/>
		<list n="vb2vbref"/>
	      </in>
	    </test>
	    
	    <choose>
	    <when>
	      <test>
	        <equal>
		  <clip pos="1" side="tl" part="temps"/>
		  <lit-tag v="imp"/>
		</equal> 
	      </test> 
	        <choose>    
                 <when>
                  <test>
                    <equal>
                      <clip pos="1" side="tl" part="persona"/>
                     <lit-tag v="p1"/>
                    </equal>
                  </test>
	           <choose>
                    <when>
                     <test>
                       <equal>
                        <clip pos="1" side="tl" part="nbr"/>
                        <lit-tag v="pl"/>
                      </equal>
                     </test>
                      <out>
	               <mlu>
	                 <lu>
                          <clip pos="1" side="tl" part="lemh"/>
                          <clip pos="1" side="tl" part="a_verb"/>
                         <clip pos="1" side="tl" part="temps"/>
                         <clip pos="1" side="tl" part="persona"/>
                         <clip pos="1" side="tl" part="gen"/>
                        <clip pos="1" side="tl" part="nbr"/>
	                <clip pos="1" side="tl" part="lemq"/>
	                </lu>
                        <lu>
                         <get-case-from pos="1">
                          <lit v="nos"/>
                         </get-case-from>
                         <lit-tag v="prn.enc.p1.mf.pl"/>
                       </lu>
		       </mlu>
                       </out>
                    </when>
                  </choose>
                </when>
             <otherwise>
            <choose>
            <when>
              <test>
                <equal>
                  <clip pos="1" side="tl" part="persona"/>
                  <lit-tag v="p2"/>
                </equal>
              </test>
              <choose>
                <when>
                  <test>
                    <equal>
                      <clip pos="1" side="tl" part="nbr"/>
                      <lit-tag v="sg"/>
                    </equal>
                  </test>
                  <out>
		  <mlu>
		   <lu>
                <clip pos="1" side="tl" part="lemh"/>
                <clip pos="1" side="tl" part="a_verb"/>
                <clip pos="1" side="tl" part="temps"/>
                <clip pos="1" side="tl" part="persona"/>
                <clip pos="1" side="tl" part="gen"/>
                <clip pos="1" side="tl" part="nbr"/>
	        <clip pos="1" side="tl" part="lemq"/>
	       </lu>
                    <lu>
                      <get-case-from pos="1">
                        <lit v="te"/>
                      </get-case-from>
                      <lit-tag v="prn.enc.p2.mf.sg"/>
                    </lu>
		    </mlu>
                  </out>
                </when>
                <otherwise>
                  <out>
		  <mlu>
		   <lu>
                <clip pos="1" side="tl" part="lemh"/>
                <clip pos="1" side="tl" part="a_verb"/>
                <clip pos="1" side="tl" part="temps"/>
                <clip pos="1" side="tl" part="persona"/>
                <clip pos="1" side="tl" part="gen"/>
                <clip pos="1" side="tl" part="nbr"/>
	        <clip pos="1" side="tl" part="lemq"/>
	       </lu>
                    <lu>
                      <get-case-from pos="1">
                        <lit v="os"/>
                      </get-case-from>
                      <lit-tag v="prn.enc.p2.mf.pl"/>
                    </lu>
		    </mlu>
                  </out>
                </otherwise>
              </choose>
            </when>
            <otherwise>
              <out>
	      <mlu>
	       <lu>
                <clip pos="1" side="tl" part="lemh"/>
                <clip pos="1" side="tl" part="a_verb"/>
                <clip pos="1" side="tl" part="temps"/>
                <clip pos="1" side="tl" part="persona"/>
                <clip pos="1" side="tl" part="gen"/>
                <clip pos="1" side="tl" part="nbr"/>
	        <clip pos="1" side="tl" part="lemq"/>
	       </lu>
                <lu>
                  <get-case-from pos="1">
                    <lit v="se"/>
                  </get-case-from>
                  <lit-tag v="prn.enc.ref.p3.mf.sp"/>
                </lu>
		</mlu>
              </out>
            </otherwise>
          </choose>
	  </otherwise>
	  </choose>
	 </when>
	 <otherwise>	 
	 <choose>
	   <when>   
	     <test>
	      <and>
	       <not>
	        <equal>
		  <clip pos="1" side="tl" part="temps"/>
		  <lit-tag v="pp"/>
		</equal>
	       </not>
	       <not>
	        <equal>
		  <clip pos="1" side="tl" part="temps"/>
		  <lit-tag v="inf"/>
		</equal>
		</not>
	       <not>
		<equal>
		  <clip pos="1" side="tl" part="temps"/>
		  <lit-tag v="ger"/>
		</equal>
		</not>
	       </and>  	 
	       </test>
	      <call-macro n="prn_verb">
                <with-param pos="1"/>
              </call-macro>
	      <out>   
	       <b/>
               <lu>
                <clip pos="1" side="tl" part="lemh"/>
                <clip pos="1" side="tl" part="a_verb"/>
                <clip pos="1" side="tl" part="temps"/>
                <clip pos="1" side="tl" part="persona"/>
                <clip pos="1" side="tl" part="gen"/>
                <clip pos="1" side="tl" part="nbr"/>
                <clip pos="1" side="tl" part="lemq"/>
               </lu>
              </out>
	     </when>
	     <otherwise>
	       <out>
                <lu>
                  <clip pos="1" side="tl" part="lemh"/>
                  <clip pos="1" side="tl" part="a_verb"/>
                  <clip pos="1" side="tl" part="temps"/>
                  <clip pos="1" side="tl" part="persona"/>
                  <clip pos="1" side="tl" part="gen"/>
                  <clip pos="1" side="tl" part="nbr"/>
                  <clip pos="1" side="tl" part="lemq"/>
               </lu>
               </out>  
	     </otherwise>
	   </choose>
	   </otherwise> 
	  </choose>
	 </when> 
	<otherwise>
           <out>
          <lu>
            <clip pos="1" side="tl" part="lemh"/>
            <clip pos="1" side="tl" part="a_verb"/>
            <clip pos="1" side="tl" part="temps"/>
            <clip pos="1" side="tl" part="persona"/>
            <clip pos="1" side="tl" part="gen"/>
            <clip pos="1" side="tl" part="nbr"/>
            <clip pos="1" side="tl" part="lemq"/>
          </lu>
        </out>
      </otherwise>
    </choose>  
   </action>
  </rule>
  
  
  <rule> <!-- REGLA 85 Verbos pronominales en rumano > no pronominales en castellano -->
  <pattern>
      <pattern-item n="prnproref"/>
      <pattern-item n="verbospron"/>
    </pattern>
    <action>
     <call-macro n="f_modgen">
	   <with-param pos="2"/>
	</call-macro>
      <choose><!--Si la persona del pronombre y el verbo concuerdan, no envíes el pronombre -->
	<when>
	  <test>
	    <equal>
	      <clip pos="1" side="sl" part="persona"/>
	      <clip pos="2" side="sl" part="persona"/>
	    </equal>
	  </test>
	  <call-macro n="f_bcond"><!--Envía el blanco sólo si tiene formato -->
	    <with-param pos="1"/>
	  </call-macro>   
           <out>
          <lu>
	   <get-case-from pos="1">
            <clip pos="2" side="tl" part="lemh"/>
	   </get-case-from> 
            <clip pos="2" side="tl" part="a_verb"/>
            <clip pos="2" side="tl" part="temps"/>
            <clip pos="2" side="tl" part="persona"/>
            <clip pos="2" side="tl" part="gen"/>
            <clip pos="2" side="tl" part="nbr"/>
            <clip pos="2" side="tl" part="lemq"/>
          </lu>
        </out>
	</when>
      </choose>
    </action>
</rule>


<rule> <!-- REGLA 55BIS DELIA ADVCA + NOM: COMO + NOM-->
  <pattern>
      <pattern-item n="advca"/>
      <pattern-item n="nom"/>
    </pattern>
    <action>
      <call-macro n="f_modgen">
        <with-param pos="2"/>
      </call-macro> 
          <out>
          <lu>
            <lit v="como"/>
            <lit-tag v="adv"/>
          </lu> 
          <b/>
          <lu>
            <lit v="el"/>
            <lit-tag v="det.def"/>
            <clip pos="2" side="tl" part="gen"/>
            <clip pos="2" side="tl" part="nbr"/>
          </lu>
          <b/>
          <lu>
                <clip pos="2" side="tl" part="lem"/>
                <clip pos="2" side="tl" part="a_nom"/>
                <clip pos="2" side="tl" part="gen"/>
                <clip pos="2" side="tl" part="nbr"/>
          </lu>                                     
        </out>
    </action>
</rule>    

<rule> <!-- REGLA 55BISBIS DELIA ADVCA + DET IND + NOM: COMO + UN,A + NOM-->
  <pattern>
      <pattern-item n="advca"/>
      <pattern-item n="det"/>
      <pattern-item n="nom"/>
    </pattern>
    <action>
      <call-macro n="f_modgen">
        <with-param pos="2"/>
      </call-macro>
      <call-macro n="f_modgen">
        <with-param pos="3"/>
      </call-macro>
      <call-macro n="f_concord2">
	   <with-param pos="3"/>
           <with-param pos="2"/>
	</call-macro> 
          <out>
          <lu>
            <lit v="como"/>
            <lit-tag v="adv"/>
          </lu> 
          <b/>
          <lu>
                <clip pos="2" side="tl" part="lem"/>
                <clip pos="2" side="tl" part="a_det"/>
                <clip pos="3" side="tl" part="gen"/>
                <clip pos="3" side="tl" part="nbr"/>
          </lu>
          <b/>
          <lu>
                <clip pos="3" side="tl" part="lem"/>
                <clip pos="3" side="tl" part="a_nom"/>
                <clip pos="3" side="tl" part="gen"/>
                <clip pos="3" side="tl" part="nbr"/>
          </lu>                                     
        </out>
    </action>
</rule>     

<rule>
<!--REGLA 86 mai + adj + ca = más + adj + que-->
<pattern>
	<pattern-item n="adv"/>
	<pattern-item n="adj"/>
	<pattern-item n="advca"/>
</pattern>
  <action>
        <call-macro n="f_modgen">
	   <with-param pos="2"/>
	</call-macro>
	<call-macro n="f_concord1">
	   <with-param pos="2"/>
	</call-macro>
	<choose>
	  <when>
	    <test>
	      <equal>
	        <clip pos="1" side="sl" part="lem"/>
		<lit v="mai"/>
	      </equal>
	     </test>
	     <out>
	     <lu>
	       <lit v="más"/>
	       <lit-tag v="adv"/>
	      </lu>
	        <b pos="1"/>
		<lu>
                    <clip pos="2" side="tl" part="lem"/>
                    <clip pos="2" side="tl" part="a_adj"/>
                    <clip pos="2" side="tl" part="gen"/>
                    <clip pos="2" side="tl" part="nbr"/>
                  </lu>
	        <b pos="2"/>
	      <lu>
	         <lit v="que"/>
		 <lit-tag v="adv"/>
	       </lu>
	     </out>
	   </when>
	   <otherwise>
	     <out>
	       <lu>
	         <clip pos="1" side="tl" part="whole"/>
	       </lu>
	       <b pos="1"/>
	       <lu>
                    <clip pos="2" side="tl" part="lem"/>
                    <clip pos="2" side="tl" part="a_adj"/>
                    <clip pos="2" side="tl" part="gen"/>
                    <clip pos="2" side="tl" part="nbr"/>
	       </lu>
	       <b pos="2"/>
	       <lu>
	         <clip pos="3" side="tl" part="whole"/>
		</lu>
	      </out>
	    </otherwise>
	   </choose>
	  </action>
</rule>
	   

<!-- <rule>
<!-*- REGLA 26 nu aça de + adj= no tan + adj-*->
<pattern>
        <pattern-item n="adv"/>
	<pattern-item n="adv"/>
        <pattern-item n="prep"/>
	<pattern-item n="adj"/>
</pattern>
    <action>
    	<call-macro n="f_modgen">
	   <with-param pos="3"/>
	</call-macro>
    	<call-macro n="f_concord1">
	   <with-param pos="3"/>
	</call-macro>
	<choose>
	  <when>
	    <test>
              <equal>
	        <clip pos="2" side="sl" part="lem"/>
		<lit v="aça"/>
	      </equal>
              </test>
	     <out>
               <lu>
	       <lit v="no"/>
	       <lit-tag v="adv"/>
	      </lu>
              <b pos="1"/>
               <lu>
	       <lit v="tan"/>
	       <lit-tag v="preadv"/>
	      </lu>
	        <b pos="2"/>
		<lu>
                    <clip pos="3" side="tl" part="lem"/>
                    <clip pos="3" side="tl" part="a_adj"/>
                    <clip pos="3" side="tl" part="gen"/>
                    <clip pos="3" side="tl" part="nbr"/>
                  </lu>
	        <b pos="3"/>
	      <lu>
	         <lit v="que"/>
		 <lit-tag v="adv"/>
	       </lu>
	     </out>
              </when>
	 <otherwise>
	     <out>
	       <lu>
	       <clip pos="1" side="tl" part="whole"/>
	       </lu>
	       <b pos="1"/>
	       <lu>
	       <clip pos="2" side="tl" part="whole"/>
	       </lu>
	       <b pos="2"/>
	       <lu>
	       <clip pos="3" side="tl" part="whole"/>
	       </lu>
	       </out>
	     </otherwise>
	    </choose>
	   </action>
 </rule> 

<rule>
<!-*- REGLA 27 nu aça de + adj + ca = no tan + adj + que-*->
<pattern>
	<pattern-item n="adv"/>
        <pattern-item n="adv"/>
        <pattern-item n="prep"/>
	<pattern-item n="adj"/>
	<pattern-item n="advca"/>
    </pattern>
    <action>
    	<call-macro n="f_modgen">
	   <with-param pos="4"/>
	</call-macro>
    	<call-macro n="f_concord1">
	   <with-param pos="4"/>
	</call-macro>
	<choose>
	  <when>
	    <test>
              <and>
	      <equal>
	        <clip pos="1" side="sl" part="lem"/>
		<lit v="nu"/>
	      </equal>
	      <equal>
	        <clip pos="2" side="sl" part="lem"/>
		<lit v="aça"/>
	      </equal>
              </and>
	     </test>
	     <out>
	       <lu>
	         <lit v="no"/>
		 <lit-tag v="adv"/>
	       </lu>
	         <b pos="1"/>
               <lu>
	         <lit v="tan"/>
		 <lit-tag v="preadv"/>
	       </lu>
	         <b pos="2"/>
	       <lu>
	       <clip pos="4" side="tl" part="whole"/>
	       </lu>
	         <b pos="3"/>
	       <lu>
	         <lit v="que"/>
		 <lit-tag v="adv"/>
	       </lu>
	     </out>
	   </when>
	 <otherwise>
	     <out>
	       <lu>
	       <clip pos="1" side="tl" part="whole"/>
	       </lu>
	       <b pos="1"/>
	       <lu>
	       <clip pos="2" side="tl" part="whole"/>
	       </lu>
	       <b pos="2"/>
	       <lu>
	       <clip pos="3" side="tl" part="whole"/>
	       </lu>
	       </out>
	     </otherwise>
	    </choose>
	   </action>
 </rule> -->


 
 <rule>
 <!--  REGLA 87: NOM + NOM PROPI LLOC DG  ex. hotarele Europei = los confines de Europa -->
      <pattern>
        <pattern-item n="nom"/>
        <pattern-item n="nploc"/>
      </pattern>
      <action> 
         <call-macro n="f_concord1">
          <with-param pos="1"/>
        </call-macro>   
	 <call-macro n="f_concord1">
          <with-param pos="2"/>
        </call-macro>    
         <choose>
          <when>
             <test>
              <and>
		<equal>
                  <clip pos="1" side="sl" part="a_case"/>
                  <lit-tag v="nom"/>
              </equal>	      
              <equal>
	        <clip pos="1" side="sl" part="a_def"/>
		<lit-tag v="def"/>
	      </equal>
              <equal>
                  <clip pos="2" side="sl" part="a_case"/>
                  <lit-tag v="dg"/>
                </equal>
	      <equal>
	        <clip pos="2" side="sl" part="a_def"/>
                  <lit-tag v="def"/>
              </equal>
              </and>
            </test>
             <call-macro n="modcase">
               <with-param pos="1"/>
            </call-macro>
	       <out>
                  <lu>		  
		<get-case-from pos="1">
                    <lit v="el"/>
                </get-case-from>
		    <lit-tag v="det.def"/>
                    <clip pos="1" side="tl" part="gen"/>
                    <clip pos="1" side="tl" part="nbr"/>
                  </lu>
                  <b/>
                  <lu>
		    <clip pos="1" side="tl" part="lem"/>
		    <clip pos="1" side="tl" part="a_nom"/>
                    <clip pos="1" side="tl" part="gen"/>
                    <clip pos="1" side="tl" part="nbr"/>
  		</lu>
		<b pos="1"/>
		  <lu>
                   <lit v="de"/>
		   <lit-tag v="pr"/>
                  </lu>
                 <b/>
                  <lu>
                    <clip pos="2" side="tl" part="lem"/>
                    <clip pos="2" side="tl" part="a_nploc"/>
                    <clip pos="2" side="tl" part="gen"/>
                    <clip pos="2" side="tl" part="nbr"/>
                  </lu>
                </out>
		</when>
               <otherwise>
                <out>
                  <lu>
                    <clip pos="1" side="tl" part="lem"/>
                    <clip pos="1" side="tl" part="a_nom"/>
                    <clip pos="1" side="tl" part="gen"/>
                    <clip pos="1" side="tl" part="nbr"/>
                  </lu>
		  <b pos="1"/>
                  <lu>
                    <clip pos="2" side="tl" part="lem"/>
                    <clip pos="2" side="tl" part="a_nploc"/>
                    <clip pos="2" side="tl" part="gen"/>
                    <clip pos="2" side="tl" part="nbr"/>
                  </lu>
                </out>
              </otherwise>
	    </choose> 
       </action>
    </rule>

 <rule>
 <!--  REGLA 88: PREP + NOM + NOM PROPI LLOC DG  ex. la hotarele Europei = a los confines de Europa -->
      <pattern>
        <pattern-item n="prep"/>
        <pattern-item n="nom"/>
        <pattern-item n="nploc"/>
      </pattern>
      <action> 
         <call-macro n="f_concord1">
          <with-param pos="2"/>
        </call-macro>   
	 <call-macro n="f_concord1">
          <with-param pos="3"/>
        </call-macro>    
         <choose>
          <when>
             <test>
              <and>
		<equal>
                  <clip pos="2" side="sl" part="a_case"/>
                  <lit-tag v="nom"/>
              </equal>	      
              <equal>
	        <clip pos="2" side="sl" part="a_def"/>
		<lit-tag v="def"/>
	      </equal>
              <equal>
                  <clip pos="3" side="sl" part="a_case"/>
                  <lit-tag v="dg"/>
                </equal>
	      <equal>
	        <clip pos="3" side="sl" part="a_def"/>
                  <lit-tag v="def"/>
              </equal>
              </and>
            </test>
             <call-macro n="modcase">
               <with-param pos="2"/>
            </call-macro>
	       <out>
                  <lu>
                    <get-case-from pos="1">
                    <clip pos="1" side="tl" part="lem"/>
                    </get-case-from> 
                    <clip pos="1" side="tl" part="a_prep"/>     		     
  		</lu>
		<b pos="1"/>
                  <lu>		  
		    <lit v="el"/>
                    <lit-tag v="det.def"/>
                    <clip pos="2" side="tl" part="gen"/>
                    <clip pos="2" side="tl" part="nbr"/>
                  </lu>
                  <b/>
                  <lu>
		    <clip pos="2" side="tl" part="lem"/>
		    <clip pos="2" side="tl" part="a_nom"/>
                    <clip pos="2" side="tl" part="gen"/>
                    <clip pos="2" side="tl" part="nbr"/>
  		</lu>
		<b pos="2"/>
		  <lu>
                   <lit v="de"/>
		   <lit-tag v="pr"/>
                  </lu>
                 <b/>
                  <lu>
                    <clip pos="3" side="tl" part="lem"/>
                    <clip pos="3" side="tl" part="a_nploc"/>
                    <clip pos="3" side="tl" part="gen"/>
                    <clip pos="3" side="tl" part="nbr"/>
                  </lu>
                </out>
		</when>
               <otherwise>
                <out>
                  <lu>
                    <clip pos="1" side="tl" part="lem"/>
                    <clip pos="1" side="tl" part="a_prep"/>                    
                  </lu>
		  <b pos="1"/>
                  <lu>
                    <clip pos="1" side="tl" part="lem"/>
                    <clip pos="1" side="tl" part="a_nom"/>
                    <clip pos="1" side="tl" part="gen"/>
                    <clip pos="1" side="tl" part="nbr"/>
                  </lu>
		  <b pos="2"/>
                  <lu>
                    <clip pos="3" side="tl" part="lem"/>
                    <clip pos="3" side="tl" part="a_nploc"/>
                    <clip pos="3" side="tl" part="gen"/>
                    <clip pos="3" side="tl" part="nbr"/>
                  </lu>
                </out>
              </otherwise>
	    </choose> 
       </action>
    </rule>

<rule>
 <!-- REGLA 89: PREP DINTR- (de) + un, o (art ind)  per a traduir "de un, de una" -->
      <pattern>
        <pattern-item n="prepdintr-"/>
        <pattern-item n="detind"/>
      </pattern>
      <action>
      <choose>
	  <when>
	    <test>
              <equal>
	        <clip pos="1" side="sl" part="lem"/>
		<lit v="dintr-"/>
	      </equal>
	    </test>
        <out>
          <lu>
            <lit v="de"/>
            <lit-tag v="pr"/>
          </lu>
          <b/>
          <lu>
            <lit-tag v="det.ind"/>
                 <clip pos="2" side="tl" part="gen"/>
                 <clip pos="2" side="tl" part="nbr"/>
          </lu>
        </out>
       </when>
      </choose>
      </action>
    </rule> 


<rule>
<!-- REGLA 90: reset variables-->
      <pattern>
        <pattern-item n="sent"/>
      </pattern>
      <action>
        <let>
          <var n="numero"/>
          <lit-tag v="sg"/>
        </let>
        <let>
          <var n="genero"/>
          <lit-tag v="m"/>
        </let>
        <out>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
        </out>
      </action>
    </rule>
  </section-rules>
</transfer>
